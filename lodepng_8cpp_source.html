<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>NTrace: src/framework/3rdparty/lodepng/lodepng.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">NTrace
   </div>
   <div id="projectbrief">GPU ray tracing framework</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('lodepng_8cpp_source.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Macros</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">lodepng.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="lodepng_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">LodePNG version 20110823</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">Copyright (c) 2005-2011 Lode Vandevenne</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">This software is provided &#39;as-is&#39;, without any express or implied</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">warranty. In no event will the authors be held liable for any damages</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">arising from the use of this software.</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">Permission is granted to anyone to use this software for any purpose,</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">including commercial applications, and to alter it and redistribute it</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">freely, subject to the following restrictions:</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">    1. The origin of this software must not be misrepresented; you must not</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">    claim that you wrote the original software. If you use this software</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">    in a product, an acknowledgment in the product documentation would be</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">    appreciated but is not required.</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">    2. Altered source versions must be plainly marked as such, and must not be</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">    misrepresented as being the original software.</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">    3. This notice may not be removed or altered from any source</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">    distribution.</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">*/</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment">The manual and changelog are in the header file &quot;lodepng.h&quot;</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment">Rename this file to lodepng.cpp to use it for C++, or to lodepng.c to use it for C.</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment">*/</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="lodepng_8h.html">lodepng.h</a>&quot;</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#include &lt;stdio.h&gt;</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="preprocessor">#include &lt;stdlib.h&gt;</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="preprocessor">#ifdef __cplusplus</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#include &lt;fstream&gt;</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/*__cplusplus*/</span><span class="preprocessor"></span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00040"></a><span class="lineno"><a class="line" href="lodepng_8cpp.html#a698acb89e1bf5837b33c30ef35c30044">   40</a></span>&#160;<span class="preprocessor">#define VERSION_STRING &quot;20110823&quot;</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="comment">This source file is built up in the following large parts. The code sections</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment">with the &quot;LODEPNG_COMPILE_&quot; #defines divide this up further in an intermixed way.</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="comment">-Tools for C and common code for PNG and Zlib</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="comment">-C Code for Zlib (huffman, deflate, ...)</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment">-C Code for PNG (file format chunks, adam7, PNG filters, color conversions, ...)</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment">-The C++ wrapper around all of the above</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="comment">*/</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="comment">/* ////////////////////////////////////////////////////////////////////////// */</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="comment">/* ////////////////////////////////////////////////////////////////////////// */</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="comment">/* // Tools for C, and common code for PNG and Zlib.                       // */</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="comment">/* ////////////////////////////////////////////////////////////////////////// */</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="comment">/* ////////////////////////////////////////////////////////////////////////// */</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="comment">Often in case of an error a value is assigned to a variable and then it breaks</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="comment">out of a loop (to go to the cleanup phase of a function). This macro does that.</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="comment">It makes the error handling code shorter and more readable.</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="comment">Example: if(!uivector_resizev(&amp;frequencies_ll, 286, 0)) ERROR_BREAK(9924);</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="comment">*/</span></div>
<div class="line"><a name="l00064"></a><span class="lineno"><a class="line" href="lodepng_8cpp.html#af803b1b42c6d252d173df9cd0b32725a">   64</a></span>&#160;<span class="preprocessor">#define CERROR_BREAK(errorvar, code)\</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="preprocessor">{\</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="preprocessor">  errorvar = code;\</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="preprocessor">  break;\</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="preprocessor">}</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="comment">/*version of CERROR_BREAK that assumes the common case where the error variable is named &quot;error&quot;*/</span></div>
<div class="line"><a name="l00071"></a><span class="lineno"><a class="line" href="lodepng_8cpp.html#a691b23954341613b96b6d98ce67d339c">   71</a></span>&#160;<span class="preprocessor">#define ERROR_BREAK(code) CERROR_BREAK(error, code)</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="comment">About vector, uivector, ucvector and string:</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="comment">-All of them wrap dynamic arrays or text strings in a similar way.</span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="comment">-LodePNG was originally written in C++. The vectors replace the std::vectors that were used in the C++ version.</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="comment">-The string tools are made to avoid problems with compilers that declare things like strncat as deprecated.</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="comment">-They&#39;re not used in the interface, only internally in this file as static functions.</span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="comment">-As with many other structs in this file, the init and cleanup functions serve as ctor and dtor.</span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="comment">*/</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="preprocessor">#ifdef LODEPNG_COMPILE_ZLIB</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef LODEPNG_COMPILE_ENCODER</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00085"></a><span class="lineno"><a class="line" href="structvector.html">   85</a></span>&#160;<span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structvector.html">vector</a> <span class="comment">/*dynamic vector of void* pointers. This one is used only by the deflate compressor*/</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;{</div>
<div class="line"><a name="l00087"></a><span class="lineno"><a class="line" href="structvector.html#afee87fd86bbabb017991064293317a8b">   87</a></span>&#160;  <span class="keywordtype">void</span>* <a class="code" href="structvector.html#afee87fd86bbabb017991064293317a8b">data</a>;</div>
<div class="line"><a name="l00088"></a><span class="lineno"><a class="line" href="structvector.html#a4200005b6949608d6a533db1a0d299c8">   88</a></span>&#160;  <span class="keywordtype">size_t</span> <a class="code" href="structvector.html#a4200005b6949608d6a533db1a0d299c8">size</a>; <span class="comment">/*in groups of bytes depending on type*/</span></div>
<div class="line"><a name="l00089"></a><span class="lineno"><a class="line" href="structvector.html#a52795ebc16dc899ccb6c1f9f6238921a">   89</a></span>&#160;  <span class="keywordtype">size_t</span> <a class="code" href="structvector.html#a52795ebc16dc899ccb6c1f9f6238921a">allocsize</a>; <span class="comment">/*in bytes*/</span></div>
<div class="line"><a name="l00090"></a><span class="lineno"><a class="line" href="structvector.html#aab0b37e2650659a664f4c993e6309d42">   90</a></span>&#160;  <span class="keywordtype">unsigned</span> <a class="code" href="structvector.html#aab0b37e2650659a664f4c993e6309d42">typesize</a>; <span class="comment">/*sizeof the type you store in data*/</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;} <a class="code" href="lodepng_8cpp.html#a604ea30e5e116f443a85a821a53402c7">vector</a>;</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="keyword">static</span> <span class="keywordtype">unsigned</span> vector_resize(<a class="code" href="structvector.html">vector</a>* <a class="code" href="_d_l_l_imports_8inl.html#a5a11afa44e3df9fa01e461dc15484392">p</a>, <span class="keywordtype">size_t</span> <a class="code" href="_d_l_l_imports_8inl.html#abcaf2e752dfff61ecb0b2d0a593966ee">size</a>) <span class="comment">/*returns 1 if success, 0 if failure ==&gt; nothing done*/</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;{</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;  <span class="keywordflow">if</span>(size * p-&gt;<a class="code" href="structvector.html#aab0b37e2650659a664f4c993e6309d42">typesize</a> &gt; p-&gt;<a class="code" href="structvector.html#a52795ebc16dc899ccb6c1f9f6238921a">allocsize</a>)</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;  {</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    <span class="keywordtype">size_t</span> newsize = size * p-&gt;<a class="code" href="structvector.html#aab0b37e2650659a664f4c993e6309d42">typesize</a> * 2;</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    <span class="keywordtype">void</span>* <a class="code" href="_d_l_l_imports_8inl.html#a156a9c7e986e0352d0fe500e629d5171">data</a> = <a class="code" href="namespace_f_w.html#a1c91e4066f0cc4e93981c3a04a229198">realloc</a>(p-&gt;<a class="code" href="structvector.html#afee87fd86bbabb017991064293317a8b">data</a>, newsize);</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    <span class="keywordflow">if</span>(data)</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    {</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;      p-&gt;<a class="code" href="structvector.html#a52795ebc16dc899ccb6c1f9f6238921a">allocsize</a> = newsize;</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;      p-&gt;<a class="code" href="structvector.html#afee87fd86bbabb017991064293317a8b">data</a> = <a class="code" href="_d_l_l_imports_8inl.html#a156a9c7e986e0352d0fe500e629d5171">data</a>;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;      p-&gt;<a class="code" href="structvector.html#a4200005b6949608d6a533db1a0d299c8">size</a> = <a class="code" href="_d_l_l_imports_8inl.html#abcaf2e752dfff61ecb0b2d0a593966ee">size</a>;</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    }</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;  }</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;  <span class="keywordflow">else</span> p-&gt;<a class="code" href="structvector.html#a4200005b6949608d6a533db1a0d299c8">size</a> = <a class="code" href="_d_l_l_imports_8inl.html#abcaf2e752dfff61ecb0b2d0a593966ee">size</a>;</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;  <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;}</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="comment">/*resize and use destructor on elements if it gets smaller*/</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="keyword">static</span> <span class="keywordtype">unsigned</span> vector_resized(<a class="code" href="structvector.html">vector</a>* <a class="code" href="_d_l_l_imports_8inl.html#a5a11afa44e3df9fa01e461dc15484392">p</a>, <span class="keywordtype">size_t</span> <a class="code" href="_d_l_l_imports_8inl.html#abcaf2e752dfff61ecb0b2d0a593966ee">size</a>, <span class="keywordtype">void</span> dtor(<span class="keywordtype">void</span>*))</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;{</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;  <span class="keywordtype">size_t</span> i;</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;  <span class="keywordflow">if</span>(size &lt; p-&gt;size)</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;  {</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    <span class="keywordflow">for</span>(i = size; i &lt; p-&gt;<a class="code" href="structvector.html#a4200005b6949608d6a533db1a0d299c8">size</a>; i++)</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    {</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;      dtor(&amp;((<span class="keywordtype">char</span>*)(p-&gt;<a class="code" href="structvector.html#afee87fd86bbabb017991064293317a8b">data</a>))[i * p-&gt;<a class="code" href="structvector.html#aab0b37e2650659a664f4c993e6309d42">typesize</a>]);</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    }</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;  }</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;  <span class="keywordflow">return</span> vector_resize(p, size);</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;}</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> vector_cleanup(<span class="keywordtype">void</span>* p)</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;{</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;  ((<a class="code" href="structvector.html">vector</a>*)p)-&gt;size = ((<a class="code" href="structvector.html">vector</a>*)p)-&gt;allocsize = 0;</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;  <a class="code" href="namespace_f_w.html#a93be8f55938d6ffb5ca0af1f95f81589">free</a>(((<a class="code" href="structvector.html">vector</a>*)p)-&gt;<a class="code" href="_d_l_l_imports_8inl.html#a156a9c7e986e0352d0fe500e629d5171">data</a>);</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;  ((<a class="code" href="structvector.html">vector</a>*)p)-&gt;data = <a class="code" href="_defs_8hpp.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;}</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> vector_cleanupd(<a class="code" href="structvector.html">vector</a>* p, <span class="keywordtype">void</span> dtor(<span class="keywordtype">void</span>*)) <span class="comment">/*clear and use destructor on elements*/</span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;{</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;  vector_resized(p, 0, dtor);</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;  vector_cleanup(p);</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;}</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> vector_init(<a class="code" href="structvector.html">vector</a>* p, <span class="keywordtype">unsigned</span> typesize)</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;{</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;  p-&gt;<a class="code" href="structvector.html#afee87fd86bbabb017991064293317a8b">data</a> = <a class="code" href="_defs_8hpp.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;  p-&gt;<a class="code" href="structvector.html#a4200005b6949608d6a533db1a0d299c8">size</a> = p-&gt;<a class="code" href="structvector.html#a52795ebc16dc899ccb6c1f9f6238921a">allocsize</a> = 0;</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;  p-&gt;<a class="code" href="structvector.html#aab0b37e2650659a664f4c993e6309d42">typesize</a> = typesize;</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;}</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> vector_swap(<a class="code" href="structvector.html">vector</a>* p, <a class="code" href="structvector.html">vector</a>* q) <span class="comment">/*they&#39;re supposed to have the same typesize*/</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;{</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;  <span class="keywordtype">size_t</span> tmp;</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;  <span class="keywordtype">void</span>* tmpp;</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;  tmp = p-&gt;<a class="code" href="structvector.html#a4200005b6949608d6a533db1a0d299c8">size</a>; p-&gt;<a class="code" href="structvector.html#a4200005b6949608d6a533db1a0d299c8">size</a> = q-&gt;<a class="code" href="structvector.html#a4200005b6949608d6a533db1a0d299c8">size</a>; q-&gt;<a class="code" href="structvector.html#a4200005b6949608d6a533db1a0d299c8">size</a> = tmp;</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;  tmp = p-&gt;<a class="code" href="structvector.html#a52795ebc16dc899ccb6c1f9f6238921a">allocsize</a>; p-&gt;<a class="code" href="structvector.html#a52795ebc16dc899ccb6c1f9f6238921a">allocsize</a> = q-&gt;<a class="code" href="structvector.html#a52795ebc16dc899ccb6c1f9f6238921a">allocsize</a>; q-&gt;<a class="code" href="structvector.html#a52795ebc16dc899ccb6c1f9f6238921a">allocsize</a> = tmp;</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;  tmpp = p-&gt;<a class="code" href="structvector.html#afee87fd86bbabb017991064293317a8b">data</a>; p-&gt;<a class="code" href="structvector.html#afee87fd86bbabb017991064293317a8b">data</a> = q-&gt;<a class="code" href="structvector.html#afee87fd86bbabb017991064293317a8b">data</a>; q-&gt;<a class="code" href="structvector.html#afee87fd86bbabb017991064293317a8b">data</a> = tmpp;</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;}</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span>* vector_get(<a class="code" href="structvector.html">vector</a>* p, <span class="keywordtype">size_t</span> <a class="code" href="_d_l_l_imports_8inl.html#abf1b96ba8e05b846fde16efb5851232e">index</a>)</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;{</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;  <span class="keywordflow">return</span> &amp;((<span class="keywordtype">char</span>*)p-&gt;<a class="code" href="structvector.html#afee87fd86bbabb017991064293317a8b">data</a>)[index * p-&gt;<a class="code" href="structvector.html#aab0b37e2650659a664f4c993e6309d42">typesize</a>];</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;}</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/*LODEPNG_COMPILE_ENCODER*/</span><span class="preprocessor"></span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#endif </span><span class="comment">/*LODEPNG_COMPILE_ZLIB*/</span><span class="preprocessor"></span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;<span class="comment">/* /////////////////////////////////////////////////////////////////////////// */</span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;<span class="preprocessor">#ifdef LODEPNG_COMPILE_ZLIB</span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;<span class="preprocessor"></span><span class="comment">/*dynamic vector of unsigned ints*/</span></div>
<div class="line"><a name="l00166"></a><span class="lineno"><a class="line" href="structuivector.html">  166</a></span>&#160;<span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structuivector.html">uivector</a></div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;{</div>
<div class="line"><a name="l00168"></a><span class="lineno"><a class="line" href="structuivector.html#a427d761df4bb4f0f19b4a973fc224c78">  168</a></span>&#160;  <span class="keywordtype">unsigned</span>* <a class="code" href="structuivector.html#a427d761df4bb4f0f19b4a973fc224c78">data</a>;</div>
<div class="line"><a name="l00169"></a><span class="lineno"><a class="line" href="structuivector.html#aa999025945f0c93d0461192475ae2720">  169</a></span>&#160;  <span class="keywordtype">size_t</span> <a class="code" href="structuivector.html#aa999025945f0c93d0461192475ae2720">size</a>; <span class="comment">/*size in number of unsigned longs*/</span></div>
<div class="line"><a name="l00170"></a><span class="lineno"><a class="line" href="structuivector.html#aac0395a9ad397ae7a28219561ab49ffa">  170</a></span>&#160;  <span class="keywordtype">size_t</span> <a class="code" href="structuivector.html#aac0395a9ad397ae7a28219561ab49ffa">allocsize</a>; <span class="comment">/*allocated size in bytes*/</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;} <a class="code" href="lodepng_8cpp.html#a358797f791102c447e2e895e8da46854">uivector</a>;</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> uivector_cleanup(<span class="keywordtype">void</span>* p)</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;{</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;  ((<a class="code" href="structuivector.html">uivector</a>*)p)-&gt;size = ((<a class="code" href="structuivector.html">uivector</a>*)p)-&gt;allocsize = 0;</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;  <a class="code" href="namespace_f_w.html#a93be8f55938d6ffb5ca0af1f95f81589">free</a>(((<a class="code" href="structuivector.html">uivector</a>*)p)-&gt;<a class="code" href="_d_l_l_imports_8inl.html#a156a9c7e986e0352d0fe500e629d5171">data</a>);</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;  ((<a class="code" href="structuivector.html">uivector</a>*)p)-&gt;data = <a class="code" href="_defs_8hpp.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;}</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;<span class="comment">/*returns 1 if success, 0 if failure ==&gt; nothing done*/</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;<span class="keyword">static</span> <span class="keywordtype">unsigned</span> uivector_resize(<a class="code" href="structuivector.html">uivector</a>* p, <span class="keywordtype">size_t</span> size)</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;{</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;  <span class="keywordflow">if</span>(size * <span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span>) &gt; p-&gt;<a class="code" href="structuivector.html#aac0395a9ad397ae7a28219561ab49ffa">allocsize</a>)</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;  {</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    <span class="keywordtype">size_t</span> newsize = size * <span class="keyword">sizeof</span>(unsigned) * 2;</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    <span class="keywordtype">void</span>* <a class="code" href="_d_l_l_imports_8inl.html#a156a9c7e986e0352d0fe500e629d5171">data</a> = <a class="code" href="namespace_f_w.html#a1c91e4066f0cc4e93981c3a04a229198">realloc</a>(p-&gt;<a class="code" href="structuivector.html#a427d761df4bb4f0f19b4a973fc224c78">data</a>, newsize);</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    <span class="keywordflow">if</span>(data)</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    {</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;      p-&gt;<a class="code" href="structuivector.html#aac0395a9ad397ae7a28219561ab49ffa">allocsize</a> = newsize;</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;      p-&gt;<a class="code" href="structuivector.html#a427d761df4bb4f0f19b4a973fc224c78">data</a> = (<span class="keywordtype">unsigned</span>*)data;</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;      p-&gt;<a class="code" href="structuivector.html#aa999025945f0c93d0461192475ae2720">size</a> = <a class="code" href="_d_l_l_imports_8inl.html#abcaf2e752dfff61ecb0b2d0a593966ee">size</a>;</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    }</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;  }</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;  <span class="keywordflow">else</span> p-&gt;<a class="code" href="structuivector.html#aa999025945f0c93d0461192475ae2720">size</a> = <a class="code" href="_d_l_l_imports_8inl.html#abcaf2e752dfff61ecb0b2d0a593966ee">size</a>;</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;  <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;}</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;<span class="comment">/*resize and give all new elements the value*/</span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;<span class="keyword">static</span> <span class="keywordtype">unsigned</span> uivector_resizev(<a class="code" href="structuivector.html">uivector</a>* p, <span class="keywordtype">size_t</span> size, <span class="keywordtype">unsigned</span> <a class="code" href="_d_l_l_imports_8inl.html#a3f2d6cd655118d09cc005e6760706570">value</a>)</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;{</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;  <span class="keywordtype">size_t</span> oldsize = p-&gt;<a class="code" href="structuivector.html#aa999025945f0c93d0461192475ae2720">size</a>, i;</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;  <span class="keywordflow">if</span>(!uivector_resize(p, size)) <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;  <span class="keywordflow">for</span>(i = oldsize; i &lt; <a class="code" href="_d_l_l_imports_8inl.html#abcaf2e752dfff61ecb0b2d0a593966ee">size</a>; i++) p-&gt;<a class="code" href="structuivector.html#a427d761df4bb4f0f19b4a973fc224c78">data</a>[i] = value;</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;  <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;}</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> uivector_init(<a class="code" href="structuivector.html">uivector</a>* p)</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;{</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;  p-&gt;<a class="code" href="structuivector.html#a427d761df4bb4f0f19b4a973fc224c78">data</a> = <a class="code" href="_defs_8hpp.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;  p-&gt;<a class="code" href="structuivector.html#aa999025945f0c93d0461192475ae2720">size</a> = p-&gt;<a class="code" href="structuivector.html#aac0395a9ad397ae7a28219561ab49ffa">allocsize</a> = 0;</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;}</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;<span class="preprocessor">#ifdef LODEPNG_COMPILE_ENCODER</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;<span class="preprocessor"></span><span class="comment">/*returns 1 if success, 0 if failure ==&gt; nothing done*/</span></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;<span class="keyword">static</span> <span class="keywordtype">unsigned</span> uivector_push_back(<a class="code" href="structuivector.html">uivector</a>* p, <span class="keywordtype">unsigned</span> c)</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;{</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;  <span class="keywordflow">if</span>(!uivector_resize(p, p-&gt;<a class="code" href="structuivector.html#aa999025945f0c93d0461192475ae2720">size</a> + 1)) <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;  p-&gt;<a class="code" href="structuivector.html#a427d761df4bb4f0f19b4a973fc224c78">data</a>[p-&gt;<a class="code" href="structuivector.html#aa999025945f0c93d0461192475ae2720">size</a> - 1] = c;</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;  <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;}</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;<span class="comment">/*copy q to p, returns 1 if success, 0 if failure ==&gt; nothing done*/</span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;<span class="keyword">static</span> <span class="keywordtype">unsigned</span> uivector_copy(<a class="code" href="structuivector.html">uivector</a>* p, <span class="keyword">const</span> <a class="code" href="structuivector.html">uivector</a>* q)</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;{</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;  <span class="keywordtype">size_t</span> i;</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;  <span class="keywordflow">if</span>(!uivector_resize(p, q-&gt;<a class="code" href="structuivector.html#aa999025945f0c93d0461192475ae2720">size</a>)) <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;  <span class="keywordflow">for</span>(i = 0; i &lt; q-&gt;<a class="code" href="structuivector.html#aa999025945f0c93d0461192475ae2720">size</a>; i++) p-&gt;<a class="code" href="structuivector.html#a427d761df4bb4f0f19b4a973fc224c78">data</a>[i] = q-&gt;<a class="code" href="structuivector.html#a427d761df4bb4f0f19b4a973fc224c78">data</a>[i];</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;  <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;}</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> uivector_swap(<a class="code" href="structuivector.html">uivector</a>* p, <a class="code" href="structuivector.html">uivector</a>* q)</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;{</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;  <span class="keywordtype">size_t</span> tmp;</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;  <span class="keywordtype">unsigned</span>* tmpp;</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;  tmp = p-&gt;<a class="code" href="structuivector.html#aa999025945f0c93d0461192475ae2720">size</a>; p-&gt;<a class="code" href="structuivector.html#aa999025945f0c93d0461192475ae2720">size</a> = q-&gt;<a class="code" href="structuivector.html#aa999025945f0c93d0461192475ae2720">size</a>; q-&gt;<a class="code" href="structuivector.html#aa999025945f0c93d0461192475ae2720">size</a> = tmp;</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;  tmp = p-&gt;<a class="code" href="structuivector.html#aac0395a9ad397ae7a28219561ab49ffa">allocsize</a>; p-&gt;<a class="code" href="structuivector.html#aac0395a9ad397ae7a28219561ab49ffa">allocsize</a> = q-&gt;<a class="code" href="structuivector.html#aac0395a9ad397ae7a28219561ab49ffa">allocsize</a>; q-&gt;<a class="code" href="structuivector.html#aac0395a9ad397ae7a28219561ab49ffa">allocsize</a> = tmp;</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;  tmpp = p-&gt;<a class="code" href="structuivector.html#a427d761df4bb4f0f19b4a973fc224c78">data</a>; p-&gt;<a class="code" href="structuivector.html#a427d761df4bb4f0f19b4a973fc224c78">data</a> = q-&gt;<a class="code" href="structuivector.html#a427d761df4bb4f0f19b4a973fc224c78">data</a>; q-&gt;<a class="code" href="structuivector.html#a427d761df4bb4f0f19b4a973fc224c78">data</a> = tmpp;</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;}</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/*LODEPNG_COMPILE_ENCODER*/</span><span class="preprocessor"></span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#endif </span><span class="comment">/*LODEPNG_COMPILE_ZLIB*/</span><span class="preprocessor"></span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;<span class="comment">/* /////////////////////////////////////////////////////////////////////////// */</span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;<span class="comment">/*dynamic vector of unsigned chars*/</span></div>
<div class="line"><a name="l00246"></a><span class="lineno"><a class="line" href="structucvector.html">  246</a></span>&#160;<span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structucvector.html">ucvector</a></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;{</div>
<div class="line"><a name="l00248"></a><span class="lineno"><a class="line" href="structucvector.html#ace794c5713208c5a20f21762cd87c919">  248</a></span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* <a class="code" href="structucvector.html#ace794c5713208c5a20f21762cd87c919">data</a>;</div>
<div class="line"><a name="l00249"></a><span class="lineno"><a class="line" href="structucvector.html#a27c99c34de0c5b3ca0c242d402c69499">  249</a></span>&#160;  <span class="keywordtype">size_t</span> <a class="code" href="structucvector.html#a27c99c34de0c5b3ca0c242d402c69499">size</a>; <span class="comment">/*used size*/</span></div>
<div class="line"><a name="l00250"></a><span class="lineno"><a class="line" href="structucvector.html#a235168baac13f0c78bd3e309dc170f90">  250</a></span>&#160;  <span class="keywordtype">size_t</span> <a class="code" href="structucvector.html#a235168baac13f0c78bd3e309dc170f90">allocsize</a>; <span class="comment">/*allocated size*/</span></div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;} <a class="code" href="lodepng_8cpp.html#a8ebce7aaef4f64e50d2ad2e3a383a505">ucvector</a>;</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> ucvector_cleanup(<span class="keywordtype">void</span>* p)</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;{</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;  ((<a class="code" href="structucvector.html">ucvector</a>*)p)-&gt;size = ((<a class="code" href="structucvector.html">ucvector</a>*)p)-&gt;allocsize = 0;</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;  <a class="code" href="namespace_f_w.html#a93be8f55938d6ffb5ca0af1f95f81589">free</a>(((<a class="code" href="structucvector.html">ucvector</a>*)p)-&gt;<a class="code" href="_d_l_l_imports_8inl.html#a156a9c7e986e0352d0fe500e629d5171">data</a>);</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;  ((<a class="code" href="structucvector.html">ucvector</a>*)p)-&gt;data = <a class="code" href="_defs_8hpp.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;}</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;<span class="comment">/*returns 1 if success, 0 if failure ==&gt; nothing done*/</span></div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;<span class="keyword">static</span> <span class="keywordtype">unsigned</span> ucvector_resize(<a class="code" href="structucvector.html">ucvector</a>* p, <span class="keywordtype">size_t</span> size)</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;{</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;  <span class="keywordflow">if</span>(size * <span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>) &gt; p-&gt;<a class="code" href="structucvector.html#a235168baac13f0c78bd3e309dc170f90">allocsize</a>)</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;  {</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    <span class="keywordtype">size_t</span> newsize = size * <span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span> char) * 2;</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    <span class="keywordtype">void</span>* <a class="code" href="_d_l_l_imports_8inl.html#a156a9c7e986e0352d0fe500e629d5171">data</a> = <a class="code" href="namespace_f_w.html#a1c91e4066f0cc4e93981c3a04a229198">realloc</a>(p-&gt;<a class="code" href="structucvector.html#ace794c5713208c5a20f21762cd87c919">data</a>, newsize);</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    <span class="keywordflow">if</span>(data)</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    {</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;      p-&gt;<a class="code" href="structucvector.html#a235168baac13f0c78bd3e309dc170f90">allocsize</a> = newsize;</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;      p-&gt;<a class="code" href="structucvector.html#ace794c5713208c5a20f21762cd87c919">data</a> = (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>*)data;</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;      p-&gt;<a class="code" href="structucvector.html#a27c99c34de0c5b3ca0c242d402c69499">size</a> = <a class="code" href="_d_l_l_imports_8inl.html#abcaf2e752dfff61ecb0b2d0a593966ee">size</a>;</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    }</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">return</span> 0; <span class="comment">/*error: not enough memory*/</span></div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;  }</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;  <span class="keywordflow">else</span> p-&gt;<a class="code" href="structucvector.html#a27c99c34de0c5b3ca0c242d402c69499">size</a> = <a class="code" href="_d_l_l_imports_8inl.html#abcaf2e752dfff61ecb0b2d0a593966ee">size</a>;</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;  <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;}</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;<span class="preprocessor">#ifdef LODEPNG_COMPILE_DECODER</span></div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef LODEPNG_COMPILE_PNG</span></div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;<span class="preprocessor"></span><span class="comment">/*resize and give all new elements the value*/</span></div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;<span class="keyword">static</span> <span class="keywordtype">unsigned</span> ucvector_resizev(<a class="code" href="structucvector.html">ucvector</a>* p, <span class="keywordtype">size_t</span> size, <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> value)</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;{</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;  <span class="keywordtype">size_t</span> oldsize = p-&gt;<a class="code" href="structucvector.html#a27c99c34de0c5b3ca0c242d402c69499">size</a>, i;</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;  <span class="keywordflow">if</span>(!ucvector_resize(p, size)) <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;  <span class="keywordflow">for</span>(i = oldsize; i &lt; <a class="code" href="_d_l_l_imports_8inl.html#abcaf2e752dfff61ecb0b2d0a593966ee">size</a>; i++) p-&gt;<a class="code" href="structucvector.html#ace794c5713208c5a20f21762cd87c919">data</a>[i] = value;</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;  <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;}</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/*LODEPNG_COMPILE_PNG*/</span><span class="preprocessor"></span></div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#endif </span><span class="comment">/*LODEPNG_COMPILE_DECODER*/</span><span class="preprocessor"></span></div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> ucvector_init(<a class="code" href="structucvector.html">ucvector</a>* p)</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;{</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;  p-&gt;<a class="code" href="structucvector.html#ace794c5713208c5a20f21762cd87c919">data</a> = <a class="code" href="_defs_8hpp.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;  p-&gt;<a class="code" href="structucvector.html#a27c99c34de0c5b3ca0c242d402c69499">size</a> = p-&gt;<a class="code" href="structucvector.html#a235168baac13f0c78bd3e309dc170f90">allocsize</a> = 0;</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;}</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;<span class="preprocessor">#ifdef LODEPNG_COMPILE_ZLIB</span></div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;<span class="preprocessor"></span><span class="comment">/*you can both convert from vector to buffer&amp;size and vica versa. If you use</span></div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;<span class="comment">init_buffer to take over a buffer and size, it is not needed to use cleanup*/</span></div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> ucvector_init_buffer(<a class="code" href="structucvector.html">ucvector</a>* p, <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* <a class="code" href="_d_l_l_imports_8inl.html#a9dbca2ffca3195a70ff9a21d5c97b242">buffer</a>, <span class="keywordtype">size_t</span> size)</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;{</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;  p-&gt;<a class="code" href="structucvector.html#ace794c5713208c5a20f21762cd87c919">data</a> = <a class="code" href="_d_l_l_imports_8inl.html#a9dbca2ffca3195a70ff9a21d5c97b242">buffer</a>;</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;  p-&gt;<a class="code" href="structucvector.html#a235168baac13f0c78bd3e309dc170f90">allocsize</a> = p-&gt;<a class="code" href="structucvector.html#a27c99c34de0c5b3ca0c242d402c69499">size</a> = <a class="code" href="_d_l_l_imports_8inl.html#abcaf2e752dfff61ecb0b2d0a593966ee">size</a>;</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;}</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/*LODEPNG_COMPILE_ZLIB*/</span><span class="preprocessor"></span></div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;<span class="preprocessor">#ifdef LODEPNG_COMPILE_ENCODER</span></div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;<span class="preprocessor"></span><span class="comment">/*returns 1 if success, 0 if failure ==&gt; nothing done*/</span></div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;<span class="keyword">static</span> <span class="keywordtype">unsigned</span> ucvector_push_back(<a class="code" href="structucvector.html">ucvector</a>* p, <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> c)</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;{</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;  <span class="keywordflow">if</span>(!ucvector_resize(p, p-&gt;<a class="code" href="structucvector.html#a27c99c34de0c5b3ca0c242d402c69499">size</a> + 1)) <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;  p-&gt;<a class="code" href="structucvector.html#ace794c5713208c5a20f21762cd87c919">data</a>[p-&gt;<a class="code" href="structucvector.html#a27c99c34de0c5b3ca0c242d402c69499">size</a> - 1] = c;</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;  <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;}</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/*LODEPNG_COMPILE_ENCODER*/</span><span class="preprocessor"></span></div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;<span class="comment">/* ////////////////////////////////////////////////////////////////////////// */</span></div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;<span class="preprocessor">#ifdef LODEPNG_COMPILE_PNG</span></div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef LODEPNG_COMPILE_ANCILLARY_CHUNKS</span></div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;<span class="preprocessor"></span><span class="comment">/*returns 1 if success, 0 if failure ==&gt; nothing done*/</span></div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;<span class="keyword">static</span> <span class="keywordtype">unsigned</span> string_resize(<span class="keywordtype">char</span>** out, <span class="keywordtype">size_t</span> size)</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;{</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;  <span class="keywordtype">char</span>* <a class="code" href="_d_l_l_imports_8inl.html#a156a9c7e986e0352d0fe500e629d5171">data</a> = (<span class="keywordtype">char</span>*)<a class="code" href="namespace_f_w.html#a1c91e4066f0cc4e93981c3a04a229198">realloc</a>(*out, size + 1);</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;  <span class="keywordflow">if</span>(data)</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;  {</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    data[<a class="code" href="_d_l_l_imports_8inl.html#abcaf2e752dfff61ecb0b2d0a593966ee">size</a>] = 0; <span class="comment">/*null termination char*/</span></div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    *out = <a class="code" href="_d_l_l_imports_8inl.html#a156a9c7e986e0352d0fe500e629d5171">data</a>;</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;  }</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;  <span class="keywordflow">return</span> data != 0;</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;}</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;<span class="comment">/*init a {char*, size_t} pair for use as string*/</span></div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> string_init(<span class="keywordtype">char</span>** out)</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;{</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;  *out = <a class="code" href="_defs_8hpp.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;  string_resize(out, 0);</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;}</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;<span class="comment">/*free the above pair again*/</span></div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> string_cleanup(<span class="keywordtype">char</span>** out)</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;{</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;  <a class="code" href="namespace_f_w.html#a93be8f55938d6ffb5ca0af1f95f81589">free</a>(*out);</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;  *out = <a class="code" href="_defs_8hpp.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;}</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> string_set(<span class="keywordtype">char</span>** out, <span class="keyword">const</span> <span class="keywordtype">char</span>* in)</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;{</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;  <span class="keywordtype">size_t</span> insize = strlen(in), i = 0;</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;  <span class="keywordflow">if</span>(string_resize(out, insize))</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;  {</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;    <span class="keywordflow">for</span>(i = 0; i &lt; insize; i++)</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    {</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;      (*out)[i] = in[i];</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    }</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;  }</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;}</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/*LODEPNG_COMPILE_ANCILLARY_CHUNKS*/</span><span class="preprocessor"></span></div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#endif </span><span class="comment">/*LODEPNG_COMPILE_PNG*/</span><span class="preprocessor"></span></div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;<span class="comment">/* ////////////////////////////////////////////////////////////////////////// */</span></div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;</div>
<div class="line"><a name="l00365"></a><span class="lineno"><a class="line" href="lodepng_8cpp.html#a347e6964b32f99efb902fbf7b1a9d934">  365</a></span>&#160;<span class="keywordtype">unsigned</span> <a class="code" href="lodepng_8cpp.html#a347e6964b32f99efb902fbf7b1a9d934">LodePNG_read32bitInt</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* <a class="code" href="_d_l_l_imports_8inl.html#a9dbca2ffca3195a70ff9a21d5c97b242">buffer</a>)</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;{</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;  <span class="keywordflow">return</span> (buffer[0] &lt;&lt; 24) | (buffer[1] &lt;&lt; 16) | (buffer[2] &lt;&lt; 8) | buffer[3];</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;}</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;<span class="comment">/*buffer must have at least 4 allocated bytes available*/</span></div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> LodePNG_set32bitInt(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* <a class="code" href="_d_l_l_imports_8inl.html#a9dbca2ffca3195a70ff9a21d5c97b242">buffer</a>, <span class="keywordtype">unsigned</span> value)</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;{</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;  buffer[0] = (<span class="keywordtype">unsigned</span> char)((value &gt;&gt; 24) &amp; 0xff);</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;  buffer[1] = (<span class="keywordtype">unsigned</span> char)((value &gt;&gt; 16) &amp; 0xff);</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;  buffer[2] = (<span class="keywordtype">unsigned</span> char)((value &gt;&gt;  8) &amp; 0xff);</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;  buffer[3] = (<span class="keywordtype">unsigned</span> char)((value      ) &amp; 0xff);</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;}</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;<span class="preprocessor">#ifdef LODEPNG_COMPILE_ENCODER</span></div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;<span class="preprocessor"></span><span class="keyword">static</span> <span class="keywordtype">void</span> LodePNG_add32bitInt(<a class="code" href="structucvector.html">ucvector</a>* buffer, <span class="keywordtype">unsigned</span> value)</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;{</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;  ucvector_resize(buffer, buffer-&gt;<a class="code" href="structucvector.html#a27c99c34de0c5b3ca0c242d402c69499">size</a> + 4); <span class="comment">/*todo: give error if resize failed*/</span></div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;  LodePNG_set32bitInt(&amp;buffer-&gt;<a class="code" href="structucvector.html#ace794c5713208c5a20f21762cd87c919">data</a>[buffer-&gt;<a class="code" href="structucvector.html#a27c99c34de0c5b3ca0c242d402c69499">size</a> - 4], value);</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;}</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/*LODEPNG_COMPILE_ENCODER*/</span><span class="preprocessor"></span></div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;<span class="comment">/* ////////////////////////////////////////////////////////////////////////// */</span></div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;<span class="comment">/* / File IO                                                                / */</span></div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;<span class="comment">/* ////////////////////////////////////////////////////////////////////////// */</span></div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;<span class="preprocessor">#ifdef LODEPNG_COMPILE_DISK</span></div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00393"></a><span class="lineno"><a class="line" href="lodepng_8h.html#aca6d9a07dd0805433de47feb04e0fc52">  393</a></span>&#160;<span class="keywordtype">unsigned</span> <a class="code" href="lodepng_8cpp.html#aca6d9a07dd0805433de47feb04e0fc52">LodePNG_loadFile</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>** out, <span class="keywordtype">size_t</span>* outsize, <span class="keyword">const</span> <span class="keywordtype">char</span>* filename)</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;{</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;  FILE* file;</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;  <span class="keywordtype">long</span> <a class="code" href="_d_l_l_imports_8inl.html#abcaf2e752dfff61ecb0b2d0a593966ee">size</a>;</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;  <span class="comment">/*provide some proper output values if error will happen*/</span></div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;  *out = 0;</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;  *outsize = 0;</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;  file = fopen(filename, <span class="stringliteral">&quot;rb&quot;</span>);</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;  <span class="keywordflow">if</span>(!file) <span class="keywordflow">return</span> 78;</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;  <span class="comment">/*get filesize:*/</span></div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;  fseek(file , 0 , SEEK_END);</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;  size = ftell(file);</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;  rewind(file);</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;  <span class="comment">/*read contents of the file into the vector*/</span></div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;  *outsize = 0;</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;  *out = (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>*)<a class="code" href="namespace_f_w.html#a440e071d8fdbc9789b728245caad99c0">malloc</a>((<span class="keywordtype">size_t</span>)<a class="code" href="_d_l_l_imports_8inl.html#abcaf2e752dfff61ecb0b2d0a593966ee">size</a>);</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;  <span class="keywordflow">if</span>(size &amp;&amp; (*out)) (*outsize) = fread(*out, 1, (<span class="keywordtype">size_t</span>)size, file);</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;  fclose(file);</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;  <span class="keywordflow">if</span>(!(*out) &amp;&amp; size) <span class="keywordflow">return</span> 9900; <span class="comment">/*the above malloc failed*/</span></div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;  <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;}</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;<span class="comment">/*write given buffer to the file, overwriting the file, it doesn&#39;t append to it.*/</span></div>
<div class="line"><a name="l00421"></a><span class="lineno"><a class="line" href="lodepng_8h.html#a35604ddb7255afb1526979ca40815987">  421</a></span>&#160;<span class="keywordtype">unsigned</span> <a class="code" href="lodepng_8cpp.html#a35604ddb7255afb1526979ca40815987">LodePNG_saveFile</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* buffer, <span class="keywordtype">size_t</span> buffersize, <span class="keyword">const</span> <span class="keywordtype">char</span>* filename)</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;{</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;  FILE* file;</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;  file = fopen(filename, <span class="stringliteral">&quot;wb&quot;</span> );</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;  <span class="keywordflow">if</span>(!file) <span class="keywordflow">return</span> 79;</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;  fwrite((<span class="keywordtype">char</span>*)buffer , 1 , buffersize, file);</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;  fclose(file);</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;  <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;}</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/*LODEPNG_COMPILE_DISK*/</span><span class="preprocessor"></span></div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;<span class="comment">/* ////////////////////////////////////////////////////////////////////////// */</span></div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;<span class="comment">/* ////////////////////////////////////////////////////////////////////////// */</span></div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;<span class="comment">/* // End of common code and tools. Begin of Zlib related code.            // */</span></div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;<span class="comment">/* ////////////////////////////////////////////////////////////////////////// */</span></div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;<span class="comment">/* ////////////////////////////////////////////////////////////////////////// */</span></div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;<span class="preprocessor">#ifdef LODEPNG_COMPILE_ZLIB</span></div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;<span class="comment">/* ////////////////////////////////////////////////////////////////////////// */</span></div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;<span class="comment">/* / Reading and writing single bits and bytes from/to stream for Deflate   / */</span></div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;<span class="comment">/* ////////////////////////////////////////////////////////////////////////// */</span></div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;<span class="preprocessor">#ifdef LODEPNG_COMPILE_ENCODER</span></div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;<span class="preprocessor"></span><span class="comment">/*TODO: this ignores potential out of memory errors*/</span></div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> addBitToStream(<span class="keywordtype">size_t</span>* bitpointer, <a class="code" href="structucvector.html">ucvector</a>* bitstream, <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> bit)</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;{</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;  <span class="comment">/*add a new byte at the end*/</span></div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;  <span class="keywordflow">if</span>((*bitpointer) % 8 == 0) ucvector_push_back(bitstream, (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>)0);</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;  <span class="comment">/*earlier bit of huffman code is in a lesser significant bit of an earlier byte*/</span></div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;  (bitstream-&gt;<a class="code" href="structucvector.html#ace794c5713208c5a20f21762cd87c919">data</a>[bitstream-&gt;<a class="code" href="structucvector.html#a27c99c34de0c5b3ca0c242d402c69499">size</a> - 1]) |= (bit &lt;&lt; ((*bitpointer) &amp; 0x7));</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;  (*bitpointer)++;</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;}</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> addBitsToStream(<span class="keywordtype">size_t</span>* bitpointer, <a class="code" href="structucvector.html">ucvector</a>* bitstream, <span class="keywordtype">unsigned</span> value, <span class="keywordtype">size_t</span> nbits)</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;{</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;  <span class="keywordtype">size_t</span> i;</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;  <span class="keywordflow">for</span>(i = 0; i &lt; nbits; i++) addBitToStream(bitpointer, bitstream, (unsigned char)((value &gt;&gt; i) &amp; 1));</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;}</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> addBitsToStreamReversed(<span class="keywordtype">size_t</span>* bitpointer, <a class="code" href="structucvector.html">ucvector</a>* bitstream, <span class="keywordtype">unsigned</span> value, <span class="keywordtype">size_t</span> nbits)</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;{</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;  <span class="keywordtype">size_t</span> i;</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;  <span class="keywordflow">for</span>(i = 0; i &lt; nbits; i++) addBitToStream(bitpointer, bitstream, (unsigned char)((value &gt;&gt; (nbits - 1 - i)) &amp; 1));</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;}</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/*LODEPNG_COMPILE_ENCODER*/</span><span class="preprocessor"></span></div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;<span class="preprocessor">#ifdef LODEPNG_COMPILE_DECODER</span></div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00471"></a><span class="lineno"><a class="line" href="lodepng_8cpp.html#a89f06ac9bcf1964fb4d663ad7a8dc4a1">  471</a></span>&#160;<span class="preprocessor">#define READBIT(bitpointer, bitstream) ((bitstream[bitpointer &gt;&gt; 3] &gt;&gt; (bitpointer &amp; 0x7)) &amp; (unsigned char)1)</span></div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;<span class="keyword">static</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> readBitFromStream(<span class="keywordtype">size_t</span>* bitpointer, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* bitstream)</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;{</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> result = (<span class="keywordtype">unsigned</span> char)(<a class="code" href="lodepng_8cpp.html#a89f06ac9bcf1964fb4d663ad7a8dc4a1">READBIT</a>(*bitpointer, bitstream));</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;  (*bitpointer)++;</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;  <span class="keywordflow">return</span> result;</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;}</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;<span class="keyword">static</span> <span class="keywordtype">unsigned</span> readBitsFromStream(<span class="keywordtype">size_t</span>* bitpointer, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* bitstream, <span class="keywordtype">size_t</span> nbits)</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;{</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;  <span class="keywordtype">unsigned</span> result = 0, i;</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;  <span class="keywordflow">for</span>(i = 0; i &lt; nbits; i++)</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;  {</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;    result += ((unsigned)<a class="code" href="lodepng_8cpp.html#a89f06ac9bcf1964fb4d663ad7a8dc4a1">READBIT</a>(*bitpointer, bitstream)) &lt;&lt; i;</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;    (*bitpointer)++;</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;  }</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;  <span class="keywordflow">return</span> result;</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;}</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/*LODEPNG_COMPILE_DECODER*/</span><span class="preprocessor"></span></div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;<span class="comment">/* ////////////////////////////////////////////////////////////////////////// */</span></div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;<span class="comment">/* / Deflate - Huffman                                                      / */</span></div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;<span class="comment">/* ////////////////////////////////////////////////////////////////////////// */</span></div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;</div>
<div class="line"><a name="l00496"></a><span class="lineno"><a class="line" href="lodepng_8cpp.html#acfb12caea990f92b3aed7c199f615213">  496</a></span>&#160;<span class="preprocessor">#define FIRST_LENGTH_CODE_INDEX 257</span></div>
<div class="line"><a name="l00497"></a><span class="lineno"><a class="line" href="lodepng_8cpp.html#adf9597781d7175fdee0b2466e6e462e7">  497</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define LAST_LENGTH_CODE_INDEX 285</span></div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;<span class="preprocessor"></span><span class="comment">/*256 literals, the end code, some length codes, and 2 unused codes*/</span></div>
<div class="line"><a name="l00499"></a><span class="lineno"><a class="line" href="lodepng_8cpp.html#a58feace6a0d109fc6bb2161504a3011e">  499</a></span>&#160;<span class="preprocessor">#define NUM_DEFLATE_CODE_SYMBOLS 288</span></div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;<span class="preprocessor"></span><span class="comment">/*the distance codes have their own symbols, 30 used, 2 unused*/</span></div>
<div class="line"><a name="l00501"></a><span class="lineno"><a class="line" href="lodepng_8cpp.html#a5b48becc8f2653ba2bb90858d38fc9ec">  501</a></span>&#160;<span class="preprocessor">#define NUM_DISTANCE_SYMBOLS 32</span></div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;<span class="preprocessor"></span><span class="comment">/*the code length codes. 0-15: code lengths, 16: copy previous 3-6 times, 17: 3-10 zeros, 18: 11-138 zeros*/</span></div>
<div class="line"><a name="l00503"></a><span class="lineno"><a class="line" href="lodepng_8cpp.html#a22ed04d49e008cb4295a8b366c4f2f3b">  503</a></span>&#160;<span class="preprocessor">#define NUM_CODE_LENGTH_CODES 19</span></div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;<span class="comment">/*the base lengths represented by codes 257-285*/</span></div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> LENGTHBASE[29]</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;  = {3, 4, 5, 6, 7, 8, 9, 10, 11, 13, 15, 17, 19, 23, 27, 31, 35, 43, 51, 59,</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;     67, 83, 99, 115, 131, 163, 195, 227, 258};</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;<span class="comment">/*the extra bits used by codes 257-285 (added to base length)*/</span></div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> LENGTHEXTRA[29]</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;  = {0, 0, 0, 0, 0, 0, 0,  0,  1,  1,  1,  1,  2,  2,  2,  2,  3,  3,  3,  3,</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;      4,  4,  4,   4,   5,   5,   5,   5,   0};</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;<span class="comment">/*the base backwards distances (the bits of distance codes appear after length codes and use their own huffman tree)*/</span></div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> DISTANCEBASE[30]</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;  = {1, 2, 3, 4, 5, 7, 9, 13, 17, 25, 33, 49, 65, 97, 129, 193, 257, 385, 513,</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;     769, 1025, 1537, 2049, 3073, 4097, 6145, 8193, 12289, 16385, 24577};</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;<span class="comment">/*the extra bits of backwards distances (added to base)*/</span></div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> DISTANCEEXTRA[30]</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;  = {0, 0, 0, 0, 1, 1, 2,  2,  3,  3,  4,  4,  5,  5,   6,   6,   7,   7,   8,</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;       8,    9,    9,   10,   10,   11,   11,   12,    12,    13,    13};</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;<span class="comment">/*the order in which &quot;code length alphabet code lengths&quot; are stored, out of this</span></div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;<span class="comment">the huffman tree of the dynamic huffman tree lengths is generated*/</span></div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> CLCL_ORDER[<a class="code" href="lodepng_8cpp.html#a22ed04d49e008cb4295a8b366c4f2f3b">NUM_CODE_LENGTH_CODES</a>]</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;  = {16, 17, 18, 0, 8, 7, 9, 6, 10, 5, 11, 4, 12, 3, 13, 2, 14, 1, 15};</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;<span class="comment">/* ////////////////////////////////////////////////////////////////////////// */</span></div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;<span class="comment">Huffman tree struct, containing multiple representations of the tree</span></div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;<span class="comment">*/</span></div>
<div class="line"><a name="l00535"></a><span class="lineno"><a class="line" href="struct_huffman_tree.html">  535</a></span>&#160;<span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="struct_huffman_tree.html">HuffmanTree</a></div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;{</div>
<div class="line"><a name="l00537"></a><span class="lineno"><a class="line" href="struct_huffman_tree.html#a24afa4a1079f6ee1c9829b9b5aa5fe89">  537</a></span>&#160;  <a class="code" href="structuivector.html">uivector</a> <a class="code" href="struct_huffman_tree.html#a24afa4a1079f6ee1c9829b9b5aa5fe89">tree2d</a>;</div>
<div class="line"><a name="l00538"></a><span class="lineno"><a class="line" href="struct_huffman_tree.html#a0bb5fd80eb9ec029f66cf30641b98363">  538</a></span>&#160;  <a class="code" href="structuivector.html">uivector</a> <a class="code" href="struct_huffman_tree.html#a0bb5fd80eb9ec029f66cf30641b98363">tree1d</a>;</div>
<div class="line"><a name="l00539"></a><span class="lineno"><a class="line" href="struct_huffman_tree.html#a293790e0f67d8fdf9df5a2914af39251">  539</a></span>&#160;  <a class="code" href="structuivector.html">uivector</a> <a class="code" href="struct_huffman_tree.html#a293790e0f67d8fdf9df5a2914af39251">lengths</a>; <span class="comment">/*the lengths of the codes of the 1d-tree*/</span></div>
<div class="line"><a name="l00540"></a><span class="lineno"><a class="line" href="struct_huffman_tree.html#adf034ca9ce62a4ebfffaaeaba4378a26">  540</a></span>&#160;  <span class="keywordtype">unsigned</span> <a class="code" href="struct_huffman_tree.html#adf034ca9ce62a4ebfffaaeaba4378a26">maxbitlen</a>; <span class="comment">/*maximum number of bits a single code can get*/</span></div>
<div class="line"><a name="l00541"></a><span class="lineno"><a class="line" href="struct_huffman_tree.html#a608df5a24f60d1077a5cde19d5149e1f">  541</a></span>&#160;  <span class="keywordtype">unsigned</span> <a class="code" href="struct_huffman_tree.html#a608df5a24f60d1077a5cde19d5149e1f">numcodes</a>; <span class="comment">/*number of symbols in the alphabet = number of codes*/</span></div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;} <a class="code" href="lodepng_8cpp.html#ad705dca4fd163e14e555a6e2e3223af1">HuffmanTree</a>;</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;<span class="comment">/*function used for debug purposes to draw the tree in ascii art with C++*/</span></div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;<span class="comment">/*#include &lt;iostream&gt;</span></div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;<span class="comment">static void HuffmanTree_draw(HuffmanTree* tree)</span></div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;<span class="comment">{</span></div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;<span class="comment">  std::cout &lt;&lt; &quot;tree. length: &quot; &lt;&lt; tree-&gt;numcodes &lt;&lt; &quot; maxbitlen: &quot; &lt;&lt; tree-&gt;maxbitlen &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;<span class="comment">  for(size_t i = 0; i &lt; tree-&gt;tree1d.size; i++)</span></div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;<span class="comment">  {</span></div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;<span class="comment">    if(tree-&gt;lengths.data[i])</span></div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;<span class="comment">      std::cout &lt;&lt; i &lt;&lt; &quot; &quot; &lt;&lt; tree-&gt;tree1d.data[i] &lt;&lt; &quot; &quot; &lt;&lt; tree-&gt;lengths.data[i] &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;<span class="comment">  }</span></div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;<span class="comment">  std::cout &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;<span class="comment">}*/</span></div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> HuffmanTree_init(<a class="code" href="struct_huffman_tree.html">HuffmanTree</a>* tree)</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;{</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;  uivector_init(&amp;tree-&gt;<a class="code" href="struct_huffman_tree.html#a24afa4a1079f6ee1c9829b9b5aa5fe89">tree2d</a>);</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;  uivector_init(&amp;tree-&gt;<a class="code" href="struct_huffman_tree.html#a0bb5fd80eb9ec029f66cf30641b98363">tree1d</a>);</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;  uivector_init(&amp;tree-&gt;<a class="code" href="struct_huffman_tree.html#a293790e0f67d8fdf9df5a2914af39251">lengths</a>);</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;}</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> HuffmanTree_cleanup(<a class="code" href="struct_huffman_tree.html">HuffmanTree</a>* tree)</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;{</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;  uivector_cleanup(&amp;tree-&gt;<a class="code" href="struct_huffman_tree.html#a24afa4a1079f6ee1c9829b9b5aa5fe89">tree2d</a>);</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;  uivector_cleanup(&amp;tree-&gt;<a class="code" href="struct_huffman_tree.html#a0bb5fd80eb9ec029f66cf30641b98363">tree1d</a>);</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;  uivector_cleanup(&amp;tree-&gt;<a class="code" href="struct_huffman_tree.html#a293790e0f67d8fdf9df5a2914af39251">lengths</a>);</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;}</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;<span class="comment">/*the tree representation used by the decoder. return value is error*/</span></div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;<span class="keyword">static</span> <span class="keywordtype">unsigned</span> HuffmanTree_make2DTree(<a class="code" href="struct_huffman_tree.html">HuffmanTree</a>* tree)</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;{</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;  <span class="keywordtype">unsigned</span> nodefilled = 0; <span class="comment">/*up to which node it is filled*/</span></div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;  <span class="keywordtype">unsigned</span> treepos = 0; <span class="comment">/*position in the tree (1 of the numcodes columns)*/</span></div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;  <span class="keywordtype">unsigned</span> <a class="code" href="_d_l_l_imports_8inl.html#a7bfd2fdf58fb75abde6e36d72617c71b">n</a>, i;</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;  <span class="keywordflow">if</span>(!uivector_resize(&amp;tree-&gt;<a class="code" href="struct_huffman_tree.html#a24afa4a1079f6ee1c9829b9b5aa5fe89">tree2d</a>, tree-&gt;<a class="code" href="struct_huffman_tree.html#a608df5a24f60d1077a5cde19d5149e1f">numcodes</a> * 2)) <span class="keywordflow">return</span> 9901; <span class="comment">/*alloc fail*/</span></div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;  <span class="comment">/*</span></div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;<span class="comment">  convert tree1d[] to tree2d[][]. In the 2D array, a value of 32767 means</span></div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;<span class="comment">  uninited, a value &gt;= numcodes is an address to another bit, a value &lt; numcodes</span></div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;<span class="comment">  is a code. The 2 rows are the 2 possible bit values (0 or 1), there are as</span></div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;<span class="comment">  many columns as codes - 1.</span></div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;<span class="comment">  A good huffmann tree has N * 2 - 1 nodes, of which N - 1 are internal nodes.</span></div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;<span class="comment">  Here, the internal nodes are stored (what their 0 and 1 option point to).</span></div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;<span class="comment">  There is only memory for such good tree currently, if there are more nodes</span></div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;<span class="comment">  (due to too long length codes), error 55 will happen</span></div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;<span class="comment">  */</span></div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;  <span class="keywordflow">for</span>(n = 0;  n &lt; tree-&gt;<a class="code" href="struct_huffman_tree.html#a608df5a24f60d1077a5cde19d5149e1f">numcodes</a> * 2; n++)</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;  {</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;    tree-&gt;<a class="code" href="struct_huffman_tree.html#a24afa4a1079f6ee1c9829b9b5aa5fe89">tree2d</a>.<a class="code" href="structuivector.html#a427d761df4bb4f0f19b4a973fc224c78">data</a>[<a class="code" href="_d_l_l_imports_8inl.html#a7bfd2fdf58fb75abde6e36d72617c71b">n</a>] = 32767; <span class="comment">/*32767 here means the tree2d isn&#39;t filled there yet*/</span></div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;  }</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;  <span class="keywordflow">for</span>(n = 0; n &lt; tree-&gt;<a class="code" href="struct_huffman_tree.html#a608df5a24f60d1077a5cde19d5149e1f">numcodes</a>; n++) <span class="comment">/*the codes*/</span></div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;  {</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;    <span class="keywordflow">for</span>(i = 0; i &lt; tree-&gt;<a class="code" href="struct_huffman_tree.html#a293790e0f67d8fdf9df5a2914af39251">lengths</a>.<a class="code" href="structuivector.html#a427d761df4bb4f0f19b4a973fc224c78">data</a>[<a class="code" href="_d_l_l_imports_8inl.html#a7bfd2fdf58fb75abde6e36d72617c71b">n</a>]; i++) <span class="comment">/*the bits for this code*/</span></div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;    {</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> bit = (<span class="keywordtype">unsigned</span> char)((tree-&gt;<a class="code" href="struct_huffman_tree.html#a0bb5fd80eb9ec029f66cf30641b98363">tree1d</a>.<a class="code" href="structuivector.html#a427d761df4bb4f0f19b4a973fc224c78">data</a>[n] &gt;&gt; (tree-&gt;<a class="code" href="struct_huffman_tree.html#a293790e0f67d8fdf9df5a2914af39251">lengths</a>.<a class="code" href="structuivector.html#a427d761df4bb4f0f19b4a973fc224c78">data</a>[n] - i - 1)) &amp; 1);</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;      <span class="keywordflow">if</span>(treepos &gt; tree-&gt;<a class="code" href="struct_huffman_tree.html#a608df5a24f60d1077a5cde19d5149e1f">numcodes</a> - 2) <span class="keywordflow">return</span> 55; <span class="comment">/*error 55: oversubscribed; see description in header*/</span></div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;      <span class="keywordflow">if</span>(tree-&gt;<a class="code" href="struct_huffman_tree.html#a24afa4a1079f6ee1c9829b9b5aa5fe89">tree2d</a>.<a class="code" href="structuivector.html#a427d761df4bb4f0f19b4a973fc224c78">data</a>[2 * treepos + bit] == 32767) <span class="comment">/*not yet filled in*/</span></div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;      {</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;        <span class="keywordflow">if</span>(i + 1 == tree-&gt;<a class="code" href="struct_huffman_tree.html#a293790e0f67d8fdf9df5a2914af39251">lengths</a>.<a class="code" href="structuivector.html#a427d761df4bb4f0f19b4a973fc224c78">data</a>[n]) <span class="comment">/*last bit*/</span></div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;        {</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;          tree-&gt;<a class="code" href="struct_huffman_tree.html#a24afa4a1079f6ee1c9829b9b5aa5fe89">tree2d</a>.<a class="code" href="structuivector.html#a427d761df4bb4f0f19b4a973fc224c78">data</a>[2 * treepos + bit] = <a class="code" href="_d_l_l_imports_8inl.html#a7bfd2fdf58fb75abde6e36d72617c71b">n</a>; <span class="comment">/*put the current code in it*/</span></div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;          treepos = 0;</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;        }</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;        {</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;          <span class="comment">/*put address of the next step in here, first that address has to be found of course</span></div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;<span class="comment">          (it&#39;s just nodefilled + 1)...*/</span></div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;          nodefilled++;</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;          <span class="comment">/*addresses encoded with numcodes added to it*/</span></div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;          tree-&gt;<a class="code" href="struct_huffman_tree.html#a24afa4a1079f6ee1c9829b9b5aa5fe89">tree2d</a>.<a class="code" href="structuivector.html#a427d761df4bb4f0f19b4a973fc224c78">data</a>[2 * treepos + bit] = nodefilled + tree-&gt;<a class="code" href="struct_huffman_tree.html#a608df5a24f60d1077a5cde19d5149e1f">numcodes</a>;</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;          treepos = nodefilled;</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;        }</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;      }</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;      <span class="keywordflow">else</span> treepos = tree-&gt;<a class="code" href="struct_huffman_tree.html#a24afa4a1079f6ee1c9829b9b5aa5fe89">tree2d</a>.<a class="code" href="structuivector.html#a427d761df4bb4f0f19b4a973fc224c78">data</a>[2 * treepos + bit] - tree-&gt;<a class="code" href="struct_huffman_tree.html#a608df5a24f60d1077a5cde19d5149e1f">numcodes</a>;</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;    }</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;  }</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;  <span class="keywordflow">for</span>(n = 0;  n &lt; tree-&gt;<a class="code" href="struct_huffman_tree.html#a608df5a24f60d1077a5cde19d5149e1f">numcodes</a> * 2; n++)</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;  {</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;    <span class="keywordflow">if</span>(tree-&gt;<a class="code" href="struct_huffman_tree.html#a24afa4a1079f6ee1c9829b9b5aa5fe89">tree2d</a>.<a class="code" href="structuivector.html#a427d761df4bb4f0f19b4a973fc224c78">data</a>[n] == 32767) tree-&gt;<a class="code" href="struct_huffman_tree.html#a24afa4a1079f6ee1c9829b9b5aa5fe89">tree2d</a>.<a class="code" href="structuivector.html#a427d761df4bb4f0f19b4a973fc224c78">data</a>[<a class="code" href="_d_l_l_imports_8inl.html#a7bfd2fdf58fb75abde6e36d72617c71b">n</a>] = 0; <span class="comment">/*remove possible remaining 32767&#39;s*/</span></div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;  }</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;  <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;}</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;<span class="comment">Second step for the ...makeFromLengths and ...makeFromFrequencies functions.</span></div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;<span class="comment">numcodes, lengths and maxbitlen must already be filled in correctly. return</span></div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;<span class="comment">value is error.</span></div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;<span class="comment">*/</span></div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;<span class="keyword">static</span> <span class="keywordtype">unsigned</span> HuffmanTree_makeFromLengths2(<a class="code" href="struct_huffman_tree.html">HuffmanTree</a>* tree)</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;{</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;  <a class="code" href="structuivector.html">uivector</a> blcount;</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;  <a class="code" href="structuivector.html">uivector</a> nextcode;</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;  <span class="keywordtype">unsigned</span> bits, <a class="code" href="_d_l_l_imports_8inl.html#a7bfd2fdf58fb75abde6e36d72617c71b">n</a>, error = 0;</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;  uivector_init(&amp;blcount);</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;  uivector_init(&amp;nextcode);</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;  <span class="keywordflow">if</span>(!uivector_resize(&amp;tree-&gt;<a class="code" href="struct_huffman_tree.html#a0bb5fd80eb9ec029f66cf30641b98363">tree1d</a>, tree-&gt;<a class="code" href="struct_huffman_tree.html#a608df5a24f60d1077a5cde19d5149e1f">numcodes</a>)</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;  || !uivector_resizev(&amp;blcount, tree-&gt;<a class="code" href="struct_huffman_tree.html#adf034ca9ce62a4ebfffaaeaba4378a26">maxbitlen</a> + 1, 0)</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;  || !uivector_resizev(&amp;nextcode, tree-&gt;<a class="code" href="struct_huffman_tree.html#adf034ca9ce62a4ebfffaaeaba4378a26">maxbitlen</a> + 1, 0))</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;    error = 9902; <span class="comment">/*alloc fail*/</span></div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;  <span class="keywordflow">if</span>(!error)</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;  {</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;    <span class="comment">/*step 1: count number of instances of each code length*/</span></div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;    <span class="keywordflow">for</span>(bits = 0; bits &lt; tree-&gt;<a class="code" href="struct_huffman_tree.html#a608df5a24f60d1077a5cde19d5149e1f">numcodes</a>; bits++) blcount.<a class="code" href="structuivector.html#a427d761df4bb4f0f19b4a973fc224c78">data</a>[tree-&gt;<a class="code" href="struct_huffman_tree.html#a293790e0f67d8fdf9df5a2914af39251">lengths</a>.<a class="code" href="structuivector.html#a427d761df4bb4f0f19b4a973fc224c78">data</a>[bits]]++;</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;    <span class="comment">/*step 2: generate the nextcode values*/</span></div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;    <span class="keywordflow">for</span>(bits = 1; bits &lt;= tree-&gt;maxbitlen; bits++)</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;    {</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;      nextcode.<a class="code" href="structuivector.html#a427d761df4bb4f0f19b4a973fc224c78">data</a>[bits] = (nextcode.<a class="code" href="structuivector.html#a427d761df4bb4f0f19b4a973fc224c78">data</a>[bits - 1] + blcount.<a class="code" href="structuivector.html#a427d761df4bb4f0f19b4a973fc224c78">data</a>[bits - 1]) &lt;&lt; 1;</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;    }</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;    <span class="comment">/*step 3: generate all the codes*/</span></div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;    <span class="keywordflow">for</span>(n = 0; n &lt; tree-&gt;<a class="code" href="struct_huffman_tree.html#a608df5a24f60d1077a5cde19d5149e1f">numcodes</a>; n++)</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;    {</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;      <span class="keywordflow">if</span>(tree-&gt;<a class="code" href="struct_huffman_tree.html#a293790e0f67d8fdf9df5a2914af39251">lengths</a>.<a class="code" href="structuivector.html#a427d761df4bb4f0f19b4a973fc224c78">data</a>[n] != 0) tree-&gt;<a class="code" href="struct_huffman_tree.html#a0bb5fd80eb9ec029f66cf30641b98363">tree1d</a>.<a class="code" href="structuivector.html#a427d761df4bb4f0f19b4a973fc224c78">data</a>[<a class="code" href="_d_l_l_imports_8inl.html#a7bfd2fdf58fb75abde6e36d72617c71b">n</a>] = nextcode.<a class="code" href="structuivector.html#a427d761df4bb4f0f19b4a973fc224c78">data</a>[tree-&gt;<a class="code" href="struct_huffman_tree.html#a293790e0f67d8fdf9df5a2914af39251">lengths</a>.<a class="code" href="structuivector.html#a427d761df4bb4f0f19b4a973fc224c78">data</a>[<a class="code" href="_d_l_l_imports_8inl.html#a7bfd2fdf58fb75abde6e36d72617c71b">n</a>]]++;</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;    }</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;  }</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;  uivector_cleanup(&amp;blcount);</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;  uivector_cleanup(&amp;nextcode);</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;  <span class="keywordflow">if</span>(!error) <span class="keywordflow">return</span> HuffmanTree_make2DTree(tree);</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">return</span> error;</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;}</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;<span class="comment">given the code lengths (as stored in the PNG file), generate the tree as defined</span></div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;<span class="comment">by Deflate. maxbitlen is the maximum bits that a code in the tree can have.</span></div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;<span class="comment">return value is error.</span></div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;<span class="comment">*/</span></div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;<span class="keyword">static</span> <span class="keywordtype">unsigned</span> HuffmanTree_makeFromLengths(<a class="code" href="struct_huffman_tree.html">HuffmanTree</a>* tree, <span class="keyword">const</span> <span class="keywordtype">unsigned</span>* bitlen,</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;                                            <span class="keywordtype">size_t</span> numcodes, <span class="keywordtype">unsigned</span> maxbitlen)</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;{</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;  <span class="keywordtype">unsigned</span> i;</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;  <span class="keywordflow">if</span>(!uivector_resize(&amp;tree-&gt;<a class="code" href="struct_huffman_tree.html#a293790e0f67d8fdf9df5a2914af39251">lengths</a>, numcodes)) <span class="keywordflow">return</span> 9903; <span class="comment">/*alloc fail*/</span></div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;  <span class="keywordflow">for</span>(i = 0; i &lt; numcodes; i++) tree-&gt;<a class="code" href="struct_huffman_tree.html#a293790e0f67d8fdf9df5a2914af39251">lengths</a>.<a class="code" href="structuivector.html#a427d761df4bb4f0f19b4a973fc224c78">data</a>[i] = bitlen[i];</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;  tree-&gt;<a class="code" href="struct_huffman_tree.html#a608df5a24f60d1077a5cde19d5149e1f">numcodes</a> = (<span class="keywordtype">unsigned</span>)numcodes; <span class="comment">/*number of symbols*/</span></div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;  tree-&gt;<a class="code" href="struct_huffman_tree.html#adf034ca9ce62a4ebfffaaeaba4378a26">maxbitlen</a> = maxbitlen;</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;  <span class="keywordflow">return</span> HuffmanTree_makeFromLengths2(tree);</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;}</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;<span class="preprocessor">#ifdef LODEPNG_COMPILE_ENCODER</span></div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;<span class="comment">A coin, this is the terminology used for the package-merge algorithm and the</span></div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;<span class="comment">coin collector&#39;s problem. This is used to generate the huffman tree.</span></div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;<span class="comment">A coin can be multiple coins (when they&#39;re merged)</span></div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;<span class="comment">*/</span></div>
<div class="line"><a name="l00694"></a><span class="lineno"><a class="line" href="struct_coin.html">  694</a></span>&#160;<span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="struct_coin.html">Coin</a></div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;{</div>
<div class="line"><a name="l00696"></a><span class="lineno"><a class="line" href="struct_coin.html#a1d6bc1176bb9fcbd9ca8c781c92ef432">  696</a></span>&#160;  <a class="code" href="structuivector.html">uivector</a> <a class="code" href="struct_coin.html#a1d6bc1176bb9fcbd9ca8c781c92ef432">symbols</a>;</div>
<div class="line"><a name="l00697"></a><span class="lineno"><a class="line" href="struct_coin.html#a0427f9a678a9ce031a254f40f06b3669">  697</a></span>&#160;  <span class="keywordtype">float</span> <a class="code" href="struct_coin.html#a0427f9a678a9ce031a254f40f06b3669">weight</a>; <span class="comment">/*the sum of all weights in this coin*/</span></div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;} <a class="code" href="lodepng_8cpp.html#a4d2cd18166489c9373aad80d9036addb">Coin</a>;</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> Coin_init(<a class="code" href="struct_coin.html">Coin</a>* c)</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;{</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;  uivector_init(&amp;c-&gt;<a class="code" href="struct_coin.html#a1d6bc1176bb9fcbd9ca8c781c92ef432">symbols</a>);</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;}</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;<span class="comment">/*argument c is void* so that this dtor can be given as function pointer to the vector resize function*/</span></div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> Coin_cleanup(<span class="keywordtype">void</span>* c)</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;{</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;  uivector_cleanup(&amp;((<a class="code" href="struct_coin.html">Coin</a>*)c)-&gt;symbols);</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;}</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> Coin_copy(<a class="code" href="struct_coin.html">Coin</a>* c1, <span class="keyword">const</span> <a class="code" href="struct_coin.html">Coin</a>* c2)</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;{</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;  c1-&gt;<a class="code" href="struct_coin.html#a0427f9a678a9ce031a254f40f06b3669">weight</a> = c2-&gt;<a class="code" href="struct_coin.html#a0427f9a678a9ce031a254f40f06b3669">weight</a>;</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;  uivector_copy(&amp;c1-&gt;<a class="code" href="struct_coin.html#a1d6bc1176bb9fcbd9ca8c781c92ef432">symbols</a>, &amp;c2-&gt;<a class="code" href="struct_coin.html#a1d6bc1176bb9fcbd9ca8c781c92ef432">symbols</a>);</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;}</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> addCoins(<a class="code" href="struct_coin.html">Coin</a>* c1, <span class="keyword">const</span> <a class="code" href="struct_coin.html">Coin</a>* c2)</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;{</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;  <span class="keywordtype">size_t</span> i;</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;  <span class="keywordflow">for</span>(i = 0; i &lt; c2-&gt;<a class="code" href="struct_coin.html#a1d6bc1176bb9fcbd9ca8c781c92ef432">symbols</a>.<a class="code" href="structuivector.html#aa999025945f0c93d0461192475ae2720">size</a>; i++) uivector_push_back(&amp;c1-&gt;<a class="code" href="struct_coin.html#a1d6bc1176bb9fcbd9ca8c781c92ef432">symbols</a>, c2-&gt;<a class="code" href="struct_coin.html#a1d6bc1176bb9fcbd9ca8c781c92ef432">symbols</a>.<a class="code" href="structuivector.html#a427d761df4bb4f0f19b4a973fc224c78">data</a>[i]);</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;  c1-&gt;<a class="code" href="struct_coin.html#a0427f9a678a9ce031a254f40f06b3669">weight</a> += c2-&gt;<a class="code" href="struct_coin.html#a0427f9a678a9ce031a254f40f06b3669">weight</a>;</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;}</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;<span class="comment">Coin_sort: This uses a simple combsort to sort the data. This function is not critical for</span></div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;<span class="comment">overall encoding speed and the data amount isn&#39;t that large.</span></div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;<span class="comment">*/</span></div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> Coin_sort(<a class="code" href="struct_coin.html">Coin</a>* data, <span class="keywordtype">size_t</span> amount)</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;{</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;  <span class="keywordtype">size_t</span> gap = amount;</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> swapped = 0;</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;  <span class="keywordflow">while</span>((gap &gt; 1) || swapped)</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;  {</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;    <span class="keywordtype">size_t</span> i;</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;    gap = (gap * 10) / 13; <span class="comment">/*shrink factor 1.3*/</span></div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;    <span class="keywordflow">if</span>(gap == 9 || gap == 10) gap = 11; <span class="comment">/*combsort11*/</span></div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;    <span class="keywordflow">if</span>(gap &lt; 1) gap = 1;</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;    swapped = 0;</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;    <span class="keywordflow">for</span>(i = 0; i &lt; amount - gap; i++)</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;    {</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;      <span class="keywordtype">size_t</span> j = i + gap;</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;      <span class="keywordflow">if</span>(data[j].weight &lt; data[i].weight)</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;      {</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;        <span class="keywordtype">float</span> temp = data[j].<a class="code" href="struct_coin.html#a0427f9a678a9ce031a254f40f06b3669">weight</a>; data[j].<a class="code" href="struct_coin.html#a0427f9a678a9ce031a254f40f06b3669">weight</a> = data[i].<a class="code" href="struct_coin.html#a0427f9a678a9ce031a254f40f06b3669">weight</a>; data[i].<a class="code" href="struct_coin.html#a0427f9a678a9ce031a254f40f06b3669">weight</a> = temp;</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;        uivector_swap(&amp;data[i].symbols, &amp;data[j].symbols);</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;        swapped = 1;</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;      }</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;    }</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;  }</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;}</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;<span class="keyword">static</span> <span class="keywordtype">unsigned</span> HuffmanTree_fillInCoins(<a class="code" href="structvector.html">vector</a>* coins, <span class="keyword">const</span> <span class="keywordtype">unsigned</span>* frequencies, <span class="keywordtype">unsigned</span> numcodes, <span class="keywordtype">size_t</span> <a class="code" href="namespace_f_w.html#ab37f6a6b7427cf34d9cec7c7d482d9d2">sum</a>)</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;{</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;  <span class="keywordtype">unsigned</span> i;</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;  <span class="keywordflow">for</span>(i = 0; i &lt; numcodes; i++)</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;  {</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;    <a class="code" href="struct_coin.html">Coin</a>* coin;</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;    <span class="keywordflow">if</span>(frequencies[i] == 0) <span class="keywordflow">continue</span>; <span class="comment">/*it&#39;s important to exclude symbols that aren&#39;t present*/</span></div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;    <span class="keywordflow">if</span>(!vector_resize(coins, coins-&gt;<a class="code" href="structvector.html#a4200005b6949608d6a533db1a0d299c8">size</a> + 1))</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;    {</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;      vector_cleanup(coins);</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;      <span class="keywordflow">return</span> 9904; <span class="comment">/*alloc fail*/</span></div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;    }</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;    coin = (<a class="code" href="struct_coin.html">Coin</a>*)(vector_get(coins, coins-&gt;<a class="code" href="structvector.html#a4200005b6949608d6a533db1a0d299c8">size</a> - 1));</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;    Coin_init(coin);</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;    coin-&gt;<a class="code" href="struct_coin.html#a0427f9a678a9ce031a254f40f06b3669">weight</a> = frequencies[i] / (float)sum;</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;    uivector_push_back(&amp;coin-&gt;<a class="code" href="struct_coin.html#a1d6bc1176bb9fcbd9ca8c781c92ef432">symbols</a>, i);</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;  }</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;  <span class="keywordflow">if</span>(coins-&gt;<a class="code" href="structvector.html#a4200005b6949608d6a533db1a0d299c8">size</a>) Coin_sort((<a class="code" href="struct_coin.html">Coin</a>*)coins-&gt;<a class="code" href="structvector.html#afee87fd86bbabb017991064293317a8b">data</a>, coins-&gt;<a class="code" href="structvector.html#a4200005b6949608d6a533db1a0d299c8">size</a>);</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;  <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;}</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;<span class="comment">/*Create the Huffman tree given the symbol frequencies*/</span></div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;<span class="keyword">static</span> <span class="keywordtype">unsigned</span> HuffmanTree_makeFromFrequencies(<a class="code" href="struct_huffman_tree.html">HuffmanTree</a>* tree, <span class="keyword">const</span> <span class="keywordtype">unsigned</span>* frequencies,</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;                                                <span class="keywordtype">size_t</span> numcodes, <span class="keywordtype">unsigned</span> maxbitlen)</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;{</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;  <span class="keywordtype">unsigned</span> i, j;</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;  <span class="keywordtype">size_t</span> sum = 0, numpresent = 0;</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;  <span class="keywordtype">unsigned</span> error = 0;</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;  <a class="code" href="structvector.html">vector</a> prev_row; <span class="comment">/*type Coin, the previous row of coins*/</span></div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;  <a class="code" href="structvector.html">vector</a> coins; <span class="comment">/*type Coin, the coins of the currently calculated row*/</span></div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;  tree-&gt;<a class="code" href="struct_huffman_tree.html#adf034ca9ce62a4ebfffaaeaba4378a26">maxbitlen</a> = maxbitlen;</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;  <span class="keywordflow">for</span>(i = 0; i &lt; numcodes; i++)</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;  {</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;    <span class="keywordflow">if</span>(frequencies[i] &gt; 0)</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;    {</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;      numpresent++;</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;      sum += frequencies[i];</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;    }</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;  }</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;  <span class="keywordflow">if</span>(numcodes == 0) <span class="keywordflow">return</span> 80; <span class="comment">/*error: a tree of 0 symbols is not supposed to be made*/</span></div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;  tree-&gt;<a class="code" href="struct_huffman_tree.html#a608df5a24f60d1077a5cde19d5149e1f">numcodes</a> = (unsigned)numcodes; <span class="comment">/*number of symbols*/</span></div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;  uivector_resize(&amp;tree-&gt;<a class="code" href="struct_huffman_tree.html#a293790e0f67d8fdf9df5a2914af39251">lengths</a>, 0);</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;  <span class="keywordflow">if</span>(!uivector_resizev(&amp;tree-&gt;<a class="code" href="struct_huffman_tree.html#a293790e0f67d8fdf9df5a2914af39251">lengths</a>, tree-&gt;<a class="code" href="struct_huffman_tree.html#a608df5a24f60d1077a5cde19d5149e1f">numcodes</a>, 0)) <span class="keywordflow">return</span> 9905; <span class="comment">/*alloc fail*/</span></div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;  <span class="comment">/*there are no symbols at all, in that case add one symbol of value 0 to the tree (see RFC 1951 section 3.2.7) */</span></div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;  <span class="keywordflow">if</span>(numpresent == 0)</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;  {</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;    tree-&gt;<a class="code" href="struct_huffman_tree.html#a293790e0f67d8fdf9df5a2914af39251">lengths</a>.<a class="code" href="structuivector.html#a427d761df4bb4f0f19b4a973fc224c78">data</a>[0] = 1;</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;    <span class="keywordflow">return</span> HuffmanTree_makeFromLengths2(tree);</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;  }</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;  <span class="comment">/*the package merge algorithm gives wrong results if there&#39;s only one symbol</span></div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;<span class="comment">  (theoretically 0 bits would then suffice, but we need a proper symbol for zlib)*/</span></div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span>(numpresent == 1)</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;  {</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;    <span class="keywordflow">for</span>(i = 0; i &lt; numcodes; i++) <span class="keywordflow">if</span>(frequencies[i]) tree-&gt;<a class="code" href="struct_huffman_tree.html#a293790e0f67d8fdf9df5a2914af39251">lengths</a>.<a class="code" href="structuivector.html#a427d761df4bb4f0f19b4a973fc224c78">data</a>[i] = 1;</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;    <span class="keywordflow">return</span> HuffmanTree_makeFromLengths2(tree);</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;  }</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;  vector_init(&amp;coins, <span class="keyword">sizeof</span>(<a class="code" href="struct_coin.html">Coin</a>));</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;  vector_init(&amp;prev_row, <span class="keyword">sizeof</span>(<a class="code" href="struct_coin.html">Coin</a>));</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;  <span class="comment">/*Package-Merge algorithm represented by coin collector&#39;s problem</span></div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;<span class="comment">  For every symbol, maxbitlen coins will be created*/</span></div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;  <span class="comment">/*first row, lowest denominator*/</span></div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;  error = HuffmanTree_fillInCoins(&amp;coins, frequencies, tree-&gt;<a class="code" href="struct_huffman_tree.html#a608df5a24f60d1077a5cde19d5149e1f">numcodes</a>, sum);</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;  <span class="keywordflow">if</span>(!error)</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;  {</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;    <span class="keywordflow">for</span>(j = 1; j &lt;= maxbitlen &amp;&amp; !error; j++) <span class="comment">/*each of the remaining rows*/</span></div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;    {</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;      vector_swap(&amp;coins, &amp;prev_row); <span class="comment">/*swap instead of copying*/</span></div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;      <span class="keywordflow">if</span>(!vector_resized(&amp;coins, 0, Coin_cleanup)) <a class="code" href="lodepng_8cpp.html#a691b23954341613b96b6d98ce67d339c">ERROR_BREAK</a>(9906 <span class="comment">/*alloc fail*/</span>);</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;      <span class="keywordflow">for</span>(i = 0; i + 1 &lt; prev_row.<a class="code" href="structvector.html#a4200005b6949608d6a533db1a0d299c8">size</a>; i += 2)</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;      {</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;        <span class="keywordflow">if</span>(!vector_resize(&amp;coins, coins.<a class="code" href="structvector.html#a4200005b6949608d6a533db1a0d299c8">size</a> + 1)) <a class="code" href="lodepng_8cpp.html#a691b23954341613b96b6d98ce67d339c">ERROR_BREAK</a>(9907 <span class="comment">/*alloc fail*/</span>);</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;        Coin_init((<a class="code" href="struct_coin.html">Coin</a>*)vector_get(&amp;coins, coins.<a class="code" href="structvector.html#a4200005b6949608d6a533db1a0d299c8">size</a> - 1));</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;        Coin_copy((<a class="code" href="struct_coin.html">Coin</a>*)vector_get(&amp;coins, coins.<a class="code" href="structvector.html#a4200005b6949608d6a533db1a0d299c8">size</a> - 1), (<a class="code" href="struct_coin.html">Coin</a>*)vector_get(&amp;prev_row, i));</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;        <span class="comment">/*merge the coins into packages*/</span></div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;        addCoins((<a class="code" href="struct_coin.html">Coin</a>*)vector_get(&amp;coins, coins.<a class="code" href="structvector.html#a4200005b6949608d6a533db1a0d299c8">size</a> - 1), (<a class="code" href="struct_coin.html">Coin</a>*)vector_get(&amp;prev_row, i + 1));</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;      }</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;      <span class="keywordflow">if</span>(j &lt; maxbitlen)</div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;      {</div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;        error = HuffmanTree_fillInCoins(&amp;coins, frequencies, tree-&gt;<a class="code" href="struct_huffman_tree.html#a608df5a24f60d1077a5cde19d5149e1f">numcodes</a>, sum);</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;      }</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;    }</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;  }</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;  <span class="keywordflow">if</span>(!error)</div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;  {</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;    <span class="comment">/*keep the coins with lowest weight, so that they add up to the amount of symbols - 1*/</span></div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;    vector_resized(&amp;coins, numpresent - 1, Coin_cleanup);</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;    <span class="comment">/*calculate the lenghts of each symbol, as the amount of times a coin of each symbol is used*/</span></div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;    <span class="keywordflow">for</span>(i = 0; i &lt; coins.<a class="code" href="structvector.html#a4200005b6949608d6a533db1a0d299c8">size</a>; i++)</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;    {</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;      <a class="code" href="struct_coin.html">Coin</a>* coin = (<a class="code" href="struct_coin.html">Coin</a>*)vector_get(&amp;coins, i);</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;      <span class="keywordflow">for</span>(j = 0; j &lt; coin-&gt;<a class="code" href="struct_coin.html#a1d6bc1176bb9fcbd9ca8c781c92ef432">symbols</a>.<a class="code" href="structuivector.html#aa999025945f0c93d0461192475ae2720">size</a>; j++) tree-&gt;<a class="code" href="struct_huffman_tree.html#a293790e0f67d8fdf9df5a2914af39251">lengths</a>.<a class="code" href="structuivector.html#a427d761df4bb4f0f19b4a973fc224c78">data</a>[coin-&gt;<a class="code" href="struct_coin.html#a1d6bc1176bb9fcbd9ca8c781c92ef432">symbols</a>.<a class="code" href="structuivector.html#a427d761df4bb4f0f19b4a973fc224c78">data</a>[j]]++;</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;    }</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;    error = HuffmanTree_makeFromLengths2(tree);</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;  }</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;  vector_cleanupd(&amp;coins, Coin_cleanup);</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;  vector_cleanupd(&amp;prev_row, Coin_cleanup);</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;</div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;  <span class="keywordflow">return</span> error;</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;}</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;<span class="keyword">static</span> <span class="keywordtype">unsigned</span> HuffmanTree_getCode(<span class="keyword">const</span> <a class="code" href="struct_huffman_tree.html">HuffmanTree</a>* tree, <span class="keywordtype">unsigned</span> <a class="code" href="_d_l_l_imports_8inl.html#abf1b96ba8e05b846fde16efb5851232e">index</a>)</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;{</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;  <span class="keywordflow">return</span> tree-&gt;<a class="code" href="struct_huffman_tree.html#a0bb5fd80eb9ec029f66cf30641b98363">tree1d</a>.<a class="code" href="structuivector.html#a427d761df4bb4f0f19b4a973fc224c78">data</a>[<a class="code" href="_d_l_l_imports_8inl.html#abf1b96ba8e05b846fde16efb5851232e">index</a>];</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;}</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;<span class="keyword">static</span> <span class="keywordtype">unsigned</span> HuffmanTree_getLength(<span class="keyword">const</span> <a class="code" href="struct_huffman_tree.html">HuffmanTree</a>* tree, <span class="keywordtype">unsigned</span> <a class="code" href="_d_l_l_imports_8inl.html#abf1b96ba8e05b846fde16efb5851232e">index</a>)</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;{</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;  <span class="keywordflow">return</span> tree-&gt;<a class="code" href="struct_huffman_tree.html#a293790e0f67d8fdf9df5a2914af39251">lengths</a>.<a class="code" href="structuivector.html#a427d761df4bb4f0f19b4a973fc224c78">data</a>[<a class="code" href="_d_l_l_imports_8inl.html#abf1b96ba8e05b846fde16efb5851232e">index</a>];</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;}</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/*LODEPNG_COMPILE_ENCODER*/</span><span class="preprocessor"></span></div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;<span class="comment">/*get the literal and length code tree of a deflated block with fixed tree, as per the deflate specification*/</span></div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;<span class="keyword">static</span> <span class="keywordtype">unsigned</span> generateFixedLitLenTree(<a class="code" href="struct_huffman_tree.html">HuffmanTree</a>* tree)</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;{</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;  <span class="keywordtype">unsigned</span> i, error = 0;</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;  <a class="code" href="structuivector.html">uivector</a> bitlen;</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;  uivector_init(&amp;bitlen);</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;  <span class="keywordflow">if</span>(!uivector_resize(&amp;bitlen, <a class="code" href="lodepng_8cpp.html#a58feace6a0d109fc6bb2161504a3011e">NUM_DEFLATE_CODE_SYMBOLS</a>)) error = 9909; <span class="comment">/*alloc fail*/</span></div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;  <span class="keywordflow">if</span>(!error)</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;  {</div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;    <span class="comment">/*288 possible codes: 0-255=literals, 256=endcode, 257-285=lengthcodes, 286-287=unused*/</span></div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;    <span class="keywordflow">for</span>(i =   0; i &lt;= 143; i++) bitlen.<a class="code" href="structuivector.html#a427d761df4bb4f0f19b4a973fc224c78">data</a>[i] = 8;</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;    <span class="keywordflow">for</span>(i = 144; i &lt;= 255; i++) bitlen.<a class="code" href="structuivector.html#a427d761df4bb4f0f19b4a973fc224c78">data</a>[i] = 9;</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;    <span class="keywordflow">for</span>(i = 256; i &lt;= 279; i++) bitlen.<a class="code" href="structuivector.html#a427d761df4bb4f0f19b4a973fc224c78">data</a>[i] = 7;</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;    <span class="keywordflow">for</span>(i = 280; i &lt;= 287; i++) bitlen.<a class="code" href="structuivector.html#a427d761df4bb4f0f19b4a973fc224c78">data</a>[i] = 8;</div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;</div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;    error = HuffmanTree_makeFromLengths(tree, bitlen.<a class="code" href="structuivector.html#a427d761df4bb4f0f19b4a973fc224c78">data</a>, <a class="code" href="lodepng_8cpp.html#a58feace6a0d109fc6bb2161504a3011e">NUM_DEFLATE_CODE_SYMBOLS</a>, 15);</div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;  }</div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;</div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;  uivector_cleanup(&amp;bitlen);</div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;  <span class="keywordflow">return</span> error;</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;}</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;</div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;<span class="comment">/*get the distance code tree of a deflated block with fixed tree, as specified in the deflate specification*/</span></div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;<span class="keyword">static</span> <span class="keywordtype">unsigned</span> generateFixedDistanceTree(<a class="code" href="struct_huffman_tree.html">HuffmanTree</a>* tree)</div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;{</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;  <span class="keywordtype">unsigned</span> i, error = 0;</div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;  <a class="code" href="structuivector.html">uivector</a> bitlen;</div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;  uivector_init(&amp;bitlen);</div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;  <span class="keywordflow">if</span>(!uivector_resize(&amp;bitlen, <a class="code" href="lodepng_8cpp.html#a5b48becc8f2653ba2bb90858d38fc9ec">NUM_DISTANCE_SYMBOLS</a>)) error = 9910; <span class="comment">/*alloc fail*/</span></div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;  <span class="comment">/*there are 32 distance codes, but 30-31 are unused*/</span></div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;  <span class="keywordflow">if</span>(!error)</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;  {</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;    <span class="keywordflow">for</span>(i = 0; i &lt; <a class="code" href="lodepng_8cpp.html#a5b48becc8f2653ba2bb90858d38fc9ec">NUM_DISTANCE_SYMBOLS</a>; i++) bitlen.<a class="code" href="structuivector.html#a427d761df4bb4f0f19b4a973fc224c78">data</a>[i] = 5;</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;    error = HuffmanTree_makeFromLengths(tree, bitlen.<a class="code" href="structuivector.html#a427d761df4bb4f0f19b4a973fc224c78">data</a>, NUM_DISTANCE_SYMBOLS, 15);</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;  }</div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;  uivector_cleanup(&amp;bitlen);</div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;  <span class="keywordflow">return</span> error;</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;}</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;<span class="preprocessor">#ifdef LODEPNG_COMPILE_DECODER</span></div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;<span class="comment">returns the code, or (unsigned)(-1) if error happened</span></div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;<span class="comment">inbitlength is the length of the complete buffer, in bits (so its byte length times 8)</span></div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;<span class="comment">*/</span></div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;<span class="keyword">static</span> <span class="keywordtype">unsigned</span> huffmanDecodeSymbol(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* in, <span class="keywordtype">size_t</span>* bp,</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;                                    <span class="keyword">const</span> <a class="code" href="struct_huffman_tree.html">HuffmanTree</a>* codetree, <span class="keywordtype">size_t</span> inbitlength)</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;{</div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;  <span class="keywordtype">unsigned</span> treepos = 0, ct;</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;  <span class="keywordflow">for</span>(;;)</div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;  {</div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;    <span class="keywordflow">if</span>(*bp &gt; inbitlength) <span class="keywordflow">return</span> (<span class="keywordtype">unsigned</span>)(-1); <span class="comment">/*error: end of input memory reached without endcode*/</span></div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;<span class="comment">    decode the symbol from the tree. The &quot;readBitFromStream&quot; code is inlined in</span></div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;<span class="comment">    the expression below because this is the biggest bottleneck while decoding</span></div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;<span class="comment">    */</span></div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;    ct = codetree-&gt;<a class="code" href="struct_huffman_tree.html#a24afa4a1079f6ee1c9829b9b5aa5fe89">tree2d</a>.<a class="code" href="structuivector.html#a427d761df4bb4f0f19b4a973fc224c78">data</a>[(treepos &lt;&lt; 1) + <a class="code" href="lodepng_8cpp.html#a89f06ac9bcf1964fb4d663ad7a8dc4a1">READBIT</a>(*bp, in)];</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;    (*bp)++;</div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;    <span class="keywordflow">if</span>(ct &lt; codetree-&gt;numcodes) <span class="keywordflow">return</span> ct; <span class="comment">/*the symbol is decoded, return it*/</span></div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;    <span class="keywordflow">else</span> treepos = ct - codetree-&gt;<a class="code" href="struct_huffman_tree.html#a608df5a24f60d1077a5cde19d5149e1f">numcodes</a>; <span class="comment">/*symbol not yet decoded, instead move tree position*/</span></div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;</div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;    <span class="keywordflow">if</span>(treepos &gt;= codetree-&gt;<a class="code" href="struct_huffman_tree.html#a608df5a24f60d1077a5cde19d5149e1f">numcodes</a>) <span class="keywordflow">return</span> (<span class="keywordtype">unsigned</span>)(-1); <span class="comment">/*error: it appeared outside the codetree*/</span></div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;  }</div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;}</div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/*LODEPNG_COMPILE_DECODER*/</span><span class="preprocessor"></span></div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;<span class="preprocessor">#ifdef LODEPNG_COMPILE_DECODER</span></div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;<span class="comment">/* ////////////////////////////////////////////////////////////////////////// */</span></div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;<span class="comment">/* / Inflator (Decompressor)                                                / */</span></div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;<span class="comment">/* ////////////////////////////////////////////////////////////////////////// */</span></div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;</div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;<span class="comment">/*get the tree of a deflated block with fixed tree, as specified in the deflate specification*/</span></div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> getTreeInflateFixed(<a class="code" href="struct_huffman_tree.html">HuffmanTree</a>* tree_ll, <a class="code" href="struct_huffman_tree.html">HuffmanTree</a>* tree_d)</div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;{</div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;  <span class="comment">/*error checking not done, this is fixed stuff, it works, it doesn&#39;t depend on the image*/</span></div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;  <span class="comment">/*TODO: out of memory errors could still happen...*/</span></div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;  generateFixedLitLenTree(tree_ll);</div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;  generateFixedDistanceTree(tree_d);</div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;}</div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;<span class="comment">/*get the tree of a deflated block with dynamic tree, the tree itself is also Huffman compressed with a known tree*/</span></div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;<span class="keyword">static</span> <span class="keywordtype">unsigned</span> getTreeInflateDynamic(<a class="code" href="struct_huffman_tree.html">HuffmanTree</a>* tree_ll, <a class="code" href="struct_huffman_tree.html">HuffmanTree</a>* tree_d,</div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;                                      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* in, <span class="keywordtype">size_t</span>* bp, <span class="keywordtype">size_t</span> inlength)</div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;{</div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;  <span class="comment">/*make sure that length values that aren&#39;t filled in will be 0, or a wrong tree will be generated*/</span></div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;  <span class="keywordtype">unsigned</span> error = 0;</div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;  <span class="keywordtype">unsigned</span> <a class="code" href="_d_l_l_imports_8inl.html#a7bfd2fdf58fb75abde6e36d72617c71b">n</a>, HLIT, HDIST, HCLEN, i;</div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;  <span class="keywordtype">size_t</span> inbitlength = inlength * 8;</div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;</div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;  <span class="comment">/*see comments in deflateDynamic for explanation of the context and these variables, it is analogous*/</span></div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;  <a class="code" href="structuivector.html">uivector</a> bitlen_ll; <span class="comment">/*lit,len code lengths*/</span></div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;  <a class="code" href="structuivector.html">uivector</a> bitlen_d; <span class="comment">/*dist code lengths*/</span></div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;  <span class="comment">/*code length code lengths (&quot;clcl&quot;), the bit lengths of the huffman tree used to compress bitlen_ll and bitlen_d*/</span></div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;  <a class="code" href="structuivector.html">uivector</a> bitlen_cl;</div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;  <a class="code" href="struct_huffman_tree.html">HuffmanTree</a> tree_cl; <span class="comment">/*the code tree for code length codes (the huffman tree for compressed huffman trees)*/</span></div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;</div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;  <span class="keywordflow">if</span>((*bp) &gt;&gt; 3 &gt;= inlength - 2) <span class="keywordflow">return</span> 49; <span class="comment">/*the bit pointer is or will go past the memory*/</span></div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;</div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;  <span class="comment">/*number of literal/length codes + 257. Unlike the spec, the value 257 is added to it here already*/</span></div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;  HLIT =  readBitsFromStream(bp, in, 5) + 257;</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;  <span class="comment">/*number of distance codes. Unlike the spec, the value 1 is added to it here already*/</span></div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;  HDIST = readBitsFromStream(bp, in, 5) + 1;</div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;  <span class="comment">/*number of code length codes. Unlike the spec, the value 4 is added to it here already*/</span></div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;  HCLEN = readBitsFromStream(bp, in, 4) + 4;</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;</div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;  HuffmanTree_init(&amp;tree_cl);</div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;  uivector_init(&amp;bitlen_ll);</div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;  uivector_init(&amp;bitlen_d);</div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;  uivector_init(&amp;bitlen_cl);</div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;</div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;  <span class="keywordflow">while</span>(!error)</div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;  {</div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;    <span class="comment">/*read the code length codes out of 3 * (amount of code length codes) bits*/</span></div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;    </div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;    <span class="keywordflow">if</span>(!uivector_resize(&amp;bitlen_cl, <a class="code" href="lodepng_8cpp.html#a22ed04d49e008cb4295a8b366c4f2f3b">NUM_CODE_LENGTH_CODES</a>)) <a class="code" href="lodepng_8cpp.html#a691b23954341613b96b6d98ce67d339c">ERROR_BREAK</a>(9911);</div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;</div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;    <span class="keywordflow">for</span>(i = 0; i &lt; <a class="code" href="lodepng_8cpp.html#a22ed04d49e008cb4295a8b366c4f2f3b">NUM_CODE_LENGTH_CODES</a>; i++)</div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;    {</div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;      <span class="keywordflow">if</span>(i &lt; HCLEN) bitlen_cl.<a class="code" href="structuivector.html#a427d761df4bb4f0f19b4a973fc224c78">data</a>[CLCL_ORDER[i]] = readBitsFromStream(bp, in, 3);</div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;      <span class="keywordflow">else</span> bitlen_cl.<a class="code" href="structuivector.html#a427d761df4bb4f0f19b4a973fc224c78">data</a>[CLCL_ORDER[i]] = 0; <span class="comment">/*if not, it must stay 0*/</span></div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;    }</div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;</div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;    error = HuffmanTree_makeFromLengths(&amp;tree_cl, bitlen_cl.<a class="code" href="structuivector.html#a427d761df4bb4f0f19b4a973fc224c78">data</a>, bitlen_cl.<a class="code" href="structuivector.html#aa999025945f0c93d0461192475ae2720">size</a>, 7);</div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;    <span class="keywordflow">if</span>(error) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;</div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;    <span class="comment">/*now we can use this tree to read the lengths for the tree that this function will return*/</span></div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;    uivector_resizev(&amp;bitlen_ll, <a class="code" href="lodepng_8cpp.html#a58feace6a0d109fc6bb2161504a3011e">NUM_DEFLATE_CODE_SYMBOLS</a>, 0);</div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;    uivector_resizev(&amp;bitlen_d, <a class="code" href="lodepng_8cpp.html#a5b48becc8f2653ba2bb90858d38fc9ec">NUM_DISTANCE_SYMBOLS</a>, 0);</div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;    i = 0;</div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;    <span class="keywordflow">if</span>(!bitlen_ll.<a class="code" href="structuivector.html#a427d761df4bb4f0f19b4a973fc224c78">data</a> || !bitlen_d.<a class="code" href="structuivector.html#a427d761df4bb4f0f19b4a973fc224c78">data</a>) <a class="code" href="lodepng_8cpp.html#a691b23954341613b96b6d98ce67d339c">ERROR_BREAK</a>(9912); <span class="comment">/*alloc fail*/</span></div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;</div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;    <span class="comment">/*i is the current symbol we&#39;re reading in the part that contains the code lengths of lit/len and dist codes*/</span></div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;    <span class="keywordflow">while</span>(i &lt; HLIT + HDIST)</div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;    {</div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;      <span class="keywordtype">unsigned</span> code = huffmanDecodeSymbol(in, bp, &amp;tree_cl, inbitlength);</div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;      <span class="keywordflow">if</span>(code &lt;= 15) <span class="comment">/*a length code*/</span></div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;      {</div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;        <span class="keywordflow">if</span>(i &lt; HLIT) bitlen_ll.<a class="code" href="structuivector.html#a427d761df4bb4f0f19b4a973fc224c78">data</a>[i] = code;</div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;        <span class="keywordflow">else</span> bitlen_d.<a class="code" href="structuivector.html#a427d761df4bb4f0f19b4a973fc224c78">data</a>[i - HLIT] = code;</div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;        i++;</div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;      }</div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span>(code == 16) <span class="comment">/*repeat previous*/</span></div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;      {</div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;        <span class="keywordtype">unsigned</span> replength = 3; <span class="comment">/*read in the 2 bits that indicate repeat length (3-6)*/</span></div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;        <span class="keywordtype">unsigned</span> <a class="code" href="_d_l_l_imports_8inl.html#a3f2d6cd655118d09cc005e6760706570">value</a>; <span class="comment">/*set value to the previous code*/</span></div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;</div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;        <span class="keywordflow">if</span>((*bp) &gt;&gt; 3 &gt;= inlength) <a class="code" href="lodepng_8cpp.html#a691b23954341613b96b6d98ce67d339c">ERROR_BREAK</a>(50); <span class="comment">/*error, bit pointer jumps past memory*/</span></div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;</div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;        replength += readBitsFromStream(bp, in, 2);</div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;</div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;        <span class="keywordflow">if</span>((i - 1) &lt; HLIT) value = bitlen_ll.<a class="code" href="structuivector.html#a427d761df4bb4f0f19b4a973fc224c78">data</a>[i - 1];</div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;        <span class="keywordflow">else</span> value = bitlen_d.<a class="code" href="structuivector.html#a427d761df4bb4f0f19b4a973fc224c78">data</a>[i - HLIT - 1];</div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;        <span class="comment">/*repeat this value in the next lengths*/</span></div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;        <span class="keywordflow">for</span>(n = 0; n &lt; replength; n++)</div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;        {</div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;          <span class="keywordflow">if</span>(i &gt;= HLIT + HDIST) <a class="code" href="lodepng_8cpp.html#a691b23954341613b96b6d98ce67d339c">ERROR_BREAK</a>(13); <span class="comment">/*error: i is larger than the amount of codes*/</span></div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;          <span class="keywordflow">if</span>(i &lt; HLIT) bitlen_ll.<a class="code" href="structuivector.html#a427d761df4bb4f0f19b4a973fc224c78">data</a>[i] = <a class="code" href="_d_l_l_imports_8inl.html#a3f2d6cd655118d09cc005e6760706570">value</a>;</div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;          <span class="keywordflow">else</span> bitlen_d.<a class="code" href="structuivector.html#a427d761df4bb4f0f19b4a973fc224c78">data</a>[i - HLIT] = <a class="code" href="_d_l_l_imports_8inl.html#a3f2d6cd655118d09cc005e6760706570">value</a>;</div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;          i++;</div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;        }</div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;      }</div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span>(code == 17) <span class="comment">/*repeat &quot;0&quot; 3-10 times*/</span></div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;      {</div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;        <span class="keywordtype">unsigned</span> replength = 3; <span class="comment">/*read in the bits that indicate repeat length*/</span></div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;        <span class="keywordflow">if</span>((*bp) &gt;&gt; 3 &gt;= inlength) <a class="code" href="lodepng_8cpp.html#a691b23954341613b96b6d98ce67d339c">ERROR_BREAK</a>(50); <span class="comment">/*error, bit pointer jumps past memory*/</span></div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;</div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;        replength += readBitsFromStream(bp, in, 3);</div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;</div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;        <span class="comment">/*repeat this value in the next lengths*/</span></div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;        <span class="keywordflow">for</span>(n = 0; n &lt; replength; n++)</div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;        {</div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;          <span class="keywordflow">if</span>(i &gt;= HLIT + HDIST) <a class="code" href="lodepng_8cpp.html#a691b23954341613b96b6d98ce67d339c">ERROR_BREAK</a>(14); <span class="comment">/*error: i is larger than the amount of codes*/</span></div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;</div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;          <span class="keywordflow">if</span>(i &lt; HLIT) bitlen_ll.<a class="code" href="structuivector.html#a427d761df4bb4f0f19b4a973fc224c78">data</a>[i] = 0;</div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;          <span class="keywordflow">else</span> bitlen_d.<a class="code" href="structuivector.html#a427d761df4bb4f0f19b4a973fc224c78">data</a>[i - HLIT] = 0;</div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;          i++;</div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;        }</div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;      }</div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span>(code == 18) <span class="comment">/*repeat &quot;0&quot; 11-138 times*/</span></div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;      {</div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;        <span class="keywordtype">unsigned</span> replength = 11; <span class="comment">/*read in the bits that indicate repeat length*/</span></div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;        <span class="keywordflow">if</span>((*bp) &gt;&gt; 3 &gt;= inlength) <a class="code" href="lodepng_8cpp.html#a691b23954341613b96b6d98ce67d339c">ERROR_BREAK</a>(50); <span class="comment">/*error, bit pointer jumps past memory*/</span></div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;</div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;        replength += readBitsFromStream(bp, in, 7);</div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;</div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;        <span class="comment">/*repeat this value in the next lengths*/</span></div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;        <span class="keywordflow">for</span>(n = 0; n &lt; replength; n++)</div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;        {</div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;          <span class="keywordflow">if</span>(i &gt;= HLIT + HDIST) <a class="code" href="lodepng_8cpp.html#a691b23954341613b96b6d98ce67d339c">ERROR_BREAK</a>(15); <span class="comment">/*error: i is larger than the amount of codes*/</span></div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;</div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;          <span class="keywordflow">if</span>(i &lt; HLIT) bitlen_ll.<a class="code" href="structuivector.html#a427d761df4bb4f0f19b4a973fc224c78">data</a>[i] = 0;</div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;          <span class="keywordflow">else</span> bitlen_d.<a class="code" href="structuivector.html#a427d761df4bb4f0f19b4a973fc224c78">data</a>[i - HLIT] = 0;</div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;          i++;</div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;        }</div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;      }</div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;      <span class="keywordflow">else</span> <span class="comment">/*if(code == (unsigned)(-1))*/</span> <span class="comment">/*huffmanDecodeSymbol returns (unsigned)(-1) in case of error*/</span></div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;      {</div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;        <span class="keywordflow">if</span>(code == (<span class="keywordtype">unsigned</span>)(-1))</div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;        {</div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;          <span class="comment">/*return error code 10 or 11 depending on the situation that happened in huffmanDecodeSymbol</span></div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;<span class="comment">          (10=no endcode, 11=wrong jump outside of tree)*/</span></div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;          error = (*bp) &gt; inlength * 8 ? 10 : 11;</div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;        }</div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;        <span class="keywordflow">else</span> error = 16; <span class="comment">/*unexisting code, this can never happen*/</span></div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;      }</div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;    }</div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;    <span class="keywordflow">if</span>(error) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;</div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;    <span class="keywordflow">if</span>(bitlen_ll.<a class="code" href="structuivector.html#a427d761df4bb4f0f19b4a973fc224c78">data</a>[256] == 0) <a class="code" href="lodepng_8cpp.html#a691b23954341613b96b6d98ce67d339c">ERROR_BREAK</a>(64); <span class="comment">/*the length of the end code 256 must be larger than 0*/</span></div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;</div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;    <span class="comment">/*now we&#39;ve finally got HLIT and HDIST, so generate the code trees, and the function is done*/</span></div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;    error = HuffmanTree_makeFromLengths(tree_ll, &amp;bitlen_ll.<a class="code" href="structuivector.html#a427d761df4bb4f0f19b4a973fc224c78">data</a>[0], bitlen_ll.<a class="code" href="structuivector.html#aa999025945f0c93d0461192475ae2720">size</a>, 15);</div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;    <span class="keywordflow">if</span>(error) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;    error = HuffmanTree_makeFromLengths(tree_d, &amp;bitlen_d.<a class="code" href="structuivector.html#a427d761df4bb4f0f19b4a973fc224c78">data</a>[0], bitlen_d.<a class="code" href="structuivector.html#aa999025945f0c93d0461192475ae2720">size</a>, 15);</div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;</div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;    <span class="keywordflow">break</span>; <span class="comment">/*end of error-while*/</span></div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;  }</div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;</div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;  uivector_cleanup(&amp;bitlen_cl);</div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;  uivector_cleanup(&amp;bitlen_ll);</div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;  uivector_cleanup(&amp;bitlen_d);</div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;  HuffmanTree_cleanup(&amp;tree_cl);</div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;</div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;  <span class="keywordflow">return</span> error;</div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;}</div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;</div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;<span class="comment">/*inflate a block with dynamic of fixed Huffman tree*/</span></div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;<span class="keyword">static</span> <span class="keywordtype">unsigned</span> inflateHuffmanBlock(<a class="code" href="structucvector.html">ucvector</a>* out, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* in, <span class="keywordtype">size_t</span>* bp,</div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;                                    <span class="keywordtype">size_t</span>* pos, <span class="keywordtype">size_t</span> inlength, <span class="keywordtype">unsigned</span> btype)</div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;{</div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;  <span class="keywordtype">unsigned</span> error = 0;</div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;  <a class="code" href="struct_huffman_tree.html">HuffmanTree</a> tree_ll; <span class="comment">/*the huffman tree for literal and length codes*/</span></div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;  <a class="code" href="struct_huffman_tree.html">HuffmanTree</a> tree_d; <span class="comment">/*the huffman tree for distance codes*/</span></div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;  <span class="keywordtype">size_t</span> inbitlength = inlength * 8;</div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;</div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;  HuffmanTree_init(&amp;tree_ll);</div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;  HuffmanTree_init(&amp;tree_d);</div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;</div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;  <span class="keywordflow">if</span>(btype == 1) getTreeInflateFixed(&amp;tree_ll, &amp;tree_d);</div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span>(btype == 2)</div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;  {</div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;    error = getTreeInflateDynamic(&amp;tree_ll, &amp;tree_d, in, bp, inlength);</div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;  }</div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;</div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;  <span class="keywordflow">for</span>(;;) <span class="comment">/*decode all symbols until end reached*/</span></div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;  {</div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;    <span class="comment">/*code_ll is literal, length or end code*/</span></div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;    <span class="keywordtype">unsigned</span> code_ll = huffmanDecodeSymbol(in, bp, &amp;tree_ll, inbitlength);</div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;    <span class="keywordflow">if</span>(code_ll &lt;= 255) <span class="comment">/*literal symbol*/</span></div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;    {</div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;      <span class="keywordflow">if</span>((*pos) &gt;= out-&gt;<a class="code" href="structucvector.html#a27c99c34de0c5b3ca0c242d402c69499">size</a>)</div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;      {</div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;        <span class="comment">/*reserve more room at once*/</span></div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;        <span class="keywordflow">if</span>(!ucvector_resize(out, ((*pos) + 1) * 2)) <a class="code" href="lodepng_8cpp.html#a691b23954341613b96b6d98ce67d339c">ERROR_BREAK</a>(9913 <span class="comment">/*alloc fail*/</span>);</div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;      }</div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;      out-&gt;<a class="code" href="structucvector.html#ace794c5713208c5a20f21762cd87c919">data</a>[(*pos)] = (<span class="keywordtype">unsigned</span> char)(code_ll);</div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;      (*pos)++;</div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;    }</div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(code_ll &gt;= <a class="code" href="lodepng_8cpp.html#acfb12caea990f92b3aed7c199f615213">FIRST_LENGTH_CODE_INDEX</a> &amp;&amp; code_ll &lt;= <a class="code" href="lodepng_8cpp.html#adf9597781d7175fdee0b2466e6e462e7">LAST_LENGTH_CODE_INDEX</a>) <span class="comment">/*length code*/</span></div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;    {</div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;      <span class="keywordtype">unsigned</span> code_d, distance;</div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;      <span class="keywordtype">unsigned</span> numextrabits_l, numextrabits_d; <span class="comment">/*extra bits for length and distance*/</span></div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;      <span class="keywordtype">size_t</span> start, forward, backward, <a class="code" href="_d_l_l_imports_8inl.html#a5720e2b8f4f85b31e0bab5a1b6e69c74">length</a>;</div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;      </div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;      <span class="comment">/*part 1: get length base*/</span></div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;      length = LENGTHBASE[code_ll - <a class="code" href="lodepng_8cpp.html#acfb12caea990f92b3aed7c199f615213">FIRST_LENGTH_CODE_INDEX</a>];</div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;</div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;      <span class="comment">/*part 2: get extra bits and add the value of that to length*/</span></div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;      numextrabits_l = LENGTHEXTRA[code_ll - <a class="code" href="lodepng_8cpp.html#acfb12caea990f92b3aed7c199f615213">FIRST_LENGTH_CODE_INDEX</a>];</div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;      <span class="keywordflow">if</span>(((*bp) &gt;&gt; 3) &gt;= inlength) <a class="code" href="lodepng_8cpp.html#a691b23954341613b96b6d98ce67d339c">ERROR_BREAK</a>(51); <span class="comment">/*error, bit pointer will jump past memory*/</span></div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;      length += readBitsFromStream(bp, in, numextrabits_l);</div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;</div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;      <span class="comment">/*part 3: get distance code*/</span></div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;      code_d = huffmanDecodeSymbol(in, bp, &amp;tree_d, inbitlength);</div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;      <span class="keywordflow">if</span>(code_d &gt; 29)</div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;      {</div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;        <span class="keywordflow">if</span>(code_ll == (<span class="keywordtype">unsigned</span>)(-1)) <span class="comment">/*huffmanDecodeSymbol returns (unsigned)(-1) in case of error*/</span></div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;        {</div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;          <span class="comment">/*return error code 10 or 11 depending on the situation that happened in huffmanDecodeSymbol</span></div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;<span class="comment">          (10=no endcode, 11=wrong jump outside of tree)*/</span></div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;          error = (*bp) &gt; inlength * 8 ? 10 : 11;</div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;        }</div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;        <span class="keywordflow">else</span> error = 18; <span class="comment">/*error: invalid distance code (30-31 are never used)*/</span></div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;      }</div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;      distance = DISTANCEBASE[code_d];</div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;</div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;      <span class="comment">/*part 4: get extra bits from distance*/</span></div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;      numextrabits_d = DISTANCEEXTRA[code_d];</div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;      <span class="keywordflow">if</span>(((*bp) &gt;&gt; 3) &gt;= inlength) <a class="code" href="lodepng_8cpp.html#a691b23954341613b96b6d98ce67d339c">ERROR_BREAK</a>(51); <span class="comment">/*error, bit pointer will jump past memory*/</span></div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;</div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;      distance += readBitsFromStream(bp, in, numextrabits_d);</div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;</div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;      <span class="comment">/*part 5: fill in all the out[n] values based on the length and dist*/</span></div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;      start = (*pos);</div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;      backward = start - distance;</div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;      <span class="keywordflow">if</span>((*pos) + length &gt;= out-&gt;<a class="code" href="structucvector.html#a27c99c34de0c5b3ca0c242d402c69499">size</a>)</div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;      {</div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;        <span class="comment">/*reserve more room at once*/</span></div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;        <span class="keywordflow">if</span>(!ucvector_resize(out, ((*pos) + length) * 2)) <a class="code" href="lodepng_8cpp.html#a691b23954341613b96b6d98ce67d339c">ERROR_BREAK</a>(9914 <span class="comment">/*alloc fail*/</span>);</div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;      }</div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;</div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;      <span class="keywordflow">for</span>(forward = 0; forward &lt; <a class="code" href="_d_l_l_imports_8inl.html#a5720e2b8f4f85b31e0bab5a1b6e69c74">length</a>; forward++)</div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;      {</div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;        out-&gt;<a class="code" href="structucvector.html#ace794c5713208c5a20f21762cd87c919">data</a>[(*pos)] = out-&gt;<a class="code" href="structucvector.html#ace794c5713208c5a20f21762cd87c919">data</a>[backward];</div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;        (*pos)++;</div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;        backward++;</div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;        <span class="keywordflow">if</span>(backward &gt;= start) backward = start - distance;</div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;      }</div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;    }</div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(code_ll == 256)</div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;    {</div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;      <span class="keywordflow">break</span>; <span class="comment">/*end code, break the loop*/</span></div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;    }</div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;    <span class="keywordflow">else</span> <span class="comment">/*if(code == (unsigned)(-1))*/</span> <span class="comment">/*huffmanDecodeSymbol returns (unsigned)(-1) in case of error*/</span></div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;    {</div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;      <span class="comment">/*return error code 10 or 11 depending on the situation that happened in huffmanDecodeSymbol</span></div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;<span class="comment">      (10=no endcode, 11=wrong jump outside of tree)*/</span></div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;      error = (*bp) &gt; inlength * 8 ? 10 : 11;</div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;    }</div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;  }</div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;</div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;  HuffmanTree_cleanup(&amp;tree_ll);</div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;  HuffmanTree_cleanup(&amp;tree_d);</div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;</div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;  <span class="keywordflow">return</span> error;</div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;}</div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;</div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;<span class="keyword">static</span> <span class="keywordtype">unsigned</span> inflateNoCompression(<a class="code" href="structucvector.html">ucvector</a>* out, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* in, <span class="keywordtype">size_t</span>* bp, <span class="keywordtype">size_t</span>* pos, <span class="keywordtype">size_t</span> inlength)</div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;{</div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;  <span class="comment">/*go to first boundary of byte*/</span></div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;  <span class="keywordtype">size_t</span> <a class="code" href="_d_l_l_imports_8inl.html#a5a11afa44e3df9fa01e461dc15484392">p</a>;</div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;  <span class="keywordtype">unsigned</span> LEN, NLEN, <a class="code" href="_d_l_l_imports_8inl.html#a7bfd2fdf58fb75abde6e36d72617c71b">n</a>, error = 0;</div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;  <span class="keywordflow">while</span>(((*bp) &amp; 0x7) != 0) (*bp)++;</div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;  p = (*bp) / 8; <span class="comment">/*byte position*/</span></div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;</div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;  <span class="comment">/*read LEN (2 bytes) and NLEN (2 bytes)*/</span></div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;  <span class="keywordflow">if</span>(p &gt;= inlength - 4) <span class="keywordflow">return</span> 52; <span class="comment">/*error, bit pointer will jump past memory*/</span></div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;  LEN = in[<a class="code" href="_d_l_l_imports_8inl.html#a5a11afa44e3df9fa01e461dc15484392">p</a>] + 256 * in[p + 1]; p += 2;</div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;  NLEN = in[<a class="code" href="_d_l_l_imports_8inl.html#a5a11afa44e3df9fa01e461dc15484392">p</a>] + 256 * in[p + 1]; p += 2;</div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;</div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;  <span class="comment">/*check if 16-bit NLEN is really the one&#39;s complement of LEN*/</span></div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;  <span class="keywordflow">if</span>(LEN + NLEN != 65535) <span class="keywordflow">return</span> 21; <span class="comment">/*error: NLEN is not one&#39;s complement of LEN*/</span></div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;</div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;  <span class="keywordflow">if</span>((*pos) + LEN &gt;= out-&gt;<a class="code" href="structucvector.html#a27c99c34de0c5b3ca0c242d402c69499">size</a>)</div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;  {</div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;    <span class="keywordflow">if</span>(!ucvector_resize(out, (*pos) + LEN)) <span class="keywordflow">return</span> 9915; <span class="comment">/*alloc fail*/</span></div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;  }</div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;</div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;  <span class="comment">/*read the literal data: LEN bytes are now stored in the out buffer*/</span></div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;  <span class="keywordflow">if</span>(p + LEN &gt; inlength) <span class="keywordflow">return</span> 23; <span class="comment">/*error: reading outside of in buffer*/</span></div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;  <span class="keywordflow">for</span>(n = 0; n &lt; LEN; n++) out-&gt;<a class="code" href="structucvector.html#ace794c5713208c5a20f21762cd87c919">data</a>[(*pos)++] = in[p++];</div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;</div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;  (*bp) = p * 8;</div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;</div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;  <span class="keywordflow">return</span> error;</div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;}</div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;</div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;<span class="comment">/*inflate the deflated data (cfr. deflate spec); return value is the error*/</span></div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;<span class="keyword">static</span> <span class="keywordtype">unsigned</span> LodePNG_inflate(<a class="code" href="structucvector.html">ucvector</a>* out, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* in, <span class="keywordtype">size_t</span> insize, <span class="keywordtype">size_t</span> inpos)</div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;{</div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;  <span class="comment">/*bit pointer in the &quot;in&quot; data, current byte is bp &gt;&gt; 3, current bit is bp &amp; 0x7 (from lsb to msb of the byte)*/</span></div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;  <span class="keywordtype">size_t</span> bp = 0;</div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;  <span class="keywordtype">unsigned</span> BFINAL = 0;</div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;  <span class="keywordtype">size_t</span> pos = 0; <span class="comment">/*byte position in the out buffer*/</span></div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;</div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;  <span class="keywordtype">unsigned</span> error = 0;</div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;</div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;  <span class="keywordflow">while</span>(!BFINAL)</div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;  {</div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;    <span class="keywordtype">unsigned</span> BTYPE;</div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;    <span class="keywordflow">if</span>(bp + 2 &gt;= insize * 8) <span class="keywordflow">return</span> 52; <span class="comment">/*error, bit pointer will jump past memory*/</span></div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;    BFINAL = readBitFromStream(&amp;bp, &amp;in[inpos]);</div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;    BTYPE = 1 * readBitFromStream(&amp;bp, &amp;in[inpos]);</div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;    BTYPE += 2 * readBitFromStream(&amp;bp, &amp;in[inpos]);</div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;</div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;    <span class="keywordflow">if</span>(BTYPE == 3) <span class="keywordflow">return</span> 20; <span class="comment">/*error: invalid BTYPE*/</span></div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(BTYPE == 0) error = inflateNoCompression(out, &amp;in[inpos], &amp;bp, &amp;pos, insize); <span class="comment">/*no compression*/</span></div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;    <span class="keywordflow">else</span> error = inflateHuffmanBlock(out, &amp;in[inpos], &amp;bp, &amp;pos, insize, BTYPE); <span class="comment">/*compression, BTYPE 01 or 10*/</span></div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;</div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;    <span class="keywordflow">if</span>(error) <span class="keywordflow">return</span> error;</div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;  }</div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;  </div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;  <span class="comment">/*Only now we know the true size of out, resize it to that*/</span></div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;  <span class="keywordflow">if</span>(!ucvector_resize(out, pos)) error = 9916; <span class="comment">/*alloc fail*/</span></div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;</div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;  <span class="keywordflow">return</span> error;</div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;}</div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;</div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/*LODEPNG_COMPILE_DECODER*/</span><span class="preprocessor"></span></div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;<span class="preprocessor">#ifdef LODEPNG_COMPILE_ENCODER</span></div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;<span class="comment">/* ////////////////////////////////////////////////////////////////////////// */</span></div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;<span class="comment">/* / Deflator (Compressor)                                                  / */</span></div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;<span class="comment">/* ////////////////////////////////////////////////////////////////////////// */</span></div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;</div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">size_t</span> MAX_SUPPORTED_DEFLATE_LENGTH = 258;</div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;</div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;<span class="comment">/*bitlen is the size in bits of the code*/</span></div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> addHuffmanSymbol(<span class="keywordtype">size_t</span>* bp, <a class="code" href="structucvector.html">ucvector</a>* compressed, <span class="keywordtype">unsigned</span> code, <span class="keywordtype">unsigned</span> bitlen)</div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;{</div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;  addBitsToStreamReversed(bp, compressed, code, bitlen);</div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;}</div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;</div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;<span class="comment">/*search the index in the array, that has the largest value smaller than or equal to the given value,</span></div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;<span class="comment">given array must be sorted (if no value is smaller, it returns the size of the given array)*/</span></div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;<span class="keyword">static</span> <span class="keywordtype">size_t</span> searchCodeIndex(<span class="keyword">const</span> <span class="keywordtype">unsigned</span>* array, <span class="keywordtype">size_t</span> array_size, <span class="keywordtype">size_t</span> value)</div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;{</div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;  <span class="comment">/*linear search implementation*/</span></div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;  <span class="comment">/*for(size_t i = 1; i &lt; array_size; i++) if(array[i] &gt; value) return i - 1;</span></div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;<span class="comment">  return array_size - 1;*/</span></div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;</div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;  <span class="comment">/*binary search implementation (not that much faster) (precondition: array_size &gt; 0)*/</span></div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;  <span class="keywordtype">size_t</span> left  = 1;</div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;  <span class="keywordtype">size_t</span> right = array_size - 1;</div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;  <span class="keywordflow">while</span>(left &lt;= right)</div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;  {</div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;    <span class="keywordtype">size_t</span> mid = (left + right) / 2;</div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;    <span class="keywordflow">if</span>(array[mid] &lt;= value) left = mid + 1; <span class="comment">/*the value to find is more to the right*/</span></div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(array[mid - 1] &gt; value) right = mid - 1; <span class="comment">/*the value to find is more to the left*/</span></div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">return</span> mid - 1;</div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;  }</div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;  <span class="keywordflow">return</span> array_size - 1;</div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;}</div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;</div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> addLengthDistance(<a class="code" href="structuivector.html">uivector</a>* values, <span class="keywordtype">size_t</span> length, <span class="keywordtype">size_t</span> distance)</div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;{</div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;  <span class="comment">/*values in encoded vector are those used by deflate:</span></div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;<span class="comment">  0-255: literal bytes</span></div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;<span class="comment">  256: end</span></div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;<span class="comment">  257-285: length/distance pair (length code, followed by extra length bits, distance code, extra distance bits)</span></div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;<span class="comment">  286-287: invalid*/</span></div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;</div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;  <span class="keywordtype">unsigned</span> length_code = (unsigned)searchCodeIndex(LENGTHBASE, 29, length);</div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;  <span class="keywordtype">unsigned</span> extra_length = (unsigned)(length - LENGTHBASE[length_code]);</div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;  <span class="keywordtype">unsigned</span> dist_code = (unsigned)searchCodeIndex(DISTANCEBASE, 30, distance);</div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;  <span class="keywordtype">unsigned</span> extra_distance = (unsigned)(distance - DISTANCEBASE[dist_code]);</div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;</div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;  uivector_push_back(values, length_code + <a class="code" href="lodepng_8cpp.html#acfb12caea990f92b3aed7c199f615213">FIRST_LENGTH_CODE_INDEX</a>);</div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;  uivector_push_back(values, extra_length);</div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;  uivector_push_back(values, dist_code);</div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;  uivector_push_back(values, extra_distance);</div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;}</div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;</div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;<span class="preprocessor">#if 0</span></div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;<span class="preprocessor"></span><span class="comment">/*the &quot;brute force&quot; version of the encodeLZ7 algorithm, not used anymore, kept here for reference*/</span></div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;<span class="keyword">static</span> <span class="keywordtype">unsigned</span> encodeLZ77_brute(<a class="code" href="structuivector.html">uivector</a>* out, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* in, <span class="keywordtype">size_t</span> insize, <span class="keywordtype">unsigned</span> windowSize)</div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;{</div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;  <span class="keywordtype">size_t</span> pos;</div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;  <span class="keywordflow">for</span>(pos = 0; pos &lt; insize; pos++)</div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;  {</div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;    <span class="keywordtype">size_t</span> length = 0, <a class="code" href="_d_l_l_imports_8inl.html#a08fccce21fc4e2b456ae007e9b576c41">offset</a> = 0; <span class="comment">/*the length and offset found for the current position*/</span></div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;    <span class="keywordtype">size_t</span> max_offset = pos &lt; windowSize ? pos : windowSize; <span class="comment">/*how far back to test*/</span></div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;    <span class="keywordtype">size_t</span> current_offset;</div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;</div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;    <span class="keywordflow">for</span>(current_offset = 1; current_offset &lt; max_offset; current_offset++)</div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;    {</div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;      <span class="keywordtype">size_t</span> backpos = pos - current_offset;</div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;      <span class="keywordflow">if</span>(in[backpos] == in[pos])</div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;      {</div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;        <span class="comment">/*test the next characters*/</span></div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;        <span class="keywordtype">size_t</span> current_length = 1;</div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;        <span class="keywordtype">size_t</span> backtest = backpos + 1;</div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;        <span class="keywordtype">size_t</span> foretest = pos + 1;</div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;        <span class="comment">/*maximum supporte length by deflate is max length*/</span></div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;        <span class="keywordflow">while</span>(foretest &lt; insize &amp;&amp; in[backtest] == in[foretest] &amp;&amp; current_length &lt; MAX_SUPPORTED_DEFLATE_LENGTH)</div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;        {</div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;          <span class="keywordflow">if</span>(backpos &gt;= pos)</div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;          {</div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;            <span class="comment">/*continue as if we work on the decoded bytes after pos by jumping back before pos*/</span></div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;            backpos -= current_offset;</div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;          }</div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;          current_length++;</div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;          backtest++;</div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;          foretest++;</div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;        }</div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;        <span class="keywordflow">if</span>(current_length &gt; length)</div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;        {</div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;          length = current_length; <span class="comment">/*the longest length*/</span></div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;          <a class="code" href="_d_l_l_imports_8inl.html#a08fccce21fc4e2b456ae007e9b576c41">offset</a> = current_offset; <span class="comment">/*the offset that is related to this longest length*/</span></div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;          <span class="comment">/*you can jump out of this for loop once a length of max length is found (gives significant speed gain)*/</span></div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;          <span class="keywordflow">if</span>(current_length == MAX_SUPPORTED_DEFLATE_LENGTH) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;        }</div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;      }</div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;    }</div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;</div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;    <span class="keywordflow">if</span>(length &lt; 3) <span class="comment">/*only lengths of 3 or higher are supported as length/distance pair*/</span></div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;    {</div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;      uivector_push_back(out, in[pos]);</div>
<div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;    }</div>
<div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;    {</div>
<div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;      addLengthDistance(out, length, <a class="code" href="_d_l_l_imports_8inl.html#a08fccce21fc4e2b456ae007e9b576c41">offset</a>);</div>
<div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;      pos += (length - 1);</div>
<div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;    }</div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;  } <span class="comment">/*end of the loop through each character of input*/</span></div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;  <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;}</div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> HASH_NUM_VALUES = 2048;</div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> HASH_NUM_CHARACTERS = 3;</div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> HASH_SHIFT = 2;</div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;<span class="comment">The HASH_NUM_CHARACTERS value is used to make encoding faster by using longer</span></div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;<span class="comment">sequences to generate a hash value from the stream bytes. Setting it to 3</span></div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;<span class="comment">gives exactly the same compression as the brute force method, since deflate&#39;s</span></div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;<span class="comment">run length encoding starts with lengths of 3. Setting it to higher values,</span></div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;<span class="comment">like 6, can make the encoding faster (not always though!), but will cause the</span></div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;<span class="comment">encoding to miss any length between 3 and this value, so that the compression</span></div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;<span class="comment">may be worse (but this can vary too depending on the image, sometimes it is</span></div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;<span class="comment">even a bit better instead).</span></div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;<span class="comment">The HASH_NUM_VALUES is the amount of unique possible hash values that</span></div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;<span class="comment">combinations of bytes can give, the higher it is the more memory is needed, but</span></div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;<span class="comment">if it&#39;s too low the advantage of hashing is gone.</span></div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;<span class="comment">*/</span></div>
<div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;</div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;<span class="keyword">static</span> <span class="keywordtype">unsigned</span> getHash(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* data, <span class="keywordtype">size_t</span> size, <span class="keywordtype">size_t</span> pos, <span class="keywordtype">size_t</span> num)</div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;{</div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;  <span class="keywordtype">unsigned</span> result = 0;</div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;  <span class="keywordtype">size_t</span> amount, i;</div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;  <span class="keywordflow">if</span>(pos &gt;= size) <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;  amount = num;</div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;  <span class="keywordflow">if</span>(pos + amount &gt;= size) amount = size - pos;</div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;  <span class="keywordflow">for</span>(i = 0; i &lt; amount; i++) result ^= (data[pos + i] &lt;&lt; (i * HASH_SHIFT));</div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;  <span class="keywordflow">return</span> result % HASH_NUM_VALUES;</div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;}</div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;</div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;<span class="keyword">static</span> <span class="keywordtype">unsigned</span> countInitialZeros(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* data, <span class="keywordtype">size_t</span> size, <span class="keywordtype">size_t</span> pos)</div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;{</div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;  <span class="keywordtype">size_t</span> max_count = MAX_SUPPORTED_DEFLATE_LENGTH;</div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;  <span class="keywordtype">size_t</span> i;</div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;  <span class="keywordflow">if</span>(max_count &gt; size - pos) max_count = size - pos;</div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;  <span class="keywordflow">for</span>(i = 0; i &lt; max_count; i++)</div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;  {</div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;    <span class="keywordflow">if</span>(data[pos + i] != 0)</div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;      <span class="keywordflow">return</span> i;</div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;  }</div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;  <span class="keywordflow">return</span> max_count;</div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;}</div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;</div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;<span class="comment">/*push a value to the vector in a circular way. This is to do as if we&#39;re extending</span></div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;<span class="comment">the vector&#39;s size forever, but instead the size is limited to maxsize and it wraps</span></div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;<span class="comment">around, to avoid too large memory size. The pos pointer gets updated to the current</span></div>
<div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;<span class="comment">end (unless updatepos is false, in that case pos is only used to know the current</span></div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;<span class="comment">value). returns 1 on success, 0 if fail*/</span></div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;<span class="keyword">static</span> <span class="keywordtype">unsigned</span> push_circular(<a class="code" href="structuivector.html">uivector</a>* <a class="code" href="_d_l_l_imports_8inl.html#aa775029a6efb12d0b0eeef97c1814d04">v</a>, <span class="keywordtype">unsigned</span>* pos, <span class="keywordtype">unsigned</span> value, <span class="keywordtype">size_t</span> maxsize, <span class="keywordtype">unsigned</span> updatepos)</div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;{</div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;  <span class="keywordflow">if</span>(v-&gt;<a class="code" href="structuivector.html#aa999025945f0c93d0461192475ae2720">size</a> &lt; maxsize)</div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;  {</div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;    <span class="keywordflow">if</span>(!uivector_push_back(v, value)) <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;    <span class="keywordflow">if</span>(updatepos) (*pos)++;</div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;  }</div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;  {</div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;    <span class="keywordflow">if</span>(updatepos)</div>
<div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;    {</div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;      (*pos)++;</div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;      <span class="keywordflow">if</span>((*pos) &gt; maxsize) (*pos) = 1;</div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;    }</div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;    v-&gt;<a class="code" href="structuivector.html#a427d761df4bb4f0f19b4a973fc224c78">data</a>[(*pos) - 1] = <a class="code" href="_d_l_l_imports_8inl.html#a3f2d6cd655118d09cc005e6760706570">value</a>;</div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;  }</div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;  <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;}</div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;</div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;<span class="comment">LZ77-encode the data. Return value is error code. The input are raw bytes, the output</span></div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;<span class="comment">is in the form of unsigned integers with codes representing for example literal bytes, or</span></div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;<span class="comment">length/distance pairs.</span></div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;<span class="comment">It uses a hash table technique to let it encode faster. When doing LZ77 encoding, a</span></div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;<span class="comment">sliding window (of windowSize) is used, and all past bytes in that window can be used as</span></div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;<span class="comment">the &quot;dictionary&quot;. A brute force search through all possible distances would be slow, and</span></div>
<div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;<span class="comment">this hash technique is one out of several ways to speed this up.</span></div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;<span class="comment">*/</span></div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;<span class="keyword">static</span> <span class="keywordtype">unsigned</span> encodeLZ77(<a class="code" href="structuivector.html">uivector</a>* out, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* in, <span class="keywordtype">size_t</span> insize, <span class="keywordtype">unsigned</span> windowSize)</div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;{</div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;  <span class="comment">/*</span></div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;<span class="comment">  The hash table is 2-dimensional. For every possible hash value, it contains a list of positions</span></div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;<span class="comment">  in the data where this hash occured.</span></div>
<div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;<span class="comment">  tablepos1 and tablepos2 remember the last used start and end index in the hash table for each hash value.</span></div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;<span class="comment">  */</span></div>
<div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;  <a class="code" href="structvector.html">vector</a> table; <span class="comment">/*HASH_NUM_VALUES uivectors; this is what would be an std::vector&lt;std::vector&lt;unsigned&gt; &gt; in C++*/</span></div>
<div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;  <a class="code" href="structuivector.html">uivector</a> tablepos1, tablepos2;</div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;  <span class="comment">/*hash 0 indicates a possible common case of a long sequence of zeros, store and use the amount here for a speedup*/</span></div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;  <a class="code" href="structuivector.html">uivector</a> initialZerosTable;</div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;  <span class="keywordtype">unsigned</span> pos, i, error = 0;</div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;  <span class="keywordtype">unsigned</span> hash_num_characters = HASH_NUM_CHARACTERS;</div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;</div>
<div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;  vector_init(&amp;table, <span class="keyword">sizeof</span>(<a class="code" href="structuivector.html">uivector</a>));</div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;  <span class="keywordflow">if</span>(!vector_resize(&amp;table, HASH_NUM_VALUES)) <span class="keywordflow">return</span> 9917; <span class="comment">/*alloc fail*/</span></div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;  <span class="keywordflow">for</span>(i = 0; i &lt; HASH_NUM_VALUES; i++)</div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;  {</div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;    <a class="code" href="structuivector.html">uivector</a>* v = (<a class="code" href="structuivector.html">uivector</a>*)vector_get(&amp;table, i);</div>
<div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;    uivector_init(v);</div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;  }</div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;</div>
<div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;  <span class="comment">/*remember start and end positions in the tables to search in*/</span></div>
<div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;  uivector_init(&amp;tablepos1);</div>
<div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;  uivector_init(&amp;tablepos2);</div>
<div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;  uivector_init(&amp;initialZerosTable);</div>
<div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;</div>
<div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;  <span class="keywordflow">if</span>(!uivector_resizev(&amp;tablepos1, HASH_NUM_VALUES, 0)) error = 9918; <span class="comment">/*alloc fail*/</span></div>
<div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;  <span class="keywordflow">if</span>(!uivector_resizev(&amp;tablepos2, HASH_NUM_VALUES, 0)) error = 9919; <span class="comment">/*alloc fail*/</span></div>
<div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;</div>
<div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;  <span class="keywordflow">if</span>(!error)</div>
<div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;  {</div>
<div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;    <span class="keywordtype">unsigned</span> <a class="code" href="_d_l_l_imports_8inl.html#a08fccce21fc4e2b456ae007e9b576c41">offset</a>, max_offset; <span class="comment">/*the offset represents the distance in LZ77 terminology*/</span></div>
<div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;    <span class="keywordtype">unsigned</span> <a class="code" href="_d_l_l_imports_8inl.html#a5720e2b8f4f85b31e0bab5a1b6e69c74">length</a>, tablepos;</div>
<div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;    <span class="keywordtype">unsigned</span> <a class="code" href="namespace_f_w.html#ae73c23ac68578f9a4a32ee9668118369">hash</a>, initialZeros = 0;</div>
<div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;    <span class="keywordtype">unsigned</span> backpos, current_offset, t1, t2, t11, current_length;</div>
<div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *lastptr, *foreptr, *backptr;</div>
<div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;    <a class="code" href="structuivector.html">uivector</a>* <a class="code" href="_d_l_l_imports_8inl.html#aa775029a6efb12d0b0eeef97c1814d04">v</a>; <span class="comment">/*vector from the hash table we&#39;re currently working on*/</span></div>
<div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;    <span class="keywordtype">unsigned</span> hashWindow = windowSize;</div>
<div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;    <span class="keywordtype">unsigned</span> numones = 0;</div>
<div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;</div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;    <span class="keywordflow">for</span>(pos = 0; pos &lt; insize; pos++)</div>
<div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;    {</div>
<div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;      length = 0, offset = 0; <span class="comment">/*the length and offset found for the current position*/</span></div>
<div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;      max_offset = pos &lt; windowSize ? pos : windowSize; <span class="comment">/*how far back to test*/</span></div>
<div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;</div>
<div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;      <span class="comment">/*search for the longest string. First find out where in the table to start</span></div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;<span class="comment">      (the first value that is in the range from &quot;pos - max_offset&quot; to &quot;pos&quot;)*/</span></div>
<div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;      hash = getHash(in, insize, pos, hash_num_characters);</div>
<div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;      v = (<a class="code" href="structuivector.html">uivector</a>*)vector_get(&amp;table, hash);</div>
<div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;      <span class="keywordflow">if</span>(!push_circular(v, &amp;tablepos2.<a class="code" href="structuivector.html#a427d761df4bb4f0f19b4a973fc224c78">data</a>[hash], pos, hashWindow, 1)) <a class="code" href="lodepng_8cpp.html#a691b23954341613b96b6d98ce67d339c">ERROR_BREAK</a>(9920 <span class="comment">/*alloc fail*/</span>);</div>
<div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;      </div>
<div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;      <span class="keywordflow">if</span>(hash == 0)</div>
<div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;      {</div>
<div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;        initialZeros = countInitialZeros(in, insize, pos);</div>
<div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;        <span class="keywordflow">if</span>(!push_circular(&amp;initialZerosTable, &amp;tablepos2.<a class="code" href="structuivector.html#a427d761df4bb4f0f19b4a973fc224c78">data</a>[hash], initialZeros, hashWindow, 0))</div>
<div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;          <a class="code" href="lodepng_8cpp.html#a691b23954341613b96b6d98ce67d339c">ERROR_BREAK</a>(9920 <span class="comment">/*alloc fail*/</span>);</div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;      }</div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;      </div>
<div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;      <span class="keywordflow">while</span>(v-&gt;<a class="code" href="structuivector.html#a427d761df4bb4f0f19b4a973fc224c78">data</a>[tablepos1.<a class="code" href="structuivector.html#a427d761df4bb4f0f19b4a973fc224c78">data</a>[hash]] &lt; pos - max_offset)</div>
<div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;      {</div>
<div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;        <span class="comment">/*it now points to the first value in the table for which the index is</span></div>
<div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;<span class="comment">        larger than or equal to pos - max_offset*/</span></div>
<div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;        tablepos1.<a class="code" href="structuivector.html#a427d761df4bb4f0f19b4a973fc224c78">data</a>[<a class="code" href="namespace_f_w.html#ae73c23ac68578f9a4a32ee9668118369">hash</a>]++;</div>
<div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;        <span class="keywordflow">if</span>(tablepos1.<a class="code" href="structuivector.html#a427d761df4bb4f0f19b4a973fc224c78">data</a>[hash] &gt;= hashWindow) tablepos1.<a class="code" href="structuivector.html#a427d761df4bb4f0f19b4a973fc224c78">data</a>[<a class="code" href="namespace_f_w.html#ae73c23ac68578f9a4a32ee9668118369">hash</a>] = 0;</div>
<div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;      }</div>
<div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;</div>
<div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;      t1 = tablepos1.<a class="code" href="structuivector.html#a427d761df4bb4f0f19b4a973fc224c78">data</a>[<a class="code" href="namespace_f_w.html#ae73c23ac68578f9a4a32ee9668118369">hash</a>];</div>
<div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;      t2 = tablepos2.<a class="code" href="structuivector.html#a427d761df4bb4f0f19b4a973fc224c78">data</a>[<a class="code" href="namespace_f_w.html#ae73c23ac68578f9a4a32ee9668118369">hash</a>] - 1;</div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;      <span class="keywordflow">if</span>(tablepos2.<a class="code" href="structuivector.html#a427d761df4bb4f0f19b4a973fc224c78">data</a>[hash] == 0) t2 = hashWindow - 1;</div>
<div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;</div>
<div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;      lastptr = &amp;in[insize &lt; pos + MAX_SUPPORTED_DEFLATE_LENGTH ? insize : pos + MAX_SUPPORTED_DEFLATE_LENGTH];</div>
<div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;</div>
<div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;      t11 = t1 == 0 ? hashWindow - 1 : t1 - 1;</div>
<div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;      <span class="keywordflow">for</span>(tablepos = t2 == 0 ? hashWindow - 1 : t2 - 1;</div>
<div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;          tablepos != t2 &amp;&amp; tablepos != t11 &amp;&amp; tablepos &lt; v-&gt;<a class="code" href="structuivector.html#aa999025945f0c93d0461192475ae2720">size</a>;</div>
<div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;          tablepos = tablepos == 0 ? hashWindow - 1 : tablepos - 1)</div>
<div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;      {</div>
<div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;        backpos = v-&gt;<a class="code" href="structuivector.html#a427d761df4bb4f0f19b4a973fc224c78">data</a>[tablepos];</div>
<div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;        current_offset = pos - backpos;</div>
<div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;        <span class="comment">/*test the next characters*/</span></div>
<div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;        foreptr = &amp;in[pos];</div>
<div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;        backptr = &amp;in[backpos];</div>
<div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;</div>
<div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;        <span class="keywordflow">if</span>(hash == 0)</div>
<div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;        {</div>
<div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;          <span class="keywordtype">unsigned</span> skip = initialZerosTable.<a class="code" href="structuivector.html#a427d761df4bb4f0f19b4a973fc224c78">data</a>[tablepos];</div>
<div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;          <span class="keywordflow">if</span>(skip &gt; initialZeros) skip = initialZeros;</div>
<div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;          <span class="keywordflow">if</span>(skip &gt; insize - pos) skip = insize - pos;</div>
<div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;          backptr += skip;</div>
<div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;          foreptr += skip;</div>
<div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;        }</div>
<div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;        <span class="keywordflow">while</span>(foreptr != lastptr &amp;&amp; *backptr == *foreptr) <span class="comment">/*maximum supported length by deflate is max length*/</span></div>
<div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;        {</div>
<div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;          ++backptr;</div>
<div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;          ++foreptr;</div>
<div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;        }</div>
<div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;        current_length = (unsigned)(foreptr - &amp;in[pos]);</div>
<div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;        <span class="keywordflow">if</span>(current_length &gt; length)</div>
<div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;        {</div>
<div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;          length = current_length; <span class="comment">/*the longest length*/</span></div>
<div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;          offset = current_offset; <span class="comment">/*the offset that is related to this longest length*/</span></div>
<div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;          <span class="comment">/*you can jump out of this for loop once a length of max length is found (gives significant speed gain)*/</span></div>
<div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;          <span class="keywordflow">if</span>(current_length == MAX_SUPPORTED_DEFLATE_LENGTH) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;        }</div>
<div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;      }</div>
<div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;      </div>
<div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;      <span class="keywordflow">if</span>(length &lt; 3) <span class="comment">/*only lengths of 3 or higher are supported as length/distance pair*/</span></div>
<div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;      {</div>
<div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;        <span class="keywordflow">if</span>(!uivector_push_back(out, in[pos])) <a class="code" href="lodepng_8cpp.html#a691b23954341613b96b6d98ce67d339c">ERROR_BREAK</a>(9921 <span class="comment">/*alloc fail*/</span>);</div>
<div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;      }</div>
<div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;      {</div>
<div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;        <span class="keywordtype">unsigned</span> j, local_hash;</div>
<div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;        addLengthDistance(out, length, offset);</div>
<div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;        <span class="keywordflow">for</span>(j = 0; j &lt; length - 1; j++)</div>
<div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;        {</div>
<div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;          <span class="keywordtype">unsigned</span>* t2p; <span class="comment">/*pointer to current tablepos2 element*/</span></div>
<div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;          pos++;</div>
<div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;          local_hash = getHash(in, insize, pos, hash_num_characters);</div>
<div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;          t2p = &amp;tablepos2.<a class="code" href="structuivector.html#a427d761df4bb4f0f19b4a973fc224c78">data</a>[local_hash];</div>
<div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;          v = (<a class="code" href="structuivector.html">uivector</a>*)vector_get(&amp;table, local_hash);</div>
<div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;          <span class="keywordflow">if</span>(!push_circular(v, t2p, pos, hashWindow, 1)) <a class="code" href="lodepng_8cpp.html#a691b23954341613b96b6d98ce67d339c">ERROR_BREAK</a>(9920 <span class="comment">/*alloc fail*/</span>);</div>
<div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;          </div>
<div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;          <span class="keywordflow">if</span>(local_hash == 0)</div>
<div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;          {</div>
<div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;            initialZeros = countInitialZeros(in, insize, pos);</div>
<div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;            <span class="keywordflow">if</span>(!push_circular(&amp;initialZerosTable, t2p, initialZeros, hashWindow, 0))</div>
<div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;              <a class="code" href="lodepng_8cpp.html#a691b23954341613b96b6d98ce67d339c">ERROR_BREAK</a>(9922 <span class="comment">/*alloc fail*/</span>);</div>
<div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;          }</div>
<div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;          <span class="keywordflow">if</span>(local_hash == 1 &amp;&amp; hash_num_characters == 3)</div>
<div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;          {</div>
<div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;            <span class="comment">/*</span></div>
<div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;<span class="comment">            If many hash values are getting grouped together in hash value 1, 4, 16, 20, ...,</span></div>
<div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;<span class="comment">            it indicates there are many near-zero values. This is not zero enough to benefit from a speed</span></div>
<div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;<span class="comment">            increase from the initialZerosTable, and makes it very slow. For that case only, switch to</span></div>
<div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;<span class="comment">            hash_num_characters = 6. Value 6 is experimentally found to be fastest. For this particular type</span></div>
<div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;<span class="comment">            of file, the compression isn&#39;t even worse, despite the fact that lengths &lt; 6 are now no longer</span></div>
<div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;<span class="comment">            found, and that by changing hash_num_characters not all previously found hash values are still valid.</span></div>
<div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;<span class="comment">            Almost all images compress fast enough and smaller with hash_num_characters = 3, except sine plasma</span></div>
<div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;<span class="comment">            images. Those benefit a lot from this heuristic.</span></div>
<div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;<span class="comment">            */</span></div>
<div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;            <span class="keywordflow">if</span>(numones &gt; 8192 &amp;&amp; numones &gt; pos / 16) hash_num_characters = 6;</div>
<div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;            <span class="keywordflow">else</span> numones++;</div>
<div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;          }</div>
<div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;        }</div>
<div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;      }</div>
<div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;    } <span class="comment">/*end of the loop through each character of input*/</span></div>
<div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;  } <span class="comment">/*end of &quot;if(!error)&quot;*/</span></div>
<div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;</div>
<div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;  <span class="comment">/*cleanup*/</span></div>
<div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;  <span class="keywordflow">for</span>(i = 0; i &lt; table.<a class="code" href="structvector.html#a4200005b6949608d6a533db1a0d299c8">size</a>; i++)</div>
<div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;  {</div>
<div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;    <a class="code" href="structuivector.html">uivector</a>* v = (<a class="code" href="structuivector.html">uivector</a>*)vector_get(&amp;table, i);</div>
<div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;    uivector_cleanup(v);</div>
<div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;  }</div>
<div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;  vector_cleanup(&amp;table);</div>
<div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;  uivector_cleanup(&amp;tablepos1);</div>
<div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;  uivector_cleanup(&amp;tablepos2);</div>
<div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;  uivector_cleanup(&amp;initialZerosTable);</div>
<div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;  <span class="keywordflow">return</span> error;</div>
<div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;}</div>
<div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;</div>
<div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;<span class="comment">/* /////////////////////////////////////////////////////////////////////////// */</span></div>
<div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;</div>
<div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;<span class="keyword">static</span> <span class="keywordtype">unsigned</span> deflateNoCompression(<a class="code" href="structucvector.html">ucvector</a>* out, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* data, <span class="keywordtype">size_t</span> datasize)</div>
<div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;{</div>
<div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;  <span class="comment">/*non compressed deflate block data: 1 bit BFINAL,2 bits BTYPE,(5 bits): it jumps to start of next byte,</span></div>
<div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;<span class="comment">  2 bytes LEN, 2 bytes NLEN, LEN bytes literal DATA*/</span></div>
<div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;</div>
<div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;  <span class="keywordtype">size_t</span> i, j, numdeflateblocks = datasize / 65536 + 1;</div>
<div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;  <span class="keywordtype">unsigned</span> datapos = 0;</div>
<div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;  <span class="keywordflow">for</span>(i = 0; i &lt; numdeflateblocks; i++)</div>
<div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;  {</div>
<div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;    <span class="keywordtype">unsigned</span> BFINAL, BTYPE, LEN, NLEN;</div>
<div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> firstbyte;</div>
<div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;</div>
<div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;    BFINAL = (i == numdeflateblocks - 1);</div>
<div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;    BTYPE = 0;</div>
<div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;</div>
<div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;    firstbyte = (<span class="keywordtype">unsigned</span> char)(BFINAL + ((BTYPE &amp; 1) &lt;&lt; 1) + ((BTYPE &amp; 2) &lt;&lt; 1));</div>
<div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;    ucvector_push_back(out, firstbyte);</div>
<div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;</div>
<div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;    LEN = 65535;</div>
<div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;    <span class="keywordflow">if</span>(datasize - datapos &lt; 65535) LEN = (unsigned)datasize - datapos;</div>
<div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;    NLEN = 65535 - LEN;</div>
<div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;</div>
<div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;    ucvector_push_back(out, (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>)(LEN % 256));</div>
<div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;    ucvector_push_back(out, (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>)(LEN / 256));</div>
<div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;    ucvector_push_back(out, (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>)(NLEN % 256));</div>
<div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;    ucvector_push_back(out, (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>)(NLEN / 256));</div>
<div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;</div>
<div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;    <span class="comment">/*Decompressed data*/</span></div>
<div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;    <span class="keywordflow">for</span>(j = 0; j &lt; 65535 &amp;&amp; datapos &lt; datasize; j++)</div>
<div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;    {</div>
<div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;      ucvector_push_back(out, data[datapos++]);</div>
<div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;    }</div>
<div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;  }</div>
<div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;</div>
<div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;  <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;}</div>
<div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;</div>
<div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;<span class="comment">write the lz77-encoded data, which has lit, len and dist codes, to compressed stream using huffman trees.</span></div>
<div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;<span class="comment">tree_ll: the tree for lit and len codes.</span></div>
<div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;<span class="comment">tree_d: the tree for distance codes.</span></div>
<div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;<span class="comment">*/</span></div>
<div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> writeLZ77data(<span class="keywordtype">size_t</span>* bp, <a class="code" href="structucvector.html">ucvector</a>* out, <span class="keyword">const</span> <a class="code" href="structuivector.html">uivector</a>* lz77_encoded,</div>
<div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;                          <span class="keyword">const</span> <a class="code" href="struct_huffman_tree.html">HuffmanTree</a>* tree_ll, <span class="keyword">const</span> <a class="code" href="struct_huffman_tree.html">HuffmanTree</a>* tree_d)</div>
<div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;{</div>
<div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;  <span class="keywordtype">size_t</span> i = 0;</div>
<div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;  <span class="keywordflow">for</span>(i = 0; i &lt; lz77_encoded-&gt;<a class="code" href="structuivector.html#aa999025945f0c93d0461192475ae2720">size</a>; i++)</div>
<div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;  {</div>
<div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;    <span class="keywordtype">unsigned</span> val = lz77_encoded-&gt;<a class="code" href="structuivector.html#a427d761df4bb4f0f19b4a973fc224c78">data</a>[i];</div>
<div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;    addHuffmanSymbol(bp, out, HuffmanTree_getCode(tree_ll, val), HuffmanTree_getLength(tree_ll, val));</div>
<div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;    <span class="keywordflow">if</span>(val &gt; 256) <span class="comment">/*for a length code, 3 more things have to be added*/</span></div>
<div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;    {</div>
<div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;      <span class="keywordtype">unsigned</span> length_index = val - <a class="code" href="lodepng_8cpp.html#acfb12caea990f92b3aed7c199f615213">FIRST_LENGTH_CODE_INDEX</a>;</div>
<div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;      <span class="keywordtype">unsigned</span> n_length_extra_bits = LENGTHEXTRA[length_index];</div>
<div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;      <span class="keywordtype">unsigned</span> length_extra_bits = lz77_encoded-&gt;<a class="code" href="structuivector.html#a427d761df4bb4f0f19b4a973fc224c78">data</a>[++i];</div>
<div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;</div>
<div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;      <span class="keywordtype">unsigned</span> distance_code = lz77_encoded-&gt;<a class="code" href="structuivector.html#a427d761df4bb4f0f19b4a973fc224c78">data</a>[++i];</div>
<div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;</div>
<div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;      <span class="keywordtype">unsigned</span> distance_index = distance_code;</div>
<div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;      <span class="keywordtype">unsigned</span> n_distance_extra_bits = DISTANCEEXTRA[distance_index];</div>
<div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;      <span class="keywordtype">unsigned</span> distance_extra_bits = lz77_encoded-&gt;<a class="code" href="structuivector.html#a427d761df4bb4f0f19b4a973fc224c78">data</a>[++i];</div>
<div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;</div>
<div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;      addBitsToStream(bp, out, length_extra_bits, n_length_extra_bits);</div>
<div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;      addHuffmanSymbol(bp, out, HuffmanTree_getCode(tree_d, distance_code),</div>
<div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;                       HuffmanTree_getLength(tree_d, distance_code));</div>
<div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;      addBitsToStream(bp, out, distance_extra_bits, n_distance_extra_bits);</div>
<div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;    }</div>
<div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;  }</div>
<div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;}</div>
<div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;</div>
<div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;<span class="comment">/*Deflate for a block of type &quot;dynamic&quot;, that is, with freely, optimally, created huffman trees*/</span></div>
<div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;<span class="keyword">static</span> <span class="keywordtype">unsigned</span> deflateDynamic(<a class="code" href="structucvector.html">ucvector</a>* out, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* data, <span class="keywordtype">size_t</span> datasize,</div>
<div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;                               <span class="keyword">const</span> <a class="code" href="struct_lode_p_n_g___compress_settings.html">LodePNG_CompressSettings</a>* settings)</div>
<div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;{</div>
<div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;  <span class="keywordtype">unsigned</span> error = 0;</div>
<div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;</div>
<div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;  <span class="comment">/*</span></div>
<div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;<span class="comment">  A block is compressed as follows: The PNG data is lz77 encoded, resulting in</span></div>
<div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;<span class="comment">  literal bytes and length/distance pairs. This is then huffman compressed with</span></div>
<div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;<span class="comment">  two huffman trees. One huffman tree is used for the lit and len values (&quot;ll&quot;),</span></div>
<div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;<span class="comment">  another huffman tree is used for the dist values (&quot;d&quot;). These two trees are</span></div>
<div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;<span class="comment">  stored using their code lengths, and to compress even more these code lengths</span></div>
<div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;<span class="comment">  are also run-length encoded and huffman compressed. This gives a huffman tree</span></div>
<div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;<span class="comment">  of code lengths &quot;cl&quot;. The code lenghts used to describe this third tree are</span></div>
<div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;<span class="comment">  the code length code lengths (&quot;clcl&quot;).</span></div>
<div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;<span class="comment">  */</span></div>
<div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;  </div>
<div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;  <span class="comment">/*The lz77 encoded data, represented with integers since there will also be length and distance codes in it*/</span></div>
<div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;  <a class="code" href="structuivector.html">uivector</a> lz77_encoded;</div>
<div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;  <a class="code" href="struct_huffman_tree.html">HuffmanTree</a> tree_ll; <span class="comment">/*tree for lit,len values*/</span></div>
<div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;  <a class="code" href="struct_huffman_tree.html">HuffmanTree</a> tree_d; <span class="comment">/*tree for distance codes*/</span></div>
<div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;  <a class="code" href="struct_huffman_tree.html">HuffmanTree</a> tree_cl; <span class="comment">/*tree for encoding the code lengths representing tree_ll and tree_d*/</span></div>
<div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;  <a class="code" href="structuivector.html">uivector</a> frequencies_ll; <span class="comment">/*frequency of lit,len codes*/</span></div>
<div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;  <a class="code" href="structuivector.html">uivector</a> frequencies_d; <span class="comment">/*frequency of dist codes*/</span></div>
<div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;  <a class="code" href="structuivector.html">uivector</a> frequencies_cl; <span class="comment">/*frequency of code length codes*/</span></div>
<div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;  <a class="code" href="structuivector.html">uivector</a> bitlen_lld; <span class="comment">/*lit,len,dist code lenghts (int bits), literally (without repeat codes).*/</span></div>
<div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;  <a class="code" href="structuivector.html">uivector</a> bitlen_lld_e; <span class="comment">/*bitlen_lld encoded with repeat codes (this is a rudemtary run length compression)*/</span></div>
<div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;  <span class="comment">/*bitlen_cl is the code length code lengths (&quot;clcl&quot;). The bit lengths of codes to represent tree_cl</span></div>
<div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;<span class="comment">  (these are written as is in the file, it would be crazy to compress these using yet another huffman</span></div>
<div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;<span class="comment">  tree that needs to be represented by yet another set of code lengths)*/</span></div>
<div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;  <a class="code" href="structuivector.html">uivector</a> bitlen_cl;</div>
<div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;</div>
<div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;  <span class="comment">/*</span></div>
<div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;<span class="comment">  Due to the huffman compression of huffman tree representations (&quot;two levels&quot;), there are some anologies:</span></div>
<div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;<span class="comment">  bitlen_lld is to tree_cl what data is to tree_ll and tree_d. </span></div>
<div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;<span class="comment">  bitlen_lld_e is to bitlen_lld what lz77_encoded is to data.</span></div>
<div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;<span class="comment">  bitlen_cl is to bitlen_lld_e what bitlen_lld is to lz77_encoded.</span></div>
<div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;<span class="comment">  */</span></div>
<div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;</div>
<div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;  <span class="keywordtype">unsigned</span> BFINAL = 1; <span class="comment">/*make only one block... the first and final one*/</span></div>
<div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;  <span class="keywordtype">size_t</span> numcodes_ll, numcodes_d, i;</div>
<div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;  <span class="keywordtype">size_t</span> bp = 0; <span class="comment">/*the bit pointer*/</span></div>
<div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;  <span class="keywordtype">unsigned</span> HLIT, HDIST, HCLEN;</div>
<div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;</div>
<div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;  uivector_init(&amp;lz77_encoded);</div>
<div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;  HuffmanTree_init(&amp;tree_ll);</div>
<div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;  HuffmanTree_init(&amp;tree_d);</div>
<div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;  HuffmanTree_init(&amp;tree_cl);</div>
<div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;  uivector_init(&amp;frequencies_ll);</div>
<div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;  uivector_init(&amp;frequencies_d);</div>
<div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;  uivector_init(&amp;frequencies_cl);</div>
<div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;  uivector_init(&amp;bitlen_lld);</div>
<div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;  uivector_init(&amp;bitlen_lld_e);</div>
<div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;  uivector_init(&amp;bitlen_cl);</div>
<div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;</div>
<div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;  <span class="comment">/*This while loop is never loops due to a break at the end, it is here to</span></div>
<div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;<span class="comment">  allow breaking out of it to the cleanup phase on error conditions.*/</span></div>
<div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;  <span class="keywordflow">while</span>(!error)</div>
<div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;  {</div>
<div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;    <span class="keywordflow">if</span>(settings-&gt;<a class="code" href="struct_lode_p_n_g___compress_settings.html#ab7b87ac5529ab33b12efb05372974ca5">useLZ77</a>)</div>
<div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;    {</div>
<div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;      error = encodeLZ77(&amp;lz77_encoded, data, datasize, settings-&gt;<a class="code" href="struct_lode_p_n_g___compress_settings.html#adaebb6134716768bd1636aa97ec68b90">windowSize</a>); <span class="comment">/*LZ77 encoded*/</span></div>
<div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;      <span class="keywordflow">if</span>(error) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;    }</div>
<div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;    {</div>
<div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;      <span class="keywordflow">if</span>(!uivector_resize(&amp;lz77_encoded, datasize)) <a class="code" href="lodepng_8cpp.html#a691b23954341613b96b6d98ce67d339c">ERROR_BREAK</a>(9923 <span class="comment">/*alloc fail*/</span>);</div>
<div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;      <span class="keywordflow">for</span>(i = 0; i &lt; datasize; i++) lz77_encoded.<a class="code" href="structuivector.html#a427d761df4bb4f0f19b4a973fc224c78">data</a>[i] = data[i]; <span class="comment">/*no LZ77, but still will be Huffman compressed*/</span></div>
<div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;    }</div>
<div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;</div>
<div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;    <span class="keywordflow">if</span>(!uivector_resizev(&amp;frequencies_ll, 286, 0)) <a class="code" href="lodepng_8cpp.html#a691b23954341613b96b6d98ce67d339c">ERROR_BREAK</a>(9924 <span class="comment">/*alloc fail*/</span>);</div>
<div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;    <span class="keywordflow">if</span>(!uivector_resizev(&amp;frequencies_d, 30, 0)) <a class="code" href="lodepng_8cpp.html#a691b23954341613b96b6d98ce67d339c">ERROR_BREAK</a>(9925 <span class="comment">/*alloc fail*/</span>);</div>
<div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;</div>
<div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;    <span class="comment">/*Count the frequencies of lit, len and dist codes*/</span></div>
<div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;    <span class="keywordflow">for</span>(i = 0; i &lt; lz77_encoded.<a class="code" href="structuivector.html#aa999025945f0c93d0461192475ae2720">size</a>; i++)</div>
<div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;    {</div>
<div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;      <span class="keywordtype">unsigned</span> symbol = lz77_encoded.<a class="code" href="structuivector.html#a427d761df4bb4f0f19b4a973fc224c78">data</a>[i];</div>
<div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;      frequencies_ll.<a class="code" href="structuivector.html#a427d761df4bb4f0f19b4a973fc224c78">data</a>[symbol]++;</div>
<div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;      <span class="keywordflow">if</span>(symbol &gt; 256)</div>
<div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;      {</div>
<div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;        <span class="keywordtype">unsigned</span> dist = lz77_encoded.<a class="code" href="structuivector.html#a427d761df4bb4f0f19b4a973fc224c78">data</a>[i + 2];</div>
<div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;        frequencies_d.<a class="code" href="structuivector.html#a427d761df4bb4f0f19b4a973fc224c78">data</a>[dist]++;</div>
<div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;        i += 3;</div>
<div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;      }</div>
<div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;    }</div>
<div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;    frequencies_ll.<a class="code" href="structuivector.html#a427d761df4bb4f0f19b4a973fc224c78">data</a>[256] = 1; <span class="comment">/*there will be exactly 1 end code, at the end of the block*/</span></div>
<div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;</div>
<div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;    <span class="comment">/*Make both huffman trees, one for the lit and len codes, one for the dist codes*/</span></div>
<div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;    error = HuffmanTree_makeFromFrequencies(&amp;tree_ll, frequencies_ll.<a class="code" href="structuivector.html#a427d761df4bb4f0f19b4a973fc224c78">data</a>, frequencies_ll.<a class="code" href="structuivector.html#aa999025945f0c93d0461192475ae2720">size</a>, 15);</div>
<div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;    <span class="keywordflow">if</span>(error) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;    error = HuffmanTree_makeFromFrequencies(&amp;tree_d, frequencies_d.<a class="code" href="structuivector.html#a427d761df4bb4f0f19b4a973fc224c78">data</a>, frequencies_d.<a class="code" href="structuivector.html#aa999025945f0c93d0461192475ae2720">size</a>, 15);</div>
<div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;    <span class="keywordflow">if</span>(error) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;</div>
<div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;    numcodes_ll = tree_ll.<a class="code" href="struct_huffman_tree.html#a608df5a24f60d1077a5cde19d5149e1f">numcodes</a>; <span class="keywordflow">if</span>(numcodes_ll &gt; 286) numcodes_ll = 286;</div>
<div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;    numcodes_d = tree_d.<a class="code" href="struct_huffman_tree.html#a608df5a24f60d1077a5cde19d5149e1f">numcodes</a>; <span class="keywordflow">if</span>(numcodes_d &gt; 30) numcodes_d = 30;</div>
<div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;    <span class="comment">/*store the code lengths of both generated trees in bitlen_lld*/</span></div>
<div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;    <span class="keywordflow">for</span>(i = 0; i &lt; numcodes_ll; i++) uivector_push_back(&amp;bitlen_lld, HuffmanTree_getLength(&amp;tree_ll, (<span class="keywordtype">unsigned</span>)i));</div>
<div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;    <span class="keywordflow">for</span>(i = 0; i &lt; numcodes_d; i++) uivector_push_back(&amp;bitlen_lld, HuffmanTree_getLength(&amp;tree_d, (<span class="keywordtype">unsigned</span>)i));</div>
<div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;</div>
<div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;    <span class="comment">/*run-length compress bitlen_ldd into bitlen_lld_e by using repeat codes 16 (copy length 3-6 times),</span></div>
<div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;<span class="comment">    17 (3-10 zeroes), 18 (11-138 zeroes)*/</span></div>
<div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;    <span class="keywordflow">for</span>(i = 0; i &lt; (unsigned)bitlen_lld.<a class="code" href="structuivector.html#aa999025945f0c93d0461192475ae2720">size</a>; i++)</div>
<div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;    {</div>
<div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;      <span class="keywordtype">unsigned</span> j = 0; <span class="comment">/*amount of repititions*/</span></div>
<div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;      <span class="keywordflow">while</span>(i + j + 1 &lt; (<span class="keywordtype">unsigned</span>)bitlen_lld.<a class="code" href="structuivector.html#aa999025945f0c93d0461192475ae2720">size</a> &amp;&amp; bitlen_lld.<a class="code" href="structuivector.html#a427d761df4bb4f0f19b4a973fc224c78">data</a>[i + j + 1] == bitlen_lld.<a class="code" href="structuivector.html#a427d761df4bb4f0f19b4a973fc224c78">data</a>[i]) j++;</div>
<div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;</div>
<div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;      <span class="keywordflow">if</span>(bitlen_lld.<a class="code" href="structuivector.html#a427d761df4bb4f0f19b4a973fc224c78">data</a>[i] == 0 &amp;&amp; j &gt;= 2) <span class="comment">/*repeat code for zeroes*/</span></div>
<div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;      {</div>
<div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;        j++; <span class="comment">/*include the first zero*/</span></div>
<div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;        <span class="keywordflow">if</span>(j &lt;= 10) <span class="comment">/*repeat code 17 supports max 10 zeroes*/</span></div>
<div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;        {</div>
<div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;          uivector_push_back(&amp;bitlen_lld_e, 17);</div>
<div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;          uivector_push_back(&amp;bitlen_lld_e, j - 3);</div>
<div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;        }</div>
<div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;        <span class="keywordflow">else</span> <span class="comment">/*repeat code 18 supports max 138 zeroes*/</span></div>
<div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;        {</div>
<div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;          <span class="keywordflow">if</span>(j &gt; 138) j = 138;</div>
<div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;          uivector_push_back(&amp;bitlen_lld_e, 18);</div>
<div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;          uivector_push_back(&amp;bitlen_lld_e, j - 11);</div>
<div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;        }</div>
<div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;        i += (j - 1);</div>
<div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;      }</div>
<div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span>(j &gt;= 3) <span class="comment">/*repeat code for value other than zero*/</span></div>
<div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;      {</div>
<div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;        <span class="keywordtype">size_t</span> k;</div>
<div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;        <span class="keywordtype">unsigned</span> num = j / 6, rest = j % 6;</div>
<div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;        uivector_push_back(&amp;bitlen_lld_e, bitlen_lld.<a class="code" href="structuivector.html#a427d761df4bb4f0f19b4a973fc224c78">data</a>[i]);</div>
<div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;        <span class="keywordflow">for</span>(k = 0; k &lt; num; k++)</div>
<div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;        {</div>
<div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;          uivector_push_back(&amp;bitlen_lld_e, 16);</div>
<div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;          uivector_push_back(&amp;bitlen_lld_e, 6 - 3);</div>
<div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;        }</div>
<div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;        <span class="keywordflow">if</span>(rest &gt;= 3)</div>
<div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;        {</div>
<div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;          uivector_push_back(&amp;bitlen_lld_e, 16);</div>
<div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;          uivector_push_back(&amp;bitlen_lld_e, rest - 3);</div>
<div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;        }</div>
<div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;        <span class="keywordflow">else</span> j -= rest;</div>
<div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;        i += j;</div>
<div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;      }</div>
<div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;      <span class="keywordflow">else</span> <span class="comment">/*too short to benefit from repeat code*/</span></div>
<div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;      {</div>
<div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;        uivector_push_back(&amp;bitlen_lld_e, bitlen_lld.<a class="code" href="structuivector.html#a427d761df4bb4f0f19b4a973fc224c78">data</a>[i]);</div>
<div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;      }</div>
<div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;    }</div>
<div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;</div>
<div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;    <span class="comment">/*generate tree_cl, the huffmantree of huffmantrees*/</span></div>
<div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;</div>
<div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;    <span class="keywordflow">if</span>(!uivector_resizev(&amp;frequencies_cl, NUM_CODE_LENGTH_CODES, 0)) <a class="code" href="lodepng_8cpp.html#a691b23954341613b96b6d98ce67d339c">ERROR_BREAK</a>(9926 <span class="comment">/*alloc fail*/</span>);</div>
<div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;    <span class="keywordflow">for</span>(i = 0; i &lt; bitlen_lld_e.<a class="code" href="structuivector.html#aa999025945f0c93d0461192475ae2720">size</a>; i++)</div>
<div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;    {</div>
<div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;      frequencies_cl.<a class="code" href="structuivector.html#a427d761df4bb4f0f19b4a973fc224c78">data</a>[bitlen_lld_e.<a class="code" href="structuivector.html#a427d761df4bb4f0f19b4a973fc224c78">data</a>[i]]++;</div>
<div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;      <span class="comment">/*after a repeat code come the bits that specify the number of repetitions,</span></div>
<div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;<span class="comment">      those don&#39;t need to be in the frequencies_cl calculation*/</span></div>
<div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;      <span class="keywordflow">if</span>(bitlen_lld_e.<a class="code" href="structuivector.html#a427d761df4bb4f0f19b4a973fc224c78">data</a>[i] &gt;= 16) i++;</div>
<div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;    }</div>
<div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;</div>
<div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;    error = HuffmanTree_makeFromFrequencies(&amp;tree_cl, frequencies_cl.<a class="code" href="structuivector.html#a427d761df4bb4f0f19b4a973fc224c78">data</a>, frequencies_cl.<a class="code" href="structuivector.html#aa999025945f0c93d0461192475ae2720">size</a>, 7);</div>
<div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;    <span class="keywordflow">if</span>(error) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;</div>
<div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;    <span class="keywordflow">if</span>(!uivector_resize(&amp;bitlen_cl, NUM_CODE_LENGTH_CODES)) <a class="code" href="lodepng_8cpp.html#a691b23954341613b96b6d98ce67d339c">ERROR_BREAK</a>(9927 <span class="comment">/*alloc fail*/</span>);</div>
<div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;    <span class="keywordflow">for</span>(i = 0; i &lt; <a class="code" href="lodepng_8cpp.html#a22ed04d49e008cb4295a8b366c4f2f3b">NUM_CODE_LENGTH_CODES</a>; i++)</div>
<div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;    {</div>
<div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;      <span class="comment">/*lenghts of code length tree is in the order as specified by deflate*/</span></div>
<div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;      bitlen_cl.<a class="code" href="structuivector.html#a427d761df4bb4f0f19b4a973fc224c78">data</a>[i] = HuffmanTree_getLength(&amp;tree_cl, CLCL_ORDER[i]);</div>
<div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;    }</div>
<div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;    <span class="keywordflow">while</span>(bitlen_cl.<a class="code" href="structuivector.html#a427d761df4bb4f0f19b4a973fc224c78">data</a>[bitlen_cl.<a class="code" href="structuivector.html#aa999025945f0c93d0461192475ae2720">size</a> - 1] == 0 &amp;&amp; bitlen_cl.<a class="code" href="structuivector.html#aa999025945f0c93d0461192475ae2720">size</a> &gt; 4)</div>
<div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;    {</div>
<div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;      <span class="comment">/*remove zeros at the end, but minimum size must be 4*/</span></div>
<div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;      <span class="keywordflow">if</span>(!uivector_resize(&amp;bitlen_cl, bitlen_cl.<a class="code" href="structuivector.html#aa999025945f0c93d0461192475ae2720">size</a> - 1)) <a class="code" href="lodepng_8cpp.html#a691b23954341613b96b6d98ce67d339c">ERROR_BREAK</a>(9928 <span class="comment">/*alloc fail*/</span>);</div>
<div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;    }</div>
<div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;    <span class="keywordflow">if</span>(error) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;</div>
<div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;<span class="comment">    Write everything into the output</span></div>
<div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;<span class="comment">    </span></div>
<div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;<span class="comment">    After the BFINAL and BTYPE, the dynamic block consists out of the following:</span></div>
<div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;<span class="comment">    - 5 bits HLIT, 5 bits HDIST, 4 bits HCLEN</span></div>
<div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;<span class="comment">    - (HCLEN+4)*3 bits code lengths of code length alphabet</span></div>
<div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;<span class="comment">    - HLIT + 257 code lenghts of lit/length alphabet (encoded using the code length</span></div>
<div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;<span class="comment">      alphabet, + possible repetition codes 16, 17, 18)</span></div>
<div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;<span class="comment">    - HDIST + 1 code lengths of distance alphabet (encoded using the code length</span></div>
<div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;<span class="comment">      alphabet, + possible repetition codes 16, 17, 18)</span></div>
<div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160;<span class="comment">    - compressed data</span></div>
<div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;<span class="comment">    - 256 (end code)</span></div>
<div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160;<span class="comment">    */</span></div>
<div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;</div>
<div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;    <span class="comment">/*Write block type*/</span></div>
<div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160;    addBitToStream(&amp;bp, out, BFINAL);</div>
<div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;    addBitToStream(&amp;bp, out, 0); <span class="comment">/*first bit of BTYPE &quot;dynamic&quot;*/</span></div>
<div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;    addBitToStream(&amp;bp, out, 1); <span class="comment">/*second bit of BTYPE &quot;dynamic&quot;*/</span></div>
<div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;</div>
<div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;    <span class="comment">/*write the HLIT, HDIST and HCLEN values*/</span></div>
<div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;    HLIT = (unsigned)(numcodes_ll - 257);</div>
<div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;    HDIST = (unsigned)(numcodes_d - 1);</div>
<div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;    HCLEN = (unsigned)bitlen_cl.<a class="code" href="structuivector.html#aa999025945f0c93d0461192475ae2720">size</a> - 4;</div>
<div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;    addBitsToStream(&amp;bp, out, HLIT, 5);</div>
<div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;    addBitsToStream(&amp;bp, out, HDIST, 5);</div>
<div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;    addBitsToStream(&amp;bp, out, HCLEN, 4);</div>
<div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;</div>
<div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;    <span class="comment">/*write the code lenghts of the code length alphabet*/</span></div>
<div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;    <span class="keywordflow">for</span>(i = 0; i &lt; HCLEN + 4; i++) addBitsToStream(&amp;bp, out, bitlen_cl.<a class="code" href="structuivector.html#a427d761df4bb4f0f19b4a973fc224c78">data</a>[i], 3);</div>
<div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;</div>
<div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;    <span class="comment">/*write the lenghts of the lit/len AND the dist alphabet*/</span></div>
<div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;    <span class="keywordflow">for</span>(i = 0; i &lt; bitlen_lld_e.<a class="code" href="structuivector.html#aa999025945f0c93d0461192475ae2720">size</a>; i++)</div>
<div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;    {</div>
<div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;      addHuffmanSymbol(&amp;bp, out, HuffmanTree_getCode(&amp;tree_cl, bitlen_lld_e.<a class="code" href="structuivector.html#a427d761df4bb4f0f19b4a973fc224c78">data</a>[i]),</div>
<div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;                       HuffmanTree_getLength(&amp;tree_cl, bitlen_lld_e.<a class="code" href="structuivector.html#a427d761df4bb4f0f19b4a973fc224c78">data</a>[i]));</div>
<div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;      <span class="comment">/*extra bits of repeat codes*/</span></div>
<div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;      <span class="keywordflow">if</span>(bitlen_lld_e.<a class="code" href="structuivector.html#a427d761df4bb4f0f19b4a973fc224c78">data</a>[i] == 16) addBitsToStream(&amp;bp, out, bitlen_lld_e.<a class="code" href="structuivector.html#a427d761df4bb4f0f19b4a973fc224c78">data</a>[++i], 2);</div>
<div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span>(bitlen_lld_e.<a class="code" href="structuivector.html#a427d761df4bb4f0f19b4a973fc224c78">data</a>[i] == 17) addBitsToStream(&amp;bp, out, bitlen_lld_e.<a class="code" href="structuivector.html#a427d761df4bb4f0f19b4a973fc224c78">data</a>[++i], 3);</div>
<div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span>(bitlen_lld_e.<a class="code" href="structuivector.html#a427d761df4bb4f0f19b4a973fc224c78">data</a>[i] == 18) addBitsToStream(&amp;bp, out, bitlen_lld_e.<a class="code" href="structuivector.html#a427d761df4bb4f0f19b4a973fc224c78">data</a>[++i], 7);</div>
<div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;    }</div>
<div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160;</div>
<div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;    <span class="comment">/*write the compressed data symbols*/</span></div>
<div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;    writeLZ77data(&amp;bp, out, &amp;lz77_encoded, &amp;tree_ll, &amp;tree_d);</div>
<div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;    <span class="comment">/*error: the length of the end code 256 must be larger than 0*/</span></div>
<div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;    <span class="keywordflow">if</span>(HuffmanTree_getLength(&amp;tree_ll, 256) == 0) <a class="code" href="lodepng_8cpp.html#a691b23954341613b96b6d98ce67d339c">ERROR_BREAK</a>(64);</div>
<div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;</div>
<div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;    <span class="comment">/*write the end code*/</span></div>
<div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;    addHuffmanSymbol(&amp;bp, out, HuffmanTree_getCode(&amp;tree_ll, 256), HuffmanTree_getLength(&amp;tree_ll, 256));</div>
<div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;</div>
<div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;    <span class="keywordflow">break</span>; <span class="comment">/*end of error-while*/</span></div>
<div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;  }</div>
<div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;</div>
<div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;  <span class="comment">/*cleanup*/</span></div>
<div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;  uivector_cleanup(&amp;lz77_encoded);</div>
<div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;  HuffmanTree_cleanup(&amp;tree_ll);</div>
<div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;  HuffmanTree_cleanup(&amp;tree_d);</div>
<div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;  HuffmanTree_cleanup(&amp;tree_cl);</div>
<div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;  uivector_cleanup(&amp;frequencies_ll);</div>
<div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;  uivector_cleanup(&amp;frequencies_d);</div>
<div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;  uivector_cleanup(&amp;frequencies_cl);</div>
<div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;  uivector_cleanup(&amp;bitlen_lld_e);</div>
<div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;  uivector_cleanup(&amp;bitlen_lld);</div>
<div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;  uivector_cleanup(&amp;bitlen_cl);</div>
<div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160;</div>
<div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;  <span class="keywordflow">return</span> error;</div>
<div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;}</div>
<div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;</div>
<div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;<span class="keyword">static</span> <span class="keywordtype">unsigned</span> deflateFixed(<a class="code" href="structucvector.html">ucvector</a>* out, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* data,</div>
<div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;                             <span class="keywordtype">size_t</span> datasize, <span class="keyword">const</span> <a class="code" href="struct_lode_p_n_g___compress_settings.html">LodePNG_CompressSettings</a>* settings)</div>
<div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;{</div>
<div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;  <a class="code" href="struct_huffman_tree.html">HuffmanTree</a> tree_ll; <span class="comment">/*tree for literal values and length codes*/</span></div>
<div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;  <a class="code" href="struct_huffman_tree.html">HuffmanTree</a> tree_d; <span class="comment">/*tree for distance codes*/</span></div>
<div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;</div>
<div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;  <span class="keywordtype">unsigned</span> BFINAL = 1; <span class="comment">/*make only one block... the first and final one*/</span></div>
<div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;  <span class="keywordtype">unsigned</span> error = 0;</div>
<div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;  <span class="keywordtype">size_t</span> i, bp = 0; <span class="comment">/*the bit pointer*/</span></div>
<div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;</div>
<div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;  HuffmanTree_init(&amp;tree_ll);</div>
<div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;  HuffmanTree_init(&amp;tree_d);</div>
<div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;</div>
<div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;  generateFixedLitLenTree(&amp;tree_ll);</div>
<div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;  generateFixedDistanceTree(&amp;tree_d);</div>
<div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;</div>
<div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;  addBitToStream(&amp;bp, out, BFINAL);</div>
<div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;  addBitToStream(&amp;bp, out, 1); <span class="comment">/*first bit of BTYPE*/</span></div>
<div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;  addBitToStream(&amp;bp, out, 0); <span class="comment">/*second bit of BTYPE*/</span></div>
<div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;</div>
<div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;  <span class="keywordflow">if</span>(settings-&gt;<a class="code" href="struct_lode_p_n_g___compress_settings.html#ab7b87ac5529ab33b12efb05372974ca5">useLZ77</a>) <span class="comment">/*LZ77 encoded*/</span></div>
<div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;  {</div>
<div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;    <a class="code" href="structuivector.html">uivector</a> lz77_encoded;</div>
<div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;    uivector_init(&amp;lz77_encoded);</div>
<div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;    error = encodeLZ77(&amp;lz77_encoded, data, datasize, settings-&gt;<a class="code" href="struct_lode_p_n_g___compress_settings.html#adaebb6134716768bd1636aa97ec68b90">windowSize</a>);</div>
<div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;    <span class="keywordflow">if</span>(!error) writeLZ77data(&amp;bp, out, &amp;lz77_encoded, &amp;tree_ll, &amp;tree_d);</div>
<div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;    uivector_cleanup(&amp;lz77_encoded);</div>
<div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;  }</div>
<div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;  <span class="keywordflow">else</span> <span class="comment">/*no LZ77, but still will be Huffman compressed*/</span></div>
<div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;  {</div>
<div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;    <span class="keywordflow">for</span>(i = 0; i &lt; datasize; i++)</div>
<div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;    {</div>
<div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;      addHuffmanSymbol(&amp;bp, out, HuffmanTree_getCode(&amp;tree_ll, data[i]), HuffmanTree_getLength(&amp;tree_ll, data[i]));</div>
<div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;    }</div>
<div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;  }</div>
<div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;  <span class="comment">/*add END code*/</span></div>
<div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;  <span class="keywordflow">if</span>(!error) addHuffmanSymbol(&amp;bp, out, HuffmanTree_getCode(&amp;tree_ll, 256), HuffmanTree_getLength(&amp;tree_ll, 256));</div>
<div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;</div>
<div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;  <span class="comment">/*cleanup*/</span></div>
<div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;  HuffmanTree_cleanup(&amp;tree_ll);</div>
<div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;  HuffmanTree_cleanup(&amp;tree_d);</div>
<div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;</div>
<div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;  <span class="keywordflow">return</span> error;</div>
<div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;}</div>
<div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;</div>
<div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;<span class="keyword">static</span> <span class="keywordtype">unsigned</span> LodePNG_deflate(<a class="code" href="structucvector.html">ucvector</a>* out, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* data, <span class="keywordtype">size_t</span> datasize,</div>
<div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;                                <span class="keyword">const</span> <a class="code" href="struct_lode_p_n_g___compress_settings.html">LodePNG_CompressSettings</a>* settings)</div>
<div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;{</div>
<div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;  <span class="keywordtype">unsigned</span> error = 0;</div>
<div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;  <span class="keywordflow">if</span>(settings-&gt;<a class="code" href="struct_lode_p_n_g___compress_settings.html#aafec7ef311a7ad4e2ad3b1184e2aa805">btype</a> == 0) error = deflateNoCompression(out, data, datasize);</div>
<div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span>(settings-&gt;<a class="code" href="struct_lode_p_n_g___compress_settings.html#aafec7ef311a7ad4e2ad3b1184e2aa805">btype</a> == 1) error = deflateFixed(out, data, datasize, settings);</div>
<div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span>(settings-&gt;<a class="code" href="struct_lode_p_n_g___compress_settings.html#aafec7ef311a7ad4e2ad3b1184e2aa805">btype</a> == 2) error = deflateDynamic(out, data, datasize, settings);</div>
<div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;  <span class="keywordflow">else</span> error = 61;</div>
<div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;  <span class="keywordflow">return</span> error;</div>
<div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;}</div>
<div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;</div>
<div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/*LODEPNG_COMPILE_DECODER*/</span><span class="preprocessor"></span></div>
<div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;<span class="comment">/* ////////////////////////////////////////////////////////////////////////// */</span></div>
<div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;<span class="comment">/* / Adler32                                                                  */</span></div>
<div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;<span class="comment">/* ////////////////////////////////////////////////////////////////////////// */</span></div>
<div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;</div>
<div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;<span class="keyword">static</span> <span class="keywordtype">unsigned</span> update_adler32(<span class="keywordtype">unsigned</span> adler, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* data, <span class="keywordtype">unsigned</span> <a class="code" href="_d_l_l_imports_8inl.html#ab709438bbd0c872fe3f3894e04efaf2d">len</a>)</div>
<div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;{</div>
<div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;   <span class="keywordtype">unsigned</span> s1 = adler &amp; 0xffff;</div>
<div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;   <span class="keywordtype">unsigned</span> s2 = (adler &gt;&gt; 16) &amp; 0xffff;</div>
<div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;</div>
<div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;  <span class="keywordflow">while</span>(len &gt; 0)</div>
<div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;  {</div>
<div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;    <span class="comment">/*at least 5550 sums can be done before the sums overflow, saving a lot of module divisions*/</span></div>
<div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;    <span class="keywordtype">unsigned</span> amount = len &gt; 5550 ? 5550 : <a class="code" href="_d_l_l_imports_8inl.html#ab709438bbd0c872fe3f3894e04efaf2d">len</a>;</div>
<div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;    len -= amount;</div>
<div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;    <span class="keywordflow">while</span>(amount &gt; 0)</div>
<div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;    {</div>
<div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;      s1 = (s1 + *data++);</div>
<div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;      s2 = (s2 + s1);</div>
<div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160;      amount--;</div>
<div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160;    }</div>
<div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;    s1 %= 65521;</div>
<div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;    s2 %= 65521;</div>
<div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160;  }</div>
<div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;</div>
<div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;  <span class="keywordflow">return</span> (s2 &lt;&lt; 16) | s1;</div>
<div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;}</div>
<div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;</div>
<div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;<span class="comment">/*Return the adler32 of the bytes data[0..len-1]*/</span></div>
<div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;<span class="keyword">static</span> <span class="keywordtype">unsigned</span> adler32(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* data, <span class="keywordtype">unsigned</span> len)</div>
<div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;{</div>
<div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160;  <span class="keywordflow">return</span> update_adler32(1<a class="code" href="namespace_f_w.html#a3a10d44b3bb3a43e7a6c30e8242248ed">L</a>, data, len);</div>
<div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;}</div>
<div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;</div>
<div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160;<span class="comment">/* ////////////////////////////////////////////////////////////////////////// */</span></div>
<div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;<span class="comment">/* / Zlib                                                                   / */</span></div>
<div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;<span class="comment">/* ////////////////////////////////////////////////////////////////////////// */</span></div>
<div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160;</div>
<div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160;<span class="preprocessor">#ifdef LODEPNG_COMPILE_DECODER</span></div>
<div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l02032"></a><span class="lineno"><a class="line" href="lodepng_8h.html#af11d6ba19787c8d48aa3ed88cf3e6462"> 2032</a></span>&#160;<span class="keywordtype">unsigned</span> <a class="code" href="lodepng_8cpp.html#af11d6ba19787c8d48aa3ed88cf3e6462">LodePNG_zlib_decompress</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>** out, <span class="keywordtype">size_t</span>* outsize, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* in,</div>
<div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;                                 <span class="keywordtype">size_t</span> insize, <span class="keyword">const</span> <a class="code" href="struct_lode_p_n_g___decompress_settings.html">LodePNG_DecompressSettings</a>* settings)</div>
<div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160;{</div>
<div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160;  <span class="keywordtype">unsigned</span> error = 0;</div>
<div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160;  <span class="keywordtype">unsigned</span> CM, CINFO, FDICT;</div>
<div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160;  <a class="code" href="structucvector.html">ucvector</a> outv;</div>
<div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160;</div>
<div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160;  <span class="keywordflow">if</span>(insize &lt; 2) <span class="keywordflow">return</span> 53; <span class="comment">/*error, size of zlib data too small*/</span></div>
<div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160;  <span class="comment">/*read information from zlib header*/</span></div>
<div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;  <span class="keywordflow">if</span>((in[0] * 256 + in[1]) % 31 != 0)</div>
<div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;  {</div>
<div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160;    <span class="comment">/*error: 256 * in[0] + in[1] must be a multiple of 31, the FCHECK value is supposed to be made that way*/</span></div>
<div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160;    <span class="keywordflow">return</span> 24;</div>
<div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;  }</div>
<div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160;</div>
<div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160;  CM = in[0] &amp; 15;</div>
<div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160;  CINFO = (in[0] &gt;&gt; 4) &amp; 15;</div>
<div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160;  <span class="comment">/*FCHECK = in[1] &amp; 31;*/</span> <span class="comment">/*FCHECK is already tested above*/</span></div>
<div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160;  FDICT = (in[1] &gt;&gt; 5) &amp; 1;</div>
<div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160;  <span class="comment">/*FLEVEL = (in[1] &gt;&gt; 6) &amp; 3;*/</span> <span class="comment">/*FLEVEL is not used here*/</span></div>
<div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160;</div>
<div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160;  <span class="keywordflow">if</span>(CM != 8 || CINFO &gt; 7)</div>
<div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160;  {</div>
<div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160;    <span class="comment">/*error: only compression method 8: inflate with sliding window of 32k is supported by the PNG spec*/</span></div>
<div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160;    <span class="keywordflow">return</span> 25;</div>
<div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160;  }</div>
<div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160;  <span class="keywordflow">if</span>(FDICT != 0)</div>
<div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160;  {</div>
<div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160;    <span class="comment">/*error: the specification of PNG says about the zlib stream:</span></div>
<div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160;<span class="comment">      &quot;The additional flags shall not specify a preset dictionary.&quot;*/</span></div>
<div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160;    <span class="keywordflow">return</span> 26;</div>
<div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160;  }</div>
<div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160;</div>
<div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160;  <span class="comment">/*ucvector-controlled version of the output buffer, for dynamic array*/</span></div>
<div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160;  ucvector_init_buffer(&amp;outv, *out, *outsize);</div>
<div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160;  error = LodePNG_inflate(&amp;outv, in, insize, 2);</div>
<div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160;  *out = outv.<a class="code" href="structucvector.html#ace794c5713208c5a20f21762cd87c919">data</a>;</div>
<div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160;  *outsize = outv.<a class="code" href="structucvector.html#a27c99c34de0c5b3ca0c242d402c69499">size</a>;</div>
<div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160;  <span class="keywordflow">if</span>(error) <span class="keywordflow">return</span> error;</div>
<div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160;</div>
<div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160;  <span class="keywordflow">if</span>(!settings-&gt;<a class="code" href="struct_lode_p_n_g___decompress_settings.html#a6dfc36e99305ee75bab8f416d80fb9a5">ignoreAdler32</a>)</div>
<div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160;  {</div>
<div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160;    <span class="keywordtype">unsigned</span> ADLER32 = <a class="code" href="lodepng_8cpp.html#a347e6964b32f99efb902fbf7b1a9d934">LodePNG_read32bitInt</a>(&amp;in[insize - 4]);</div>
<div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160;    <span class="keywordtype">unsigned</span> checksum = adler32(outv.<a class="code" href="structucvector.html#ace794c5713208c5a20f21762cd87c919">data</a>, (<span class="keywordtype">unsigned</span>)outv.<a class="code" href="structucvector.html#a27c99c34de0c5b3ca0c242d402c69499">size</a>);</div>
<div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160;    <span class="keywordflow">if</span>(checksum != ADLER32) <span class="keywordflow">return</span> 58; <span class="comment">/*error, adler checksum not correct, data must be corrupted*/</span></div>
<div class="line"><a name="l02077"></a><span class="lineno"> 2077</span>&#160;  }</div>
<div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160;</div>
<div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160;  <span class="keywordflow">return</span> 0; <span class="comment">/*no error*/</span></div>
<div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160;}</div>
<div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160;</div>
<div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/*LODEPNG_COMPILE_DECODER*/</span><span class="preprocessor"></span></div>
<div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160;<span class="preprocessor">#ifdef LODEPNG_COMPILE_ENCODER</span></div>
<div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l02086"></a><span class="lineno"><a class="line" href="lodepng_8h.html#aa2ff174234767c087c7ba974ba862be9"> 2086</a></span>&#160;<span class="keywordtype">unsigned</span> <a class="code" href="lodepng_8cpp.html#aa2ff174234767c087c7ba974ba862be9">LodePNG_zlib_compress</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>** out, <span class="keywordtype">size_t</span>* outsize, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* in,</div>
<div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160;                               <span class="keywordtype">size_t</span> insize, <span class="keyword">const</span> <a class="code" href="struct_lode_p_n_g___compress_settings.html">LodePNG_CompressSettings</a>* settings)</div>
<div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160;{</div>
<div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160;  <span class="comment">/*initially, *out must be NULL and outsize 0, if you just give some random *out</span></div>
<div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160;<span class="comment">  that&#39;s pointing to a non allocated buffer, this&#39;ll crash*/</span></div>
<div class="line"><a name="l02091"></a><span class="lineno"> 2091</span>&#160;  <a class="code" href="structucvector.html">ucvector</a> deflatedata, outv;</div>
<div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160;  <span class="keywordtype">size_t</span> i;</div>
<div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160;  <span class="keywordtype">unsigned</span> error;</div>
<div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160;</div>
<div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160;  <span class="keywordtype">unsigned</span> ADLER32;</div>
<div class="line"><a name="l02096"></a><span class="lineno"> 2096</span>&#160;  <span class="comment">/*zlib data: 1 byte CMF (CM+CINFO), 1 byte FLG, deflate data, 4 byte ADLER32 checksum of the Decompressed data*/</span></div>
<div class="line"><a name="l02097"></a><span class="lineno"> 2097</span>&#160;  <span class="keywordtype">unsigned</span> CMF = 120; <span class="comment">/*0b01111000: CM 8, CINFO 7. With CINFO 7, any window size up to 32768 can be used.*/</span></div>
<div class="line"><a name="l02098"></a><span class="lineno"> 2098</span>&#160;  <span class="keywordtype">unsigned</span> FLEVEL = 0;</div>
<div class="line"><a name="l02099"></a><span class="lineno"> 2099</span>&#160;  <span class="keywordtype">unsigned</span> FDICT = 0;</div>
<div class="line"><a name="l02100"></a><span class="lineno"> 2100</span>&#160;  <span class="keywordtype">unsigned</span> CMFFLG = 256 * CMF + FDICT * 32 + FLEVEL * 64;</div>
<div class="line"><a name="l02101"></a><span class="lineno"> 2101</span>&#160;  <span class="keywordtype">unsigned</span> FCHECK = 31 - CMFFLG % 31;</div>
<div class="line"><a name="l02102"></a><span class="lineno"> 2102</span>&#160;  CMFFLG += FCHECK;</div>
<div class="line"><a name="l02103"></a><span class="lineno"> 2103</span>&#160;</div>
<div class="line"><a name="l02104"></a><span class="lineno"> 2104</span>&#160;  <span class="comment">/*ucvector-controlled version of the output buffer, for dynamic array*/</span></div>
<div class="line"><a name="l02105"></a><span class="lineno"> 2105</span>&#160;  ucvector_init_buffer(&amp;outv, *out, *outsize);</div>
<div class="line"><a name="l02106"></a><span class="lineno"> 2106</span>&#160;</div>
<div class="line"><a name="l02107"></a><span class="lineno"> 2107</span>&#160;  ucvector_push_back(&amp;outv, (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>)(CMFFLG / 256));</div>
<div class="line"><a name="l02108"></a><span class="lineno"> 2108</span>&#160;  ucvector_push_back(&amp;outv, (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>)(CMFFLG % 256));</div>
<div class="line"><a name="l02109"></a><span class="lineno"> 2109</span>&#160;</div>
<div class="line"><a name="l02110"></a><span class="lineno"> 2110</span>&#160;  ucvector_init(&amp;deflatedata);</div>
<div class="line"><a name="l02111"></a><span class="lineno"> 2111</span>&#160;  error = LodePNG_deflate(&amp;deflatedata, in, insize, settings);</div>
<div class="line"><a name="l02112"></a><span class="lineno"> 2112</span>&#160;</div>
<div class="line"><a name="l02113"></a><span class="lineno"> 2113</span>&#160;  <span class="keywordflow">if</span>(!error)</div>
<div class="line"><a name="l02114"></a><span class="lineno"> 2114</span>&#160;  {</div>
<div class="line"><a name="l02115"></a><span class="lineno"> 2115</span>&#160;    ADLER32 = adler32(in, (<span class="keywordtype">unsigned</span>)insize);</div>
<div class="line"><a name="l02116"></a><span class="lineno"> 2116</span>&#160;    <span class="keywordflow">for</span>(i = 0; i &lt; deflatedata.<a class="code" href="structucvector.html#a27c99c34de0c5b3ca0c242d402c69499">size</a>; i++) ucvector_push_back(&amp;outv, deflatedata.<a class="code" href="structucvector.html#ace794c5713208c5a20f21762cd87c919">data</a>[i]);</div>
<div class="line"><a name="l02117"></a><span class="lineno"> 2117</span>&#160;    ucvector_cleanup(&amp;deflatedata);</div>
<div class="line"><a name="l02118"></a><span class="lineno"> 2118</span>&#160;    LodePNG_add32bitInt(&amp;outv, ADLER32);</div>
<div class="line"><a name="l02119"></a><span class="lineno"> 2119</span>&#160;  }</div>
<div class="line"><a name="l02120"></a><span class="lineno"> 2120</span>&#160;</div>
<div class="line"><a name="l02121"></a><span class="lineno"> 2121</span>&#160;  *out = outv.<a class="code" href="structucvector.html#ace794c5713208c5a20f21762cd87c919">data</a>;</div>
<div class="line"><a name="l02122"></a><span class="lineno"> 2122</span>&#160;  *outsize = outv.<a class="code" href="structucvector.html#a27c99c34de0c5b3ca0c242d402c69499">size</a>;</div>
<div class="line"><a name="l02123"></a><span class="lineno"> 2123</span>&#160;</div>
<div class="line"><a name="l02124"></a><span class="lineno"> 2124</span>&#160;  <span class="keywordflow">return</span> error;</div>
<div class="line"><a name="l02125"></a><span class="lineno"> 2125</span>&#160;}</div>
<div class="line"><a name="l02126"></a><span class="lineno"> 2126</span>&#160;</div>
<div class="line"><a name="l02127"></a><span class="lineno"> 2127</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/*LODEPNG_COMPILE_ENCODER*/</span><span class="preprocessor"></span></div>
<div class="line"><a name="l02128"></a><span class="lineno"> 2128</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l02129"></a><span class="lineno"> 2129</span>&#160;<span class="preprocessor">#else </span><span class="comment">/*no LODEPNG_COMPILE_ZLIB*/</span><span class="preprocessor"></span></div>
<div class="line"><a name="l02130"></a><span class="lineno"> 2130</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l02131"></a><span class="lineno"> 2131</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l02132"></a><span class="lineno"> 2132</span>&#160;<span class="comment">Dummy functions used if LODEPNG_COMPILE_ZLIB isn&#39;t defined. You need to implement</span></div>
<div class="line"><a name="l02133"></a><span class="lineno"> 2133</span>&#160;<span class="comment">these yourself when disabling the LodePNG Zlib part, e.g. by calling another</span></div>
<div class="line"><a name="l02134"></a><span class="lineno"> 2134</span>&#160;<span class="comment">library from here.</span></div>
<div class="line"><a name="l02135"></a><span class="lineno"> 2135</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l02136"></a><span class="lineno"> 2136</span>&#160;<span class="comment">*out must be NULL and *outsize must be 0 initially, and after the function is done,</span></div>
<div class="line"><a name="l02137"></a><span class="lineno"> 2137</span>&#160;<span class="comment">*out must point to the decompressed data, *outsize must be the size of it, and must</span></div>
<div class="line"><a name="l02138"></a><span class="lineno"> 2138</span>&#160;<span class="comment">be the size of the useful data in bytes, not the alloc size.</span></div>
<div class="line"><a name="l02139"></a><span class="lineno"> 2139</span>&#160;<span class="comment">*/</span></div>
<div class="line"><a name="l02140"></a><span class="lineno"> 2140</span>&#160;</div>
<div class="line"><a name="l02141"></a><span class="lineno"> 2141</span>&#160;<span class="preprocessor">#ifdef LODEPNG_COMPILE_DECODER</span></div>
<div class="line"><a name="l02142"></a><span class="lineno"> 2142</span>&#160;<span class="preprocessor"></span><span class="keyword">static</span> <span class="keywordtype">unsigned</span> <a class="code" href="lodepng_8cpp.html#af11d6ba19787c8d48aa3ed88cf3e6462">LodePNG_zlib_decompress</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>** out, <span class="keywordtype">size_t</span>* outsize, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* in,</div>
<div class="line"><a name="l02143"></a><span class="lineno"> 2143</span>&#160;                                        <span class="keywordtype">size_t</span> insize, <span class="keyword">const</span> <a class="code" href="struct_lode_p_n_g___decompress_settings.html">LodePNG_DecompressSettings</a>* settings)</div>
<div class="line"><a name="l02144"></a><span class="lineno"> 2144</span>&#160;{</div>
<div class="line"><a name="l02145"></a><span class="lineno"> 2145</span>&#160;  <span class="keywordflow">return</span> 0; <span class="comment">//Placeholder to be implemented if LODEPNG_COMPILE_ZLIB is disabled.</span></div>
<div class="line"><a name="l02146"></a><span class="lineno"> 2146</span>&#160;}</div>
<div class="line"><a name="l02147"></a><span class="lineno"> 2147</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/*LODEPNG_COMPILE_DECODER*/</span><span class="preprocessor"></span></div>
<div class="line"><a name="l02148"></a><span class="lineno"> 2148</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef LODEPNG_COMPILE_ENCODER</span></div>
<div class="line"><a name="l02149"></a><span class="lineno"> 2149</span>&#160;<span class="preprocessor"></span><span class="keyword">static</span> <span class="keywordtype">unsigned</span> <a class="code" href="lodepng_8cpp.html#aa2ff174234767c087c7ba974ba862be9">LodePNG_zlib_compress</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>** out, <span class="keywordtype">size_t</span>* outsize, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* in,</div>
<div class="line"><a name="l02150"></a><span class="lineno"> 2150</span>&#160;                                      <span class="keywordtype">size_t</span> insize, <span class="keyword">const</span> <a class="code" href="struct_lode_p_n_g___compress_settings.html">LodePNG_CompressSettings</a>* settings)</div>
<div class="line"><a name="l02151"></a><span class="lineno"> 2151</span>&#160;{</div>
<div class="line"><a name="l02152"></a><span class="lineno"> 2152</span>&#160;  <span class="keywordflow">return</span> 0; <span class="comment">//Placeholder to be implemented if LODEPNG_COMPILE_ZLIB is disabled.</span></div>
<div class="line"><a name="l02153"></a><span class="lineno"> 2153</span>&#160;}</div>
<div class="line"><a name="l02154"></a><span class="lineno"> 2154</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/*LODEPNG_COMPILE_ENCODER*/</span><span class="preprocessor"></span></div>
<div class="line"><a name="l02155"></a><span class="lineno"> 2155</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l02156"></a><span class="lineno"> 2156</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/*LODEPNG_COMPILE_ZLIB*/</span><span class="preprocessor"></span></div>
<div class="line"><a name="l02157"></a><span class="lineno"> 2157</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l02158"></a><span class="lineno"> 2158</span>&#160;<span class="comment">/* ////////////////////////////////////////////////////////////////////////// */</span></div>
<div class="line"><a name="l02159"></a><span class="lineno"> 2159</span>&#160;</div>
<div class="line"><a name="l02160"></a><span class="lineno"> 2160</span>&#160;<span class="preprocessor">#ifdef LODEPNG_COMPILE_ENCODER</span></div>
<div class="line"><a name="l02161"></a><span class="lineno"> 2161</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l02162"></a><span class="lineno"> 2162</span>&#160;<span class="comment">/*this is a good tradeoff between speed and compression ratio*/</span></div>
<div class="line"><a name="l02163"></a><span class="lineno"><a class="line" href="lodepng_8cpp.html#a947faf188804eb1b43158cd836333a6f"> 2163</a></span>&#160;<span class="preprocessor">#define DEFAULT_WINDOWSIZE 2048</span></div>
<div class="line"><a name="l02164"></a><span class="lineno"> 2164</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l02165"></a><span class="lineno"><a class="line" href="lodepng_8h.html#a1887de65d8e8d03605c736ace1c9f3aa"> 2165</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="lodepng_8cpp.html#a1887de65d8e8d03605c736ace1c9f3aa">LodePNG_CompressSettings_init</a>(<a class="code" href="struct_lode_p_n_g___compress_settings.html">LodePNG_CompressSettings</a>* settings)</div>
<div class="line"><a name="l02166"></a><span class="lineno"> 2166</span>&#160;{</div>
<div class="line"><a name="l02167"></a><span class="lineno"> 2167</span>&#160;  <span class="comment">/*compress with dynamic huffman tree (not in the mathematical sense, just not the predefined one)*/</span></div>
<div class="line"><a name="l02168"></a><span class="lineno"> 2168</span>&#160;  settings-&gt;<a class="code" href="struct_lode_p_n_g___compress_settings.html#aafec7ef311a7ad4e2ad3b1184e2aa805">btype</a> = 2;</div>
<div class="line"><a name="l02169"></a><span class="lineno"> 2169</span>&#160;  settings-&gt;<a class="code" href="struct_lode_p_n_g___compress_settings.html#ab7b87ac5529ab33b12efb05372974ca5">useLZ77</a> = 1;</div>
<div class="line"><a name="l02170"></a><span class="lineno"> 2170</span>&#160;  settings-&gt;<a class="code" href="struct_lode_p_n_g___compress_settings.html#adaebb6134716768bd1636aa97ec68b90">windowSize</a> = <a class="code" href="lodepng_8cpp.html#a947faf188804eb1b43158cd836333a6f">DEFAULT_WINDOWSIZE</a>;</div>
<div class="line"><a name="l02171"></a><span class="lineno"> 2171</span>&#160;}</div>
<div class="line"><a name="l02172"></a><span class="lineno"> 2172</span>&#160;</div>
<div class="line"><a name="l02173"></a><span class="lineno"><a class="line" href="lodepng_8h.html#af5a4469e6cb7a84476d16686fd55fcda"> 2173</a></span>&#160;<span class="keyword">const</span> <a class="code" href="struct_lode_p_n_g___compress_settings.html">LodePNG_CompressSettings</a> <a class="code" href="lodepng_8cpp.html#af5a4469e6cb7a84476d16686fd55fcda">LodePNG_defaultCompressSettings</a> = {2, 1, <a class="code" href="lodepng_8cpp.html#a947faf188804eb1b43158cd836333a6f">DEFAULT_WINDOWSIZE</a>};</div>
<div class="line"><a name="l02174"></a><span class="lineno"> 2174</span>&#160;</div>
<div class="line"><a name="l02175"></a><span class="lineno"> 2175</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/*LODEPNG_COMPILE_ENCODER*/</span><span class="preprocessor"></span></div>
<div class="line"><a name="l02176"></a><span class="lineno"> 2176</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l02177"></a><span class="lineno"> 2177</span>&#160;<span class="preprocessor">#ifdef LODEPNG_COMPILE_DECODER</span></div>
<div class="line"><a name="l02178"></a><span class="lineno"> 2178</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l02179"></a><span class="lineno"><a class="line" href="lodepng_8h.html#a5ac964beddc20407668774ebf7804fc4"> 2179</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="lodepng_8cpp.html#a5ac964beddc20407668774ebf7804fc4">LodePNG_DecompressSettings_init</a>(<a class="code" href="struct_lode_p_n_g___decompress_settings.html">LodePNG_DecompressSettings</a>* settings)</div>
<div class="line"><a name="l02180"></a><span class="lineno"> 2180</span>&#160;{</div>
<div class="line"><a name="l02181"></a><span class="lineno"> 2181</span>&#160;  settings-&gt;<a class="code" href="struct_lode_p_n_g___decompress_settings.html#a6dfc36e99305ee75bab8f416d80fb9a5">ignoreAdler32</a> = 0;</div>
<div class="line"><a name="l02182"></a><span class="lineno"> 2182</span>&#160;}</div>
<div class="line"><a name="l02183"></a><span class="lineno"> 2183</span>&#160;</div>
<div class="line"><a name="l02184"></a><span class="lineno"><a class="line" href="lodepng_8h.html#ae22b6f611167b5f0f0468989746fe406"> 2184</a></span>&#160;<span class="keyword">const</span> <a class="code" href="struct_lode_p_n_g___decompress_settings.html">LodePNG_DecompressSettings</a> <a class="code" href="lodepng_8cpp.html#ae22b6f611167b5f0f0468989746fe406">LodePNG_defaultDecompressSettings</a> = {0};</div>
<div class="line"><a name="l02185"></a><span class="lineno"> 2185</span>&#160;</div>
<div class="line"><a name="l02186"></a><span class="lineno"> 2186</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/*LODEPNG_COMPILE_DECODER*/</span><span class="preprocessor"></span></div>
<div class="line"><a name="l02187"></a><span class="lineno"> 2187</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l02188"></a><span class="lineno"> 2188</span>&#160;<span class="comment">/* ////////////////////////////////////////////////////////////////////////// */</span></div>
<div class="line"><a name="l02189"></a><span class="lineno"> 2189</span>&#160;<span class="comment">/* ////////////////////////////////////////////////////////////////////////// */</span></div>
<div class="line"><a name="l02190"></a><span class="lineno"> 2190</span>&#160;<span class="comment">/* // End of Zlib related code. Begin of PNG related code.                 // */</span></div>
<div class="line"><a name="l02191"></a><span class="lineno"> 2191</span>&#160;<span class="comment">/* ////////////////////////////////////////////////////////////////////////// */</span></div>
<div class="line"><a name="l02192"></a><span class="lineno"> 2192</span>&#160;<span class="comment">/* ////////////////////////////////////////////////////////////////////////// */</span></div>
<div class="line"><a name="l02193"></a><span class="lineno"> 2193</span>&#160;</div>
<div class="line"><a name="l02194"></a><span class="lineno"> 2194</span>&#160;<span class="preprocessor">#ifdef LODEPNG_COMPILE_PNG</span></div>
<div class="line"><a name="l02195"></a><span class="lineno"> 2195</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l02196"></a><span class="lineno"> 2196</span>&#160;<span class="comment">/* ////////////////////////////////////////////////////////////////////////// */</span></div>
<div class="line"><a name="l02197"></a><span class="lineno"> 2197</span>&#160;<span class="comment">/* / CRC32                                                                  / */</span></div>
<div class="line"><a name="l02198"></a><span class="lineno"> 2198</span>&#160;<span class="comment">/* ////////////////////////////////////////////////////////////////////////// */</span></div>
<div class="line"><a name="l02199"></a><span class="lineno"> 2199</span>&#160;</div>
<div class="line"><a name="l02200"></a><span class="lineno"> 2200</span>&#160;<span class="keyword">static</span> <span class="keywordtype">unsigned</span> Crc32_crc_table_computed = 0;</div>
<div class="line"><a name="l02201"></a><span class="lineno"> 2201</span>&#160;<span class="keyword">static</span> <span class="keywordtype">unsigned</span> Crc32_crc_table[256];</div>
<div class="line"><a name="l02202"></a><span class="lineno"> 2202</span>&#160;</div>
<div class="line"><a name="l02203"></a><span class="lineno"> 2203</span>&#160;<span class="comment">/*Make the table for a fast CRC.*/</span></div>
<div class="line"><a name="l02204"></a><span class="lineno"> 2204</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> Crc32_make_crc_table(<span class="keywordtype">void</span>)</div>
<div class="line"><a name="l02205"></a><span class="lineno"> 2205</span>&#160;{</div>
<div class="line"><a name="l02206"></a><span class="lineno"> 2206</span>&#160;  <span class="keywordtype">unsigned</span> c, k, <a class="code" href="_d_l_l_imports_8inl.html#a7bfd2fdf58fb75abde6e36d72617c71b">n</a>;</div>
<div class="line"><a name="l02207"></a><span class="lineno"> 2207</span>&#160;  <span class="keywordflow">for</span>(n = 0; n &lt; 256; n++)</div>
<div class="line"><a name="l02208"></a><span class="lineno"> 2208</span>&#160;  {</div>
<div class="line"><a name="l02209"></a><span class="lineno"> 2209</span>&#160;    c = <a class="code" href="_d_l_l_imports_8inl.html#a7bfd2fdf58fb75abde6e36d72617c71b">n</a>;</div>
<div class="line"><a name="l02210"></a><span class="lineno"> 2210</span>&#160;    <span class="keywordflow">for</span>(k = 0; k &lt; 8; k++)</div>
<div class="line"><a name="l02211"></a><span class="lineno"> 2211</span>&#160;    {</div>
<div class="line"><a name="l02212"></a><span class="lineno"> 2212</span>&#160;      <span class="keywordflow">if</span>(c &amp; 1) c = 0xedb88320<a class="code" href="namespace_f_w.html#a3a10d44b3bb3a43e7a6c30e8242248ed">L</a> ^ (c &gt;&gt; 1);</div>
<div class="line"><a name="l02213"></a><span class="lineno"> 2213</span>&#160;      <span class="keywordflow">else</span> c = c &gt;&gt; 1;</div>
<div class="line"><a name="l02214"></a><span class="lineno"> 2214</span>&#160;    }</div>
<div class="line"><a name="l02215"></a><span class="lineno"> 2215</span>&#160;    Crc32_crc_table[<a class="code" href="_d_l_l_imports_8inl.html#a7bfd2fdf58fb75abde6e36d72617c71b">n</a>] = c;</div>
<div class="line"><a name="l02216"></a><span class="lineno"> 2216</span>&#160;  }</div>
<div class="line"><a name="l02217"></a><span class="lineno"> 2217</span>&#160;  Crc32_crc_table_computed = 1;</div>
<div class="line"><a name="l02218"></a><span class="lineno"> 2218</span>&#160;}</div>
<div class="line"><a name="l02219"></a><span class="lineno"> 2219</span>&#160;</div>
<div class="line"><a name="l02220"></a><span class="lineno"> 2220</span>&#160;<span class="comment">/*Update a running CRC with the bytes buf[0..len-1]--the CRC should be</span></div>
<div class="line"><a name="l02221"></a><span class="lineno"> 2221</span>&#160;<span class="comment">initialized to all 1&#39;s, and the transmitted value is the 1&#39;s complement of the</span></div>
<div class="line"><a name="l02222"></a><span class="lineno"> 2222</span>&#160;<span class="comment">final running CRC (see the crc() routine below).*/</span></div>
<div class="line"><a name="l02223"></a><span class="lineno"> 2223</span>&#160;<span class="keyword">static</span> <span class="keywordtype">unsigned</span> Crc32_update_crc(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* buf, <span class="keywordtype">unsigned</span> crc, <span class="keywordtype">size_t</span> len)</div>
<div class="line"><a name="l02224"></a><span class="lineno"> 2224</span>&#160;{</div>
<div class="line"><a name="l02225"></a><span class="lineno"> 2225</span>&#160;  <span class="keywordtype">unsigned</span> c = crc;</div>
<div class="line"><a name="l02226"></a><span class="lineno"> 2226</span>&#160;  <span class="keywordtype">size_t</span> <a class="code" href="_d_l_l_imports_8inl.html#a7bfd2fdf58fb75abde6e36d72617c71b">n</a>;</div>
<div class="line"><a name="l02227"></a><span class="lineno"> 2227</span>&#160;</div>
<div class="line"><a name="l02228"></a><span class="lineno"> 2228</span>&#160;  <span class="keywordflow">if</span>(!Crc32_crc_table_computed) Crc32_make_crc_table();</div>
<div class="line"><a name="l02229"></a><span class="lineno"> 2229</span>&#160;  <span class="keywordflow">for</span>(n = 0; n &lt; <a class="code" href="_d_l_l_imports_8inl.html#ab709438bbd0c872fe3f3894e04efaf2d">len</a>; n++)</div>
<div class="line"><a name="l02230"></a><span class="lineno"> 2230</span>&#160;  {</div>
<div class="line"><a name="l02231"></a><span class="lineno"> 2231</span>&#160;    c = Crc32_crc_table[(c ^ buf[<a class="code" href="_d_l_l_imports_8inl.html#a7bfd2fdf58fb75abde6e36d72617c71b">n</a>]) &amp; 0xff] ^ (c &gt;&gt; 8);</div>
<div class="line"><a name="l02232"></a><span class="lineno"> 2232</span>&#160;  }</div>
<div class="line"><a name="l02233"></a><span class="lineno"> 2233</span>&#160;  <span class="keywordflow">return</span> c;</div>
<div class="line"><a name="l02234"></a><span class="lineno"> 2234</span>&#160;}</div>
<div class="line"><a name="l02235"></a><span class="lineno"> 2235</span>&#160;</div>
<div class="line"><a name="l02236"></a><span class="lineno"> 2236</span>&#160;<span class="comment">/*Return the CRC of the bytes buf[0..len-1].*/</span></div>
<div class="line"><a name="l02237"></a><span class="lineno"> 2237</span>&#160;<span class="keyword">static</span> <span class="keywordtype">unsigned</span> Crc32_crc(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* buf, <span class="keywordtype">size_t</span> len)</div>
<div class="line"><a name="l02238"></a><span class="lineno"> 2238</span>&#160;{</div>
<div class="line"><a name="l02239"></a><span class="lineno"> 2239</span>&#160;  <span class="keywordflow">return</span> Crc32_update_crc(buf, 0xffffffffL, len) ^ 0xffffffff<a class="code" href="namespace_f_w.html#a3a10d44b3bb3a43e7a6c30e8242248ed">L</a>;</div>
<div class="line"><a name="l02240"></a><span class="lineno"> 2240</span>&#160;}</div>
<div class="line"><a name="l02241"></a><span class="lineno"> 2241</span>&#160;</div>
<div class="line"><a name="l02242"></a><span class="lineno"> 2242</span>&#160;<span class="comment">/* ////////////////////////////////////////////////////////////////////////// */</span></div>
<div class="line"><a name="l02243"></a><span class="lineno"> 2243</span>&#160;<span class="comment">/* / Reading and writing single bits and bytes from/to stream for LodePNG   / */</span></div>
<div class="line"><a name="l02244"></a><span class="lineno"> 2244</span>&#160;<span class="comment">/* ////////////////////////////////////////////////////////////////////////// */</span></div>
<div class="line"><a name="l02245"></a><span class="lineno"> 2245</span>&#160;</div>
<div class="line"><a name="l02246"></a><span class="lineno"> 2246</span>&#160;<span class="keyword">static</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> readBitFromReversedStream(<span class="keywordtype">size_t</span>* bitpointer, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* bitstream)</div>
<div class="line"><a name="l02247"></a><span class="lineno"> 2247</span>&#160;{</div>
<div class="line"><a name="l02248"></a><span class="lineno"> 2248</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> result = (<span class="keywordtype">unsigned</span> char)((bitstream[(*bitpointer) &gt;&gt; 3] &gt;&gt; (7 - ((*bitpointer) &amp; 0x7))) &amp; 1);</div>
<div class="line"><a name="l02249"></a><span class="lineno"> 2249</span>&#160;  (*bitpointer)++;</div>
<div class="line"><a name="l02250"></a><span class="lineno"> 2250</span>&#160;  <span class="keywordflow">return</span> result;</div>
<div class="line"><a name="l02251"></a><span class="lineno"> 2251</span>&#160;}</div>
<div class="line"><a name="l02252"></a><span class="lineno"> 2252</span>&#160;</div>
<div class="line"><a name="l02253"></a><span class="lineno"> 2253</span>&#160;<span class="keyword">static</span> <span class="keywordtype">unsigned</span> readBitsFromReversedStream(<span class="keywordtype">size_t</span>* bitpointer, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* bitstream, <span class="keywordtype">size_t</span> nbits)</div>
<div class="line"><a name="l02254"></a><span class="lineno"> 2254</span>&#160;{</div>
<div class="line"><a name="l02255"></a><span class="lineno"> 2255</span>&#160;  <span class="keywordtype">unsigned</span> result = 0;</div>
<div class="line"><a name="l02256"></a><span class="lineno"> 2256</span>&#160;  <span class="keywordtype">size_t</span> i;</div>
<div class="line"><a name="l02257"></a><span class="lineno"> 2257</span>&#160;  <span class="keywordflow">for</span>(i = nbits - 1; i &lt; nbits; i--)</div>
<div class="line"><a name="l02258"></a><span class="lineno"> 2258</span>&#160;  {</div>
<div class="line"><a name="l02259"></a><span class="lineno"> 2259</span>&#160;    result += (unsigned)readBitFromReversedStream(bitpointer, bitstream) &lt;&lt; i;</div>
<div class="line"><a name="l02260"></a><span class="lineno"> 2260</span>&#160;  }</div>
<div class="line"><a name="l02261"></a><span class="lineno"> 2261</span>&#160;  <span class="keywordflow">return</span> result;</div>
<div class="line"><a name="l02262"></a><span class="lineno"> 2262</span>&#160;}</div>
<div class="line"><a name="l02263"></a><span class="lineno"> 2263</span>&#160;</div>
<div class="line"><a name="l02264"></a><span class="lineno"> 2264</span>&#160;<span class="preprocessor">#ifdef LODEPNG_COMPILE_DECODER</span></div>
<div class="line"><a name="l02265"></a><span class="lineno"> 2265</span>&#160;<span class="preprocessor"></span><span class="keyword">static</span> <span class="keywordtype">void</span> setBitOfReversedStream0(<span class="keywordtype">size_t</span>* bitpointer, <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* bitstream, <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> bit)</div>
<div class="line"><a name="l02266"></a><span class="lineno"> 2266</span>&#160;{</div>
<div class="line"><a name="l02267"></a><span class="lineno"> 2267</span>&#160;  <span class="comment">/*the current bit in bitstream must be 0 for this to work*/</span></div>
<div class="line"><a name="l02268"></a><span class="lineno"> 2268</span>&#160;  <span class="keywordflow">if</span>(bit)</div>
<div class="line"><a name="l02269"></a><span class="lineno"> 2269</span>&#160;  {</div>
<div class="line"><a name="l02270"></a><span class="lineno"> 2270</span>&#160;    <span class="comment">/*earlier bit of huffman code is in a lesser significant bit of an earlier byte*/</span></div>
<div class="line"><a name="l02271"></a><span class="lineno"> 2271</span>&#160;    bitstream[(*bitpointer) &gt;&gt; 3] |= (bit &lt;&lt; (7 - ((*bitpointer) &amp; 0x7)));</div>
<div class="line"><a name="l02272"></a><span class="lineno"> 2272</span>&#160;  }</div>
<div class="line"><a name="l02273"></a><span class="lineno"> 2273</span>&#160;  (*bitpointer)++;</div>
<div class="line"><a name="l02274"></a><span class="lineno"> 2274</span>&#160;}</div>
<div class="line"><a name="l02275"></a><span class="lineno"> 2275</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/*LODEPNG_COMPILE_DECODER*/</span><span class="preprocessor"></span></div>
<div class="line"><a name="l02276"></a><span class="lineno"> 2276</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l02277"></a><span class="lineno"> 2277</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> setBitOfReversedStream(<span class="keywordtype">size_t</span>* bitpointer, <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* bitstream, <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> bit)</div>
<div class="line"><a name="l02278"></a><span class="lineno"> 2278</span>&#160;{</div>
<div class="line"><a name="l02279"></a><span class="lineno"> 2279</span>&#160;  <span class="comment">/*the current bit in bitstream may be 0 or 1 for this to work*/</span></div>
<div class="line"><a name="l02280"></a><span class="lineno"> 2280</span>&#160;  <span class="keywordflow">if</span>(bit == 0) bitstream[(*bitpointer) &gt;&gt; 3] &amp;=  (<span class="keywordtype">unsigned</span> char)(~(1 &lt;&lt; (7 - ((*bitpointer) &amp; 0x7))));</div>
<div class="line"><a name="l02281"></a><span class="lineno"> 2281</span>&#160;  <span class="keywordflow">else</span>         bitstream[(*bitpointer) &gt;&gt; 3] |=  (1 &lt;&lt; (7 - ((*bitpointer) &amp; 0x7)));</div>
<div class="line"><a name="l02282"></a><span class="lineno"> 2282</span>&#160;  (*bitpointer)++;</div>
<div class="line"><a name="l02283"></a><span class="lineno"> 2283</span>&#160;}</div>
<div class="line"><a name="l02284"></a><span class="lineno"> 2284</span>&#160;</div>
<div class="line"><a name="l02285"></a><span class="lineno"> 2285</span>&#160;<span class="comment">/* ////////////////////////////////////////////////////////////////////////// */</span></div>
<div class="line"><a name="l02286"></a><span class="lineno"> 2286</span>&#160;<span class="comment">/* / PNG chunks                                                             / */</span></div>
<div class="line"><a name="l02287"></a><span class="lineno"> 2287</span>&#160;<span class="comment">/* ////////////////////////////////////////////////////////////////////////// */</span></div>
<div class="line"><a name="l02288"></a><span class="lineno"> 2288</span>&#160;</div>
<div class="line"><a name="l02289"></a><span class="lineno"><a class="line" href="lodepng_8h.html#a4e9b1ed7e3242b335ddd8b4a0aba161f"> 2289</a></span>&#160;<span class="keywordtype">unsigned</span> <a class="code" href="lodepng_8cpp.html#a4e9b1ed7e3242b335ddd8b4a0aba161f">LodePNG_chunk_length</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* chunk)</div>
<div class="line"><a name="l02290"></a><span class="lineno"> 2290</span>&#160;{</div>
<div class="line"><a name="l02291"></a><span class="lineno"> 2291</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="lodepng_8cpp.html#a347e6964b32f99efb902fbf7b1a9d934">LodePNG_read32bitInt</a>(&amp;chunk[0]);</div>
<div class="line"><a name="l02292"></a><span class="lineno"> 2292</span>&#160;}</div>
<div class="line"><a name="l02293"></a><span class="lineno"> 2293</span>&#160;</div>
<div class="line"><a name="l02294"></a><span class="lineno"><a class="line" href="lodepng_8h.html#af3cff22c00facc19aa15202f1001e863"> 2294</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="lodepng_8cpp.html#af3cff22c00facc19aa15202f1001e863">LodePNG_chunk_type</a>(<span class="keywordtype">char</span> <a class="code" href="_d_l_l_imports_8inl.html#a1d14bae93fe47a03f0ace206fef6a34e">type</a>[5], <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* chunk)</div>
<div class="line"><a name="l02295"></a><span class="lineno"> 2295</span>&#160;{</div>
<div class="line"><a name="l02296"></a><span class="lineno"> 2296</span>&#160;  <span class="keywordtype">unsigned</span> i;</div>
<div class="line"><a name="l02297"></a><span class="lineno"> 2297</span>&#160;  <span class="keywordflow">for</span>(i = 0; i &lt; 4; i++) type[i] = chunk[4 + i];</div>
<div class="line"><a name="l02298"></a><span class="lineno"> 2298</span>&#160;  type[4] = 0; <span class="comment">/*null termination char*/</span></div>
<div class="line"><a name="l02299"></a><span class="lineno"> 2299</span>&#160;}</div>
<div class="line"><a name="l02300"></a><span class="lineno"> 2300</span>&#160;</div>
<div class="line"><a name="l02301"></a><span class="lineno"><a class="line" href="lodepng_8h.html#a1e3ab3e373966fd2c323bd5a698ccfb1"> 2301</a></span>&#160;<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="lodepng_8cpp.html#a1e3ab3e373966fd2c323bd5a698ccfb1">LodePNG_chunk_type_equals</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* chunk, <span class="keyword">const</span> <span class="keywordtype">char</span>* <a class="code" href="_d_l_l_imports_8inl.html#a1d14bae93fe47a03f0ace206fef6a34e">type</a>)</div>
<div class="line"><a name="l02302"></a><span class="lineno"> 2302</span>&#160;{</div>
<div class="line"><a name="l02303"></a><span class="lineno"> 2303</span>&#160;  <span class="keywordflow">if</span>(strlen(type) != 4) <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l02304"></a><span class="lineno"> 2304</span>&#160;  <span class="keywordflow">return</span> (chunk[4] == type[0] &amp;&amp; chunk[5] == type[1] &amp;&amp; chunk[6] == type[2] &amp;&amp; chunk[7] == type[3]);</div>
<div class="line"><a name="l02305"></a><span class="lineno"> 2305</span>&#160;}</div>
<div class="line"><a name="l02306"></a><span class="lineno"> 2306</span>&#160;</div>
<div class="line"><a name="l02307"></a><span class="lineno"><a class="line" href="lodepng_8h.html#abaf9330852c93cddc2e633f975e56193"> 2307</a></span>&#160;<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="lodepng_8cpp.html#abaf9330852c93cddc2e633f975e56193">LodePNG_chunk_critical</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* chunk)</div>
<div class="line"><a name="l02308"></a><span class="lineno"> 2308</span>&#160;{</div>
<div class="line"><a name="l02309"></a><span class="lineno"> 2309</span>&#160;  <span class="keywordflow">return</span>((chunk[4] &amp; 32) == 0);</div>
<div class="line"><a name="l02310"></a><span class="lineno"> 2310</span>&#160;}</div>
<div class="line"><a name="l02311"></a><span class="lineno"> 2311</span>&#160;</div>
<div class="line"><a name="l02312"></a><span class="lineno"><a class="line" href="lodepng_8h.html#a08a6b93d30eb7ee67b9c0788436b3bd6"> 2312</a></span>&#160;<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="lodepng_8cpp.html#a08a6b93d30eb7ee67b9c0788436b3bd6">LodePNG_chunk_private</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* chunk)</div>
<div class="line"><a name="l02313"></a><span class="lineno"> 2313</span>&#160;{</div>
<div class="line"><a name="l02314"></a><span class="lineno"> 2314</span>&#160;  <span class="keywordflow">return</span>((chunk[6] &amp; 32) != 0);</div>
<div class="line"><a name="l02315"></a><span class="lineno"> 2315</span>&#160;}</div>
<div class="line"><a name="l02316"></a><span class="lineno"> 2316</span>&#160;</div>
<div class="line"><a name="l02317"></a><span class="lineno"><a class="line" href="lodepng_8h.html#af89aa48b710fa002d71884069726bf8c"> 2317</a></span>&#160;<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="lodepng_8cpp.html#af89aa48b710fa002d71884069726bf8c">LodePNG_chunk_safetocopy</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* chunk)</div>
<div class="line"><a name="l02318"></a><span class="lineno"> 2318</span>&#160;{</div>
<div class="line"><a name="l02319"></a><span class="lineno"> 2319</span>&#160;  <span class="keywordflow">return</span>((chunk[7] &amp; 32) != 0);</div>
<div class="line"><a name="l02320"></a><span class="lineno"> 2320</span>&#160;}</div>
<div class="line"><a name="l02321"></a><span class="lineno"> 2321</span>&#160;</div>
<div class="line"><a name="l02322"></a><span class="lineno"><a class="line" href="lodepng_8h.html#a5f9dec8a5637a646a41821af36faa152"> 2322</a></span>&#160;<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* <a class="code" href="lodepng_8cpp.html#a5f9dec8a5637a646a41821af36faa152">LodePNG_chunk_data</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* chunk)</div>
<div class="line"><a name="l02323"></a><span class="lineno"> 2323</span>&#160;{</div>
<div class="line"><a name="l02324"></a><span class="lineno"> 2324</span>&#160;  <span class="keywordflow">return</span> &amp;chunk[8];</div>
<div class="line"><a name="l02325"></a><span class="lineno"> 2325</span>&#160;}</div>
<div class="line"><a name="l02326"></a><span class="lineno"> 2326</span>&#160;</div>
<div class="line"><a name="l02327"></a><span class="lineno"><a class="line" href="lodepng_8h.html#ab2b9a3341171c2cd4a31bdff0211f007"> 2327</a></span>&#160;<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* <a class="code" href="lodepng_8cpp.html#ab2b9a3341171c2cd4a31bdff0211f007">LodePNG_chunk_data_const</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* chunk)</div>
<div class="line"><a name="l02328"></a><span class="lineno"> 2328</span>&#160;{</div>
<div class="line"><a name="l02329"></a><span class="lineno"> 2329</span>&#160;  <span class="keywordflow">return</span> &amp;chunk[8];</div>
<div class="line"><a name="l02330"></a><span class="lineno"> 2330</span>&#160;}</div>
<div class="line"><a name="l02331"></a><span class="lineno"> 2331</span>&#160;</div>
<div class="line"><a name="l02332"></a><span class="lineno"><a class="line" href="lodepng_8h.html#a1d08e922a7f80b5afcde010489db6579"> 2332</a></span>&#160;<span class="keywordtype">unsigned</span> <a class="code" href="lodepng_8cpp.html#a1d08e922a7f80b5afcde010489db6579">LodePNG_chunk_check_crc</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* chunk)</div>
<div class="line"><a name="l02333"></a><span class="lineno"> 2333</span>&#160;{</div>
<div class="line"><a name="l02334"></a><span class="lineno"> 2334</span>&#160;  <span class="keywordtype">unsigned</span> length = <a class="code" href="lodepng_8cpp.html#a4e9b1ed7e3242b335ddd8b4a0aba161f">LodePNG_chunk_length</a>(chunk);</div>
<div class="line"><a name="l02335"></a><span class="lineno"> 2335</span>&#160;  <span class="keywordtype">unsigned</span> CRC = <a class="code" href="lodepng_8cpp.html#a347e6964b32f99efb902fbf7b1a9d934">LodePNG_read32bitInt</a>(&amp;chunk[length + 8]);</div>
<div class="line"><a name="l02336"></a><span class="lineno"> 2336</span>&#160;  <span class="comment">/*the CRC is taken of the data and the 4 chunk type letters, not the length*/</span></div>
<div class="line"><a name="l02337"></a><span class="lineno"> 2337</span>&#160;  <span class="keywordtype">unsigned</span> checksum = Crc32_crc(&amp;chunk[4], length + 4);</div>
<div class="line"><a name="l02338"></a><span class="lineno"> 2338</span>&#160;  <span class="keywordflow">if</span>(CRC != checksum) <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l02339"></a><span class="lineno"> 2339</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l02340"></a><span class="lineno"> 2340</span>&#160;}</div>
<div class="line"><a name="l02341"></a><span class="lineno"> 2341</span>&#160;</div>
<div class="line"><a name="l02342"></a><span class="lineno"><a class="line" href="lodepng_8h.html#a35e023707c907e36ad1435754cfbb4da"> 2342</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="lodepng_8cpp.html#a35e023707c907e36ad1435754cfbb4da">LodePNG_chunk_generate_crc</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* chunk)</div>
<div class="line"><a name="l02343"></a><span class="lineno"> 2343</span>&#160;{</div>
<div class="line"><a name="l02344"></a><span class="lineno"> 2344</span>&#160;  <span class="keywordtype">unsigned</span> length = <a class="code" href="lodepng_8cpp.html#a4e9b1ed7e3242b335ddd8b4a0aba161f">LodePNG_chunk_length</a>(chunk);</div>
<div class="line"><a name="l02345"></a><span class="lineno"> 2345</span>&#160;  <span class="keywordtype">unsigned</span> CRC = Crc32_crc(&amp;chunk[4], length + 4);</div>
<div class="line"><a name="l02346"></a><span class="lineno"> 2346</span>&#160;  LodePNG_set32bitInt(chunk + 8 + length, CRC);</div>
<div class="line"><a name="l02347"></a><span class="lineno"> 2347</span>&#160;}</div>
<div class="line"><a name="l02348"></a><span class="lineno"> 2348</span>&#160;</div>
<div class="line"><a name="l02349"></a><span class="lineno"><a class="line" href="lodepng_8h.html#ab1a96344114c67ce549c848c44a9597b"> 2349</a></span>&#160;<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* <a class="code" href="lodepng_8cpp.html#ab1a96344114c67ce549c848c44a9597b">LodePNG_chunk_next</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* chunk)</div>
<div class="line"><a name="l02350"></a><span class="lineno"> 2350</span>&#160;{</div>
<div class="line"><a name="l02351"></a><span class="lineno"> 2351</span>&#160;  <span class="keywordtype">unsigned</span> total_chunk_length = <a class="code" href="lodepng_8cpp.html#a4e9b1ed7e3242b335ddd8b4a0aba161f">LodePNG_chunk_length</a>(chunk) + 12;</div>
<div class="line"><a name="l02352"></a><span class="lineno"> 2352</span>&#160;  <span class="keywordflow">return</span> &amp;chunk[total_chunk_length];</div>
<div class="line"><a name="l02353"></a><span class="lineno"> 2353</span>&#160;}</div>
<div class="line"><a name="l02354"></a><span class="lineno"> 2354</span>&#160;</div>
<div class="line"><a name="l02355"></a><span class="lineno"><a class="line" href="lodepng_8h.html#a16e9565fa7d5805df2256db07ed49177"> 2355</a></span>&#160;<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* <a class="code" href="lodepng_8cpp.html#a16e9565fa7d5805df2256db07ed49177">LodePNG_chunk_next_const</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* chunk)</div>
<div class="line"><a name="l02356"></a><span class="lineno"> 2356</span>&#160;{</div>
<div class="line"><a name="l02357"></a><span class="lineno"> 2357</span>&#160;  <span class="keywordtype">unsigned</span> total_chunk_length = <a class="code" href="lodepng_8cpp.html#a4e9b1ed7e3242b335ddd8b4a0aba161f">LodePNG_chunk_length</a>(chunk) + 12;</div>
<div class="line"><a name="l02358"></a><span class="lineno"> 2358</span>&#160;  <span class="keywordflow">return</span> &amp;chunk[total_chunk_length];</div>
<div class="line"><a name="l02359"></a><span class="lineno"> 2359</span>&#160;}</div>
<div class="line"><a name="l02360"></a><span class="lineno"> 2360</span>&#160;</div>
<div class="line"><a name="l02361"></a><span class="lineno"><a class="line" href="lodepng_8h.html#a8047414db7062af3671e20c90a4a4ae7"> 2361</a></span>&#160;<span class="keywordtype">unsigned</span> <a class="code" href="lodepng_8cpp.html#a8047414db7062af3671e20c90a4a4ae7">LodePNG_append_chunk</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>** out, <span class="keywordtype">size_t</span>* outlength, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* chunk)</div>
<div class="line"><a name="l02362"></a><span class="lineno"> 2362</span>&#160;{</div>
<div class="line"><a name="l02363"></a><span class="lineno"> 2363</span>&#160;  <span class="keywordtype">unsigned</span> i;</div>
<div class="line"><a name="l02364"></a><span class="lineno"> 2364</span>&#160;  <span class="keywordtype">unsigned</span> total_chunk_length = <a class="code" href="lodepng_8cpp.html#a4e9b1ed7e3242b335ddd8b4a0aba161f">LodePNG_chunk_length</a>(chunk) + 12;</div>
<div class="line"><a name="l02365"></a><span class="lineno"> 2365</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *chunk_start, *new_buffer;</div>
<div class="line"><a name="l02366"></a><span class="lineno"> 2366</span>&#160;  <span class="keywordtype">size_t</span> new_length = (*outlength) + total_chunk_length;</div>
<div class="line"><a name="l02367"></a><span class="lineno"> 2367</span>&#160;  <span class="keywordflow">if</span>(new_length &lt; total_chunk_length || new_length &lt; (*outlength)) <span class="keywordflow">return</span> 77; <span class="comment">/*integer overflow happened*/</span></div>
<div class="line"><a name="l02368"></a><span class="lineno"> 2368</span>&#160;</div>
<div class="line"><a name="l02369"></a><span class="lineno"> 2369</span>&#160;  new_buffer = (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>*)<a class="code" href="namespace_f_w.html#a1c91e4066f0cc4e93981c3a04a229198">realloc</a>(*out, new_length);</div>
<div class="line"><a name="l02370"></a><span class="lineno"> 2370</span>&#160;  <span class="keywordflow">if</span>(!new_buffer) <span class="keywordflow">return</span> 9929; <span class="comment">/*alloc fail*/</span></div>
<div class="line"><a name="l02371"></a><span class="lineno"> 2371</span>&#160;  (*out) = new_buffer;</div>
<div class="line"><a name="l02372"></a><span class="lineno"> 2372</span>&#160;  (*outlength) = new_length;</div>
<div class="line"><a name="l02373"></a><span class="lineno"> 2373</span>&#160;  chunk_start = &amp;(*out)[new_length - total_chunk_length];</div>
<div class="line"><a name="l02374"></a><span class="lineno"> 2374</span>&#160;</div>
<div class="line"><a name="l02375"></a><span class="lineno"> 2375</span>&#160;  <span class="keywordflow">for</span>(i = 0; i &lt; total_chunk_length; i++) chunk_start[i] = chunk[i];</div>
<div class="line"><a name="l02376"></a><span class="lineno"> 2376</span>&#160;</div>
<div class="line"><a name="l02377"></a><span class="lineno"> 2377</span>&#160;  <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l02378"></a><span class="lineno"> 2378</span>&#160;}</div>
<div class="line"><a name="l02379"></a><span class="lineno"> 2379</span>&#160;</div>
<div class="line"><a name="l02380"></a><span class="lineno"><a class="line" href="lodepng_8h.html#a75457d20497de64abea3a34daefc4f8c"> 2380</a></span>&#160;<span class="keywordtype">unsigned</span> <a class="code" href="lodepng_8cpp.html#a75457d20497de64abea3a34daefc4f8c">LodePNG_create_chunk</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>** out, <span class="keywordtype">size_t</span>* outlength, <span class="keywordtype">unsigned</span> length,</div>
<div class="line"><a name="l02381"></a><span class="lineno"> 2381</span>&#160;                              <span class="keyword">const</span> <span class="keywordtype">char</span>* <a class="code" href="_d_l_l_imports_8inl.html#a1d14bae93fe47a03f0ace206fef6a34e">type</a>, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* data)</div>
<div class="line"><a name="l02382"></a><span class="lineno"> 2382</span>&#160;{</div>
<div class="line"><a name="l02383"></a><span class="lineno"> 2383</span>&#160;  <span class="keywordtype">unsigned</span> i;</div>
<div class="line"><a name="l02384"></a><span class="lineno"> 2384</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *chunk, *new_buffer;</div>
<div class="line"><a name="l02385"></a><span class="lineno"> 2385</span>&#160;  <span class="keywordtype">size_t</span> new_length = (*outlength) + length + 12;</div>
<div class="line"><a name="l02386"></a><span class="lineno"> 2386</span>&#160;  <span class="keywordflow">if</span>(new_length &lt; length + 12 || new_length &lt; (*outlength)) <span class="keywordflow">return</span> 77; <span class="comment">/*integer overflow happened*/</span></div>
<div class="line"><a name="l02387"></a><span class="lineno"> 2387</span>&#160;  new_buffer = (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>*)<a class="code" href="namespace_f_w.html#a1c91e4066f0cc4e93981c3a04a229198">realloc</a>(*out, new_length);</div>
<div class="line"><a name="l02388"></a><span class="lineno"> 2388</span>&#160;  <span class="keywordflow">if</span>(!new_buffer) <span class="keywordflow">return</span> 9930; <span class="comment">/*alloc fail*/</span></div>
<div class="line"><a name="l02389"></a><span class="lineno"> 2389</span>&#160;  (*out) = new_buffer;</div>
<div class="line"><a name="l02390"></a><span class="lineno"> 2390</span>&#160;  (*outlength) = new_length;</div>
<div class="line"><a name="l02391"></a><span class="lineno"> 2391</span>&#160;  chunk = &amp;(*out)[(*outlength) - length - 12];</div>
<div class="line"><a name="l02392"></a><span class="lineno"> 2392</span>&#160;</div>
<div class="line"><a name="l02393"></a><span class="lineno"> 2393</span>&#160;  <span class="comment">/*1: length*/</span></div>
<div class="line"><a name="l02394"></a><span class="lineno"> 2394</span>&#160;  LodePNG_set32bitInt(chunk, (<span class="keywordtype">unsigned</span>)length);</div>
<div class="line"><a name="l02395"></a><span class="lineno"> 2395</span>&#160;</div>
<div class="line"><a name="l02396"></a><span class="lineno"> 2396</span>&#160;  <span class="comment">/*2: chunk name (4 letters)*/</span></div>
<div class="line"><a name="l02397"></a><span class="lineno"> 2397</span>&#160;  chunk[4] = type[0];</div>
<div class="line"><a name="l02398"></a><span class="lineno"> 2398</span>&#160;  chunk[5] = type[1];</div>
<div class="line"><a name="l02399"></a><span class="lineno"> 2399</span>&#160;  chunk[6] = type[2];</div>
<div class="line"><a name="l02400"></a><span class="lineno"> 2400</span>&#160;  chunk[7] = type[3];</div>
<div class="line"><a name="l02401"></a><span class="lineno"> 2401</span>&#160;</div>
<div class="line"><a name="l02402"></a><span class="lineno"> 2402</span>&#160;  <span class="comment">/*3: the data*/</span></div>
<div class="line"><a name="l02403"></a><span class="lineno"> 2403</span>&#160;  <span class="keywordflow">for</span>(i = 0; i &lt; <a class="code" href="_d_l_l_imports_8inl.html#a5720e2b8f4f85b31e0bab5a1b6e69c74">length</a>; i++) chunk[8 + i] = data[i];</div>
<div class="line"><a name="l02404"></a><span class="lineno"> 2404</span>&#160;</div>
<div class="line"><a name="l02405"></a><span class="lineno"> 2405</span>&#160;  <span class="comment">/*4: CRC (of the chunkname characters and the data)*/</span></div>
<div class="line"><a name="l02406"></a><span class="lineno"> 2406</span>&#160;  <a class="code" href="lodepng_8cpp.html#a35e023707c907e36ad1435754cfbb4da">LodePNG_chunk_generate_crc</a>(chunk);</div>
<div class="line"><a name="l02407"></a><span class="lineno"> 2407</span>&#160;</div>
<div class="line"><a name="l02408"></a><span class="lineno"> 2408</span>&#160;  <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l02409"></a><span class="lineno"> 2409</span>&#160;}</div>
<div class="line"><a name="l02410"></a><span class="lineno"> 2410</span>&#160;</div>
<div class="line"><a name="l02411"></a><span class="lineno"> 2411</span>&#160;<span class="comment">/* ////////////////////////////////////////////////////////////////////////// */</span></div>
<div class="line"><a name="l02412"></a><span class="lineno"> 2412</span>&#160;<span class="comment">/* / Color types and such                                                   / */</span></div>
<div class="line"><a name="l02413"></a><span class="lineno"> 2413</span>&#160;<span class="comment">/* ////////////////////////////////////////////////////////////////////////// */</span></div>
<div class="line"><a name="l02414"></a><span class="lineno"> 2414</span>&#160;</div>
<div class="line"><a name="l02415"></a><span class="lineno"> 2415</span>&#160;<span class="comment">/*return type is a LodePNG error code*/</span></div>
<div class="line"><a name="l02416"></a><span class="lineno"> 2416</span>&#160;<span class="keyword">static</span> <span class="keywordtype">unsigned</span> checkColorValidity(<span class="keywordtype">unsigned</span> colorType, <span class="keywordtype">unsigned</span> bd) <span class="comment">/*bd = bitDepth*/</span></div>
<div class="line"><a name="l02417"></a><span class="lineno"> 2417</span>&#160;{</div>
<div class="line"><a name="l02418"></a><span class="lineno"> 2418</span>&#160;  <span class="keywordflow">switch</span>(colorType)</div>
<div class="line"><a name="l02419"></a><span class="lineno"> 2419</span>&#160;  {</div>
<div class="line"><a name="l02420"></a><span class="lineno"> 2420</span>&#160;    <span class="keywordflow">case</span> 0: <span class="keywordflow">if</span>(!(bd == 1 || bd == 2 || bd == 4 || bd == 8 || bd == 16)) <span class="keywordflow">return</span> 37; <span class="keywordflow">break</span>; <span class="comment">/*grey*/</span></div>
<div class="line"><a name="l02421"></a><span class="lineno"> 2421</span>&#160;    <span class="keywordflow">case</span> 2: <span class="keywordflow">if</span>(!(                                 bd == 8 || bd == 16)) <span class="keywordflow">return</span> 37; <span class="keywordflow">break</span>; <span class="comment">/*RGB*/</span></div>
<div class="line"><a name="l02422"></a><span class="lineno"> 2422</span>&#160;    <span class="keywordflow">case</span> 3: <span class="keywordflow">if</span>(!(bd == 1 || bd == 2 || bd == 4 || bd == 8            )) <span class="keywordflow">return</span> 37; <span class="keywordflow">break</span>; <span class="comment">/*palette*/</span></div>
<div class="line"><a name="l02423"></a><span class="lineno"> 2423</span>&#160;    <span class="keywordflow">case</span> 4: <span class="keywordflow">if</span>(!(                                 bd == 8 || bd == 16)) <span class="keywordflow">return</span> 37; <span class="keywordflow">break</span>; <span class="comment">/*grey + alpha*/</span></div>
<div class="line"><a name="l02424"></a><span class="lineno"> 2424</span>&#160;    <span class="keywordflow">case</span> 6: <span class="keywordflow">if</span>(!(                                 bd == 8 || bd == 16)) <span class="keywordflow">return</span> 37; <span class="keywordflow">break</span>; <span class="comment">/*RGBA*/</span></div>
<div class="line"><a name="l02425"></a><span class="lineno"> 2425</span>&#160;    <span class="keywordflow">default</span>: <span class="keywordflow">return</span> 31;</div>
<div class="line"><a name="l02426"></a><span class="lineno"> 2426</span>&#160;  }</div>
<div class="line"><a name="l02427"></a><span class="lineno"> 2427</span>&#160;  <span class="keywordflow">return</span> 0; <span class="comment">/*allowed color type / bits combination*/</span></div>
<div class="line"><a name="l02428"></a><span class="lineno"> 2428</span>&#160;}</div>
<div class="line"><a name="l02429"></a><span class="lineno"> 2429</span>&#160;</div>
<div class="line"><a name="l02430"></a><span class="lineno"> 2430</span>&#160;<span class="keyword">static</span> <span class="keywordtype">unsigned</span> getNumColorChannels(<span class="keywordtype">unsigned</span> colorType)</div>
<div class="line"><a name="l02431"></a><span class="lineno"> 2431</span>&#160;{</div>
<div class="line"><a name="l02432"></a><span class="lineno"> 2432</span>&#160;  <span class="keywordflow">switch</span>(colorType)</div>
<div class="line"><a name="l02433"></a><span class="lineno"> 2433</span>&#160;  {</div>
<div class="line"><a name="l02434"></a><span class="lineno"> 2434</span>&#160;    <span class="keywordflow">case</span> 0: <span class="keywordflow">return</span> 1; <span class="comment">/*grey*/</span></div>
<div class="line"><a name="l02435"></a><span class="lineno"> 2435</span>&#160;    <span class="keywordflow">case</span> 2: <span class="keywordflow">return</span> 3; <span class="comment">/*RGB*/</span></div>
<div class="line"><a name="l02436"></a><span class="lineno"> 2436</span>&#160;    <span class="keywordflow">case</span> 3: <span class="keywordflow">return</span> 1; <span class="comment">/*palette*/</span></div>
<div class="line"><a name="l02437"></a><span class="lineno"> 2437</span>&#160;    <span class="keywordflow">case</span> 4: <span class="keywordflow">return</span> 2; <span class="comment">/*grey + alpha*/</span></div>
<div class="line"><a name="l02438"></a><span class="lineno"> 2438</span>&#160;    <span class="keywordflow">case</span> 6: <span class="keywordflow">return</span> 4; <span class="comment">/*RGBA*/</span></div>
<div class="line"><a name="l02439"></a><span class="lineno"> 2439</span>&#160;  }</div>
<div class="line"><a name="l02440"></a><span class="lineno"> 2440</span>&#160;  <span class="keywordflow">return</span> 0; <span class="comment">/*unexisting color type*/</span></div>
<div class="line"><a name="l02441"></a><span class="lineno"> 2441</span>&#160;}</div>
<div class="line"><a name="l02442"></a><span class="lineno"> 2442</span>&#160;</div>
<div class="line"><a name="l02443"></a><span class="lineno"> 2443</span>&#160;<span class="keyword">static</span> <span class="keywordtype">unsigned</span> getBpp(<span class="keywordtype">unsigned</span> colorType, <span class="keywordtype">unsigned</span> bitDepth)</div>
<div class="line"><a name="l02444"></a><span class="lineno"> 2444</span>&#160;{</div>
<div class="line"><a name="l02445"></a><span class="lineno"> 2445</span>&#160;  <span class="comment">/*bits per pixel is amount of channels * bits per channel*/</span></div>
<div class="line"><a name="l02446"></a><span class="lineno"> 2446</span>&#160;  <span class="keywordflow">return</span> getNumColorChannels(colorType) * bitDepth;</div>
<div class="line"><a name="l02447"></a><span class="lineno"> 2447</span>&#160;}</div>
<div class="line"><a name="l02448"></a><span class="lineno"> 2448</span>&#160;</div>
<div class="line"><a name="l02449"></a><span class="lineno"> 2449</span>&#160;<span class="comment">/* ////////////////////////////////////////////////////////////////////////// */</span></div>
<div class="line"><a name="l02450"></a><span class="lineno"> 2450</span>&#160;</div>
<div class="line"><a name="l02451"></a><span class="lineno"><a class="line" href="lodepng_8h.html#abaea3ca539b3d5f1624ac8286f47b34c"> 2451</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="lodepng_8cpp.html#abaea3ca539b3d5f1624ac8286f47b34c">LodePNG_InfoColor_init</a>(<a class="code" href="struct_lode_p_n_g___info_color.html">LodePNG_InfoColor</a>* info)</div>
<div class="line"><a name="l02452"></a><span class="lineno"> 2452</span>&#160;{</div>
<div class="line"><a name="l02453"></a><span class="lineno"> 2453</span>&#160;  info-&gt;<a class="code" href="struct_lode_p_n_g___info_color.html#aa0193ce13025c776a0dfb1e6d1bed14a">key_defined</a> = 0;</div>
<div class="line"><a name="l02454"></a><span class="lineno"> 2454</span>&#160;  info-&gt;<a class="code" href="struct_lode_p_n_g___info_color.html#a5536a8859201cd11df789ec7ad8263df">key_r</a> = info-&gt;<a class="code" href="struct_lode_p_n_g___info_color.html#a44bf4906335328972acebd6c8b83a073">key_g</a> = info-&gt;<a class="code" href="struct_lode_p_n_g___info_color.html#a9f99cc5b4366f1eed325d13b4f191560">key_b</a> = 0;</div>
<div class="line"><a name="l02455"></a><span class="lineno"> 2455</span>&#160;  info-&gt;<a class="code" href="struct_lode_p_n_g___info_color.html#a4ed18d179c5078137a18e742b1c41a00">colorType</a> = 6;</div>
<div class="line"><a name="l02456"></a><span class="lineno"> 2456</span>&#160;  info-&gt;<a class="code" href="struct_lode_p_n_g___info_color.html#a9d538965a46d59bbdea744da8b290591">bitDepth</a> = 8;</div>
<div class="line"><a name="l02457"></a><span class="lineno"> 2457</span>&#160;  info-&gt;<a class="code" href="struct_lode_p_n_g___info_color.html#ac6de7ff58cb1f39a73567abb826f72f5">palette</a> = 0;</div>
<div class="line"><a name="l02458"></a><span class="lineno"> 2458</span>&#160;  info-&gt;<a class="code" href="struct_lode_p_n_g___info_color.html#a49842a304ffd0abc8aa791030c5fa5dd">palettesize</a> = 0;</div>
<div class="line"><a name="l02459"></a><span class="lineno"> 2459</span>&#160;}</div>
<div class="line"><a name="l02460"></a><span class="lineno"> 2460</span>&#160;</div>
<div class="line"><a name="l02461"></a><span class="lineno"><a class="line" href="lodepng_8h.html#a2f5ecf25393f688611987c61f698f1ce"> 2461</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="lodepng_8cpp.html#a2f5ecf25393f688611987c61f698f1ce">LodePNG_InfoColor_cleanup</a>(<a class="code" href="struct_lode_p_n_g___info_color.html">LodePNG_InfoColor</a>* info)</div>
<div class="line"><a name="l02462"></a><span class="lineno"> 2462</span>&#160;{</div>
<div class="line"><a name="l02463"></a><span class="lineno"> 2463</span>&#160;  <a class="code" href="lodepng_8cpp.html#ac78fd072f3dcc91ee6e3a250cfa64ea5">LodePNG_InfoColor_clearPalette</a>(info);</div>
<div class="line"><a name="l02464"></a><span class="lineno"> 2464</span>&#160;}</div>
<div class="line"><a name="l02465"></a><span class="lineno"> 2465</span>&#160;</div>
<div class="line"><a name="l02466"></a><span class="lineno"><a class="line" href="lodepng_8h.html#ac78fd072f3dcc91ee6e3a250cfa64ea5"> 2466</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="lodepng_8cpp.html#ac78fd072f3dcc91ee6e3a250cfa64ea5">LodePNG_InfoColor_clearPalette</a>(<a class="code" href="struct_lode_p_n_g___info_color.html">LodePNG_InfoColor</a>* info)</div>
<div class="line"><a name="l02467"></a><span class="lineno"> 2467</span>&#160;{</div>
<div class="line"><a name="l02468"></a><span class="lineno"> 2468</span>&#160;  <span class="keywordflow">if</span>(info-&gt;<a class="code" href="struct_lode_p_n_g___info_color.html#ac6de7ff58cb1f39a73567abb826f72f5">palette</a>) <a class="code" href="namespace_f_w.html#a93be8f55938d6ffb5ca0af1f95f81589">free</a>(info-&gt;<a class="code" href="struct_lode_p_n_g___info_color.html#ac6de7ff58cb1f39a73567abb826f72f5">palette</a>);</div>
<div class="line"><a name="l02469"></a><span class="lineno"> 2469</span>&#160;  info-&gt;<a class="code" href="struct_lode_p_n_g___info_color.html#a49842a304ffd0abc8aa791030c5fa5dd">palettesize</a> = 0;</div>
<div class="line"><a name="l02470"></a><span class="lineno"> 2470</span>&#160;}</div>
<div class="line"><a name="l02471"></a><span class="lineno"> 2471</span>&#160;</div>
<div class="line"><a name="l02472"></a><span class="lineno"><a class="line" href="lodepng_8h.html#af062c1db1f9e18f47aa2d9a86651dea3"> 2472</a></span>&#160;<span class="keywordtype">unsigned</span> <a class="code" href="lodepng_8cpp.html#af062c1db1f9e18f47aa2d9a86651dea3">LodePNG_InfoColor_addPalette</a>(<a class="code" href="struct_lode_p_n_g___info_color.html">LodePNG_InfoColor</a>* info,</div>
<div class="line"><a name="l02473"></a><span class="lineno"> 2473</span>&#160;                                      <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> r, <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> g, <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> b, <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> a)</div>
<div class="line"><a name="l02474"></a><span class="lineno"> 2474</span>&#160;{</div>
<div class="line"><a name="l02475"></a><span class="lineno"> 2475</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* <a class="code" href="_d_l_l_imports_8inl.html#a156a9c7e986e0352d0fe500e629d5171">data</a>;</div>
<div class="line"><a name="l02476"></a><span class="lineno"> 2476</span>&#160;  <span class="comment">/*the same resize technique as C++ std::vectors is used, and here it&#39;s made so that for a palette with</span></div>
<div class="line"><a name="l02477"></a><span class="lineno"> 2477</span>&#160;<span class="comment">  the max of 256 colors, it&#39;ll have the exact alloc size*/</span></div>
<div class="line"><a name="l02478"></a><span class="lineno"> 2478</span>&#160;  <span class="keywordflow">if</span>(!(info-&gt;<a class="code" href="struct_lode_p_n_g___info_color.html#a49842a304ffd0abc8aa791030c5fa5dd">palettesize</a> &amp; (info-&gt;<a class="code" href="struct_lode_p_n_g___info_color.html#a49842a304ffd0abc8aa791030c5fa5dd">palettesize</a> - 1))) <span class="comment">/*if palettesize is 0 or a power of two*/</span></div>
<div class="line"><a name="l02479"></a><span class="lineno"> 2479</span>&#160;  {</div>
<div class="line"><a name="l02480"></a><span class="lineno"> 2480</span>&#160;    <span class="comment">/*allocated data must be at least 4* palettesize (for 4 color bytes)*/</span></div>
<div class="line"><a name="l02481"></a><span class="lineno"> 2481</span>&#160;    <span class="keywordtype">size_t</span> alloc_size = info-&gt;<a class="code" href="struct_lode_p_n_g___info_color.html#a49842a304ffd0abc8aa791030c5fa5dd">palettesize</a> == 0 ? 4 : info-&gt;<a class="code" href="struct_lode_p_n_g___info_color.html#a49842a304ffd0abc8aa791030c5fa5dd">palettesize</a> * 4 * 2;</div>
<div class="line"><a name="l02482"></a><span class="lineno"> 2482</span>&#160;    data = (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>*)<a class="code" href="namespace_f_w.html#a1c91e4066f0cc4e93981c3a04a229198">realloc</a>(info-&gt;<a class="code" href="struct_lode_p_n_g___info_color.html#ac6de7ff58cb1f39a73567abb826f72f5">palette</a>, alloc_size);</div>
<div class="line"><a name="l02483"></a><span class="lineno"> 2483</span>&#160;    <span class="keywordflow">if</span>(!data) <span class="keywordflow">return</span> 9931; <span class="comment">/*alloc fail*/</span></div>
<div class="line"><a name="l02484"></a><span class="lineno"> 2484</span>&#160;    <span class="keywordflow">else</span> info-&gt;<a class="code" href="struct_lode_p_n_g___info_color.html#ac6de7ff58cb1f39a73567abb826f72f5">palette</a> = <a class="code" href="_d_l_l_imports_8inl.html#a156a9c7e986e0352d0fe500e629d5171">data</a>;</div>
<div class="line"><a name="l02485"></a><span class="lineno"> 2485</span>&#160;  }</div>
<div class="line"><a name="l02486"></a><span class="lineno"> 2486</span>&#160;  info-&gt;<a class="code" href="struct_lode_p_n_g___info_color.html#ac6de7ff58cb1f39a73567abb826f72f5">palette</a>[4 * info-&gt;<a class="code" href="struct_lode_p_n_g___info_color.html#a49842a304ffd0abc8aa791030c5fa5dd">palettesize</a> + 0] = r;</div>
<div class="line"><a name="l02487"></a><span class="lineno"> 2487</span>&#160;  info-&gt;<a class="code" href="struct_lode_p_n_g___info_color.html#ac6de7ff58cb1f39a73567abb826f72f5">palette</a>[4 * info-&gt;<a class="code" href="struct_lode_p_n_g___info_color.html#a49842a304ffd0abc8aa791030c5fa5dd">palettesize</a> + 1] = g;</div>
<div class="line"><a name="l02488"></a><span class="lineno"> 2488</span>&#160;  info-&gt;<a class="code" href="struct_lode_p_n_g___info_color.html#ac6de7ff58cb1f39a73567abb826f72f5">palette</a>[4 * info-&gt;<a class="code" href="struct_lode_p_n_g___info_color.html#a49842a304ffd0abc8aa791030c5fa5dd">palettesize</a> + 2] = b;</div>
<div class="line"><a name="l02489"></a><span class="lineno"> 2489</span>&#160;  info-&gt;<a class="code" href="struct_lode_p_n_g___info_color.html#ac6de7ff58cb1f39a73567abb826f72f5">palette</a>[4 * info-&gt;<a class="code" href="struct_lode_p_n_g___info_color.html#a49842a304ffd0abc8aa791030c5fa5dd">palettesize</a> + 3] = a;</div>
<div class="line"><a name="l02490"></a><span class="lineno"> 2490</span>&#160;  info-&gt;<a class="code" href="struct_lode_p_n_g___info_color.html#a49842a304ffd0abc8aa791030c5fa5dd">palettesize</a>++;</div>
<div class="line"><a name="l02491"></a><span class="lineno"> 2491</span>&#160;  <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l02492"></a><span class="lineno"> 2492</span>&#160;}</div>
<div class="line"><a name="l02493"></a><span class="lineno"> 2493</span>&#160;</div>
<div class="line"><a name="l02494"></a><span class="lineno"><a class="line" href="lodepng_8h.html#a81151c0087467b4ac2a815b3234fdb5a"> 2494</a></span>&#160;<span class="keywordtype">unsigned</span> <a class="code" href="lodepng_8cpp.html#a81151c0087467b4ac2a815b3234fdb5a">LodePNG_InfoColor_getBpp</a>(<span class="keyword">const</span> <a class="code" href="struct_lode_p_n_g___info_color.html">LodePNG_InfoColor</a>* info)</div>
<div class="line"><a name="l02495"></a><span class="lineno"> 2495</span>&#160;{</div>
<div class="line"><a name="l02496"></a><span class="lineno"> 2496</span>&#160;  <span class="comment">/*calculate bits per pixel out of colorType and bitDepth*/</span></div>
<div class="line"><a name="l02497"></a><span class="lineno"> 2497</span>&#160;  <span class="keywordflow">return</span> getBpp(info-&gt;<a class="code" href="struct_lode_p_n_g___info_color.html#a4ed18d179c5078137a18e742b1c41a00">colorType</a>, info-&gt;<a class="code" href="struct_lode_p_n_g___info_color.html#a9d538965a46d59bbdea744da8b290591">bitDepth</a>);</div>
<div class="line"><a name="l02498"></a><span class="lineno"> 2498</span>&#160;}</div>
<div class="line"><a name="l02499"></a><span class="lineno"> 2499</span>&#160;</div>
<div class="line"><a name="l02500"></a><span class="lineno"><a class="line" href="lodepng_8h.html#a62159dfd6cf8a67b55d5bbc70fee589b"> 2500</a></span>&#160;<span class="keywordtype">unsigned</span> <a class="code" href="lodepng_8cpp.html#a62159dfd6cf8a67b55d5bbc70fee589b">LodePNG_InfoColor_getChannels</a>(<span class="keyword">const</span> <a class="code" href="struct_lode_p_n_g___info_color.html">LodePNG_InfoColor</a>* info)</div>
<div class="line"><a name="l02501"></a><span class="lineno"> 2501</span>&#160;{</div>
<div class="line"><a name="l02502"></a><span class="lineno"> 2502</span>&#160;  <span class="keywordflow">return</span> getNumColorChannels(info-&gt;<a class="code" href="struct_lode_p_n_g___info_color.html#a4ed18d179c5078137a18e742b1c41a00">colorType</a>);</div>
<div class="line"><a name="l02503"></a><span class="lineno"> 2503</span>&#160;}</div>
<div class="line"><a name="l02504"></a><span class="lineno"> 2504</span>&#160;</div>
<div class="line"><a name="l02505"></a><span class="lineno"><a class="line" href="lodepng_8h.html#ac0564ed5cbac6fcfda3b28b3078cde65"> 2505</a></span>&#160;<span class="keywordtype">unsigned</span> <a class="code" href="lodepng_8cpp.html#ac0564ed5cbac6fcfda3b28b3078cde65">LodePNG_InfoColor_isGreyscaleType</a>(<span class="keyword">const</span> <a class="code" href="struct_lode_p_n_g___info_color.html">LodePNG_InfoColor</a>* info)</div>
<div class="line"><a name="l02506"></a><span class="lineno"> 2506</span>&#160;{</div>
<div class="line"><a name="l02507"></a><span class="lineno"> 2507</span>&#160;  <span class="keywordflow">return</span> info-&gt;<a class="code" href="struct_lode_p_n_g___info_color.html#a4ed18d179c5078137a18e742b1c41a00">colorType</a> == 0 || info-&gt;<a class="code" href="struct_lode_p_n_g___info_color.html#a4ed18d179c5078137a18e742b1c41a00">colorType</a> == 4;</div>
<div class="line"><a name="l02508"></a><span class="lineno"> 2508</span>&#160;}</div>
<div class="line"><a name="l02509"></a><span class="lineno"> 2509</span>&#160;</div>
<div class="line"><a name="l02510"></a><span class="lineno"><a class="line" href="lodepng_8h.html#af139bc36c2a9b88d21dc3652520a3f73"> 2510</a></span>&#160;<span class="keywordtype">unsigned</span> <a class="code" href="lodepng_8cpp.html#af139bc36c2a9b88d21dc3652520a3f73">LodePNG_InfoColor_isAlphaType</a>(<span class="keyword">const</span> <a class="code" href="struct_lode_p_n_g___info_color.html">LodePNG_InfoColor</a>* info)</div>
<div class="line"><a name="l02511"></a><span class="lineno"> 2511</span>&#160;{</div>
<div class="line"><a name="l02512"></a><span class="lineno"> 2512</span>&#160;  <span class="keywordflow">return</span> (info-&gt;<a class="code" href="struct_lode_p_n_g___info_color.html#a4ed18d179c5078137a18e742b1c41a00">colorType</a> &amp; 4) != 0;</div>
<div class="line"><a name="l02513"></a><span class="lineno"> 2513</span>&#160;}</div>
<div class="line"><a name="l02514"></a><span class="lineno"> 2514</span>&#160;</div>
<div class="line"><a name="l02515"></a><span class="lineno"><a class="line" href="lodepng_8h.html#a6bfc53fc461cddfd37ca800524985040"> 2515</a></span>&#160;<span class="keywordtype">unsigned</span> <a class="code" href="lodepng_8cpp.html#a6bfc53fc461cddfd37ca800524985040">LodePNG_InfoColor_isPaletteType</a>(<span class="keyword">const</span> <a class="code" href="struct_lode_p_n_g___info_color.html">LodePNG_InfoColor</a>* info)</div>
<div class="line"><a name="l02516"></a><span class="lineno"> 2516</span>&#160;{</div>
<div class="line"><a name="l02517"></a><span class="lineno"> 2517</span>&#160;  <span class="keywordflow">return</span> info-&gt;<a class="code" href="struct_lode_p_n_g___info_color.html#a4ed18d179c5078137a18e742b1c41a00">colorType</a> == 3;</div>
<div class="line"><a name="l02518"></a><span class="lineno"> 2518</span>&#160;}</div>
<div class="line"><a name="l02519"></a><span class="lineno"> 2519</span>&#160;</div>
<div class="line"><a name="l02520"></a><span class="lineno"><a class="line" href="lodepng_8h.html#aaf0b1dce9e5514b1d56509dcb6d57033"> 2520</a></span>&#160;<span class="keywordtype">unsigned</span> <a class="code" href="lodepng_8cpp.html#aaf0b1dce9e5514b1d56509dcb6d57033">LodePNG_InfoColor_hasPaletteAlpha</a>(<span class="keyword">const</span> <a class="code" href="struct_lode_p_n_g___info_color.html">LodePNG_InfoColor</a>* info)</div>
<div class="line"><a name="l02521"></a><span class="lineno"> 2521</span>&#160;{</div>
<div class="line"><a name="l02522"></a><span class="lineno"> 2522</span>&#160;  <span class="keywordtype">size_t</span> i;</div>
<div class="line"><a name="l02523"></a><span class="lineno"> 2523</span>&#160;  <span class="keywordflow">for</span>(i = 0; i &lt; info-&gt;<a class="code" href="struct_lode_p_n_g___info_color.html#a49842a304ffd0abc8aa791030c5fa5dd">palettesize</a>; i++)</div>
<div class="line"><a name="l02524"></a><span class="lineno"> 2524</span>&#160;  {</div>
<div class="line"><a name="l02525"></a><span class="lineno"> 2525</span>&#160;    <span class="keywordflow">if</span>(info-&gt;<a class="code" href="struct_lode_p_n_g___info_color.html#ac6de7ff58cb1f39a73567abb826f72f5">palette</a>[i * 4 + 3] &lt; 255) <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l02526"></a><span class="lineno"> 2526</span>&#160;  }</div>
<div class="line"><a name="l02527"></a><span class="lineno"> 2527</span>&#160;  <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l02528"></a><span class="lineno"> 2528</span>&#160;}</div>
<div class="line"><a name="l02529"></a><span class="lineno"> 2529</span>&#160;</div>
<div class="line"><a name="l02530"></a><span class="lineno"><a class="line" href="lodepng_8h.html#a6572f09bfc611dc6267a4af4e0770f28"> 2530</a></span>&#160;<span class="keywordtype">unsigned</span> <a class="code" href="lodepng_8cpp.html#a6572f09bfc611dc6267a4af4e0770f28">LodePNG_InfoColor_canHaveAlpha</a>(<span class="keyword">const</span> <a class="code" href="struct_lode_p_n_g___info_color.html">LodePNG_InfoColor</a>* info)</div>
<div class="line"><a name="l02531"></a><span class="lineno"> 2531</span>&#160;{</div>
<div class="line"><a name="l02532"></a><span class="lineno"> 2532</span>&#160;  <span class="keywordflow">return</span> info-&gt;<a class="code" href="struct_lode_p_n_g___info_color.html#aa0193ce13025c776a0dfb1e6d1bed14a">key_defined</a></div>
<div class="line"><a name="l02533"></a><span class="lineno"> 2533</span>&#160;      || <a class="code" href="lodepng_8cpp.html#af139bc36c2a9b88d21dc3652520a3f73">LodePNG_InfoColor_isAlphaType</a>(info)</div>
<div class="line"><a name="l02534"></a><span class="lineno"> 2534</span>&#160;      || <a class="code" href="lodepng_8cpp.html#aaf0b1dce9e5514b1d56509dcb6d57033">LodePNG_InfoColor_hasPaletteAlpha</a>(info);</div>
<div class="line"><a name="l02535"></a><span class="lineno"> 2535</span>&#160;}</div>
<div class="line"><a name="l02536"></a><span class="lineno"> 2536</span>&#160;</div>
<div class="line"><a name="l02537"></a><span class="lineno"><a class="line" href="lodepng_8cpp.html#ac1a87f6ae0de91fe9c7716ff5dc3fbea"> 2537</a></span>&#160;<span class="keywordtype">unsigned</span> <a class="code" href="lodepng_8cpp.html#ac1a87f6ae0de91fe9c7716ff5dc3fbea">LodePNG_InfoColor_equal</a>(<span class="keyword">const</span> <a class="code" href="struct_lode_p_n_g___info_color.html">LodePNG_InfoColor</a>* info1, <span class="keyword">const</span> <a class="code" href="struct_lode_p_n_g___info_color.html">LodePNG_InfoColor</a>* info2)</div>
<div class="line"><a name="l02538"></a><span class="lineno"> 2538</span>&#160;{</div>
<div class="line"><a name="l02539"></a><span class="lineno"> 2539</span>&#160;  <span class="keywordflow">return</span> info1-&gt;<a class="code" href="struct_lode_p_n_g___info_color.html#a4ed18d179c5078137a18e742b1c41a00">colorType</a> == info2-&gt;<a class="code" href="struct_lode_p_n_g___info_color.html#a4ed18d179c5078137a18e742b1c41a00">colorType</a></div>
<div class="line"><a name="l02540"></a><span class="lineno"> 2540</span>&#160;      &amp;&amp; info1-&gt;<a class="code" href="struct_lode_p_n_g___info_color.html#a9d538965a46d59bbdea744da8b290591">bitDepth</a>  == info2-&gt;<a class="code" href="struct_lode_p_n_g___info_color.html#a9d538965a46d59bbdea744da8b290591">bitDepth</a>; <span class="comment">/*palette and color key not compared*/</span></div>
<div class="line"><a name="l02541"></a><span class="lineno"> 2541</span>&#160;}</div>
<div class="line"><a name="l02542"></a><span class="lineno"> 2542</span>&#160;</div>
<div class="line"><a name="l02543"></a><span class="lineno"> 2543</span>&#160;<span class="preprocessor">#ifdef LODEPNG_COMPILE_UNKNOWN_CHUNKS</span></div>
<div class="line"><a name="l02544"></a><span class="lineno"><a class="line" href="lodepng_8h.html#a4af200ba997cfba6319267d2f970dfa3"> 2544</a></span>&#160;<span class="preprocessor"></span><span class="keywordtype">void</span> <a class="code" href="lodepng_8cpp.html#a4af200ba997cfba6319267d2f970dfa3">LodePNG_UnknownChunks_init</a>(<a class="code" href="struct_lode_p_n_g___unknown_chunks.html">LodePNG_UnknownChunks</a>* chunks)</div>
<div class="line"><a name="l02545"></a><span class="lineno"> 2545</span>&#160;{</div>
<div class="line"><a name="l02546"></a><span class="lineno"> 2546</span>&#160;  <span class="keywordtype">unsigned</span> i;</div>
<div class="line"><a name="l02547"></a><span class="lineno"> 2547</span>&#160;  <span class="keywordflow">for</span>(i = 0; i &lt; 3; i++) chunks-&gt;<a class="code" href="struct_lode_p_n_g___unknown_chunks.html#a9923d61d31e17e7093194da5182eda97">data</a>[i] = 0;</div>
<div class="line"><a name="l02548"></a><span class="lineno"> 2548</span>&#160;  <span class="keywordflow">for</span>(i = 0; i &lt; 3; i++) chunks-&gt;<a class="code" href="struct_lode_p_n_g___unknown_chunks.html#ab124de165db15c6cd5db43378c8ae15a">datasize</a>[i] = 0;</div>
<div class="line"><a name="l02549"></a><span class="lineno"> 2549</span>&#160;}</div>
<div class="line"><a name="l02550"></a><span class="lineno"> 2550</span>&#160;</div>
<div class="line"><a name="l02551"></a><span class="lineno"><a class="line" href="lodepng_8h.html#ab454c837b98c2643be639477e6bc3c5f"> 2551</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="lodepng_8cpp.html#ab454c837b98c2643be639477e6bc3c5f">LodePNG_UnknownChunks_cleanup</a>(<a class="code" href="struct_lode_p_n_g___unknown_chunks.html">LodePNG_UnknownChunks</a>* chunks)</div>
<div class="line"><a name="l02552"></a><span class="lineno"> 2552</span>&#160;{</div>
<div class="line"><a name="l02553"></a><span class="lineno"> 2553</span>&#160;  <span class="keywordtype">unsigned</span> i;</div>
<div class="line"><a name="l02554"></a><span class="lineno"> 2554</span>&#160;  <span class="keywordflow">for</span>(i = 0; i &lt; 3; i++) <a class="code" href="namespace_f_w.html#a93be8f55938d6ffb5ca0af1f95f81589">free</a>(chunks-&gt;<a class="code" href="struct_lode_p_n_g___unknown_chunks.html#a9923d61d31e17e7093194da5182eda97">data</a>[i]);</div>
<div class="line"><a name="l02555"></a><span class="lineno"> 2555</span>&#160;}</div>
<div class="line"><a name="l02556"></a><span class="lineno"> 2556</span>&#160;</div>
<div class="line"><a name="l02557"></a><span class="lineno"><a class="line" href="lodepng_8h.html#ace44ddf46ee78445d379279be6f9cf7d"> 2557</a></span>&#160;<span class="keywordtype">unsigned</span> <a class="code" href="lodepng_8cpp.html#ace44ddf46ee78445d379279be6f9cf7d">LodePNG_UnknownChunks_copy</a>(<a class="code" href="struct_lode_p_n_g___unknown_chunks.html">LodePNG_UnknownChunks</a>* dest, <span class="keyword">const</span> <a class="code" href="struct_lode_p_n_g___unknown_chunks.html">LodePNG_UnknownChunks</a>* src)</div>
<div class="line"><a name="l02558"></a><span class="lineno"> 2558</span>&#160;{</div>
<div class="line"><a name="l02559"></a><span class="lineno"> 2559</span>&#160;  <span class="keywordtype">unsigned</span> i;</div>
<div class="line"><a name="l02560"></a><span class="lineno"> 2560</span>&#160;</div>
<div class="line"><a name="l02561"></a><span class="lineno"> 2561</span>&#160;  <a class="code" href="lodepng_8cpp.html#ab454c837b98c2643be639477e6bc3c5f">LodePNG_UnknownChunks_cleanup</a>(dest);</div>
<div class="line"><a name="l02562"></a><span class="lineno"> 2562</span>&#160;</div>
<div class="line"><a name="l02563"></a><span class="lineno"> 2563</span>&#160;  <span class="keywordflow">for</span>(i = 0; i &lt; 3; i++)</div>
<div class="line"><a name="l02564"></a><span class="lineno"> 2564</span>&#160;  {</div>
<div class="line"><a name="l02565"></a><span class="lineno"> 2565</span>&#160;    <span class="keywordtype">size_t</span> j;</div>
<div class="line"><a name="l02566"></a><span class="lineno"> 2566</span>&#160;    dest-&gt;<a class="code" href="struct_lode_p_n_g___unknown_chunks.html#ab124de165db15c6cd5db43378c8ae15a">datasize</a>[i] = src-&gt;<a class="code" href="struct_lode_p_n_g___unknown_chunks.html#ab124de165db15c6cd5db43378c8ae15a">datasize</a>[i];</div>
<div class="line"><a name="l02567"></a><span class="lineno"> 2567</span>&#160;    dest-&gt;<a class="code" href="struct_lode_p_n_g___unknown_chunks.html#a9923d61d31e17e7093194da5182eda97">data</a>[i] = (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>*)<a class="code" href="namespace_f_w.html#a440e071d8fdbc9789b728245caad99c0">malloc</a>(src-&gt;<a class="code" href="struct_lode_p_n_g___unknown_chunks.html#ab124de165db15c6cd5db43378c8ae15a">datasize</a>[i]);</div>
<div class="line"><a name="l02568"></a><span class="lineno"> 2568</span>&#160;    <span class="keywordflow">if</span>(!dest-&gt;<a class="code" href="struct_lode_p_n_g___unknown_chunks.html#a9923d61d31e17e7093194da5182eda97">data</a>[i] &amp;&amp; dest-&gt;<a class="code" href="struct_lode_p_n_g___unknown_chunks.html#ab124de165db15c6cd5db43378c8ae15a">datasize</a>[i]) <span class="keywordflow">return</span> 9932; <span class="comment">/*alloc fail*/</span></div>
<div class="line"><a name="l02569"></a><span class="lineno"> 2569</span>&#160;    <span class="keywordflow">for</span>(j = 0; j &lt; src-&gt;<a class="code" href="struct_lode_p_n_g___unknown_chunks.html#ab124de165db15c6cd5db43378c8ae15a">datasize</a>[i]; j++) dest-&gt;<a class="code" href="struct_lode_p_n_g___unknown_chunks.html#a9923d61d31e17e7093194da5182eda97">data</a>[i][j] = src-&gt;<a class="code" href="struct_lode_p_n_g___unknown_chunks.html#a9923d61d31e17e7093194da5182eda97">data</a>[i][j];</div>
<div class="line"><a name="l02570"></a><span class="lineno"> 2570</span>&#160;  }</div>
<div class="line"><a name="l02571"></a><span class="lineno"> 2571</span>&#160;</div>
<div class="line"><a name="l02572"></a><span class="lineno"> 2572</span>&#160;  <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l02573"></a><span class="lineno"> 2573</span>&#160;}</div>
<div class="line"><a name="l02574"></a><span class="lineno"> 2574</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/*LODEPNG_COMPILE_UNKNOWN_CHUNKS*/</span><span class="preprocessor"></span></div>
<div class="line"><a name="l02575"></a><span class="lineno"> 2575</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l02576"></a><span class="lineno"> 2576</span>&#160;<span class="preprocessor">#ifdef LODEPNG_COMPILE_ANCILLARY_CHUNKS</span></div>
<div class="line"><a name="l02577"></a><span class="lineno"><a class="line" href="lodepng_8h.html#a223cd919d45a68b8a91b20e3001e4dc6"> 2577</a></span>&#160;<span class="preprocessor"></span><span class="keywordtype">void</span> <a class="code" href="lodepng_8cpp.html#a223cd919d45a68b8a91b20e3001e4dc6">LodePNG_Text_init</a>(<a class="code" href="struct_lode_p_n_g___text.html">LodePNG_Text</a>* text)</div>
<div class="line"><a name="l02578"></a><span class="lineno"> 2578</span>&#160;{</div>
<div class="line"><a name="l02579"></a><span class="lineno"> 2579</span>&#160;  text-&gt;<a class="code" href="struct_lode_p_n_g___text.html#ac85227f4c54ecda3f8beaff52e19b5c9">num</a> = 0;</div>
<div class="line"><a name="l02580"></a><span class="lineno"> 2580</span>&#160;  text-&gt;<a class="code" href="struct_lode_p_n_g___text.html#a51f019c99f3759befdf3ba5c8f6de70f">keys</a> = <a class="code" href="_defs_8hpp.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><a name="l02581"></a><span class="lineno"> 2581</span>&#160;  text-&gt;<a class="code" href="struct_lode_p_n_g___text.html#a341513a6ccbcccaa482eb4a356408dd4">strings</a> = <a class="code" href="_defs_8hpp.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><a name="l02582"></a><span class="lineno"> 2582</span>&#160;}</div>
<div class="line"><a name="l02583"></a><span class="lineno"> 2583</span>&#160;</div>
<div class="line"><a name="l02584"></a><span class="lineno"><a class="line" href="lodepng_8h.html#a798ef8e10a95cbb610ee6a0f2c92f61c"> 2584</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="lodepng_8cpp.html#a798ef8e10a95cbb610ee6a0f2c92f61c">LodePNG_Text_cleanup</a>(<a class="code" href="struct_lode_p_n_g___text.html">LodePNG_Text</a>* text)</div>
<div class="line"><a name="l02585"></a><span class="lineno"> 2585</span>&#160;{</div>
<div class="line"><a name="l02586"></a><span class="lineno"> 2586</span>&#160;  <a class="code" href="lodepng_8cpp.html#a4837cdd713daa3c3a641d4b872f83cfc">LodePNG_Text_clear</a>(text);</div>
<div class="line"><a name="l02587"></a><span class="lineno"> 2587</span>&#160;}</div>
<div class="line"><a name="l02588"></a><span class="lineno"> 2588</span>&#160;</div>
<div class="line"><a name="l02589"></a><span class="lineno"><a class="line" href="lodepng_8h.html#a924159ab70e41380aff27ba6c54e258f"> 2589</a></span>&#160;<span class="keywordtype">unsigned</span> <a class="code" href="lodepng_8cpp.html#a924159ab70e41380aff27ba6c54e258f">LodePNG_Text_copy</a>(<a class="code" href="struct_lode_p_n_g___text.html">LodePNG_Text</a>* dest, <span class="keyword">const</span> <a class="code" href="struct_lode_p_n_g___text.html">LodePNG_Text</a>* source)</div>
<div class="line"><a name="l02590"></a><span class="lineno"> 2590</span>&#160;{</div>
<div class="line"><a name="l02591"></a><span class="lineno"> 2591</span>&#160;  <span class="keywordtype">size_t</span> i = 0;</div>
<div class="line"><a name="l02592"></a><span class="lineno"> 2592</span>&#160;  dest-&gt;<a class="code" href="struct_lode_p_n_g___text.html#a51f019c99f3759befdf3ba5c8f6de70f">keys</a> = 0;</div>
<div class="line"><a name="l02593"></a><span class="lineno"> 2593</span>&#160;  dest-&gt;<a class="code" href="struct_lode_p_n_g___text.html#a341513a6ccbcccaa482eb4a356408dd4">strings</a> = 0;</div>
<div class="line"><a name="l02594"></a><span class="lineno"> 2594</span>&#160;  dest-&gt;<a class="code" href="struct_lode_p_n_g___text.html#ac85227f4c54ecda3f8beaff52e19b5c9">num</a> = 0;</div>
<div class="line"><a name="l02595"></a><span class="lineno"> 2595</span>&#160;  <span class="keywordflow">for</span>(i = 0; i &lt; source-&gt;<a class="code" href="struct_lode_p_n_g___text.html#ac85227f4c54ecda3f8beaff52e19b5c9">num</a>; i++)</div>
<div class="line"><a name="l02596"></a><span class="lineno"> 2596</span>&#160;  {</div>
<div class="line"><a name="l02597"></a><span class="lineno"> 2597</span>&#160;    <span class="keywordtype">unsigned</span> error = <a class="code" href="lodepng_8cpp.html#a9de001414ae7aa2b695c31171b4267ff">LodePNG_Text_add</a>(dest, source-&gt;<a class="code" href="struct_lode_p_n_g___text.html#a51f019c99f3759befdf3ba5c8f6de70f">keys</a>[i], source-&gt;<a class="code" href="struct_lode_p_n_g___text.html#a341513a6ccbcccaa482eb4a356408dd4">strings</a>[i]);</div>
<div class="line"><a name="l02598"></a><span class="lineno"> 2598</span>&#160;    <span class="keywordflow">if</span>(error) <span class="keywordflow">return</span> error;</div>
<div class="line"><a name="l02599"></a><span class="lineno"> 2599</span>&#160;  }</div>
<div class="line"><a name="l02600"></a><span class="lineno"> 2600</span>&#160;  <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l02601"></a><span class="lineno"> 2601</span>&#160;}</div>
<div class="line"><a name="l02602"></a><span class="lineno"> 2602</span>&#160;</div>
<div class="line"><a name="l02603"></a><span class="lineno"><a class="line" href="lodepng_8h.html#a4837cdd713daa3c3a641d4b872f83cfc"> 2603</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="lodepng_8cpp.html#a4837cdd713daa3c3a641d4b872f83cfc">LodePNG_Text_clear</a>(<a class="code" href="struct_lode_p_n_g___text.html">LodePNG_Text</a>* text)</div>
<div class="line"><a name="l02604"></a><span class="lineno"> 2604</span>&#160;{</div>
<div class="line"><a name="l02605"></a><span class="lineno"> 2605</span>&#160;  <span class="keywordtype">size_t</span> i;</div>
<div class="line"><a name="l02606"></a><span class="lineno"> 2606</span>&#160;  <span class="keywordflow">for</span>(i = 0; i &lt; text-&gt;<a class="code" href="struct_lode_p_n_g___text.html#ac85227f4c54ecda3f8beaff52e19b5c9">num</a>; i++)</div>
<div class="line"><a name="l02607"></a><span class="lineno"> 2607</span>&#160;  {</div>
<div class="line"><a name="l02608"></a><span class="lineno"> 2608</span>&#160;    string_cleanup(&amp;text-&gt;<a class="code" href="struct_lode_p_n_g___text.html#a51f019c99f3759befdf3ba5c8f6de70f">keys</a>[i]);</div>
<div class="line"><a name="l02609"></a><span class="lineno"> 2609</span>&#160;    string_cleanup(&amp;text-&gt;<a class="code" href="struct_lode_p_n_g___text.html#a341513a6ccbcccaa482eb4a356408dd4">strings</a>[i]);</div>
<div class="line"><a name="l02610"></a><span class="lineno"> 2610</span>&#160;  }</div>
<div class="line"><a name="l02611"></a><span class="lineno"> 2611</span>&#160;  <a class="code" href="namespace_f_w.html#a93be8f55938d6ffb5ca0af1f95f81589">free</a>(text-&gt;<a class="code" href="struct_lode_p_n_g___text.html#a51f019c99f3759befdf3ba5c8f6de70f">keys</a>);</div>
<div class="line"><a name="l02612"></a><span class="lineno"> 2612</span>&#160;  <a class="code" href="namespace_f_w.html#a93be8f55938d6ffb5ca0af1f95f81589">free</a>(text-&gt;<a class="code" href="struct_lode_p_n_g___text.html#a341513a6ccbcccaa482eb4a356408dd4">strings</a>);</div>
<div class="line"><a name="l02613"></a><span class="lineno"> 2613</span>&#160;}</div>
<div class="line"><a name="l02614"></a><span class="lineno"> 2614</span>&#160;</div>
<div class="line"><a name="l02615"></a><span class="lineno"><a class="line" href="lodepng_8h.html#a9de001414ae7aa2b695c31171b4267ff"> 2615</a></span>&#160;<span class="keywordtype">unsigned</span> <a class="code" href="lodepng_8cpp.html#a9de001414ae7aa2b695c31171b4267ff">LodePNG_Text_add</a>(<a class="code" href="struct_lode_p_n_g___text.html">LodePNG_Text</a>* text, <span class="keyword">const</span> <span class="keywordtype">char</span>* key, <span class="keyword">const</span> <span class="keywordtype">char</span>* str)</div>
<div class="line"><a name="l02616"></a><span class="lineno"> 2616</span>&#160;{</div>
<div class="line"><a name="l02617"></a><span class="lineno"> 2617</span>&#160;  <span class="keywordtype">char</span>** new_keys = (<span class="keywordtype">char</span>**)(<a class="code" href="namespace_f_w.html#a1c91e4066f0cc4e93981c3a04a229198">realloc</a>(text-&gt;<a class="code" href="struct_lode_p_n_g___text.html#a51f019c99f3759befdf3ba5c8f6de70f">keys</a>, <span class="keyword">sizeof</span>(<span class="keywordtype">char</span>*) * (text-&gt;<a class="code" href="struct_lode_p_n_g___text.html#ac85227f4c54ecda3f8beaff52e19b5c9">num</a> + 1)));</div>
<div class="line"><a name="l02618"></a><span class="lineno"> 2618</span>&#160;  <span class="keywordtype">char</span>** new_strings = (<span class="keywordtype">char</span>**)(<a class="code" href="namespace_f_w.html#a1c91e4066f0cc4e93981c3a04a229198">realloc</a>(text-&gt;<a class="code" href="struct_lode_p_n_g___text.html#a341513a6ccbcccaa482eb4a356408dd4">strings</a>, <span class="keyword">sizeof</span>(<span class="keywordtype">char</span>*) * (text-&gt;<a class="code" href="struct_lode_p_n_g___text.html#ac85227f4c54ecda3f8beaff52e19b5c9">num</a> + 1)));</div>
<div class="line"><a name="l02619"></a><span class="lineno"> 2619</span>&#160;  <span class="keywordflow">if</span>(!new_keys || !new_strings)</div>
<div class="line"><a name="l02620"></a><span class="lineno"> 2620</span>&#160;  {</div>
<div class="line"><a name="l02621"></a><span class="lineno"> 2621</span>&#160;    <a class="code" href="namespace_f_w.html#a93be8f55938d6ffb5ca0af1f95f81589">free</a>(new_keys);</div>
<div class="line"><a name="l02622"></a><span class="lineno"> 2622</span>&#160;    <a class="code" href="namespace_f_w.html#a93be8f55938d6ffb5ca0af1f95f81589">free</a>(new_strings);</div>
<div class="line"><a name="l02623"></a><span class="lineno"> 2623</span>&#160;    <span class="keywordflow">return</span> 9933; <span class="comment">/*alloc fail*/</span></div>
<div class="line"><a name="l02624"></a><span class="lineno"> 2624</span>&#160;  }</div>
<div class="line"><a name="l02625"></a><span class="lineno"> 2625</span>&#160;</div>
<div class="line"><a name="l02626"></a><span class="lineno"> 2626</span>&#160;  text-&gt;<a class="code" href="struct_lode_p_n_g___text.html#ac85227f4c54ecda3f8beaff52e19b5c9">num</a>++;</div>
<div class="line"><a name="l02627"></a><span class="lineno"> 2627</span>&#160;  text-&gt;<a class="code" href="struct_lode_p_n_g___text.html#a51f019c99f3759befdf3ba5c8f6de70f">keys</a> = new_keys;</div>
<div class="line"><a name="l02628"></a><span class="lineno"> 2628</span>&#160;  text-&gt;<a class="code" href="struct_lode_p_n_g___text.html#a341513a6ccbcccaa482eb4a356408dd4">strings</a> = new_strings;</div>
<div class="line"><a name="l02629"></a><span class="lineno"> 2629</span>&#160;</div>
<div class="line"><a name="l02630"></a><span class="lineno"> 2630</span>&#160;  string_init(&amp;text-&gt;<a class="code" href="struct_lode_p_n_g___text.html#a51f019c99f3759befdf3ba5c8f6de70f">keys</a>[text-&gt;<a class="code" href="struct_lode_p_n_g___text.html#ac85227f4c54ecda3f8beaff52e19b5c9">num</a> - 1]);</div>
<div class="line"><a name="l02631"></a><span class="lineno"> 2631</span>&#160;  string_set(&amp;text-&gt;<a class="code" href="struct_lode_p_n_g___text.html#a51f019c99f3759befdf3ba5c8f6de70f">keys</a>[text-&gt;<a class="code" href="struct_lode_p_n_g___text.html#ac85227f4c54ecda3f8beaff52e19b5c9">num</a> - 1], key);</div>
<div class="line"><a name="l02632"></a><span class="lineno"> 2632</span>&#160;</div>
<div class="line"><a name="l02633"></a><span class="lineno"> 2633</span>&#160;  string_init(&amp;text-&gt;<a class="code" href="struct_lode_p_n_g___text.html#a341513a6ccbcccaa482eb4a356408dd4">strings</a>[text-&gt;<a class="code" href="struct_lode_p_n_g___text.html#ac85227f4c54ecda3f8beaff52e19b5c9">num</a> - 1]);</div>
<div class="line"><a name="l02634"></a><span class="lineno"> 2634</span>&#160;  string_set(&amp;text-&gt;<a class="code" href="struct_lode_p_n_g___text.html#a341513a6ccbcccaa482eb4a356408dd4">strings</a>[text-&gt;<a class="code" href="struct_lode_p_n_g___text.html#ac85227f4c54ecda3f8beaff52e19b5c9">num</a> - 1], str);</div>
<div class="line"><a name="l02635"></a><span class="lineno"> 2635</span>&#160;</div>
<div class="line"><a name="l02636"></a><span class="lineno"> 2636</span>&#160;  <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l02637"></a><span class="lineno"> 2637</span>&#160;}</div>
<div class="line"><a name="l02638"></a><span class="lineno"> 2638</span>&#160;</div>
<div class="line"><a name="l02639"></a><span class="lineno"> 2639</span>&#160;<span class="comment">/******************************************************************************/</span></div>
<div class="line"><a name="l02640"></a><span class="lineno"> 2640</span>&#160;</div>
<div class="line"><a name="l02641"></a><span class="lineno"><a class="line" href="lodepng_8h.html#a166194e49966c1079f332863aad52770"> 2641</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="lodepng_8cpp.html#a166194e49966c1079f332863aad52770">LodePNG_IText_init</a>(<a class="code" href="struct_lode_p_n_g___i_text.html">LodePNG_IText</a>* text)</div>
<div class="line"><a name="l02642"></a><span class="lineno"> 2642</span>&#160;{</div>
<div class="line"><a name="l02643"></a><span class="lineno"> 2643</span>&#160;  text-&gt;<a class="code" href="struct_lode_p_n_g___i_text.html#a5af6eb21b9963d7f49e28d7ea181763c">num</a> = 0;</div>
<div class="line"><a name="l02644"></a><span class="lineno"> 2644</span>&#160;  text-&gt;<a class="code" href="struct_lode_p_n_g___i_text.html#a487ca35406b7c5fdd13fd32e9c148c21">keys</a> = <a class="code" href="_defs_8hpp.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><a name="l02645"></a><span class="lineno"> 2645</span>&#160;  text-&gt;<a class="code" href="struct_lode_p_n_g___i_text.html#abcb2f7a9848f6cf561e15e7c7f43fcb3">langtags</a> = <a class="code" href="_defs_8hpp.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><a name="l02646"></a><span class="lineno"> 2646</span>&#160;  text-&gt;<a class="code" href="struct_lode_p_n_g___i_text.html#af20920b249db552b73ec00f259500cfc">transkeys</a> = <a class="code" href="_defs_8hpp.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><a name="l02647"></a><span class="lineno"> 2647</span>&#160;  text-&gt;<a class="code" href="struct_lode_p_n_g___i_text.html#aa4e0811fdc21677603e387168179e66e">strings</a> = <a class="code" href="_defs_8hpp.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><a name="l02648"></a><span class="lineno"> 2648</span>&#160;}</div>
<div class="line"><a name="l02649"></a><span class="lineno"> 2649</span>&#160;</div>
<div class="line"><a name="l02650"></a><span class="lineno"><a class="line" href="lodepng_8h.html#abb33bc7b86c94e91f2919065e8c3e68e"> 2650</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="lodepng_8cpp.html#abb33bc7b86c94e91f2919065e8c3e68e">LodePNG_IText_cleanup</a>(<a class="code" href="struct_lode_p_n_g___i_text.html">LodePNG_IText</a>* text)</div>
<div class="line"><a name="l02651"></a><span class="lineno"> 2651</span>&#160;{</div>
<div class="line"><a name="l02652"></a><span class="lineno"> 2652</span>&#160;  <a class="code" href="lodepng_8cpp.html#af63c0478e6478580bcc2726dfe205598">LodePNG_IText_clear</a>(text);</div>
<div class="line"><a name="l02653"></a><span class="lineno"> 2653</span>&#160;}</div>
<div class="line"><a name="l02654"></a><span class="lineno"> 2654</span>&#160;</div>
<div class="line"><a name="l02655"></a><span class="lineno"><a class="line" href="lodepng_8h.html#a894c6c210779b2187070ac0551e3ade6"> 2655</a></span>&#160;<span class="keywordtype">unsigned</span> <a class="code" href="lodepng_8cpp.html#a894c6c210779b2187070ac0551e3ade6">LodePNG_IText_copy</a>(<a class="code" href="struct_lode_p_n_g___i_text.html">LodePNG_IText</a>* dest, <span class="keyword">const</span> <a class="code" href="struct_lode_p_n_g___i_text.html">LodePNG_IText</a>* source)</div>
<div class="line"><a name="l02656"></a><span class="lineno"> 2656</span>&#160;{</div>
<div class="line"><a name="l02657"></a><span class="lineno"> 2657</span>&#160;  <span class="keywordtype">size_t</span> i = 0;</div>
<div class="line"><a name="l02658"></a><span class="lineno"> 2658</span>&#160;  dest-&gt;<a class="code" href="struct_lode_p_n_g___i_text.html#a487ca35406b7c5fdd13fd32e9c148c21">keys</a> = 0;</div>
<div class="line"><a name="l02659"></a><span class="lineno"> 2659</span>&#160;  dest-&gt;<a class="code" href="struct_lode_p_n_g___i_text.html#abcb2f7a9848f6cf561e15e7c7f43fcb3">langtags</a> = 0;</div>
<div class="line"><a name="l02660"></a><span class="lineno"> 2660</span>&#160;  dest-&gt;<a class="code" href="struct_lode_p_n_g___i_text.html#af20920b249db552b73ec00f259500cfc">transkeys</a> = 0;</div>
<div class="line"><a name="l02661"></a><span class="lineno"> 2661</span>&#160;  dest-&gt;<a class="code" href="struct_lode_p_n_g___i_text.html#aa4e0811fdc21677603e387168179e66e">strings</a> = 0;</div>
<div class="line"><a name="l02662"></a><span class="lineno"> 2662</span>&#160;  dest-&gt;<a class="code" href="struct_lode_p_n_g___i_text.html#a5af6eb21b9963d7f49e28d7ea181763c">num</a> = 0;</div>
<div class="line"><a name="l02663"></a><span class="lineno"> 2663</span>&#160;  <span class="keywordflow">for</span>(i = 0; i &lt; source-&gt;<a class="code" href="struct_lode_p_n_g___i_text.html#a5af6eb21b9963d7f49e28d7ea181763c">num</a>; i++)</div>
<div class="line"><a name="l02664"></a><span class="lineno"> 2664</span>&#160;  {</div>
<div class="line"><a name="l02665"></a><span class="lineno"> 2665</span>&#160;    <span class="keywordtype">unsigned</span> error = <a class="code" href="lodepng_8cpp.html#a637a6754fae89a90ea3ba46b1fa99df3">LodePNG_IText_add</a>(dest, source-&gt;<a class="code" href="struct_lode_p_n_g___i_text.html#a487ca35406b7c5fdd13fd32e9c148c21">keys</a>[i], source-&gt;<a class="code" href="struct_lode_p_n_g___i_text.html#abcb2f7a9848f6cf561e15e7c7f43fcb3">langtags</a>[i],</div>
<div class="line"><a name="l02666"></a><span class="lineno"> 2666</span>&#160;                                       source-&gt;<a class="code" href="struct_lode_p_n_g___i_text.html#af20920b249db552b73ec00f259500cfc">transkeys</a>[i], source-&gt;<a class="code" href="struct_lode_p_n_g___i_text.html#aa4e0811fdc21677603e387168179e66e">strings</a>[i]);</div>
<div class="line"><a name="l02667"></a><span class="lineno"> 2667</span>&#160;    <span class="keywordflow">if</span>(error) <span class="keywordflow">return</span> error;</div>
<div class="line"><a name="l02668"></a><span class="lineno"> 2668</span>&#160;  }</div>
<div class="line"><a name="l02669"></a><span class="lineno"> 2669</span>&#160;  <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l02670"></a><span class="lineno"> 2670</span>&#160;}</div>
<div class="line"><a name="l02671"></a><span class="lineno"> 2671</span>&#160;</div>
<div class="line"><a name="l02672"></a><span class="lineno"><a class="line" href="lodepng_8h.html#af63c0478e6478580bcc2726dfe205598"> 2672</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="lodepng_8cpp.html#af63c0478e6478580bcc2726dfe205598">LodePNG_IText_clear</a>(<a class="code" href="struct_lode_p_n_g___i_text.html">LodePNG_IText</a>* text)</div>
<div class="line"><a name="l02673"></a><span class="lineno"> 2673</span>&#160;{</div>
<div class="line"><a name="l02674"></a><span class="lineno"> 2674</span>&#160;  <span class="keywordtype">size_t</span> i;</div>
<div class="line"><a name="l02675"></a><span class="lineno"> 2675</span>&#160;  <span class="keywordflow">for</span>(i = 0; i &lt; text-&gt;<a class="code" href="struct_lode_p_n_g___i_text.html#a5af6eb21b9963d7f49e28d7ea181763c">num</a>; i++)</div>
<div class="line"><a name="l02676"></a><span class="lineno"> 2676</span>&#160;  {</div>
<div class="line"><a name="l02677"></a><span class="lineno"> 2677</span>&#160;    string_cleanup(&amp;text-&gt;<a class="code" href="struct_lode_p_n_g___i_text.html#a487ca35406b7c5fdd13fd32e9c148c21">keys</a>[i]);</div>
<div class="line"><a name="l02678"></a><span class="lineno"> 2678</span>&#160;    string_cleanup(&amp;text-&gt;<a class="code" href="struct_lode_p_n_g___i_text.html#abcb2f7a9848f6cf561e15e7c7f43fcb3">langtags</a>[i]);</div>
<div class="line"><a name="l02679"></a><span class="lineno"> 2679</span>&#160;    string_cleanup(&amp;text-&gt;<a class="code" href="struct_lode_p_n_g___i_text.html#af20920b249db552b73ec00f259500cfc">transkeys</a>[i]);</div>
<div class="line"><a name="l02680"></a><span class="lineno"> 2680</span>&#160;    string_cleanup(&amp;text-&gt;<a class="code" href="struct_lode_p_n_g___i_text.html#aa4e0811fdc21677603e387168179e66e">strings</a>[i]);</div>
<div class="line"><a name="l02681"></a><span class="lineno"> 2681</span>&#160;  }</div>
<div class="line"><a name="l02682"></a><span class="lineno"> 2682</span>&#160;  <a class="code" href="namespace_f_w.html#a93be8f55938d6ffb5ca0af1f95f81589">free</a>(text-&gt;<a class="code" href="struct_lode_p_n_g___i_text.html#a487ca35406b7c5fdd13fd32e9c148c21">keys</a>);</div>
<div class="line"><a name="l02683"></a><span class="lineno"> 2683</span>&#160;  <a class="code" href="namespace_f_w.html#a93be8f55938d6ffb5ca0af1f95f81589">free</a>(text-&gt;<a class="code" href="struct_lode_p_n_g___i_text.html#abcb2f7a9848f6cf561e15e7c7f43fcb3">langtags</a>);</div>
<div class="line"><a name="l02684"></a><span class="lineno"> 2684</span>&#160;  <a class="code" href="namespace_f_w.html#a93be8f55938d6ffb5ca0af1f95f81589">free</a>(text-&gt;<a class="code" href="struct_lode_p_n_g___i_text.html#af20920b249db552b73ec00f259500cfc">transkeys</a>);</div>
<div class="line"><a name="l02685"></a><span class="lineno"> 2685</span>&#160;  <a class="code" href="namespace_f_w.html#a93be8f55938d6ffb5ca0af1f95f81589">free</a>(text-&gt;<a class="code" href="struct_lode_p_n_g___i_text.html#aa4e0811fdc21677603e387168179e66e">strings</a>);</div>
<div class="line"><a name="l02686"></a><span class="lineno"> 2686</span>&#160;}</div>
<div class="line"><a name="l02687"></a><span class="lineno"> 2687</span>&#160;</div>
<div class="line"><a name="l02688"></a><span class="lineno"><a class="line" href="lodepng_8h.html#a637a6754fae89a90ea3ba46b1fa99df3"> 2688</a></span>&#160;<span class="keywordtype">unsigned</span> <a class="code" href="lodepng_8cpp.html#a637a6754fae89a90ea3ba46b1fa99df3">LodePNG_IText_add</a>(<a class="code" href="struct_lode_p_n_g___i_text.html">LodePNG_IText</a>* text, <span class="keyword">const</span> <span class="keywordtype">char</span>* key, <span class="keyword">const</span> <span class="keywordtype">char</span>* langtag,</div>
<div class="line"><a name="l02689"></a><span class="lineno"> 2689</span>&#160;                           <span class="keyword">const</span> <span class="keywordtype">char</span>* transkey, <span class="keyword">const</span> <span class="keywordtype">char</span>* str)</div>
<div class="line"><a name="l02690"></a><span class="lineno"> 2690</span>&#160;{</div>
<div class="line"><a name="l02691"></a><span class="lineno"> 2691</span>&#160;  <span class="keywordtype">char</span>** new_keys = (<span class="keywordtype">char</span>**)(<a class="code" href="namespace_f_w.html#a1c91e4066f0cc4e93981c3a04a229198">realloc</a>(text-&gt;<a class="code" href="struct_lode_p_n_g___i_text.html#a487ca35406b7c5fdd13fd32e9c148c21">keys</a>, <span class="keyword">sizeof</span>(<span class="keywordtype">char</span>*) * (text-&gt;<a class="code" href="struct_lode_p_n_g___i_text.html#a5af6eb21b9963d7f49e28d7ea181763c">num</a> + 1)));</div>
<div class="line"><a name="l02692"></a><span class="lineno"> 2692</span>&#160;  <span class="keywordtype">char</span>** new_langtags = (<span class="keywordtype">char</span>**)(<a class="code" href="namespace_f_w.html#a1c91e4066f0cc4e93981c3a04a229198">realloc</a>(text-&gt;<a class="code" href="struct_lode_p_n_g___i_text.html#abcb2f7a9848f6cf561e15e7c7f43fcb3">langtags</a>, <span class="keyword">sizeof</span>(<span class="keywordtype">char</span>*) * (text-&gt;<a class="code" href="struct_lode_p_n_g___i_text.html#a5af6eb21b9963d7f49e28d7ea181763c">num</a> + 1)));</div>
<div class="line"><a name="l02693"></a><span class="lineno"> 2693</span>&#160;  <span class="keywordtype">char</span>** new_transkeys = (<span class="keywordtype">char</span>**)(<a class="code" href="namespace_f_w.html#a1c91e4066f0cc4e93981c3a04a229198">realloc</a>(text-&gt;<a class="code" href="struct_lode_p_n_g___i_text.html#af20920b249db552b73ec00f259500cfc">transkeys</a>, <span class="keyword">sizeof</span>(<span class="keywordtype">char</span>*) * (text-&gt;<a class="code" href="struct_lode_p_n_g___i_text.html#a5af6eb21b9963d7f49e28d7ea181763c">num</a> + 1)));</div>
<div class="line"><a name="l02694"></a><span class="lineno"> 2694</span>&#160;  <span class="keywordtype">char</span>** new_strings = (<span class="keywordtype">char</span>**)(<a class="code" href="namespace_f_w.html#a1c91e4066f0cc4e93981c3a04a229198">realloc</a>(text-&gt;<a class="code" href="struct_lode_p_n_g___i_text.html#aa4e0811fdc21677603e387168179e66e">strings</a>, <span class="keyword">sizeof</span>(<span class="keywordtype">char</span>*) * (text-&gt;<a class="code" href="struct_lode_p_n_g___i_text.html#a5af6eb21b9963d7f49e28d7ea181763c">num</a> + 1)));</div>
<div class="line"><a name="l02695"></a><span class="lineno"> 2695</span>&#160;  <span class="keywordflow">if</span>(!new_keys || !new_langtags || !new_transkeys || !new_strings)</div>
<div class="line"><a name="l02696"></a><span class="lineno"> 2696</span>&#160;  {</div>
<div class="line"><a name="l02697"></a><span class="lineno"> 2697</span>&#160;    <a class="code" href="namespace_f_w.html#a93be8f55938d6ffb5ca0af1f95f81589">free</a>(new_keys);</div>
<div class="line"><a name="l02698"></a><span class="lineno"> 2698</span>&#160;    <a class="code" href="namespace_f_w.html#a93be8f55938d6ffb5ca0af1f95f81589">free</a>(new_langtags);</div>
<div class="line"><a name="l02699"></a><span class="lineno"> 2699</span>&#160;    <a class="code" href="namespace_f_w.html#a93be8f55938d6ffb5ca0af1f95f81589">free</a>(new_transkeys);</div>
<div class="line"><a name="l02700"></a><span class="lineno"> 2700</span>&#160;    <a class="code" href="namespace_f_w.html#a93be8f55938d6ffb5ca0af1f95f81589">free</a>(new_strings);</div>
<div class="line"><a name="l02701"></a><span class="lineno"> 2701</span>&#160;    <span class="keywordflow">return</span> 9934; <span class="comment">/*alloc fail*/</span></div>
<div class="line"><a name="l02702"></a><span class="lineno"> 2702</span>&#160;  }</div>
<div class="line"><a name="l02703"></a><span class="lineno"> 2703</span>&#160;</div>
<div class="line"><a name="l02704"></a><span class="lineno"> 2704</span>&#160;  text-&gt;<a class="code" href="struct_lode_p_n_g___i_text.html#a5af6eb21b9963d7f49e28d7ea181763c">num</a>++;</div>
<div class="line"><a name="l02705"></a><span class="lineno"> 2705</span>&#160;  text-&gt;<a class="code" href="struct_lode_p_n_g___i_text.html#a487ca35406b7c5fdd13fd32e9c148c21">keys</a> = new_keys;</div>
<div class="line"><a name="l02706"></a><span class="lineno"> 2706</span>&#160;  text-&gt;<a class="code" href="struct_lode_p_n_g___i_text.html#abcb2f7a9848f6cf561e15e7c7f43fcb3">langtags</a> = new_langtags;</div>
<div class="line"><a name="l02707"></a><span class="lineno"> 2707</span>&#160;  text-&gt;<a class="code" href="struct_lode_p_n_g___i_text.html#af20920b249db552b73ec00f259500cfc">transkeys</a> = new_transkeys;</div>
<div class="line"><a name="l02708"></a><span class="lineno"> 2708</span>&#160;  text-&gt;<a class="code" href="struct_lode_p_n_g___i_text.html#aa4e0811fdc21677603e387168179e66e">strings</a> = new_strings;</div>
<div class="line"><a name="l02709"></a><span class="lineno"> 2709</span>&#160;</div>
<div class="line"><a name="l02710"></a><span class="lineno"> 2710</span>&#160;  string_init(&amp;text-&gt;<a class="code" href="struct_lode_p_n_g___i_text.html#a487ca35406b7c5fdd13fd32e9c148c21">keys</a>[text-&gt;<a class="code" href="struct_lode_p_n_g___i_text.html#a5af6eb21b9963d7f49e28d7ea181763c">num</a> - 1]);</div>
<div class="line"><a name="l02711"></a><span class="lineno"> 2711</span>&#160;  string_set(&amp;text-&gt;<a class="code" href="struct_lode_p_n_g___i_text.html#a487ca35406b7c5fdd13fd32e9c148c21">keys</a>[text-&gt;<a class="code" href="struct_lode_p_n_g___i_text.html#a5af6eb21b9963d7f49e28d7ea181763c">num</a> - 1], key);</div>
<div class="line"><a name="l02712"></a><span class="lineno"> 2712</span>&#160;</div>
<div class="line"><a name="l02713"></a><span class="lineno"> 2713</span>&#160;  string_init(&amp;text-&gt;<a class="code" href="struct_lode_p_n_g___i_text.html#abcb2f7a9848f6cf561e15e7c7f43fcb3">langtags</a>[text-&gt;<a class="code" href="struct_lode_p_n_g___i_text.html#a5af6eb21b9963d7f49e28d7ea181763c">num</a> - 1]);</div>
<div class="line"><a name="l02714"></a><span class="lineno"> 2714</span>&#160;  string_set(&amp;text-&gt;<a class="code" href="struct_lode_p_n_g___i_text.html#abcb2f7a9848f6cf561e15e7c7f43fcb3">langtags</a>[text-&gt;<a class="code" href="struct_lode_p_n_g___i_text.html#a5af6eb21b9963d7f49e28d7ea181763c">num</a> - 1], langtag);</div>
<div class="line"><a name="l02715"></a><span class="lineno"> 2715</span>&#160;</div>
<div class="line"><a name="l02716"></a><span class="lineno"> 2716</span>&#160;  string_init(&amp;text-&gt;<a class="code" href="struct_lode_p_n_g___i_text.html#af20920b249db552b73ec00f259500cfc">transkeys</a>[text-&gt;<a class="code" href="struct_lode_p_n_g___i_text.html#a5af6eb21b9963d7f49e28d7ea181763c">num</a> - 1]);</div>
<div class="line"><a name="l02717"></a><span class="lineno"> 2717</span>&#160;  string_set(&amp;text-&gt;<a class="code" href="struct_lode_p_n_g___i_text.html#af20920b249db552b73ec00f259500cfc">transkeys</a>[text-&gt;<a class="code" href="struct_lode_p_n_g___i_text.html#a5af6eb21b9963d7f49e28d7ea181763c">num</a> - 1], transkey);</div>
<div class="line"><a name="l02718"></a><span class="lineno"> 2718</span>&#160;</div>
<div class="line"><a name="l02719"></a><span class="lineno"> 2719</span>&#160;  string_init(&amp;text-&gt;<a class="code" href="struct_lode_p_n_g___i_text.html#aa4e0811fdc21677603e387168179e66e">strings</a>[text-&gt;<a class="code" href="struct_lode_p_n_g___i_text.html#a5af6eb21b9963d7f49e28d7ea181763c">num</a> - 1]);</div>
<div class="line"><a name="l02720"></a><span class="lineno"> 2720</span>&#160;  string_set(&amp;text-&gt;<a class="code" href="struct_lode_p_n_g___i_text.html#aa4e0811fdc21677603e387168179e66e">strings</a>[text-&gt;<a class="code" href="struct_lode_p_n_g___i_text.html#a5af6eb21b9963d7f49e28d7ea181763c">num</a> - 1], str);</div>
<div class="line"><a name="l02721"></a><span class="lineno"> 2721</span>&#160;</div>
<div class="line"><a name="l02722"></a><span class="lineno"> 2722</span>&#160;  <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l02723"></a><span class="lineno"> 2723</span>&#160;}</div>
<div class="line"><a name="l02724"></a><span class="lineno"> 2724</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/*LODEPNG_COMPILE_ANCILLARY_CHUNKS*/</span><span class="preprocessor"></span></div>
<div class="line"><a name="l02725"></a><span class="lineno"> 2725</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l02726"></a><span class="lineno"><a class="line" href="lodepng_8h.html#a66ddccc82c59e05d746086f56997b4cd"> 2726</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="lodepng_8cpp.html#a66ddccc82c59e05d746086f56997b4cd">LodePNG_InfoPng_init</a>(<a class="code" href="struct_lode_p_n_g___info_png.html">LodePNG_InfoPng</a>* info)</div>
<div class="line"><a name="l02727"></a><span class="lineno"> 2727</span>&#160;{</div>
<div class="line"><a name="l02728"></a><span class="lineno"> 2728</span>&#160;  info-&gt;<a class="code" href="struct_lode_p_n_g___info_png.html#a74be99b177b28f3178c02139c4b7f149">width</a> = info-&gt;<a class="code" href="struct_lode_p_n_g___info_png.html#a4b87ec9649e7177af7a5f5e08e5bc491">height</a> = 0;</div>
<div class="line"><a name="l02729"></a><span class="lineno"> 2729</span>&#160;  <a class="code" href="lodepng_8cpp.html#abaea3ca539b3d5f1624ac8286f47b34c">LodePNG_InfoColor_init</a>(&amp;info-&gt;<a class="code" href="struct_lode_p_n_g___info_png.html#acce58518f72f42ba94db4c1cfd69336b">color</a>);</div>
<div class="line"><a name="l02730"></a><span class="lineno"> 2730</span>&#160;  info-&gt;<a class="code" href="struct_lode_p_n_g___info_png.html#ad261cbe064eb69a92638e880d99347ca">interlaceMethod</a> = 0;</div>
<div class="line"><a name="l02731"></a><span class="lineno"> 2731</span>&#160;  info-&gt;<a class="code" href="struct_lode_p_n_g___info_png.html#a177065a8eeb66398a89ed93e7c2b2f50">compressionMethod</a> = 0;</div>
<div class="line"><a name="l02732"></a><span class="lineno"> 2732</span>&#160;  info-&gt;<a class="code" href="struct_lode_p_n_g___info_png.html#a101ffbacd7026dad4ab062e984cecf17">filterMethod</a> = 0;</div>
<div class="line"><a name="l02733"></a><span class="lineno"> 2733</span>&#160;<span class="preprocessor">#ifdef LODEPNG_COMPILE_ANCILLARY_CHUNKS</span></div>
<div class="line"><a name="l02734"></a><span class="lineno"> 2734</span>&#160;<span class="preprocessor"></span>  info-&gt;<a class="code" href="struct_lode_p_n_g___info_png.html#a37f6cddbe33b775fab09a91076b72f4c">background_defined</a> = 0;</div>
<div class="line"><a name="l02735"></a><span class="lineno"> 2735</span>&#160;  info-&gt;<a class="code" href="struct_lode_p_n_g___info_png.html#afbab2f688332e8c787717f797de8153e">background_r</a> = info-&gt;<a class="code" href="struct_lode_p_n_g___info_png.html#adbda2bda427f0dd6ae1b85daaab21c6c">background_g</a> = info-&gt;<a class="code" href="struct_lode_p_n_g___info_png.html#a7b8e98bf898590f785930c7b470254bc">background_b</a> = 0;</div>
<div class="line"><a name="l02736"></a><span class="lineno"> 2736</span>&#160;</div>
<div class="line"><a name="l02737"></a><span class="lineno"> 2737</span>&#160;  <a class="code" href="lodepng_8cpp.html#a223cd919d45a68b8a91b20e3001e4dc6">LodePNG_Text_init</a>(&amp;info-&gt;<a class="code" href="struct_lode_p_n_g___info_png.html#a2ba6d900f4eee624a18df252e9df40e9">text</a>);</div>
<div class="line"><a name="l02738"></a><span class="lineno"> 2738</span>&#160;  <a class="code" href="lodepng_8cpp.html#a166194e49966c1079f332863aad52770">LodePNG_IText_init</a>(&amp;info-&gt;<a class="code" href="struct_lode_p_n_g___info_png.html#a6a25d5f857d5e8d1c326997b78d9daf1">itext</a>);</div>
<div class="line"><a name="l02739"></a><span class="lineno"> 2739</span>&#160;</div>
<div class="line"><a name="l02740"></a><span class="lineno"> 2740</span>&#160;  info-&gt;<a class="code" href="struct_lode_p_n_g___info_png.html#aa220d359b0f73b1f61a87f1c3bf8aad6">time_defined</a> = 0;</div>
<div class="line"><a name="l02741"></a><span class="lineno"> 2741</span>&#160;  info-&gt;<a class="code" href="struct_lode_p_n_g___info_png.html#a0f0b0d882e5c099d06d608c79295ba2d">phys_defined</a> = 0;</div>
<div class="line"><a name="l02742"></a><span class="lineno"> 2742</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/*LODEPNG_COMPILE_ANCILLARY_CHUNKS*/</span><span class="preprocessor"></span></div>
<div class="line"><a name="l02743"></a><span class="lineno"> 2743</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef LODEPNG_COMPILE_UNKNOWN_CHUNKS</span></div>
<div class="line"><a name="l02744"></a><span class="lineno"> 2744</span>&#160;<span class="preprocessor"></span>  <a class="code" href="lodepng_8cpp.html#a4af200ba997cfba6319267d2f970dfa3">LodePNG_UnknownChunks_init</a>(&amp;info-&gt;<a class="code" href="struct_lode_p_n_g___info_png.html#a97faa43bfd4e8f8df1cd836c713edac3">unknown_chunks</a>);</div>
<div class="line"><a name="l02745"></a><span class="lineno"> 2745</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/*LODEPNG_COMPILE_UNKNOWN_CHUNKS*/</span><span class="preprocessor"></span></div>
<div class="line"><a name="l02746"></a><span class="lineno"> 2746</span>&#160;<span class="preprocessor"></span>}</div>
<div class="line"><a name="l02747"></a><span class="lineno"> 2747</span>&#160;</div>
<div class="line"><a name="l02748"></a><span class="lineno"><a class="line" href="lodepng_8h.html#a7884592df167f7136fc928cacf1efd36"> 2748</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="lodepng_8cpp.html#a7884592df167f7136fc928cacf1efd36">LodePNG_InfoPng_cleanup</a>(<a class="code" href="struct_lode_p_n_g___info_png.html">LodePNG_InfoPng</a>* info)</div>
<div class="line"><a name="l02749"></a><span class="lineno"> 2749</span>&#160;{</div>
<div class="line"><a name="l02750"></a><span class="lineno"> 2750</span>&#160;  <a class="code" href="lodepng_8cpp.html#a2f5ecf25393f688611987c61f698f1ce">LodePNG_InfoColor_cleanup</a>(&amp;info-&gt;<a class="code" href="struct_lode_p_n_g___info_png.html#acce58518f72f42ba94db4c1cfd69336b">color</a>);</div>
<div class="line"><a name="l02751"></a><span class="lineno"> 2751</span>&#160;<span class="preprocessor">#ifdef LODEPNG_COMPILE_ANCILLARY_CHUNKS</span></div>
<div class="line"><a name="l02752"></a><span class="lineno"> 2752</span>&#160;<span class="preprocessor"></span>  <a class="code" href="lodepng_8cpp.html#a798ef8e10a95cbb610ee6a0f2c92f61c">LodePNG_Text_cleanup</a>(&amp;info-&gt;<a class="code" href="struct_lode_p_n_g___info_png.html#a2ba6d900f4eee624a18df252e9df40e9">text</a>);</div>
<div class="line"><a name="l02753"></a><span class="lineno"> 2753</span>&#160;  <a class="code" href="lodepng_8cpp.html#abb33bc7b86c94e91f2919065e8c3e68e">LodePNG_IText_cleanup</a>(&amp;info-&gt;<a class="code" href="struct_lode_p_n_g___info_png.html#a6a25d5f857d5e8d1c326997b78d9daf1">itext</a>);</div>
<div class="line"><a name="l02754"></a><span class="lineno"> 2754</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/*LODEPNG_COMPILE_ANCILLARY_CHUNKS*/</span><span class="preprocessor"></span></div>
<div class="line"><a name="l02755"></a><span class="lineno"> 2755</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef LODEPNG_COMPILE_UNKNOWN_CHUNKS</span></div>
<div class="line"><a name="l02756"></a><span class="lineno"> 2756</span>&#160;<span class="preprocessor"></span>  <a class="code" href="lodepng_8cpp.html#ab454c837b98c2643be639477e6bc3c5f">LodePNG_UnknownChunks_cleanup</a>(&amp;info-&gt;<a class="code" href="struct_lode_p_n_g___info_png.html#a97faa43bfd4e8f8df1cd836c713edac3">unknown_chunks</a>);</div>
<div class="line"><a name="l02757"></a><span class="lineno"> 2757</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/*LODEPNG_COMPILE_UNKNOWN_CHUNKS*/</span><span class="preprocessor"></span></div>
<div class="line"><a name="l02758"></a><span class="lineno"> 2758</span>&#160;<span class="preprocessor"></span>}</div>
<div class="line"><a name="l02759"></a><span class="lineno"> 2759</span>&#160;</div>
<div class="line"><a name="l02760"></a><span class="lineno"><a class="line" href="lodepng_8h.html#a0e188efe0b87e1b7d11a01ff85881368"> 2760</a></span>&#160;<span class="keywordtype">unsigned</span> <a class="code" href="lodepng_8cpp.html#a0e188efe0b87e1b7d11a01ff85881368">LodePNG_InfoPng_copy</a>(<a class="code" href="struct_lode_p_n_g___info_png.html">LodePNG_InfoPng</a>* dest, <span class="keyword">const</span> <a class="code" href="struct_lode_p_n_g___info_png.html">LodePNG_InfoPng</a>* source)</div>
<div class="line"><a name="l02761"></a><span class="lineno"> 2761</span>&#160;{</div>
<div class="line"><a name="l02762"></a><span class="lineno"> 2762</span>&#160;  <span class="keywordtype">unsigned</span> error = 0;</div>
<div class="line"><a name="l02763"></a><span class="lineno"> 2763</span>&#160;  <a class="code" href="lodepng_8cpp.html#a7884592df167f7136fc928cacf1efd36">LodePNG_InfoPng_cleanup</a>(dest);</div>
<div class="line"><a name="l02764"></a><span class="lineno"> 2764</span>&#160;  *dest = *source;</div>
<div class="line"><a name="l02765"></a><span class="lineno"> 2765</span>&#160;  <a class="code" href="lodepng_8cpp.html#abaea3ca539b3d5f1624ac8286f47b34c">LodePNG_InfoColor_init</a>(&amp;dest-&gt;<a class="code" href="struct_lode_p_n_g___info_png.html#acce58518f72f42ba94db4c1cfd69336b">color</a>);</div>
<div class="line"><a name="l02766"></a><span class="lineno"> 2766</span>&#160;  error = <a class="code" href="lodepng_8cpp.html#ad7beb96e92dd01a605c669af79a54a00">LodePNG_InfoColor_copy</a>(&amp;dest-&gt;<a class="code" href="struct_lode_p_n_g___info_png.html#acce58518f72f42ba94db4c1cfd69336b">color</a>, &amp;source-&gt;<a class="code" href="struct_lode_p_n_g___info_png.html#acce58518f72f42ba94db4c1cfd69336b">color</a>); <span class="keywordflow">if</span>(error) <span class="keywordflow">return</span> error;</div>
<div class="line"><a name="l02767"></a><span class="lineno"> 2767</span>&#160;</div>
<div class="line"><a name="l02768"></a><span class="lineno"> 2768</span>&#160;<span class="preprocessor">#ifdef LODEPNG_COMPILE_ANCILLARY_CHUNKS</span></div>
<div class="line"><a name="l02769"></a><span class="lineno"> 2769</span>&#160;<span class="preprocessor"></span>  error = <a class="code" href="lodepng_8cpp.html#a924159ab70e41380aff27ba6c54e258f">LodePNG_Text_copy</a>(&amp;dest-&gt;<a class="code" href="struct_lode_p_n_g___info_png.html#a2ba6d900f4eee624a18df252e9df40e9">text</a>, &amp;source-&gt;<a class="code" href="struct_lode_p_n_g___info_png.html#a2ba6d900f4eee624a18df252e9df40e9">text</a>); <span class="keywordflow">if</span>(error) <span class="keywordflow">return</span> error;</div>
<div class="line"><a name="l02770"></a><span class="lineno"> 2770</span>&#160;  error = <a class="code" href="lodepng_8cpp.html#a894c6c210779b2187070ac0551e3ade6">LodePNG_IText_copy</a>(&amp;dest-&gt;<a class="code" href="struct_lode_p_n_g___info_png.html#a6a25d5f857d5e8d1c326997b78d9daf1">itext</a>, &amp;source-&gt;<a class="code" href="struct_lode_p_n_g___info_png.html#a6a25d5f857d5e8d1c326997b78d9daf1">itext</a>); <span class="keywordflow">if</span>(error) <span class="keywordflow">return</span> error;</div>
<div class="line"><a name="l02771"></a><span class="lineno"> 2771</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/*LODEPNG_COMPILE_ANCILLARY_CHUNKS*/</span><span class="preprocessor"></span></div>
<div class="line"><a name="l02772"></a><span class="lineno"> 2772</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l02773"></a><span class="lineno"> 2773</span>&#160;<span class="preprocessor">#ifdef LODEPNG_COMPILE_UNKNOWN_CHUNKS</span></div>
<div class="line"><a name="l02774"></a><span class="lineno"> 2774</span>&#160;<span class="preprocessor"></span>  <a class="code" href="lodepng_8cpp.html#a4af200ba997cfba6319267d2f970dfa3">LodePNG_UnknownChunks_init</a>(&amp;dest-&gt;<a class="code" href="struct_lode_p_n_g___info_png.html#a97faa43bfd4e8f8df1cd836c713edac3">unknown_chunks</a>);</div>
<div class="line"><a name="l02775"></a><span class="lineno"> 2775</span>&#160;  error = <a class="code" href="lodepng_8cpp.html#ace44ddf46ee78445d379279be6f9cf7d">LodePNG_UnknownChunks_copy</a>(&amp;dest-&gt;<a class="code" href="struct_lode_p_n_g___info_png.html#a97faa43bfd4e8f8df1cd836c713edac3">unknown_chunks</a>, &amp;source-&gt;<a class="code" href="struct_lode_p_n_g___info_png.html#a97faa43bfd4e8f8df1cd836c713edac3">unknown_chunks</a>); <span class="keywordflow">if</span>(error) <span class="keywordflow">return</span> error;</div>
<div class="line"><a name="l02776"></a><span class="lineno"> 2776</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/*LODEPNG_COMPILE_UNKNOWN_CHUNKS*/</span><span class="preprocessor"></span></div>
<div class="line"><a name="l02777"></a><span class="lineno"> 2777</span>&#160;<span class="preprocessor"></span>  <span class="keywordflow">return</span> error;</div>
<div class="line"><a name="l02778"></a><span class="lineno"> 2778</span>&#160;}</div>
<div class="line"><a name="l02779"></a><span class="lineno"> 2779</span>&#160;</div>
<div class="line"><a name="l02780"></a><span class="lineno"><a class="line" href="lodepng_8cpp.html#a64f7d3440fc708f7a349e11324119b52"> 2780</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="lodepng_8cpp.html#a64f7d3440fc708f7a349e11324119b52">LodePNG_InfoPng_swap</a>(<a class="code" href="struct_lode_p_n_g___info_png.html">LodePNG_InfoPng</a>* a, <a class="code" href="struct_lode_p_n_g___info_png.html">LodePNG_InfoPng</a>* b)</div>
<div class="line"><a name="l02781"></a><span class="lineno"> 2781</span>&#160;{</div>
<div class="line"><a name="l02782"></a><span class="lineno"> 2782</span>&#160;  <a class="code" href="struct_lode_p_n_g___info_png.html">LodePNG_InfoPng</a> temp = *a;</div>
<div class="line"><a name="l02783"></a><span class="lineno"> 2783</span>&#160;  *a = *b;</div>
<div class="line"><a name="l02784"></a><span class="lineno"> 2784</span>&#160;  *b = temp;</div>
<div class="line"><a name="l02785"></a><span class="lineno"> 2785</span>&#160;}</div>
<div class="line"><a name="l02786"></a><span class="lineno"> 2786</span>&#160;</div>
<div class="line"><a name="l02787"></a><span class="lineno"><a class="line" href="lodepng_8h.html#ad7beb96e92dd01a605c669af79a54a00"> 2787</a></span>&#160;<span class="keywordtype">unsigned</span> <a class="code" href="lodepng_8cpp.html#ad7beb96e92dd01a605c669af79a54a00">LodePNG_InfoColor_copy</a>(<a class="code" href="struct_lode_p_n_g___info_color.html">LodePNG_InfoColor</a>* dest, <span class="keyword">const</span> <a class="code" href="struct_lode_p_n_g___info_color.html">LodePNG_InfoColor</a>* source)</div>
<div class="line"><a name="l02788"></a><span class="lineno"> 2788</span>&#160;{</div>
<div class="line"><a name="l02789"></a><span class="lineno"> 2789</span>&#160;  <span class="keywordtype">size_t</span> i;</div>
<div class="line"><a name="l02790"></a><span class="lineno"> 2790</span>&#160;  <a class="code" href="lodepng_8cpp.html#a2f5ecf25393f688611987c61f698f1ce">LodePNG_InfoColor_cleanup</a>(dest);</div>
<div class="line"><a name="l02791"></a><span class="lineno"> 2791</span>&#160;  *dest = *source;</div>
<div class="line"><a name="l02792"></a><span class="lineno"> 2792</span>&#160;  dest-&gt;<a class="code" href="struct_lode_p_n_g___info_color.html#ac6de7ff58cb1f39a73567abb826f72f5">palette</a> = (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>*)<a class="code" href="namespace_f_w.html#a440e071d8fdbc9789b728245caad99c0">malloc</a>(source-&gt;<a class="code" href="struct_lode_p_n_g___info_color.html#a49842a304ffd0abc8aa791030c5fa5dd">palettesize</a> * 4);</div>
<div class="line"><a name="l02793"></a><span class="lineno"> 2793</span>&#160;  <span class="keywordflow">if</span>(!dest-&gt;<a class="code" href="struct_lode_p_n_g___info_color.html#ac6de7ff58cb1f39a73567abb826f72f5">palette</a> &amp;&amp; source-&gt;<a class="code" href="struct_lode_p_n_g___info_color.html#a49842a304ffd0abc8aa791030c5fa5dd">palettesize</a>) <span class="keywordflow">return</span> 9935; <span class="comment">/*alloc fail*/</span></div>
<div class="line"><a name="l02794"></a><span class="lineno"> 2794</span>&#160;  <span class="keywordflow">for</span>(i = 0; i &lt; source-&gt;<a class="code" href="struct_lode_p_n_g___info_color.html#a49842a304ffd0abc8aa791030c5fa5dd">palettesize</a> * 4; i++) dest-&gt;<a class="code" href="struct_lode_p_n_g___info_color.html#ac6de7ff58cb1f39a73567abb826f72f5">palette</a>[i] = source-&gt;<a class="code" href="struct_lode_p_n_g___info_color.html#ac6de7ff58cb1f39a73567abb826f72f5">palette</a>[i];</div>
<div class="line"><a name="l02795"></a><span class="lineno"> 2795</span>&#160;  <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l02796"></a><span class="lineno"> 2796</span>&#160;}</div>
<div class="line"><a name="l02797"></a><span class="lineno"> 2797</span>&#160;</div>
<div class="line"><a name="l02798"></a><span class="lineno"><a class="line" href="lodepng_8h.html#a279c66151f5c87b2225ebe866ce98f71"> 2798</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="lodepng_8cpp.html#a279c66151f5c87b2225ebe866ce98f71">LodePNG_InfoRaw_init</a>(<a class="code" href="struct_lode_p_n_g___info_raw.html">LodePNG_InfoRaw</a>* info)</div>
<div class="line"><a name="l02799"></a><span class="lineno"> 2799</span>&#160;{</div>
<div class="line"><a name="l02800"></a><span class="lineno"> 2800</span>&#160;  <a class="code" href="lodepng_8cpp.html#abaea3ca539b3d5f1624ac8286f47b34c">LodePNG_InfoColor_init</a>(&amp;info-&gt;<a class="code" href="struct_lode_p_n_g___info_raw.html#ae9fa1c020358980be41f861ab71589fb">color</a>);</div>
<div class="line"><a name="l02801"></a><span class="lineno"> 2801</span>&#160;}</div>
<div class="line"><a name="l02802"></a><span class="lineno"> 2802</span>&#160;</div>
<div class="line"><a name="l02803"></a><span class="lineno"><a class="line" href="lodepng_8h.html#ae8ee35b701bba217323f27723d2690f5"> 2803</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="lodepng_8cpp.html#ae8ee35b701bba217323f27723d2690f5">LodePNG_InfoRaw_cleanup</a>(<a class="code" href="struct_lode_p_n_g___info_raw.html">LodePNG_InfoRaw</a>* info)</div>
<div class="line"><a name="l02804"></a><span class="lineno"> 2804</span>&#160;{</div>
<div class="line"><a name="l02805"></a><span class="lineno"> 2805</span>&#160;  <a class="code" href="lodepng_8cpp.html#a2f5ecf25393f688611987c61f698f1ce">LodePNG_InfoColor_cleanup</a>(&amp;info-&gt;<a class="code" href="struct_lode_p_n_g___info_raw.html#ae9fa1c020358980be41f861ab71589fb">color</a>);</div>
<div class="line"><a name="l02806"></a><span class="lineno"> 2806</span>&#160;}</div>
<div class="line"><a name="l02807"></a><span class="lineno"> 2807</span>&#160;</div>
<div class="line"><a name="l02808"></a><span class="lineno"><a class="line" href="lodepng_8h.html#a745b94bf14f6c3497b6280863e71e5a6"> 2808</a></span>&#160;<span class="keywordtype">unsigned</span> <a class="code" href="lodepng_8cpp.html#a745b94bf14f6c3497b6280863e71e5a6">LodePNG_InfoRaw_copy</a>(<a class="code" href="struct_lode_p_n_g___info_raw.html">LodePNG_InfoRaw</a>* dest, <span class="keyword">const</span> <a class="code" href="struct_lode_p_n_g___info_raw.html">LodePNG_InfoRaw</a>* source)</div>
<div class="line"><a name="l02809"></a><span class="lineno"> 2809</span>&#160;{</div>
<div class="line"><a name="l02810"></a><span class="lineno"> 2810</span>&#160;  <span class="keywordtype">unsigned</span> error = 0;</div>
<div class="line"><a name="l02811"></a><span class="lineno"> 2811</span>&#160;  <a class="code" href="lodepng_8cpp.html#ae8ee35b701bba217323f27723d2690f5">LodePNG_InfoRaw_cleanup</a>(dest);</div>
<div class="line"><a name="l02812"></a><span class="lineno"> 2812</span>&#160;  *dest = *source;</div>
<div class="line"><a name="l02813"></a><span class="lineno"> 2813</span>&#160;  <a class="code" href="lodepng_8cpp.html#abaea3ca539b3d5f1624ac8286f47b34c">LodePNG_InfoColor_init</a>(&amp;dest-&gt;<a class="code" href="struct_lode_p_n_g___info_raw.html#ae9fa1c020358980be41f861ab71589fb">color</a>);</div>
<div class="line"><a name="l02814"></a><span class="lineno"> 2814</span>&#160;  error = <a class="code" href="lodepng_8cpp.html#ad7beb96e92dd01a605c669af79a54a00">LodePNG_InfoColor_copy</a>(&amp;dest-&gt;<a class="code" href="struct_lode_p_n_g___info_raw.html#ae9fa1c020358980be41f861ab71589fb">color</a>, &amp;source-&gt;<a class="code" href="struct_lode_p_n_g___info_raw.html#ae9fa1c020358980be41f861ab71589fb">color</a>);</div>
<div class="line"><a name="l02815"></a><span class="lineno"> 2815</span>&#160;  <span class="keywordflow">return</span> error; <span class="comment">/*this variable could be removed, but it&#39;s more clear what is returned this way*/</span></div>
<div class="line"><a name="l02816"></a><span class="lineno"> 2816</span>&#160;}</div>
<div class="line"><a name="l02817"></a><span class="lineno"> 2817</span>&#160;</div>
<div class="line"><a name="l02818"></a><span class="lineno"> 2818</span>&#160;<span class="comment">/* ////////////////////////////////////////////////////////////////////////// */</span></div>
<div class="line"><a name="l02819"></a><span class="lineno"> 2819</span>&#160;</div>
<div class="line"><a name="l02820"></a><span class="lineno"> 2820</span>&#160;<span class="comment">/*convert from any color type to RGB or RGBA with 8 bits per sample*/</span></div>
<div class="line"><a name="l02821"></a><span class="lineno"> 2821</span>&#160;<span class="keyword">static</span> <span class="keywordtype">unsigned</span> LodePNG_convert_rgb_a_8(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* out, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* in,</div>
<div class="line"><a name="l02822"></a><span class="lineno"> 2822</span>&#160;                                        <a class="code" href="struct_lode_p_n_g___info_color.html">LodePNG_InfoColor</a>* infoIn, <span class="keywordtype">size_t</span> numpixels, <span class="keywordtype">unsigned</span> <a class="code" href="_d_l_l_imports_8inl.html#abd7736f9cab649e6a7b4c85084454cdf">bytes</a>, <span class="keywordtype">unsigned</span> alpha)</div>
<div class="line"><a name="l02823"></a><span class="lineno"> 2823</span>&#160;{</div>
<div class="line"><a name="l02824"></a><span class="lineno"> 2824</span>&#160;  <span class="keywordtype">size_t</span> i, c, bp = 0; <span class="comment">/*bp = bitpointer, used by less-than-8-bit color types*/</span></div>
<div class="line"><a name="l02825"></a><span class="lineno"> 2825</span>&#160;</div>
<div class="line"><a name="l02826"></a><span class="lineno"> 2826</span>&#160;  <span class="keywordflow">if</span>(infoIn-&gt;<a class="code" href="struct_lode_p_n_g___info_color.html#a9d538965a46d59bbdea744da8b290591">bitDepth</a> == 8)</div>
<div class="line"><a name="l02827"></a><span class="lineno"> 2827</span>&#160;  {</div>
<div class="line"><a name="l02828"></a><span class="lineno"> 2828</span>&#160;    <span class="keywordflow">switch</span>(infoIn-&gt;<a class="code" href="struct_lode_p_n_g___info_color.html#a4ed18d179c5078137a18e742b1c41a00">colorType</a>)</div>
<div class="line"><a name="l02829"></a><span class="lineno"> 2829</span>&#160;    {</div>
<div class="line"><a name="l02830"></a><span class="lineno"> 2830</span>&#160;      <span class="keywordflow">case</span> 0: <span class="comment">/*greyscale color*/</span></div>
<div class="line"><a name="l02831"></a><span class="lineno"> 2831</span>&#160;        <span class="keywordflow">for</span>(i = 0; i &lt; numpixels; i++)</div>
<div class="line"><a name="l02832"></a><span class="lineno"> 2832</span>&#160;        {</div>
<div class="line"><a name="l02833"></a><span class="lineno"> 2833</span>&#160;          out[bytes * i + 0] = out[bytes * i + 1] = out[bytes * i + 2] = in[i];</div>
<div class="line"><a name="l02834"></a><span class="lineno"> 2834</span>&#160;          <span class="keywordflow">if</span>(alpha) out[bytes * i + 3] = infoIn-&gt;<a class="code" href="struct_lode_p_n_g___info_color.html#aa0193ce13025c776a0dfb1e6d1bed14a">key_defined</a> &amp;&amp; in[i] == infoIn-&gt;<a class="code" href="struct_lode_p_n_g___info_color.html#a5536a8859201cd11df789ec7ad8263df">key_r</a> ? 0 : 255;</div>
<div class="line"><a name="l02835"></a><span class="lineno"> 2835</span>&#160;        }</div>
<div class="line"><a name="l02836"></a><span class="lineno"> 2836</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02837"></a><span class="lineno"> 2837</span>&#160;      <span class="keywordflow">case</span> 2: <span class="comment">/*RGB color*/</span></div>
<div class="line"><a name="l02838"></a><span class="lineno"> 2838</span>&#160;        <span class="keywordflow">for</span>(i = 0; i &lt; numpixels; i++)</div>
<div class="line"><a name="l02839"></a><span class="lineno"> 2839</span>&#160;        {</div>
<div class="line"><a name="l02840"></a><span class="lineno"> 2840</span>&#160;          <span class="keywordflow">for</span>(c = 0; c &lt; 3; c++) out[bytes * i + c] = in[3 * i + c];</div>
<div class="line"><a name="l02841"></a><span class="lineno"> 2841</span>&#160;          <span class="keywordflow">if</span>(alpha)</div>
<div class="line"><a name="l02842"></a><span class="lineno"> 2842</span>&#160;          {</div>
<div class="line"><a name="l02843"></a><span class="lineno"> 2843</span>&#160;            <span class="keywordflow">if</span>(infoIn-&gt;<a class="code" href="struct_lode_p_n_g___info_color.html#aa0193ce13025c776a0dfb1e6d1bed14a">key_defined</a> == 1 &amp;&amp; in[3 * i + 0] == infoIn-&gt;<a class="code" href="struct_lode_p_n_g___info_color.html#a5536a8859201cd11df789ec7ad8263df">key_r</a></div>
<div class="line"><a name="l02844"></a><span class="lineno"> 2844</span>&#160;               &amp;&amp; in[3 * i + 1] == infoIn-&gt;<a class="code" href="struct_lode_p_n_g___info_color.html#a44bf4906335328972acebd6c8b83a073">key_g</a> &amp;&amp; in[3 * i + 2] == infoIn-&gt;<a class="code" href="struct_lode_p_n_g___info_color.html#a9f99cc5b4366f1eed325d13b4f191560">key_b</a>)</div>
<div class="line"><a name="l02845"></a><span class="lineno"> 2845</span>&#160;              out[bytes * i + 3] = 0;</div>
<div class="line"><a name="l02846"></a><span class="lineno"> 2846</span>&#160;            <span class="keywordflow">else</span> out[bytes * i + 3] = 255;</div>
<div class="line"><a name="l02847"></a><span class="lineno"> 2847</span>&#160;          }</div>
<div class="line"><a name="l02848"></a><span class="lineno"> 2848</span>&#160;        }</div>
<div class="line"><a name="l02849"></a><span class="lineno"> 2849</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02850"></a><span class="lineno"> 2850</span>&#160;      <span class="keywordflow">case</span> 3: <span class="comment">/*indexed color (palette)*/</span></div>
<div class="line"><a name="l02851"></a><span class="lineno"> 2851</span>&#160;        <span class="keywordflow">for</span>(i = 0; i &lt; numpixels; i++)</div>
<div class="line"><a name="l02852"></a><span class="lineno"> 2852</span>&#160;        {</div>
<div class="line"><a name="l02853"></a><span class="lineno"> 2853</span>&#160;          <span class="keywordflow">if</span>(in[i] &gt;= infoIn-&gt;<a class="code" href="struct_lode_p_n_g___info_color.html#a49842a304ffd0abc8aa791030c5fa5dd">palettesize</a>) <span class="keywordflow">return</span> 46; <span class="comment">/*invalid palette index*/</span></div>
<div class="line"><a name="l02854"></a><span class="lineno"> 2854</span>&#160;          <span class="keywordflow">for</span>(c = 0; c &lt; <a class="code" href="_d_l_l_imports_8inl.html#abd7736f9cab649e6a7b4c85084454cdf">bytes</a>; c++) out[bytes * i + c] = infoIn-&gt;<a class="code" href="struct_lode_p_n_g___info_color.html#ac6de7ff58cb1f39a73567abb826f72f5">palette</a>[4 * in[i] + c];</div>
<div class="line"><a name="l02855"></a><span class="lineno"> 2855</span>&#160;        }</div>
<div class="line"><a name="l02856"></a><span class="lineno"> 2856</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02857"></a><span class="lineno"> 2857</span>&#160;      <span class="keywordflow">case</span> 4: <span class="comment">/*greyscale with alpha*/</span></div>
<div class="line"><a name="l02858"></a><span class="lineno"> 2858</span>&#160;        <span class="keywordflow">for</span>(i = 0; i &lt; numpixels; i++)</div>
<div class="line"><a name="l02859"></a><span class="lineno"> 2859</span>&#160;        {</div>
<div class="line"><a name="l02860"></a><span class="lineno"> 2860</span>&#160;          out[bytes * i + 0] = out[bytes * i + 1] = out[bytes * i + 2] = in[2 * i + 0];</div>
<div class="line"><a name="l02861"></a><span class="lineno"> 2861</span>&#160;          <span class="keywordflow">if</span>(alpha) out[bytes * i + 3] = in[2 * i + 1];</div>
<div class="line"><a name="l02862"></a><span class="lineno"> 2862</span>&#160;        }</div>
<div class="line"><a name="l02863"></a><span class="lineno"> 2863</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02864"></a><span class="lineno"> 2864</span>&#160;      <span class="keywordflow">case</span> 6: <span class="comment">/*RGB with alpha*/</span></div>
<div class="line"><a name="l02865"></a><span class="lineno"> 2865</span>&#160;        <span class="keywordflow">for</span>(i = 0; i &lt; numpixels; i++)</div>
<div class="line"><a name="l02866"></a><span class="lineno"> 2866</span>&#160;        {</div>
<div class="line"><a name="l02867"></a><span class="lineno"> 2867</span>&#160;          <span class="keywordflow">for</span>(c = 0; c &lt; <a class="code" href="_d_l_l_imports_8inl.html#abd7736f9cab649e6a7b4c85084454cdf">bytes</a>; c++) out[bytes * i + c] = in[4 * i + c];</div>
<div class="line"><a name="l02868"></a><span class="lineno"> 2868</span>&#160;        }</div>
<div class="line"><a name="l02869"></a><span class="lineno"> 2869</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02870"></a><span class="lineno"> 2870</span>&#160;      <span class="keywordflow">default</span>: <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02871"></a><span class="lineno"> 2871</span>&#160;    }</div>
<div class="line"><a name="l02872"></a><span class="lineno"> 2872</span>&#160;  }</div>
<div class="line"><a name="l02873"></a><span class="lineno"> 2873</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span>(infoIn-&gt;<a class="code" href="struct_lode_p_n_g___info_color.html#a9d538965a46d59bbdea744da8b290591">bitDepth</a> == 16)</div>
<div class="line"><a name="l02874"></a><span class="lineno"> 2874</span>&#160;  {</div>
<div class="line"><a name="l02875"></a><span class="lineno"> 2875</span>&#160;    <span class="keywordflow">switch</span>(infoIn-&gt;<a class="code" href="struct_lode_p_n_g___info_color.html#a4ed18d179c5078137a18e742b1c41a00">colorType</a>)</div>
<div class="line"><a name="l02876"></a><span class="lineno"> 2876</span>&#160;    {</div>
<div class="line"><a name="l02877"></a><span class="lineno"> 2877</span>&#160;      <span class="keywordflow">case</span> 0: <span class="comment">/*greyscale color*/</span></div>
<div class="line"><a name="l02878"></a><span class="lineno"> 2878</span>&#160;        <span class="keywordflow">for</span>(i = 0; i &lt; numpixels; i++)</div>
<div class="line"><a name="l02879"></a><span class="lineno"> 2879</span>&#160;        {</div>
<div class="line"><a name="l02880"></a><span class="lineno"> 2880</span>&#160;          out[bytes * i + 0] = out[bytes * i + 1] = out[bytes * i + 2] = in[2 * i];</div>
<div class="line"><a name="l02881"></a><span class="lineno"> 2881</span>&#160;          <span class="keywordflow">if</span>(alpha) out[bytes * i + 3] = infoIn-&gt;<a class="code" href="struct_lode_p_n_g___info_color.html#aa0193ce13025c776a0dfb1e6d1bed14a">key_defined</a> &amp;&amp; 256U * in[i] + in[i + 1] == infoIn-&gt;<a class="code" href="struct_lode_p_n_g___info_color.html#a5536a8859201cd11df789ec7ad8263df">key_r</a> ? 0 : 255;</div>
<div class="line"><a name="l02882"></a><span class="lineno"> 2882</span>&#160;        }</div>
<div class="line"><a name="l02883"></a><span class="lineno"> 2883</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02884"></a><span class="lineno"> 2884</span>&#160;      <span class="keywordflow">case</span> 2: <span class="comment">/*RGB color*/</span></div>
<div class="line"><a name="l02885"></a><span class="lineno"> 2885</span>&#160;        <span class="keywordflow">for</span>(i = 0; i &lt; numpixels; i++)</div>
<div class="line"><a name="l02886"></a><span class="lineno"> 2886</span>&#160;        {</div>
<div class="line"><a name="l02887"></a><span class="lineno"> 2887</span>&#160;          <span class="keywordflow">if</span>(alpha) out[bytes * i + 3] = 255;</div>
<div class="line"><a name="l02888"></a><span class="lineno"> 2888</span>&#160;          <span class="keywordflow">for</span>(c = 0; c &lt; 3; c++) out[bytes * i + c] = in[6 * i + 2 * c];</div>
<div class="line"><a name="l02889"></a><span class="lineno"> 2889</span>&#160;          <span class="keywordflow">if</span>(alpha)</div>
<div class="line"><a name="l02890"></a><span class="lineno"> 2890</span>&#160;          {</div>
<div class="line"><a name="l02891"></a><span class="lineno"> 2891</span>&#160;            <span class="keywordflow">if</span>(infoIn-&gt;<a class="code" href="struct_lode_p_n_g___info_color.html#aa0193ce13025c776a0dfb1e6d1bed14a">key_defined</a> &amp;&amp; 256U * in[6 * i + 0] + in[6 * i + 1] == infoIn-&gt;<a class="code" href="struct_lode_p_n_g___info_color.html#a5536a8859201cd11df789ec7ad8263df">key_r</a></div>
<div class="line"><a name="l02892"></a><span class="lineno"> 2892</span>&#160;               &amp;&amp; 256U * in[6 * i + 2] + in[6 * i + 3] == infoIn-&gt;<a class="code" href="struct_lode_p_n_g___info_color.html#a44bf4906335328972acebd6c8b83a073">key_g</a></div>
<div class="line"><a name="l02893"></a><span class="lineno"> 2893</span>&#160;               &amp;&amp; 256U * in[6 * i + 4] + in[6 * i + 5] == infoIn-&gt;<a class="code" href="struct_lode_p_n_g___info_color.html#a9f99cc5b4366f1eed325d13b4f191560">key_b</a>)</div>
<div class="line"><a name="l02894"></a><span class="lineno"> 2894</span>&#160;              out[bytes * i + 3] = 0;</div>
<div class="line"><a name="l02895"></a><span class="lineno"> 2895</span>&#160;            <span class="keywordflow">else</span> out[bytes * i + 3] = 255;</div>
<div class="line"><a name="l02896"></a><span class="lineno"> 2896</span>&#160;          }</div>
<div class="line"><a name="l02897"></a><span class="lineno"> 2897</span>&#160;        }</div>
<div class="line"><a name="l02898"></a><span class="lineno"> 2898</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02899"></a><span class="lineno"> 2899</span>&#160;      <span class="keywordflow">case</span> 4: <span class="comment">/*greyscale with alpha*/</span></div>
<div class="line"><a name="l02900"></a><span class="lineno"> 2900</span>&#160;        <span class="keywordflow">for</span>(i = 0; i &lt; numpixels; i++)</div>
<div class="line"><a name="l02901"></a><span class="lineno"> 2901</span>&#160;        {</div>
<div class="line"><a name="l02902"></a><span class="lineno"> 2902</span>&#160;          out[bytes * i + 0] = out[bytes * i + 1] = out[bytes * i + 2] = in[4 * i];</div>
<div class="line"><a name="l02903"></a><span class="lineno"> 2903</span>&#160;          <span class="keywordflow">if</span>(alpha) out[bytes * i + 3] = in[4 * i + 2];</div>
<div class="line"><a name="l02904"></a><span class="lineno"> 2904</span>&#160;        }</div>
<div class="line"><a name="l02905"></a><span class="lineno"> 2905</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02906"></a><span class="lineno"> 2906</span>&#160;      <span class="keywordflow">case</span> 6: <span class="comment">/*RGB with alpha*/</span></div>
<div class="line"><a name="l02907"></a><span class="lineno"> 2907</span>&#160;        <span class="keywordflow">for</span>(i = 0; i &lt; numpixels; i++)</div>
<div class="line"><a name="l02908"></a><span class="lineno"> 2908</span>&#160;        {</div>
<div class="line"><a name="l02909"></a><span class="lineno"> 2909</span>&#160;          <span class="keywordflow">for</span>(c = 0; c &lt; <a class="code" href="_d_l_l_imports_8inl.html#abd7736f9cab649e6a7b4c85084454cdf">bytes</a>; c++) out[bytes * i + c] = in[8 * i + 2 * c];</div>
<div class="line"><a name="l02910"></a><span class="lineno"> 2910</span>&#160;        }</div>
<div class="line"><a name="l02911"></a><span class="lineno"> 2911</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02912"></a><span class="lineno"> 2912</span>&#160;      <span class="keywordflow">default</span>: <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02913"></a><span class="lineno"> 2913</span>&#160;    }</div>
<div class="line"><a name="l02914"></a><span class="lineno"> 2914</span>&#160;  }</div>
<div class="line"><a name="l02915"></a><span class="lineno"> 2915</span>&#160;  <span class="keywordflow">else</span> <span class="comment">/*infoIn-&gt;bitDepth is less than 8 bit per channel*/</span></div>
<div class="line"><a name="l02916"></a><span class="lineno"> 2916</span>&#160;  {</div>
<div class="line"><a name="l02917"></a><span class="lineno"> 2917</span>&#160;    <span class="keywordflow">switch</span>(infoIn-&gt;<a class="code" href="struct_lode_p_n_g___info_color.html#a4ed18d179c5078137a18e742b1c41a00">colorType</a>)</div>
<div class="line"><a name="l02918"></a><span class="lineno"> 2918</span>&#160;    {</div>
<div class="line"><a name="l02919"></a><span class="lineno"> 2919</span>&#160;      <span class="keywordflow">case</span> 0: <span class="comment">/*greyscale color*/</span></div>
<div class="line"><a name="l02920"></a><span class="lineno"> 2920</span>&#160;        <span class="keywordflow">for</span>(i = 0; i &lt; numpixels; i++)</div>
<div class="line"><a name="l02921"></a><span class="lineno"> 2921</span>&#160;        {</div>
<div class="line"><a name="l02922"></a><span class="lineno"> 2922</span>&#160;          <span class="keywordtype">unsigned</span> value = readBitsFromReversedStream(&amp;bp, in, infoIn-&gt;<a class="code" href="struct_lode_p_n_g___info_color.html#a9d538965a46d59bbdea744da8b290591">bitDepth</a>);</div>
<div class="line"><a name="l02923"></a><span class="lineno"> 2923</span>&#160;          <span class="keywordtype">unsigned</span> highest = ((1U &lt;&lt; infoIn-&gt;<a class="code" href="struct_lode_p_n_g___info_color.html#a9d538965a46d59bbdea744da8b290591">bitDepth</a>) - 1U); <span class="comment">/*highest possible value for this bit depth*/</span></div>
<div class="line"><a name="l02924"></a><span class="lineno"> 2924</span>&#160;          <span class="comment">/*scale value from 0 to 255*/</span></div>
<div class="line"><a name="l02925"></a><span class="lineno"> 2925</span>&#160;          out[bytes * i + 0] = out[bytes * i + 1] = out[bytes * i + 2]</div>
<div class="line"><a name="l02926"></a><span class="lineno"> 2926</span>&#160;                             = (<span class="keywordtype">unsigned</span> char)((value * 255) / highest);</div>
<div class="line"><a name="l02927"></a><span class="lineno"> 2927</span>&#160;          <span class="keywordflow">if</span>(alpha) out[bytes * i + 3] = infoIn-&gt;<a class="code" href="struct_lode_p_n_g___info_color.html#aa0193ce13025c776a0dfb1e6d1bed14a">key_defined</a> &amp;&amp; value == infoIn-&gt;<a class="code" href="struct_lode_p_n_g___info_color.html#a5536a8859201cd11df789ec7ad8263df">key_r</a> ? 0 : 255;</div>
<div class="line"><a name="l02928"></a><span class="lineno"> 2928</span>&#160;        }</div>
<div class="line"><a name="l02929"></a><span class="lineno"> 2929</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02930"></a><span class="lineno"> 2930</span>&#160;      <span class="keywordflow">case</span> 3: <span class="comment">/*indexed color (palette)*/</span></div>
<div class="line"><a name="l02931"></a><span class="lineno"> 2931</span>&#160;        <span class="keywordflow">for</span>(i = 0; i &lt; numpixels; i++)</div>
<div class="line"><a name="l02932"></a><span class="lineno"> 2932</span>&#160;        {</div>
<div class="line"><a name="l02933"></a><span class="lineno"> 2933</span>&#160;          <span class="keywordtype">unsigned</span> value = readBitsFromReversedStream(&amp;bp, in, infoIn-&gt;<a class="code" href="struct_lode_p_n_g___info_color.html#a9d538965a46d59bbdea744da8b290591">bitDepth</a>);</div>
<div class="line"><a name="l02934"></a><span class="lineno"> 2934</span>&#160;          <span class="keywordflow">if</span>(value &gt;= infoIn-&gt;<a class="code" href="struct_lode_p_n_g___info_color.html#a49842a304ffd0abc8aa791030c5fa5dd">palettesize</a>) <span class="keywordflow">return</span> 47;</div>
<div class="line"><a name="l02935"></a><span class="lineno"> 2935</span>&#160;          <span class="keywordflow">for</span>(c = 0; c &lt; <a class="code" href="_d_l_l_imports_8inl.html#abd7736f9cab649e6a7b4c85084454cdf">bytes</a>; c++) out[bytes * i + c] = infoIn-&gt;<a class="code" href="struct_lode_p_n_g___info_color.html#ac6de7ff58cb1f39a73567abb826f72f5">palette</a>[4 * value + c];</div>
<div class="line"><a name="l02936"></a><span class="lineno"> 2936</span>&#160;        }</div>
<div class="line"><a name="l02937"></a><span class="lineno"> 2937</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02938"></a><span class="lineno"> 2938</span>&#160;      <span class="keywordflow">default</span>: <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02939"></a><span class="lineno"> 2939</span>&#160;    }</div>
<div class="line"><a name="l02940"></a><span class="lineno"> 2940</span>&#160;  }</div>
<div class="line"><a name="l02941"></a><span class="lineno"> 2941</span>&#160;  <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l02942"></a><span class="lineno"> 2942</span>&#160;}</div>
<div class="line"><a name="l02943"></a><span class="lineno"> 2943</span>&#160;</div>
<div class="line"><a name="l02944"></a><span class="lineno"> 2944</span>&#160;<span class="comment">/*convert from any greyscale color type to 8-bit greyscale with or without alpha channel*/</span></div>
<div class="line"><a name="l02945"></a><span class="lineno"> 2945</span>&#160;<span class="keyword">static</span> <span class="keywordtype">unsigned</span> LodePNG_convert_grey_8(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* out, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* in,</div>
<div class="line"><a name="l02946"></a><span class="lineno"> 2946</span>&#160;                                       <a class="code" href="struct_lode_p_n_g___info_color.html">LodePNG_InfoColor</a>* infoIn, <span class="keywordtype">size_t</span> numpixels, <span class="keywordtype">unsigned</span> bytes, <span class="keywordtype">unsigned</span> alpha)</div>
<div class="line"><a name="l02947"></a><span class="lineno"> 2947</span>&#160;{</div>
<div class="line"><a name="l02948"></a><span class="lineno"> 2948</span>&#160;  <span class="keywordtype">size_t</span> i, bp = 0; <span class="comment">/*bp = bitpointer, used by less-than-8-bit color types*/</span></div>
<div class="line"><a name="l02949"></a><span class="lineno"> 2949</span>&#160;</div>
<div class="line"><a name="l02950"></a><span class="lineno"> 2950</span>&#160;  <span class="keywordflow">if</span>(infoIn-&gt;<a class="code" href="struct_lode_p_n_g___info_color.html#a9d538965a46d59bbdea744da8b290591">bitDepth</a> == 8)</div>
<div class="line"><a name="l02951"></a><span class="lineno"> 2951</span>&#160;  {</div>
<div class="line"><a name="l02952"></a><span class="lineno"> 2952</span>&#160;    <span class="keywordflow">switch</span>(infoIn-&gt;<a class="code" href="struct_lode_p_n_g___info_color.html#a4ed18d179c5078137a18e742b1c41a00">colorType</a>)</div>
<div class="line"><a name="l02953"></a><span class="lineno"> 2953</span>&#160;    {</div>
<div class="line"><a name="l02954"></a><span class="lineno"> 2954</span>&#160;      <span class="keywordflow">case</span> 0: <span class="comment">/*greyscale color*/</span></div>
<div class="line"><a name="l02955"></a><span class="lineno"> 2955</span>&#160;        <span class="keywordflow">for</span>(i = 0; i &lt; numpixels; i++)</div>
<div class="line"><a name="l02956"></a><span class="lineno"> 2956</span>&#160;        {</div>
<div class="line"><a name="l02957"></a><span class="lineno"> 2957</span>&#160;          out[bytes * i] = in[i];</div>
<div class="line"><a name="l02958"></a><span class="lineno"> 2958</span>&#160;          <span class="keywordflow">if</span>(alpha) out[bytes * i + 1] = infoIn-&gt;<a class="code" href="struct_lode_p_n_g___info_color.html#aa0193ce13025c776a0dfb1e6d1bed14a">key_defined</a> &amp;&amp; in[i] == infoIn-&gt;<a class="code" href="struct_lode_p_n_g___info_color.html#a5536a8859201cd11df789ec7ad8263df">key_r</a> ? 0 : 255;</div>
<div class="line"><a name="l02959"></a><span class="lineno"> 2959</span>&#160;        }</div>
<div class="line"><a name="l02960"></a><span class="lineno"> 2960</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02961"></a><span class="lineno"> 2961</span>&#160;      <span class="keywordflow">case</span> 4: <span class="comment">/*greyscale with alpha*/</span></div>
<div class="line"><a name="l02962"></a><span class="lineno"> 2962</span>&#160;        <span class="keywordflow">for</span>(i = 0; i &lt; numpixels; i++)</div>
<div class="line"><a name="l02963"></a><span class="lineno"> 2963</span>&#160;        {</div>
<div class="line"><a name="l02964"></a><span class="lineno"> 2964</span>&#160;          out[bytes * i + 0] = in[2 * i + 0];</div>
<div class="line"><a name="l02965"></a><span class="lineno"> 2965</span>&#160;          <span class="keywordflow">if</span>(alpha) out[bytes * i + 1] = in[2 * i + 1];</div>
<div class="line"><a name="l02966"></a><span class="lineno"> 2966</span>&#160;        }</div>
<div class="line"><a name="l02967"></a><span class="lineno"> 2967</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02968"></a><span class="lineno"> 2968</span>&#160;      <span class="keywordflow">default</span>: <span class="keywordflow">return</span> 31;</div>
<div class="line"><a name="l02969"></a><span class="lineno"> 2969</span>&#160;    }</div>
<div class="line"><a name="l02970"></a><span class="lineno"> 2970</span>&#160;  }</div>
<div class="line"><a name="l02971"></a><span class="lineno"> 2971</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span>(infoIn-&gt;<a class="code" href="struct_lode_p_n_g___info_color.html#a9d538965a46d59bbdea744da8b290591">bitDepth</a> == 16)</div>
<div class="line"><a name="l02972"></a><span class="lineno"> 2972</span>&#160;  {</div>
<div class="line"><a name="l02973"></a><span class="lineno"> 2973</span>&#160;    <span class="keywordflow">switch</span>(infoIn-&gt;<a class="code" href="struct_lode_p_n_g___info_color.html#a4ed18d179c5078137a18e742b1c41a00">colorType</a>)</div>
<div class="line"><a name="l02974"></a><span class="lineno"> 2974</span>&#160;    {</div>
<div class="line"><a name="l02975"></a><span class="lineno"> 2975</span>&#160;      <span class="keywordflow">case</span> 0: <span class="comment">/*greyscale color*/</span></div>
<div class="line"><a name="l02976"></a><span class="lineno"> 2976</span>&#160;        <span class="keywordflow">for</span>(i = 0; i &lt; numpixels; i++)</div>
<div class="line"><a name="l02977"></a><span class="lineno"> 2977</span>&#160;        {</div>
<div class="line"><a name="l02978"></a><span class="lineno"> 2978</span>&#160;          <span class="keywordflow">if</span>(alpha) out[bytes * i + 1] = 255;</div>
<div class="line"><a name="l02979"></a><span class="lineno"> 2979</span>&#160;          out[bytes * i] = in[2 * i];</div>
<div class="line"><a name="l02980"></a><span class="lineno"> 2980</span>&#160;          <span class="keywordflow">if</span>(alpha &amp;&amp; infoIn-&gt;<a class="code" href="struct_lode_p_n_g___info_color.html#aa0193ce13025c776a0dfb1e6d1bed14a">key_defined</a> &amp;&amp; 256U * in[i] + in[i + 1] == infoIn-&gt;<a class="code" href="struct_lode_p_n_g___info_color.html#a5536a8859201cd11df789ec7ad8263df">key_r</a>)</div>
<div class="line"><a name="l02981"></a><span class="lineno"> 2981</span>&#160;          {</div>
<div class="line"><a name="l02982"></a><span class="lineno"> 2982</span>&#160;            out[bytes * i + 1] = 0;</div>
<div class="line"><a name="l02983"></a><span class="lineno"> 2983</span>&#160;          }</div>
<div class="line"><a name="l02984"></a><span class="lineno"> 2984</span>&#160;        }</div>
<div class="line"><a name="l02985"></a><span class="lineno"> 2985</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02986"></a><span class="lineno"> 2986</span>&#160;      <span class="keywordflow">case</span> 4: <span class="comment">/*greyscale with alpha*/</span></div>
<div class="line"><a name="l02987"></a><span class="lineno"> 2987</span>&#160;        <span class="keywordflow">for</span>(i = 0; i &lt; numpixels; i++)</div>
<div class="line"><a name="l02988"></a><span class="lineno"> 2988</span>&#160;        {</div>
<div class="line"><a name="l02989"></a><span class="lineno"> 2989</span>&#160;          out[bytes * i] = in[4 * i]; <span class="comment">/*most significant byte*/</span></div>
<div class="line"><a name="l02990"></a><span class="lineno"> 2990</span>&#160;          <span class="keywordflow">if</span>(alpha) out[bytes * i + 1] = in[4 * i + 2]; <span class="comment">/*most significant byte*/</span></div>
<div class="line"><a name="l02991"></a><span class="lineno"> 2991</span>&#160;        }</div>
<div class="line"><a name="l02992"></a><span class="lineno"> 2992</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02993"></a><span class="lineno"> 2993</span>&#160;      <span class="keywordflow">default</span>: <span class="keywordflow">return</span> 31;</div>
<div class="line"><a name="l02994"></a><span class="lineno"> 2994</span>&#160;    }</div>
<div class="line"><a name="l02995"></a><span class="lineno"> 2995</span>&#160;  }</div>
<div class="line"><a name="l02996"></a><span class="lineno"> 2996</span>&#160;  <span class="keywordflow">else</span> <span class="comment">/*infoIn-&gt;bitDepth is less than 8 bit per channel*/</span></div>
<div class="line"><a name="l02997"></a><span class="lineno"> 2997</span>&#160;  {</div>
<div class="line"><a name="l02998"></a><span class="lineno"> 2998</span>&#160;    <span class="keywordflow">if</span>(infoIn-&gt;<a class="code" href="struct_lode_p_n_g___info_color.html#a4ed18d179c5078137a18e742b1c41a00">colorType</a> != 0) <span class="keywordflow">return</span> 31; <span class="comment">/*colorType 0 is the only greyscale type with &lt; 8 bits per channel*/</span></div>
<div class="line"><a name="l02999"></a><span class="lineno"> 2999</span>&#160;    <span class="keywordflow">for</span>(i = 0; i &lt; numpixels; i++)</div>
<div class="line"><a name="l03000"></a><span class="lineno"> 3000</span>&#160;    {</div>
<div class="line"><a name="l03001"></a><span class="lineno"> 3001</span>&#160;      <span class="keywordtype">unsigned</span> value = readBitsFromReversedStream(&amp;bp, in, infoIn-&gt;<a class="code" href="struct_lode_p_n_g___info_color.html#a9d538965a46d59bbdea744da8b290591">bitDepth</a>);</div>
<div class="line"><a name="l03002"></a><span class="lineno"> 3002</span>&#160;      <span class="keywordtype">unsigned</span> highest = ((1U &lt;&lt; infoIn-&gt;<a class="code" href="struct_lode_p_n_g___info_color.html#a9d538965a46d59bbdea744da8b290591">bitDepth</a>) - 1U); <span class="comment">/*highest possible value for this bit depth*/</span></div>
<div class="line"><a name="l03003"></a><span class="lineno"> 3003</span>&#160;      out[bytes * i] = (<span class="keywordtype">unsigned</span> char)((value * 255) / highest); <span class="comment">/*scale value from 0 to 255*/</span></div>
<div class="line"><a name="l03004"></a><span class="lineno"> 3004</span>&#160;      <span class="keywordflow">if</span>(alpha)</div>
<div class="line"><a name="l03005"></a><span class="lineno"> 3005</span>&#160;      {</div>
<div class="line"><a name="l03006"></a><span class="lineno"> 3006</span>&#160;        <span class="keywordflow">if</span>(infoIn-&gt;<a class="code" href="struct_lode_p_n_g___info_color.html#aa0193ce13025c776a0dfb1e6d1bed14a">key_defined</a> &amp;&amp; value == infoIn-&gt;<a class="code" href="struct_lode_p_n_g___info_color.html#a5536a8859201cd11df789ec7ad8263df">key_r</a>) out[bytes * i + 1] = 0;</div>
<div class="line"><a name="l03007"></a><span class="lineno"> 3007</span>&#160;        <span class="keywordflow">else</span> out[bytes * i + 1] = 255;</div>
<div class="line"><a name="l03008"></a><span class="lineno"> 3008</span>&#160;      }</div>
<div class="line"><a name="l03009"></a><span class="lineno"> 3009</span>&#160;    }</div>
<div class="line"><a name="l03010"></a><span class="lineno"> 3010</span>&#160;  }</div>
<div class="line"><a name="l03011"></a><span class="lineno"> 3011</span>&#160;  <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l03012"></a><span class="lineno"> 3012</span>&#160;}</div>
<div class="line"><a name="l03013"></a><span class="lineno"> 3013</span>&#160;</div>
<div class="line"><a name="l03014"></a><span class="lineno"> 3014</span>&#160;<span class="comment">/*convert from any color type to RGB or RGBA with 8 bits per sample*/</span></div>
<div class="line"><a name="l03015"></a><span class="lineno"> 3015</span>&#160;<span class="keyword">static</span> <span class="keywordtype">unsigned</span> LodePNG_convert_rgb_a_16(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* out, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* in,</div>
<div class="line"><a name="l03016"></a><span class="lineno"> 3016</span>&#160;                                         <a class="code" href="struct_lode_p_n_g___info_color.html">LodePNG_InfoColor</a>* infoIn, <span class="keywordtype">size_t</span> numpixels, <span class="keywordtype">unsigned</span> bytes, <span class="keywordtype">unsigned</span> alpha)</div>
<div class="line"><a name="l03017"></a><span class="lineno"> 3017</span>&#160;{</div>
<div class="line"><a name="l03018"></a><span class="lineno"> 3018</span>&#160;  <span class="keywordtype">size_t</span> i, c, bp = 0; <span class="comment">/*bp = bitpointer, used by less-than-8-bit color types*/</span></div>
<div class="line"><a name="l03019"></a><span class="lineno"> 3019</span>&#160;</div>
<div class="line"><a name="l03020"></a><span class="lineno"> 3020</span>&#160;  <span class="keywordflow">if</span>(infoIn-&gt;<a class="code" href="struct_lode_p_n_g___info_color.html#a9d538965a46d59bbdea744da8b290591">bitDepth</a> == 8)</div>
<div class="line"><a name="l03021"></a><span class="lineno"> 3021</span>&#160;  {</div>
<div class="line"><a name="l03022"></a><span class="lineno"> 3022</span>&#160;    <span class="keywordflow">switch</span>(infoIn-&gt;<a class="code" href="struct_lode_p_n_g___info_color.html#a4ed18d179c5078137a18e742b1c41a00">colorType</a>)</div>
<div class="line"><a name="l03023"></a><span class="lineno"> 3023</span>&#160;    {</div>
<div class="line"><a name="l03024"></a><span class="lineno"> 3024</span>&#160;      <span class="keywordflow">case</span> 0: <span class="comment">/*greyscale color*/</span></div>
<div class="line"><a name="l03025"></a><span class="lineno"> 3025</span>&#160;        <span class="keywordflow">for</span>(i = 0; i &lt; numpixels; i++)</div>
<div class="line"><a name="l03026"></a><span class="lineno"> 3026</span>&#160;        {</div>
<div class="line"><a name="l03027"></a><span class="lineno"> 3027</span>&#160;          out[bytes * i + 0] = out[bytes * i + 2] = out[bytes * i + 4] = in[i];</div>
<div class="line"><a name="l03028"></a><span class="lineno"> 3028</span>&#160;          out[bytes * i + 1] = out[bytes * i + 3] = out[bytes * i + 5] = in[i];</div>
<div class="line"><a name="l03029"></a><span class="lineno"> 3029</span>&#160;          <span class="keywordflow">if</span>(alpha)</div>
<div class="line"><a name="l03030"></a><span class="lineno"> 3030</span>&#160;          {</div>
<div class="line"><a name="l03031"></a><span class="lineno"> 3031</span>&#160;            <span class="keywordflow">if</span>(alpha &amp;&amp; infoIn-&gt;<a class="code" href="struct_lode_p_n_g___info_color.html#aa0193ce13025c776a0dfb1e6d1bed14a">key_defined</a> &amp;&amp; in[i] == infoIn-&gt;<a class="code" href="struct_lode_p_n_g___info_color.html#a5536a8859201cd11df789ec7ad8263df">key_r</a>) out[bytes * i + 6] = out[bytes * i + 7] = 0;</div>
<div class="line"><a name="l03032"></a><span class="lineno"> 3032</span>&#160;            <span class="keywordflow">else</span> out[bytes * i + 6] = out[bytes * i + 7] = 255;</div>
<div class="line"><a name="l03033"></a><span class="lineno"> 3033</span>&#160;          }</div>
<div class="line"><a name="l03034"></a><span class="lineno"> 3034</span>&#160;        }</div>
<div class="line"><a name="l03035"></a><span class="lineno"> 3035</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03036"></a><span class="lineno"> 3036</span>&#160;      <span class="keywordflow">case</span> 2: <span class="comment">/*RGB color*/</span></div>
<div class="line"><a name="l03037"></a><span class="lineno"> 3037</span>&#160;        <span class="keywordflow">for</span>(i = 0; i &lt; numpixels; i++)</div>
<div class="line"><a name="l03038"></a><span class="lineno"> 3038</span>&#160;        {</div>
<div class="line"><a name="l03039"></a><span class="lineno"> 3039</span>&#160;          out[bytes * i + 0] = out[bytes * i + 1] = in[3 * i + 0];</div>
<div class="line"><a name="l03040"></a><span class="lineno"> 3040</span>&#160;          out[bytes * i + 2] = out[bytes * i + 3] = in[3 * i + 1];</div>
<div class="line"><a name="l03041"></a><span class="lineno"> 3041</span>&#160;          out[bytes * i + 4] = out[bytes * i + 5] = in[3 * i + 2];</div>
<div class="line"><a name="l03042"></a><span class="lineno"> 3042</span>&#160;          <span class="keywordflow">if</span>(alpha)</div>
<div class="line"><a name="l03043"></a><span class="lineno"> 3043</span>&#160;          {</div>
<div class="line"><a name="l03044"></a><span class="lineno"> 3044</span>&#160;            <span class="keywordflow">if</span>(infoIn-&gt;<a class="code" href="struct_lode_p_n_g___info_color.html#aa0193ce13025c776a0dfb1e6d1bed14a">key_defined</a> == 1 &amp;&amp; in[3 * i + 0] == infoIn-&gt;<a class="code" href="struct_lode_p_n_g___info_color.html#a5536a8859201cd11df789ec7ad8263df">key_r</a></div>
<div class="line"><a name="l03045"></a><span class="lineno"> 3045</span>&#160;               &amp;&amp; in[3 * i + 1] == infoIn-&gt;<a class="code" href="struct_lode_p_n_g___info_color.html#a44bf4906335328972acebd6c8b83a073">key_g</a> &amp;&amp; in[3 * i + 2] == infoIn-&gt;<a class="code" href="struct_lode_p_n_g___info_color.html#a9f99cc5b4366f1eed325d13b4f191560">key_b</a>)</div>
<div class="line"><a name="l03046"></a><span class="lineno"> 3046</span>&#160;              out[bytes * i + 6] = out[bytes * i + 7] = 0;</div>
<div class="line"><a name="l03047"></a><span class="lineno"> 3047</span>&#160;            <span class="keywordflow">else</span> out[bytes * i + 6] = out[bytes * i + 7] = 255;</div>
<div class="line"><a name="l03048"></a><span class="lineno"> 3048</span>&#160;          }</div>
<div class="line"><a name="l03049"></a><span class="lineno"> 3049</span>&#160;        }</div>
<div class="line"><a name="l03050"></a><span class="lineno"> 3050</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03051"></a><span class="lineno"> 3051</span>&#160;      <span class="keywordflow">case</span> 3: <span class="comment">/*indexed color (palette)*/</span></div>
<div class="line"><a name="l03052"></a><span class="lineno"> 3052</span>&#160;        <span class="keywordflow">for</span>(i = 0; i &lt; numpixels; i++)</div>
<div class="line"><a name="l03053"></a><span class="lineno"> 3053</span>&#160;        {</div>
<div class="line"><a name="l03054"></a><span class="lineno"> 3054</span>&#160;          <span class="keywordflow">if</span>(in[i] &gt;= infoIn-&gt;<a class="code" href="struct_lode_p_n_g___info_color.html#a49842a304ffd0abc8aa791030c5fa5dd">palettesize</a>) <span class="keywordflow">return</span> 46; <span class="comment">/*invalid palette index*/</span></div>
<div class="line"><a name="l03055"></a><span class="lineno"> 3055</span>&#160;          <span class="keywordflow">for</span>(c = 0; c &lt; <a class="code" href="_d_l_l_imports_8inl.html#abd7736f9cab649e6a7b4c85084454cdf">bytes</a>; c++)</div>
<div class="line"><a name="l03056"></a><span class="lineno"> 3056</span>&#160;          {</div>
<div class="line"><a name="l03057"></a><span class="lineno"> 3057</span>&#160;            out[bytes * i + 2 * c] = out[bytes * i + 2 * c + 1] = infoIn-&gt;<a class="code" href="struct_lode_p_n_g___info_color.html#ac6de7ff58cb1f39a73567abb826f72f5">palette</a>[4 * in[i] + c];</div>
<div class="line"><a name="l03058"></a><span class="lineno"> 3058</span>&#160;          }</div>
<div class="line"><a name="l03059"></a><span class="lineno"> 3059</span>&#160;        }</div>
<div class="line"><a name="l03060"></a><span class="lineno"> 3060</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03061"></a><span class="lineno"> 3061</span>&#160;      <span class="keywordflow">case</span> 4: <span class="comment">/*greyscale with alpha*/</span></div>
<div class="line"><a name="l03062"></a><span class="lineno"> 3062</span>&#160;        <span class="keywordflow">for</span>(i = 0; i &lt; numpixels; i++)</div>
<div class="line"><a name="l03063"></a><span class="lineno"> 3063</span>&#160;        {</div>
<div class="line"><a name="l03064"></a><span class="lineno"> 3064</span>&#160;          out[bytes * i + 0] = out[bytes * i + 2] = out[bytes * i + 4] = in[i];</div>
<div class="line"><a name="l03065"></a><span class="lineno"> 3065</span>&#160;          out[bytes * i + 1] = out[bytes * i + 3] = out[bytes * i + 5] = in[i];</div>
<div class="line"><a name="l03066"></a><span class="lineno"> 3066</span>&#160;          <span class="keywordflow">if</span>(alpha)</div>
<div class="line"><a name="l03067"></a><span class="lineno"> 3067</span>&#160;          {</div>
<div class="line"><a name="l03068"></a><span class="lineno"> 3068</span>&#160;            out[bytes * i + 6] = out[bytes * i + 7] = in[2 * i + 1];</div>
<div class="line"><a name="l03069"></a><span class="lineno"> 3069</span>&#160;          }</div>
<div class="line"><a name="l03070"></a><span class="lineno"> 3070</span>&#160;        }</div>
<div class="line"><a name="l03071"></a><span class="lineno"> 3071</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03072"></a><span class="lineno"> 3072</span>&#160;      <span class="keywordflow">case</span> 6: <span class="comment">/*RGB with alpha*/</span></div>
<div class="line"><a name="l03073"></a><span class="lineno"> 3073</span>&#160;        <span class="keywordflow">for</span>(i = 0; i &lt; numpixels; i++)</div>
<div class="line"><a name="l03074"></a><span class="lineno"> 3074</span>&#160;        {</div>
<div class="line"><a name="l03075"></a><span class="lineno"> 3075</span>&#160;          <span class="keywordflow">for</span>(c = 0; c &lt; 3; c++)</div>
<div class="line"><a name="l03076"></a><span class="lineno"> 3076</span>&#160;          {</div>
<div class="line"><a name="l03077"></a><span class="lineno"> 3077</span>&#160;            out[bytes * i + 2 * c] = out[bytes * i + 2 * c + 1] = in[4 * i + c];</div>
<div class="line"><a name="l03078"></a><span class="lineno"> 3078</span>&#160;          }</div>
<div class="line"><a name="l03079"></a><span class="lineno"> 3079</span>&#160;          <span class="keywordflow">if</span>(alpha)</div>
<div class="line"><a name="l03080"></a><span class="lineno"> 3080</span>&#160;          {</div>
<div class="line"><a name="l03081"></a><span class="lineno"> 3081</span>&#160;            out[bytes * i + 6] = out[bytes * i + 7] = in[4 * i + c];</div>
<div class="line"><a name="l03082"></a><span class="lineno"> 3082</span>&#160;          }</div>
<div class="line"><a name="l03083"></a><span class="lineno"> 3083</span>&#160;        }</div>
<div class="line"><a name="l03084"></a><span class="lineno"> 3084</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03085"></a><span class="lineno"> 3085</span>&#160;      <span class="keywordflow">default</span>: <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03086"></a><span class="lineno"> 3086</span>&#160;    }</div>
<div class="line"><a name="l03087"></a><span class="lineno"> 3087</span>&#160;  }</div>
<div class="line"><a name="l03088"></a><span class="lineno"> 3088</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span>(infoIn-&gt;<a class="code" href="struct_lode_p_n_g___info_color.html#a9d538965a46d59bbdea744da8b290591">bitDepth</a> == 16)</div>
<div class="line"><a name="l03089"></a><span class="lineno"> 3089</span>&#160;  {</div>
<div class="line"><a name="l03090"></a><span class="lineno"> 3090</span>&#160;    <span class="keywordflow">switch</span>(infoIn-&gt;<a class="code" href="struct_lode_p_n_g___info_color.html#a4ed18d179c5078137a18e742b1c41a00">colorType</a>)</div>
<div class="line"><a name="l03091"></a><span class="lineno"> 3091</span>&#160;    {</div>
<div class="line"><a name="l03092"></a><span class="lineno"> 3092</span>&#160;      <span class="keywordflow">case</span> 0: <span class="comment">/*greyscale color*/</span></div>
<div class="line"><a name="l03093"></a><span class="lineno"> 3093</span>&#160;        <span class="keywordflow">for</span>(i = 0; i &lt; numpixels; i++)</div>
<div class="line"><a name="l03094"></a><span class="lineno"> 3094</span>&#160;        {</div>
<div class="line"><a name="l03095"></a><span class="lineno"> 3095</span>&#160;          out[bytes * i + 0] = out[bytes * i + 2] = out[bytes * i + 4] = in[2 * i];</div>
<div class="line"><a name="l03096"></a><span class="lineno"> 3096</span>&#160;          out[bytes * i + 1] = out[bytes * i + 3] = out[bytes * i + 5] = in[2 * i + 1];</div>
<div class="line"><a name="l03097"></a><span class="lineno"> 3097</span>&#160;          <span class="keywordflow">if</span>(alpha)</div>
<div class="line"><a name="l03098"></a><span class="lineno"> 3098</span>&#160;          {</div>
<div class="line"><a name="l03099"></a><span class="lineno"> 3099</span>&#160;            <span class="keywordflow">if</span>(infoIn-&gt;<a class="code" href="struct_lode_p_n_g___info_color.html#aa0193ce13025c776a0dfb1e6d1bed14a">key_defined</a> &amp;&amp; 256U * in[i] + in[i + 1] == infoIn-&gt;<a class="code" href="struct_lode_p_n_g___info_color.html#a5536a8859201cd11df789ec7ad8263df">key_r</a>)</div>
<div class="line"><a name="l03100"></a><span class="lineno"> 3100</span>&#160;              out[bytes * i + 6] = out[bytes * i + 7] = 0;</div>
<div class="line"><a name="l03101"></a><span class="lineno"> 3101</span>&#160;            <span class="keywordflow">else</span> out[bytes * i + 6] = out[bytes * i + 7] = 255;</div>
<div class="line"><a name="l03102"></a><span class="lineno"> 3102</span>&#160;          }</div>
<div class="line"><a name="l03103"></a><span class="lineno"> 3103</span>&#160;        }</div>
<div class="line"><a name="l03104"></a><span class="lineno"> 3104</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03105"></a><span class="lineno"> 3105</span>&#160;      <span class="keywordflow">case</span> 2: <span class="comment">/*RGB color*/</span></div>
<div class="line"><a name="l03106"></a><span class="lineno"> 3106</span>&#160;        <span class="keywordflow">for</span>(i = 0; i &lt; numpixels; i++)</div>
<div class="line"><a name="l03107"></a><span class="lineno"> 3107</span>&#160;        {</div>
<div class="line"><a name="l03108"></a><span class="lineno"> 3108</span>&#160;          <span class="keywordflow">for</span>(c = 0; c &lt; 6; c++) out[bytes * i + c] = in[6 * i + c];</div>
<div class="line"><a name="l03109"></a><span class="lineno"> 3109</span>&#160;          <span class="keywordflow">if</span>(alpha)</div>
<div class="line"><a name="l03110"></a><span class="lineno"> 3110</span>&#160;          {</div>
<div class="line"><a name="l03111"></a><span class="lineno"> 3111</span>&#160;            <span class="keywordflow">if</span>(infoIn-&gt;<a class="code" href="struct_lode_p_n_g___info_color.html#aa0193ce13025c776a0dfb1e6d1bed14a">key_defined</a> &amp;&amp; 256U * in[6 * i + 0] + in[6 * i + 1] == infoIn-&gt;<a class="code" href="struct_lode_p_n_g___info_color.html#a5536a8859201cd11df789ec7ad8263df">key_r</a></div>
<div class="line"><a name="l03112"></a><span class="lineno"> 3112</span>&#160;               &amp;&amp; 256U * in[6 * i + 2] + in[6 * i + 3] == infoIn-&gt;<a class="code" href="struct_lode_p_n_g___info_color.html#a44bf4906335328972acebd6c8b83a073">key_g</a></div>
<div class="line"><a name="l03113"></a><span class="lineno"> 3113</span>&#160;               &amp;&amp; 256U * in[6 * i + 4] + in[6 * i + 5] == infoIn-&gt;<a class="code" href="struct_lode_p_n_g___info_color.html#a9f99cc5b4366f1eed325d13b4f191560">key_b</a>)</div>
<div class="line"><a name="l03114"></a><span class="lineno"> 3114</span>&#160;              out[bytes * i + 6] = out[bytes * i + 7] = 0;</div>
<div class="line"><a name="l03115"></a><span class="lineno"> 3115</span>&#160;            <span class="keywordflow">else</span> out[bytes * i + 6] = out[bytes * i + 7] = 255;</div>
<div class="line"><a name="l03116"></a><span class="lineno"> 3116</span>&#160;          }</div>
<div class="line"><a name="l03117"></a><span class="lineno"> 3117</span>&#160;        }</div>
<div class="line"><a name="l03118"></a><span class="lineno"> 3118</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03119"></a><span class="lineno"> 3119</span>&#160;      <span class="keywordflow">case</span> 4: <span class="comment">/*greyscale with alpha*/</span></div>
<div class="line"><a name="l03120"></a><span class="lineno"> 3120</span>&#160;        <span class="keywordflow">for</span>(i = 0; i &lt; numpixels; i++)</div>
<div class="line"><a name="l03121"></a><span class="lineno"> 3121</span>&#160;        {</div>
<div class="line"><a name="l03122"></a><span class="lineno"> 3122</span>&#160;          out[bytes * i + 0] = out[bytes * i + 2] = out[bytes * i + 4] = in[4 * i + 0];</div>
<div class="line"><a name="l03123"></a><span class="lineno"> 3123</span>&#160;          out[bytes * i + 1] = out[bytes * i + 3] = out[bytes * i + 5] = in[4 * i + 1];</div>
<div class="line"><a name="l03124"></a><span class="lineno"> 3124</span>&#160;          <span class="keywordflow">if</span>(alpha)</div>
<div class="line"><a name="l03125"></a><span class="lineno"> 3125</span>&#160;          {</div>
<div class="line"><a name="l03126"></a><span class="lineno"> 3126</span>&#160;            out[bytes * i + 6] = in[4 * i + 2];</div>
<div class="line"><a name="l03127"></a><span class="lineno"> 3127</span>&#160;            out[bytes * i + 7] = in[4 * i + 3];</div>
<div class="line"><a name="l03128"></a><span class="lineno"> 3128</span>&#160;          }</div>
<div class="line"><a name="l03129"></a><span class="lineno"> 3129</span>&#160;        }</div>
<div class="line"><a name="l03130"></a><span class="lineno"> 3130</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03131"></a><span class="lineno"> 3131</span>&#160;      <span class="keywordflow">case</span> 6: <span class="comment">/*RGB with alpha*/</span></div>
<div class="line"><a name="l03132"></a><span class="lineno"> 3132</span>&#160;        <span class="keywordflow">for</span>(i = 0; i &lt; numpixels; i++)</div>
<div class="line"><a name="l03133"></a><span class="lineno"> 3133</span>&#160;        {</div>
<div class="line"><a name="l03134"></a><span class="lineno"> 3134</span>&#160;          <span class="keywordflow">for</span>(c = 0; c &lt; <a class="code" href="_d_l_l_imports_8inl.html#abd7736f9cab649e6a7b4c85084454cdf">bytes</a>; c++) out[bytes * i + c] = in[8 * i + 2 * c];</div>
<div class="line"><a name="l03135"></a><span class="lineno"> 3135</span>&#160;        }</div>
<div class="line"><a name="l03136"></a><span class="lineno"> 3136</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03137"></a><span class="lineno"> 3137</span>&#160;      <span class="keywordflow">default</span>: <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03138"></a><span class="lineno"> 3138</span>&#160;    }</div>
<div class="line"><a name="l03139"></a><span class="lineno"> 3139</span>&#160;  }</div>
<div class="line"><a name="l03140"></a><span class="lineno"> 3140</span>&#160;  <span class="keywordflow">else</span> <span class="comment">/*infoIn-&gt;bitDepth is less than 8 bit per channel*/</span></div>
<div class="line"><a name="l03141"></a><span class="lineno"> 3141</span>&#160;  {</div>
<div class="line"><a name="l03142"></a><span class="lineno"> 3142</span>&#160;    <span class="keywordflow">switch</span>(infoIn-&gt;<a class="code" href="struct_lode_p_n_g___info_color.html#a4ed18d179c5078137a18e742b1c41a00">colorType</a>)</div>
<div class="line"><a name="l03143"></a><span class="lineno"> 3143</span>&#160;    {</div>
<div class="line"><a name="l03144"></a><span class="lineno"> 3144</span>&#160;      <span class="keywordflow">case</span> 0: <span class="comment">/*greyscale color*/</span></div>
<div class="line"><a name="l03145"></a><span class="lineno"> 3145</span>&#160;        <span class="keywordflow">for</span>(i = 0; i &lt; numpixels; i++)</div>
<div class="line"><a name="l03146"></a><span class="lineno"> 3146</span>&#160;        {</div>
<div class="line"><a name="l03147"></a><span class="lineno"> 3147</span>&#160;          <span class="keywordtype">unsigned</span> value = readBitsFromReversedStream(&amp;bp, in, infoIn-&gt;<a class="code" href="struct_lode_p_n_g___info_color.html#a9d538965a46d59bbdea744da8b290591">bitDepth</a>);</div>
<div class="line"><a name="l03148"></a><span class="lineno"> 3148</span>&#160;          <span class="keywordtype">unsigned</span> highest = ((1U &lt;&lt; infoIn-&gt;<a class="code" href="struct_lode_p_n_g___info_color.html#a9d538965a46d59bbdea744da8b290591">bitDepth</a>) - 1U); <span class="comment">/*highest possible value for this bit depth*/</span></div>
<div class="line"><a name="l03149"></a><span class="lineno"> 3149</span>&#160;          <span class="comment">/*scale value from 0 to 255*/</span></div>
<div class="line"><a name="l03150"></a><span class="lineno"> 3150</span>&#160;          out[bytes * i + 0] = out[bytes * i + 2] = out[bytes * i + 4]</div>
<div class="line"><a name="l03151"></a><span class="lineno"> 3151</span>&#160;                             = out[bytes * i + 1] = out[bytes * i + 3]</div>
<div class="line"><a name="l03152"></a><span class="lineno"> 3152</span>&#160;                             = out[bytes * i + 5] = (<span class="keywordtype">unsigned</span> char)((value * 255) / highest);</div>
<div class="line"><a name="l03153"></a><span class="lineno"> 3153</span>&#160;          <span class="keywordflow">if</span>(alpha)</div>
<div class="line"><a name="l03154"></a><span class="lineno"> 3154</span>&#160;          {</div>
<div class="line"><a name="l03155"></a><span class="lineno"> 3155</span>&#160;            <span class="keywordflow">if</span>(infoIn-&gt;<a class="code" href="struct_lode_p_n_g___info_color.html#aa0193ce13025c776a0dfb1e6d1bed14a">key_defined</a> &amp;&amp; value == infoIn-&gt;<a class="code" href="struct_lode_p_n_g___info_color.html#a5536a8859201cd11df789ec7ad8263df">key_r</a>) out[bytes * i + 6] = out[bytes * i + 7] = 0;</div>
<div class="line"><a name="l03156"></a><span class="lineno"> 3156</span>&#160;            <span class="keywordflow">else</span> out[bytes * i + 6] = out[bytes * i + 7] = 255;</div>
<div class="line"><a name="l03157"></a><span class="lineno"> 3157</span>&#160;          }</div>
<div class="line"><a name="l03158"></a><span class="lineno"> 3158</span>&#160;        }</div>
<div class="line"><a name="l03159"></a><span class="lineno"> 3159</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03160"></a><span class="lineno"> 3160</span>&#160;      <span class="keywordflow">case</span> 3: <span class="comment">/*indexed color (palette)*/</span></div>
<div class="line"><a name="l03161"></a><span class="lineno"> 3161</span>&#160;        <span class="keywordflow">for</span>(i = 0; i &lt; numpixels; i++)</div>
<div class="line"><a name="l03162"></a><span class="lineno"> 3162</span>&#160;        {</div>
<div class="line"><a name="l03163"></a><span class="lineno"> 3163</span>&#160;          <span class="keywordtype">unsigned</span> value = readBitsFromReversedStream(&amp;bp, in, infoIn-&gt;<a class="code" href="struct_lode_p_n_g___info_color.html#a9d538965a46d59bbdea744da8b290591">bitDepth</a>);</div>
<div class="line"><a name="l03164"></a><span class="lineno"> 3164</span>&#160;          <span class="keywordflow">if</span>(value &gt;= infoIn-&gt;<a class="code" href="struct_lode_p_n_g___info_color.html#a49842a304ffd0abc8aa791030c5fa5dd">palettesize</a>) <span class="keywordflow">return</span> 47;</div>
<div class="line"><a name="l03165"></a><span class="lineno"> 3165</span>&#160;          <span class="keywordflow">for</span>(c = 0; c &lt; bytes / 2; c++)</div>
<div class="line"><a name="l03166"></a><span class="lineno"> 3166</span>&#160;          {</div>
<div class="line"><a name="l03167"></a><span class="lineno"> 3167</span>&#160;            out[bytes * i + c * 2 + 0] = out[bytes * i + c * 2 + 1] = infoIn-&gt;<a class="code" href="struct_lode_p_n_g___info_color.html#ac6de7ff58cb1f39a73567abb826f72f5">palette</a>[4 * value + c];</div>
<div class="line"><a name="l03168"></a><span class="lineno"> 3168</span>&#160;          }</div>
<div class="line"><a name="l03169"></a><span class="lineno"> 3169</span>&#160;        }</div>
<div class="line"><a name="l03170"></a><span class="lineno"> 3170</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03171"></a><span class="lineno"> 3171</span>&#160;      <span class="keywordflow">default</span>: <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03172"></a><span class="lineno"> 3172</span>&#160;    }</div>
<div class="line"><a name="l03173"></a><span class="lineno"> 3173</span>&#160;  }</div>
<div class="line"><a name="l03174"></a><span class="lineno"> 3174</span>&#160;  <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l03175"></a><span class="lineno"> 3175</span>&#160;}</div>
<div class="line"><a name="l03176"></a><span class="lineno"> 3176</span>&#160;</div>
<div class="line"><a name="l03177"></a><span class="lineno"> 3177</span>&#160;<span class="comment">/*convert from any greyscale color type to 16-bit greyscale with or without alpha channel*/</span></div>
<div class="line"><a name="l03178"></a><span class="lineno"> 3178</span>&#160;<span class="keyword">static</span> <span class="keywordtype">unsigned</span> LodePNG_convert_grey_16(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* out, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* in,</div>
<div class="line"><a name="l03179"></a><span class="lineno"> 3179</span>&#160;                                        <a class="code" href="struct_lode_p_n_g___info_color.html">LodePNG_InfoColor</a>* infoIn, <span class="keywordtype">size_t</span> numpixels, <span class="keywordtype">unsigned</span> bytes, <span class="keywordtype">unsigned</span> alpha)</div>
<div class="line"><a name="l03180"></a><span class="lineno"> 3180</span>&#160;{</div>
<div class="line"><a name="l03181"></a><span class="lineno"> 3181</span>&#160;  <span class="keywordtype">size_t</span> i, c, bp = 0; <span class="comment">/*bp = bitpointer, used by less-than-8-bit color types*/</span></div>
<div class="line"><a name="l03182"></a><span class="lineno"> 3182</span>&#160;</div>
<div class="line"><a name="l03183"></a><span class="lineno"> 3183</span>&#160;  <span class="keywordflow">if</span>(infoIn-&gt;<a class="code" href="struct_lode_p_n_g___info_color.html#a9d538965a46d59bbdea744da8b290591">bitDepth</a> == 8)</div>
<div class="line"><a name="l03184"></a><span class="lineno"> 3184</span>&#160;  {</div>
<div class="line"><a name="l03185"></a><span class="lineno"> 3185</span>&#160;    <span class="keywordflow">switch</span>(infoIn-&gt;<a class="code" href="struct_lode_p_n_g___info_color.html#a4ed18d179c5078137a18e742b1c41a00">colorType</a>)</div>
<div class="line"><a name="l03186"></a><span class="lineno"> 3186</span>&#160;    {</div>
<div class="line"><a name="l03187"></a><span class="lineno"> 3187</span>&#160;      <span class="keywordflow">case</span> 0: <span class="comment">/*greyscale color*/</span></div>
<div class="line"><a name="l03188"></a><span class="lineno"> 3188</span>&#160;        <span class="keywordflow">for</span>(i = 0; i &lt; numpixels; i++)</div>
<div class="line"><a name="l03189"></a><span class="lineno"> 3189</span>&#160;        {</div>
<div class="line"><a name="l03190"></a><span class="lineno"> 3190</span>&#160;          out[bytes * i] = out[bytes * i + 1] = in[i];</div>
<div class="line"><a name="l03191"></a><span class="lineno"> 3191</span>&#160;          <span class="keywordflow">if</span>(alpha)</div>
<div class="line"><a name="l03192"></a><span class="lineno"> 3192</span>&#160;          {</div>
<div class="line"><a name="l03193"></a><span class="lineno"> 3193</span>&#160;            <span class="keywordflow">if</span>(infoIn-&gt;<a class="code" href="struct_lode_p_n_g___info_color.html#aa0193ce13025c776a0dfb1e6d1bed14a">key_defined</a> &amp;&amp; in[i] == infoIn-&gt;<a class="code" href="struct_lode_p_n_g___info_color.html#a5536a8859201cd11df789ec7ad8263df">key_r</a>) out[bytes * i + 2] = out[bytes * i + 3] = 0;</div>
<div class="line"><a name="l03194"></a><span class="lineno"> 3194</span>&#160;            <span class="keywordflow">else</span> out[bytes * i + 2] = out[bytes * i + 3] = 255;</div>
<div class="line"><a name="l03195"></a><span class="lineno"> 3195</span>&#160;          }</div>
<div class="line"><a name="l03196"></a><span class="lineno"> 3196</span>&#160;        }</div>
<div class="line"><a name="l03197"></a><span class="lineno"> 3197</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03198"></a><span class="lineno"> 3198</span>&#160;      <span class="keywordflow">case</span> 4: <span class="comment">/*greyscale with alpha*/</span></div>
<div class="line"><a name="l03199"></a><span class="lineno"> 3199</span>&#160;        <span class="keywordflow">for</span>(i = 0; i &lt; numpixels; i++)</div>
<div class="line"><a name="l03200"></a><span class="lineno"> 3200</span>&#160;        {</div>
<div class="line"><a name="l03201"></a><span class="lineno"> 3201</span>&#160;          out[bytes * i + 0] = out[bytes * i + 1] = in[2 * i + 0];</div>
<div class="line"><a name="l03202"></a><span class="lineno"> 3202</span>&#160;          <span class="keywordflow">if</span>(alpha) out[bytes * i + 2] = out[bytes * i + 3] = in[2 * i + 1];</div>
<div class="line"><a name="l03203"></a><span class="lineno"> 3203</span>&#160;        }</div>
<div class="line"><a name="l03204"></a><span class="lineno"> 3204</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03205"></a><span class="lineno"> 3205</span>&#160;      <span class="keywordflow">default</span>: <span class="keywordflow">return</span> 31;</div>
<div class="line"><a name="l03206"></a><span class="lineno"> 3206</span>&#160;    }</div>
<div class="line"><a name="l03207"></a><span class="lineno"> 3207</span>&#160;  }</div>
<div class="line"><a name="l03208"></a><span class="lineno"> 3208</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span>(infoIn-&gt;<a class="code" href="struct_lode_p_n_g___info_color.html#a9d538965a46d59bbdea744da8b290591">bitDepth</a> == 16)</div>
<div class="line"><a name="l03209"></a><span class="lineno"> 3209</span>&#160;  {</div>
<div class="line"><a name="l03210"></a><span class="lineno"> 3210</span>&#160;    <span class="keywordflow">switch</span>(infoIn-&gt;<a class="code" href="struct_lode_p_n_g___info_color.html#a4ed18d179c5078137a18e742b1c41a00">colorType</a>)</div>
<div class="line"><a name="l03211"></a><span class="lineno"> 3211</span>&#160;    {</div>
<div class="line"><a name="l03212"></a><span class="lineno"> 3212</span>&#160;      <span class="keywordflow">case</span> 0: <span class="comment">/*greyscale color*/</span></div>
<div class="line"><a name="l03213"></a><span class="lineno"> 3213</span>&#160;        <span class="keywordflow">for</span>(i = 0; i &lt; numpixels; i++)</div>
<div class="line"><a name="l03214"></a><span class="lineno"> 3214</span>&#160;        {</div>
<div class="line"><a name="l03215"></a><span class="lineno"> 3215</span>&#160;          out[bytes * i + 0] = in[2 * i + 0];</div>
<div class="line"><a name="l03216"></a><span class="lineno"> 3216</span>&#160;          out[bytes * i + 1] = in[2 * i + 1];</div>
<div class="line"><a name="l03217"></a><span class="lineno"> 3217</span>&#160;          <span class="keywordflow">if</span>(alpha)</div>
<div class="line"><a name="l03218"></a><span class="lineno"> 3218</span>&#160;          {</div>
<div class="line"><a name="l03219"></a><span class="lineno"> 3219</span>&#160;            <span class="keywordflow">if</span>(infoIn-&gt;<a class="code" href="struct_lode_p_n_g___info_color.html#aa0193ce13025c776a0dfb1e6d1bed14a">key_defined</a> &amp;&amp; 256U * in[i] + in[i + 1] == infoIn-&gt;<a class="code" href="struct_lode_p_n_g___info_color.html#a5536a8859201cd11df789ec7ad8263df">key_r</a>)</div>
<div class="line"><a name="l03220"></a><span class="lineno"> 3220</span>&#160;              out[bytes * i + 2] = out[bytes * i + 3] = 0;</div>
<div class="line"><a name="l03221"></a><span class="lineno"> 3221</span>&#160;            <span class="keywordflow">else</span> out[bytes * i + 2] = out[bytes * i + 3] = 255;</div>
<div class="line"><a name="l03222"></a><span class="lineno"> 3222</span>&#160;          }</div>
<div class="line"><a name="l03223"></a><span class="lineno"> 3223</span>&#160;        }</div>
<div class="line"><a name="l03224"></a><span class="lineno"> 3224</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03225"></a><span class="lineno"> 3225</span>&#160;      <span class="keywordflow">case</span> 4: <span class="comment">/*greyscale with alpha*/</span></div>
<div class="line"><a name="l03226"></a><span class="lineno"> 3226</span>&#160;        <span class="keywordflow">for</span>(i = 0; i &lt; numpixels; i++)</div>
<div class="line"><a name="l03227"></a><span class="lineno"> 3227</span>&#160;        {</div>
<div class="line"><a name="l03228"></a><span class="lineno"> 3228</span>&#160;          <span class="keywordflow">for</span>(c = 0; c &lt; <a class="code" href="_d_l_l_imports_8inl.html#abd7736f9cab649e6a7b4c85084454cdf">bytes</a>; c++) out[bytes * i + c] = in[4 * i + c];</div>
<div class="line"><a name="l03229"></a><span class="lineno"> 3229</span>&#160;        }</div>
<div class="line"><a name="l03230"></a><span class="lineno"> 3230</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03231"></a><span class="lineno"> 3231</span>&#160;      <span class="keywordflow">default</span>: <span class="keywordflow">return</span> 31;</div>
<div class="line"><a name="l03232"></a><span class="lineno"> 3232</span>&#160;    }</div>
<div class="line"><a name="l03233"></a><span class="lineno"> 3233</span>&#160;  }</div>
<div class="line"><a name="l03234"></a><span class="lineno"> 3234</span>&#160;  <span class="keywordflow">else</span> <span class="comment">/*infoIn-&gt;bitDepth is less than 8 bit per channel*/</span></div>
<div class="line"><a name="l03235"></a><span class="lineno"> 3235</span>&#160;  {</div>
<div class="line"><a name="l03236"></a><span class="lineno"> 3236</span>&#160;    <span class="keywordflow">if</span>(infoIn-&gt;<a class="code" href="struct_lode_p_n_g___info_color.html#a4ed18d179c5078137a18e742b1c41a00">colorType</a> != 0) <span class="keywordflow">return</span> 31; <span class="comment">/*colorType 0 is the only greyscale type with &lt; 8 bits per channel*/</span></div>
<div class="line"><a name="l03237"></a><span class="lineno"> 3237</span>&#160;    <span class="keywordflow">for</span>(i = 0; i &lt; numpixels; i++)</div>
<div class="line"><a name="l03238"></a><span class="lineno"> 3238</span>&#160;    {</div>
<div class="line"><a name="l03239"></a><span class="lineno"> 3239</span>&#160;      <span class="keywordtype">unsigned</span> value = readBitsFromReversedStream(&amp;bp, in, infoIn-&gt;<a class="code" href="struct_lode_p_n_g___info_color.html#a9d538965a46d59bbdea744da8b290591">bitDepth</a>);</div>
<div class="line"><a name="l03240"></a><span class="lineno"> 3240</span>&#160;      <span class="keywordtype">unsigned</span> highest = ((1U &lt;&lt; infoIn-&gt;<a class="code" href="struct_lode_p_n_g___info_color.html#a9d538965a46d59bbdea744da8b290591">bitDepth</a>) - 1U); <span class="comment">/*highest possible value for this bit depth*/</span></div>
<div class="line"><a name="l03241"></a><span class="lineno"> 3241</span>&#160;      out[bytes * i] = out[bytes * i + 1] = (<span class="keywordtype">unsigned</span> char)((value * 255) / highest); <span class="comment">/*scale value from 0 to 255*/</span></div>
<div class="line"><a name="l03242"></a><span class="lineno"> 3242</span>&#160;      <span class="keywordflow">if</span>(alpha)</div>
<div class="line"><a name="l03243"></a><span class="lineno"> 3243</span>&#160;      {</div>
<div class="line"><a name="l03244"></a><span class="lineno"> 3244</span>&#160;        <span class="keywordflow">if</span>(infoIn-&gt;<a class="code" href="struct_lode_p_n_g___info_color.html#aa0193ce13025c776a0dfb1e6d1bed14a">key_defined</a> &amp;&amp; value == infoIn-&gt;<a class="code" href="struct_lode_p_n_g___info_color.html#a5536a8859201cd11df789ec7ad8263df">key_r</a>) out[bytes * i + 2] = out[bytes * i + 3] = 0;</div>
<div class="line"><a name="l03245"></a><span class="lineno"> 3245</span>&#160;        <span class="keywordflow">else</span> out[bytes * i + 2] = out[bytes * i + 3] = 255;</div>
<div class="line"><a name="l03246"></a><span class="lineno"> 3246</span>&#160;      }</div>
<div class="line"><a name="l03247"></a><span class="lineno"> 3247</span>&#160;    }</div>
<div class="line"><a name="l03248"></a><span class="lineno"> 3248</span>&#160;  }</div>
<div class="line"><a name="l03249"></a><span class="lineno"> 3249</span>&#160;  <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l03250"></a><span class="lineno"> 3250</span>&#160;}</div>
<div class="line"><a name="l03251"></a><span class="lineno"> 3251</span>&#160;</div>
<div class="line"><a name="l03252"></a><span class="lineno"> 3252</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l03253"></a><span class="lineno"> 3253</span>&#160;<span class="comment">converts from any color type to 24-bit or 32-bit (later maybe more supported). return value = LodePNG error code</span></div>
<div class="line"><a name="l03254"></a><span class="lineno"> 3254</span>&#160;<span class="comment">the out buffer must have (w * h * bpp + 7) / 8 bytes, where bpp is the bits per pixel of the output color type</span></div>
<div class="line"><a name="l03255"></a><span class="lineno"> 3255</span>&#160;<span class="comment">(LodePNG_InfoColor_getBpp) for &lt; 8 bpp images, there may _not_ be padding bits at the end of scanlines.</span></div>
<div class="line"><a name="l03256"></a><span class="lineno"> 3256</span>&#160;<span class="comment">*/</span></div>
<div class="line"><a name="l03257"></a><span class="lineno"><a class="line" href="lodepng_8h.html#a9e7ce5d1928b44ba6a7c30465b996c68"> 3257</a></span>&#160;<span class="keywordtype">unsigned</span> <a class="code" href="lodepng_8cpp.html#a9e7ce5d1928b44ba6a7c30465b996c68">LodePNG_convert</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* out, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* in, <a class="code" href="struct_lode_p_n_g___info_color.html">LodePNG_InfoColor</a>* infoOut,</div>
<div class="line"><a name="l03258"></a><span class="lineno"> 3258</span>&#160;                         <a class="code" href="struct_lode_p_n_g___info_color.html">LodePNG_InfoColor</a>* infoIn, <span class="keywordtype">unsigned</span> w, <span class="keywordtype">unsigned</span> h)</div>
<div class="line"><a name="l03259"></a><span class="lineno"> 3259</span>&#160;{</div>
<div class="line"><a name="l03260"></a><span class="lineno"> 3260</span>&#160;  <span class="keywordtype">size_t</span> numpixels = w * h; <span class="comment">/*amount of pixels*/</span></div>
<div class="line"><a name="l03261"></a><span class="lineno"> 3261</span>&#160;  <span class="keywordtype">unsigned</span> bytes = <a class="code" href="lodepng_8cpp.html#a81151c0087467b4ac2a815b3234fdb5a">LodePNG_InfoColor_getBpp</a>(infoOut) / 8; <span class="comment">/*bytes per pixel in the output image*/</span></div>
<div class="line"><a name="l03262"></a><span class="lineno"> 3262</span>&#160;  <span class="keywordtype">unsigned</span> alpha = <a class="code" href="lodepng_8cpp.html#af139bc36c2a9b88d21dc3652520a3f73">LodePNG_InfoColor_isAlphaType</a>(infoOut); <span class="comment">/*use 8-bit alpha channel*/</span></div>
<div class="line"><a name="l03263"></a><span class="lineno"> 3263</span>&#160;  </div>
<div class="line"><a name="l03264"></a><span class="lineno"> 3264</span>&#160;  <span class="comment">/*cases where in and out already have the same format*/</span></div>
<div class="line"><a name="l03265"></a><span class="lineno"> 3265</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="lodepng_8cpp.html#ac1a87f6ae0de91fe9c7716ff5dc3fbea">LodePNG_InfoColor_equal</a>(infoIn, infoOut))</div>
<div class="line"><a name="l03266"></a><span class="lineno"> 3266</span>&#160;  {</div>
<div class="line"><a name="l03267"></a><span class="lineno"> 3267</span>&#160;    <span class="keywordtype">size_t</span> i;</div>
<div class="line"><a name="l03268"></a><span class="lineno"> 3268</span>&#160;    <span class="keywordtype">size_t</span> size = (numpixels * <a class="code" href="lodepng_8cpp.html#a81151c0087467b4ac2a815b3234fdb5a">LodePNG_InfoColor_getBpp</a>(infoIn) + 7) / 8;</div>
<div class="line"><a name="l03269"></a><span class="lineno"> 3269</span>&#160;    <span class="keywordflow">for</span>(i = 0; i &lt; <a class="code" href="_d_l_l_imports_8inl.html#abcaf2e752dfff61ecb0b2d0a593966ee">size</a>; i++) out[i] = in[i];</div>
<div class="line"><a name="l03270"></a><span class="lineno"> 3270</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l03271"></a><span class="lineno"> 3271</span>&#160;  }</div>
<div class="line"><a name="l03272"></a><span class="lineno"> 3272</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span>((infoOut-&gt;<a class="code" href="struct_lode_p_n_g___info_color.html#a4ed18d179c5078137a18e742b1c41a00">colorType</a> == 2 || infoOut-&gt;<a class="code" href="struct_lode_p_n_g___info_color.html#a4ed18d179c5078137a18e742b1c41a00">colorType</a> == 6) &amp;&amp; infoOut-&gt;<a class="code" href="struct_lode_p_n_g___info_color.html#a9d538965a46d59bbdea744da8b290591">bitDepth</a> == 8)</div>
<div class="line"><a name="l03273"></a><span class="lineno"> 3273</span>&#160;  {</div>
<div class="line"><a name="l03274"></a><span class="lineno"> 3274</span>&#160;    LodePNG_convert_rgb_a_8(out, in, infoIn, numpixels, bytes, alpha);</div>
<div class="line"><a name="l03275"></a><span class="lineno"> 3275</span>&#160;  }</div>
<div class="line"><a name="l03276"></a><span class="lineno"> 3276</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="lodepng_8cpp.html#ac0564ed5cbac6fcfda3b28b3078cde65">LodePNG_InfoColor_isGreyscaleType</a>(infoOut) &amp;&amp; infoOut-&gt;<a class="code" href="struct_lode_p_n_g___info_color.html#a9d538965a46d59bbdea744da8b290591">bitDepth</a> == 8)</div>
<div class="line"><a name="l03277"></a><span class="lineno"> 3277</span>&#160;  {</div>
<div class="line"><a name="l03278"></a><span class="lineno"> 3278</span>&#160;    <span class="comment">/*conversion from greyscale to greyscale*/</span></div>
<div class="line"><a name="l03279"></a><span class="lineno"> 3279</span>&#160;    <span class="keywordflow">if</span>(!<a class="code" href="lodepng_8cpp.html#ac0564ed5cbac6fcfda3b28b3078cde65">LodePNG_InfoColor_isGreyscaleType</a>(infoIn)) <span class="keywordflow">return</span> 62; <span class="comment">/*converting from color to grey is not supported*/</span></div>
<div class="line"><a name="l03280"></a><span class="lineno"> 3280</span>&#160;    LodePNG_convert_grey_8(out, in, infoIn, numpixels, bytes, alpha);</div>
<div class="line"><a name="l03281"></a><span class="lineno"> 3281</span>&#160;  }</div>
<div class="line"><a name="l03282"></a><span class="lineno"> 3282</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span>((infoOut-&gt;<a class="code" href="struct_lode_p_n_g___info_color.html#a4ed18d179c5078137a18e742b1c41a00">colorType</a> == 2 || infoOut-&gt;<a class="code" href="struct_lode_p_n_g___info_color.html#a4ed18d179c5078137a18e742b1c41a00">colorType</a> == 6) &amp;&amp; infoOut-&gt;<a class="code" href="struct_lode_p_n_g___info_color.html#a9d538965a46d59bbdea744da8b290591">bitDepth</a> == 16)</div>
<div class="line"><a name="l03283"></a><span class="lineno"> 3283</span>&#160;  {</div>
<div class="line"><a name="l03284"></a><span class="lineno"> 3284</span>&#160;    LodePNG_convert_rgb_a_16(out, in, infoIn, numpixels, bytes, alpha);</div>
<div class="line"><a name="l03285"></a><span class="lineno"> 3285</span>&#160;  }</div>
<div class="line"><a name="l03286"></a><span class="lineno"> 3286</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="lodepng_8cpp.html#ac0564ed5cbac6fcfda3b28b3078cde65">LodePNG_InfoColor_isGreyscaleType</a>(infoOut) &amp;&amp; infoOut-&gt;<a class="code" href="struct_lode_p_n_g___info_color.html#a9d538965a46d59bbdea744da8b290591">bitDepth</a> == 16)</div>
<div class="line"><a name="l03287"></a><span class="lineno"> 3287</span>&#160;  {</div>
<div class="line"><a name="l03288"></a><span class="lineno"> 3288</span>&#160;    <span class="comment">/*conversion from greyscale to greyscale*/</span></div>
<div class="line"><a name="l03289"></a><span class="lineno"> 3289</span>&#160;    <span class="keywordflow">if</span>(!<a class="code" href="lodepng_8cpp.html#ac0564ed5cbac6fcfda3b28b3078cde65">LodePNG_InfoColor_isGreyscaleType</a>(infoIn)) <span class="keywordflow">return</span> 62; <span class="comment">/*converting from color to grey is not supported*/</span></div>
<div class="line"><a name="l03290"></a><span class="lineno"> 3290</span>&#160;    LodePNG_convert_grey_16(out, in, infoIn, numpixels, bytes, alpha);</div>
<div class="line"><a name="l03291"></a><span class="lineno"> 3291</span>&#160;  }</div>
<div class="line"><a name="l03292"></a><span class="lineno"> 3292</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">return</span> 59; <span class="comment">/*invalid color mode*/</span></div>
<div class="line"><a name="l03293"></a><span class="lineno"> 3293</span>&#160;  <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l03294"></a><span class="lineno"> 3294</span>&#160;}</div>
<div class="line"><a name="l03295"></a><span class="lineno"> 3295</span>&#160;</div>
<div class="line"><a name="l03296"></a><span class="lineno"> 3296</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l03297"></a><span class="lineno"> 3297</span>&#160;<span class="comment">Paeth predicter, used by PNG filter type 4</span></div>
<div class="line"><a name="l03298"></a><span class="lineno"> 3298</span>&#160;<span class="comment">The parameters are of type short, but should come from unsigned chars, the shorts</span></div>
<div class="line"><a name="l03299"></a><span class="lineno"> 3299</span>&#160;<span class="comment">are only needed to make the paeth calculation correct.</span></div>
<div class="line"><a name="l03300"></a><span class="lineno"> 3300</span>&#160;<span class="comment">*/</span></div>
<div class="line"><a name="l03301"></a><span class="lineno"> 3301</span>&#160;<span class="keyword">static</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> paethPredictor(<span class="keywordtype">short</span> a, <span class="keywordtype">short</span> b, <span class="keywordtype">short</span> c)</div>
<div class="line"><a name="l03302"></a><span class="lineno"> 3302</span>&#160;{</div>
<div class="line"><a name="l03303"></a><span class="lineno"> 3303</span>&#160;  <span class="keywordtype">short</span> pa = <a class="code" href="namespace_f_w.html#a79b17ce962874a748b7d0229f4e05c59">abs</a>(b - c);</div>
<div class="line"><a name="l03304"></a><span class="lineno"> 3304</span>&#160;  <span class="keywordtype">short</span> pb = <a class="code" href="namespace_f_w.html#a79b17ce962874a748b7d0229f4e05c59">abs</a>(a - c);</div>
<div class="line"><a name="l03305"></a><span class="lineno"> 3305</span>&#160;  <span class="keywordtype">short</span> pc = <a class="code" href="namespace_f_w.html#a79b17ce962874a748b7d0229f4e05c59">abs</a>(a + b - c - c);</div>
<div class="line"><a name="l03306"></a><span class="lineno"> 3306</span>&#160;</div>
<div class="line"><a name="l03307"></a><span class="lineno"> 3307</span>&#160;  <span class="comment">/*short pc = a + b - c;</span></div>
<div class="line"><a name="l03308"></a><span class="lineno"> 3308</span>&#160;<span class="comment">  short pa = abs(pc - a);</span></div>
<div class="line"><a name="l03309"></a><span class="lineno"> 3309</span>&#160;<span class="comment">  short pb = abs(pc - b);</span></div>
<div class="line"><a name="l03310"></a><span class="lineno"> 3310</span>&#160;<span class="comment">  pc = abs(pc - c);*/</span></div>
<div class="line"><a name="l03311"></a><span class="lineno"> 3311</span>&#160;</div>
<div class="line"><a name="l03312"></a><span class="lineno"> 3312</span>&#160;  <span class="keywordflow">if</span>(pa &lt;= pb &amp;&amp; pa &lt;= pc) <span class="keywordflow">return</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>)a;</div>
<div class="line"><a name="l03313"></a><span class="lineno"> 3313</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span>(pb &lt;= pc) <span class="keywordflow">return</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>)b;</div>
<div class="line"><a name="l03314"></a><span class="lineno"> 3314</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">return</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>)c;</div>
<div class="line"><a name="l03315"></a><span class="lineno"> 3315</span>&#160;}</div>
<div class="line"><a name="l03316"></a><span class="lineno"> 3316</span>&#160;</div>
<div class="line"><a name="l03317"></a><span class="lineno"> 3317</span>&#160;<span class="comment">/*shared values used by multiple Adam7 related functions*/</span></div>
<div class="line"><a name="l03318"></a><span class="lineno"> 3318</span>&#160;</div>
<div class="line"><a name="l03319"></a><span class="lineno"> 3319</span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> ADAM7_IX[7] = { 0, 4, 0, 2, 0, 1, 0 }; <span class="comment">/*x start values*/</span></div>
<div class="line"><a name="l03320"></a><span class="lineno"> 3320</span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> ADAM7_IY[7] = { 0, 0, 4, 0, 2, 0, 1 }; <span class="comment">/*y start values*/</span></div>
<div class="line"><a name="l03321"></a><span class="lineno"> 3321</span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> ADAM7_DX[7] = { 8, 8, 4, 4, 2, 2, 1 }; <span class="comment">/*x delta values*/</span></div>
<div class="line"><a name="l03322"></a><span class="lineno"> 3322</span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> ADAM7_DY[7] = { 8, 8, 8, 4, 4, 2, 2 }; <span class="comment">/*y delta values*/</span></div>
<div class="line"><a name="l03323"></a><span class="lineno"> 3323</span>&#160;</div>
<div class="line"><a name="l03324"></a><span class="lineno"> 3324</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> Adam7_getpassvalues(<span class="keywordtype">unsigned</span> passw[7], <span class="keywordtype">unsigned</span> passh[7], <span class="keywordtype">size_t</span> filter_passstart[8],</div>
<div class="line"><a name="l03325"></a><span class="lineno"> 3325</span>&#160;                                <span class="keywordtype">size_t</span> padded_passstart[8], <span class="keywordtype">size_t</span> passstart[8], <span class="keywordtype">unsigned</span> w, <span class="keywordtype">unsigned</span> h, <span class="keywordtype">unsigned</span> bpp)</div>
<div class="line"><a name="l03326"></a><span class="lineno"> 3326</span>&#160;{</div>
<div class="line"><a name="l03327"></a><span class="lineno"> 3327</span>&#160;  <span class="comment">/*the passstart values have 8 values: the 8th one indicates the byte after the end of the 7th (= last) pass*/</span></div>
<div class="line"><a name="l03328"></a><span class="lineno"> 3328</span>&#160;  <span class="keywordtype">unsigned</span> i;</div>
<div class="line"><a name="l03329"></a><span class="lineno"> 3329</span>&#160;</div>
<div class="line"><a name="l03330"></a><span class="lineno"> 3330</span>&#160;  <span class="comment">/*calculate width and height in pixels of each pass*/</span></div>
<div class="line"><a name="l03331"></a><span class="lineno"> 3331</span>&#160;  <span class="keywordflow">for</span>(i = 0; i &lt; 7; i++)</div>
<div class="line"><a name="l03332"></a><span class="lineno"> 3332</span>&#160;  {</div>
<div class="line"><a name="l03333"></a><span class="lineno"> 3333</span>&#160;    passw[i] = (w + ADAM7_DX[i] - ADAM7_IX[i] - 1) / ADAM7_DX[i];</div>
<div class="line"><a name="l03334"></a><span class="lineno"> 3334</span>&#160;    passh[i] = (h + ADAM7_DY[i] - ADAM7_IY[i] - 1) / ADAM7_DY[i];</div>
<div class="line"><a name="l03335"></a><span class="lineno"> 3335</span>&#160;    <span class="keywordflow">if</span>(passw[i] == 0) passh[i] = 0;</div>
<div class="line"><a name="l03336"></a><span class="lineno"> 3336</span>&#160;    <span class="keywordflow">if</span>(passh[i] == 0) passw[i] = 0;</div>
<div class="line"><a name="l03337"></a><span class="lineno"> 3337</span>&#160;  }</div>
<div class="line"><a name="l03338"></a><span class="lineno"> 3338</span>&#160;</div>
<div class="line"><a name="l03339"></a><span class="lineno"> 3339</span>&#160;  filter_passstart[0] = padded_passstart[0] = passstart[0] = 0;</div>
<div class="line"><a name="l03340"></a><span class="lineno"> 3340</span>&#160;  <span class="keywordflow">for</span>(i = 0; i &lt; 7; i++)</div>
<div class="line"><a name="l03341"></a><span class="lineno"> 3341</span>&#160;  {</div>
<div class="line"><a name="l03342"></a><span class="lineno"> 3342</span>&#160;    <span class="comment">/*if passw[i] is 0, it&#39;s 0 bytes, not 1 (no filtertype-byte)*/</span></div>
<div class="line"><a name="l03343"></a><span class="lineno"> 3343</span>&#160;    filter_passstart[i + 1] = filter_passstart[i]</div>
<div class="line"><a name="l03344"></a><span class="lineno"> 3344</span>&#160;                            + ((passw[i] &amp;&amp; passh[i]) ? passh[i] * (1 + (passw[i] * bpp + 7) / 8) : 0);</div>
<div class="line"><a name="l03345"></a><span class="lineno"> 3345</span>&#160;    <span class="comment">/*bits padded if needed to fill full byte at end of each scanline*/</span></div>
<div class="line"><a name="l03346"></a><span class="lineno"> 3346</span>&#160;    padded_passstart[i + 1] = padded_passstart[i] + passh[i] * ((passw[i] * bpp + 7) / 8);</div>
<div class="line"><a name="l03347"></a><span class="lineno"> 3347</span>&#160;    <span class="comment">/*only padded at end of reduced image*/</span></div>
<div class="line"><a name="l03348"></a><span class="lineno"> 3348</span>&#160;    passstart[i + 1] = passstart[i] + (passh[i] * passw[i] * bpp + 7) / 8;</div>
<div class="line"><a name="l03349"></a><span class="lineno"> 3349</span>&#160;  }</div>
<div class="line"><a name="l03350"></a><span class="lineno"> 3350</span>&#160;}</div>
<div class="line"><a name="l03351"></a><span class="lineno"> 3351</span>&#160;</div>
<div class="line"><a name="l03352"></a><span class="lineno"> 3352</span>&#160;<span class="preprocessor">#ifdef LODEPNG_COMPILE_DECODER</span></div>
<div class="line"><a name="l03353"></a><span class="lineno"> 3353</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l03354"></a><span class="lineno"> 3354</span>&#160;<span class="comment">/* ////////////////////////////////////////////////////////////////////////// */</span></div>
<div class="line"><a name="l03355"></a><span class="lineno"> 3355</span>&#160;<span class="comment">/* / PNG Decoder                                                            / */</span></div>
<div class="line"><a name="l03356"></a><span class="lineno"> 3356</span>&#160;<span class="comment">/* ////////////////////////////////////////////////////////////////////////// */</span></div>
<div class="line"><a name="l03357"></a><span class="lineno"> 3357</span>&#160;</div>
<div class="line"><a name="l03358"></a><span class="lineno"> 3358</span>&#160;<span class="comment">/*read the information from the header and store it in the LodePNG_Info. return value is error*/</span></div>
<div class="line"><a name="l03359"></a><span class="lineno"><a class="line" href="lodepng_8h.html#a3e4a692813f84f109d6cef0dfcbe7010"> 3359</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="lodepng_8cpp.html#afddaefb609ec98a432b3dd0437c849ad">LodePNG_Decoder_inspect</a>(<a class="code" href="struct_lode_p_n_g___decoder.html">LodePNG_Decoder</a>* decoder, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* in, <span class="keywordtype">size_t</span> inlength)</div>
<div class="line"><a name="l03360"></a><span class="lineno"> 3360</span>&#160;{</div>
<div class="line"><a name="l03361"></a><span class="lineno"> 3361</span>&#160;  <span class="keywordflow">if</span>(inlength == 0 || in == 0)</div>
<div class="line"><a name="l03362"></a><span class="lineno"> 3362</span>&#160;  {</div>
<div class="line"><a name="l03363"></a><span class="lineno"> 3363</span>&#160;    decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#a1986e8d73bf733140e2de07993685983">error</a> = 48; <span class="comment">/*the given data is empty*/</span></div>
<div class="line"><a name="l03364"></a><span class="lineno"> 3364</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l03365"></a><span class="lineno"> 3365</span>&#160;  }</div>
<div class="line"><a name="l03366"></a><span class="lineno"> 3366</span>&#160;  <span class="keywordflow">if</span>(inlength &lt; 29)</div>
<div class="line"><a name="l03367"></a><span class="lineno"> 3367</span>&#160;  {</div>
<div class="line"><a name="l03368"></a><span class="lineno"> 3368</span>&#160;    decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#a1986e8d73bf733140e2de07993685983">error</a> = 27; <span class="comment">/*error: the data length is smaller than the length of a PNG header*/</span></div>
<div class="line"><a name="l03369"></a><span class="lineno"> 3369</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l03370"></a><span class="lineno"> 3370</span>&#160;  }</div>
<div class="line"><a name="l03371"></a><span class="lineno"> 3371</span>&#160;</div>
<div class="line"><a name="l03372"></a><span class="lineno"> 3372</span>&#160;  <span class="comment">/*when decoding a new PNG image, make sure all parameters created after previous decoding are reset*/</span></div>
<div class="line"><a name="l03373"></a><span class="lineno"> 3373</span>&#160;  <a class="code" href="lodepng_8cpp.html#a7884592df167f7136fc928cacf1efd36">LodePNG_InfoPng_cleanup</a>(&amp;decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#aa84a32ab83a4e50d909259b2041cb13e">infoPng</a>);</div>
<div class="line"><a name="l03374"></a><span class="lineno"> 3374</span>&#160;  <a class="code" href="lodepng_8cpp.html#a66ddccc82c59e05d746086f56997b4cd">LodePNG_InfoPng_init</a>(&amp;decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#aa84a32ab83a4e50d909259b2041cb13e">infoPng</a>);</div>
<div class="line"><a name="l03375"></a><span class="lineno"> 3375</span>&#160;  decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#a1986e8d73bf733140e2de07993685983">error</a> = 0;</div>
<div class="line"><a name="l03376"></a><span class="lineno"> 3376</span>&#160;</div>
<div class="line"><a name="l03377"></a><span class="lineno"> 3377</span>&#160;  <span class="keywordflow">if</span>(in[0] != 137 || in[1] != 80 || in[2] != 78 || in[3] != 71</div>
<div class="line"><a name="l03378"></a><span class="lineno"> 3378</span>&#160;     || in[4] != 13 || in[5] != 10 || in[6] != 26 || in[7] != 10)</div>
<div class="line"><a name="l03379"></a><span class="lineno"> 3379</span>&#160;  {</div>
<div class="line"><a name="l03380"></a><span class="lineno"> 3380</span>&#160;    decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#a1986e8d73bf733140e2de07993685983">error</a> = 28; <span class="comment">/*error: the first 8 bytes are not the correct PNG signature*/</span></div>
<div class="line"><a name="l03381"></a><span class="lineno"> 3381</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l03382"></a><span class="lineno"> 3382</span>&#160;  }</div>
<div class="line"><a name="l03383"></a><span class="lineno"> 3383</span>&#160;  <span class="keywordflow">if</span>(in[12] != <span class="charliteral">&#39;I&#39;</span> || in[13] != <span class="charliteral">&#39;H&#39;</span> || in[14] != <span class="charliteral">&#39;D&#39;</span> || in[15] != <span class="charliteral">&#39;R&#39;</span>)</div>
<div class="line"><a name="l03384"></a><span class="lineno"> 3384</span>&#160;  {</div>
<div class="line"><a name="l03385"></a><span class="lineno"> 3385</span>&#160;    decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#a1986e8d73bf733140e2de07993685983">error</a> = 29; <span class="comment">/*error: it doesn&#39;t start with a IHDR chunk!*/</span></div>
<div class="line"><a name="l03386"></a><span class="lineno"> 3386</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l03387"></a><span class="lineno"> 3387</span>&#160;  }</div>
<div class="line"><a name="l03388"></a><span class="lineno"> 3388</span>&#160;</div>
<div class="line"><a name="l03389"></a><span class="lineno"> 3389</span>&#160;  <span class="comment">/*read the values given in the header*/</span></div>
<div class="line"><a name="l03390"></a><span class="lineno"> 3390</span>&#160;  decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#aa84a32ab83a4e50d909259b2041cb13e">infoPng</a>.<a class="code" href="struct_lode_p_n_g___info_png.html#a74be99b177b28f3178c02139c4b7f149">width</a> = <a class="code" href="lodepng_8cpp.html#a347e6964b32f99efb902fbf7b1a9d934">LodePNG_read32bitInt</a>(&amp;in[16]);</div>
<div class="line"><a name="l03391"></a><span class="lineno"> 3391</span>&#160;  decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#aa84a32ab83a4e50d909259b2041cb13e">infoPng</a>.<a class="code" href="struct_lode_p_n_g___info_png.html#a4b87ec9649e7177af7a5f5e08e5bc491">height</a> = <a class="code" href="lodepng_8cpp.html#a347e6964b32f99efb902fbf7b1a9d934">LodePNG_read32bitInt</a>(&amp;in[20]);</div>
<div class="line"><a name="l03392"></a><span class="lineno"> 3392</span>&#160;  decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#aa84a32ab83a4e50d909259b2041cb13e">infoPng</a>.<a class="code" href="struct_lode_p_n_g___info_png.html#acce58518f72f42ba94db4c1cfd69336b">color</a>.<a class="code" href="struct_lode_p_n_g___info_color.html#a9d538965a46d59bbdea744da8b290591">bitDepth</a> = in[24];</div>
<div class="line"><a name="l03393"></a><span class="lineno"> 3393</span>&#160;  decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#aa84a32ab83a4e50d909259b2041cb13e">infoPng</a>.<a class="code" href="struct_lode_p_n_g___info_png.html#acce58518f72f42ba94db4c1cfd69336b">color</a>.<a class="code" href="struct_lode_p_n_g___info_color.html#a4ed18d179c5078137a18e742b1c41a00">colorType</a> = in[25];</div>
<div class="line"><a name="l03394"></a><span class="lineno"> 3394</span>&#160;  decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#aa84a32ab83a4e50d909259b2041cb13e">infoPng</a>.<a class="code" href="struct_lode_p_n_g___info_png.html#a177065a8eeb66398a89ed93e7c2b2f50">compressionMethod</a> = in[26];</div>
<div class="line"><a name="l03395"></a><span class="lineno"> 3395</span>&#160;  decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#aa84a32ab83a4e50d909259b2041cb13e">infoPng</a>.<a class="code" href="struct_lode_p_n_g___info_png.html#a101ffbacd7026dad4ab062e984cecf17">filterMethod</a> = in[27];</div>
<div class="line"><a name="l03396"></a><span class="lineno"> 3396</span>&#160;  decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#aa84a32ab83a4e50d909259b2041cb13e">infoPng</a>.<a class="code" href="struct_lode_p_n_g___info_png.html#ad261cbe064eb69a92638e880d99347ca">interlaceMethod</a> = in[28];</div>
<div class="line"><a name="l03397"></a><span class="lineno"> 3397</span>&#160;</div>
<div class="line"><a name="l03398"></a><span class="lineno"> 3398</span>&#160;  <span class="keywordflow">if</span>(!decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#a03ad3505caf0cba6de6cadfd41b9067e">settings</a>.<a class="code" href="struct_lode_p_n_g___decode_settings.html#a08d95fa78ebdfcdeb8dcb05ccee6716c">ignoreCrc</a>)</div>
<div class="line"><a name="l03399"></a><span class="lineno"> 3399</span>&#160;  {</div>
<div class="line"><a name="l03400"></a><span class="lineno"> 3400</span>&#160;    <span class="keywordtype">unsigned</span> CRC = <a class="code" href="lodepng_8cpp.html#a347e6964b32f99efb902fbf7b1a9d934">LodePNG_read32bitInt</a>(&amp;in[29]);</div>
<div class="line"><a name="l03401"></a><span class="lineno"> 3401</span>&#160;    <span class="keywordtype">unsigned</span> checksum = Crc32_crc(&amp;in[12], 17);</div>
<div class="line"><a name="l03402"></a><span class="lineno"> 3402</span>&#160;    <span class="keywordflow">if</span>(CRC != checksum)</div>
<div class="line"><a name="l03403"></a><span class="lineno"> 3403</span>&#160;    {</div>
<div class="line"><a name="l03404"></a><span class="lineno"> 3404</span>&#160;      decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#a1986e8d73bf733140e2de07993685983">error</a> = 57; <span class="comment">/*invalid CRC*/</span></div>
<div class="line"><a name="l03405"></a><span class="lineno"> 3405</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l03406"></a><span class="lineno"> 3406</span>&#160;    }</div>
<div class="line"><a name="l03407"></a><span class="lineno"> 3407</span>&#160;  }</div>
<div class="line"><a name="l03408"></a><span class="lineno"> 3408</span>&#160;</div>
<div class="line"><a name="l03409"></a><span class="lineno"> 3409</span>&#160;  <span class="comment">/*error: only compression method 0 is allowed in the specification*/</span></div>
<div class="line"><a name="l03410"></a><span class="lineno"> 3410</span>&#160;  <span class="keywordflow">if</span>(decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#aa84a32ab83a4e50d909259b2041cb13e">infoPng</a>.<a class="code" href="struct_lode_p_n_g___info_png.html#a177065a8eeb66398a89ed93e7c2b2f50">compressionMethod</a> != 0) { decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#a1986e8d73bf733140e2de07993685983">error</a> = 32; <span class="keywordflow">return</span>; }</div>
<div class="line"><a name="l03411"></a><span class="lineno"> 3411</span>&#160;  <span class="comment">/*error: only filter method 0 is allowed in the specification*/</span></div>
<div class="line"><a name="l03412"></a><span class="lineno"> 3412</span>&#160;  <span class="keywordflow">if</span>(decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#aa84a32ab83a4e50d909259b2041cb13e">infoPng</a>.<a class="code" href="struct_lode_p_n_g___info_png.html#a101ffbacd7026dad4ab062e984cecf17">filterMethod</a> != 0)      { decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#a1986e8d73bf733140e2de07993685983">error</a> = 33; <span class="keywordflow">return</span>; }</div>
<div class="line"><a name="l03413"></a><span class="lineno"> 3413</span>&#160;  <span class="comment">/*error: only interlace methods 0 and 1 exist in the specification*/</span></div>
<div class="line"><a name="l03414"></a><span class="lineno"> 3414</span>&#160;  <span class="keywordflow">if</span>(decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#aa84a32ab83a4e50d909259b2041cb13e">infoPng</a>.<a class="code" href="struct_lode_p_n_g___info_png.html#ad261cbe064eb69a92638e880d99347ca">interlaceMethod</a> &gt; 1)    { decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#a1986e8d73bf733140e2de07993685983">error</a> = 34; <span class="keywordflow">return</span>; }</div>
<div class="line"><a name="l03415"></a><span class="lineno"> 3415</span>&#160;</div>
<div class="line"><a name="l03416"></a><span class="lineno"> 3416</span>&#160;  decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#a1986e8d73bf733140e2de07993685983">error</a> = checkColorValidity(decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#aa84a32ab83a4e50d909259b2041cb13e">infoPng</a>.<a class="code" href="struct_lode_p_n_g___info_png.html#acce58518f72f42ba94db4c1cfd69336b">color</a>.<a class="code" href="struct_lode_p_n_g___info_color.html#a4ed18d179c5078137a18e742b1c41a00">colorType</a>, decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#aa84a32ab83a4e50d909259b2041cb13e">infoPng</a>.<a class="code" href="struct_lode_p_n_g___info_png.html#acce58518f72f42ba94db4c1cfd69336b">color</a>.<a class="code" href="struct_lode_p_n_g___info_color.html#a9d538965a46d59bbdea744da8b290591">bitDepth</a>);</div>
<div class="line"><a name="l03417"></a><span class="lineno"> 3417</span>&#160;}</div>
<div class="line"><a name="l03418"></a><span class="lineno"> 3418</span>&#160;</div>
<div class="line"><a name="l03419"></a><span class="lineno"> 3419</span>&#160;<span class="keyword">static</span> <span class="keywordtype">unsigned</span> unfilterScanline(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* recon, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* scanline, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* precon,</div>
<div class="line"><a name="l03420"></a><span class="lineno"> 3420</span>&#160;                                 <span class="keywordtype">size_t</span> bytewidth, <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> filterType, <span class="keywordtype">size_t</span> length)</div>
<div class="line"><a name="l03421"></a><span class="lineno"> 3421</span>&#160;{</div>
<div class="line"><a name="l03422"></a><span class="lineno"> 3422</span>&#160;  <span class="comment">/*</span></div>
<div class="line"><a name="l03423"></a><span class="lineno"> 3423</span>&#160;<span class="comment">  For PNG filter method 0</span></div>
<div class="line"><a name="l03424"></a><span class="lineno"> 3424</span>&#160;<span class="comment">  unfilter a PNG image scanline by scanline. when the pixels are smaller than 1 byte,</span></div>
<div class="line"><a name="l03425"></a><span class="lineno"> 3425</span>&#160;<span class="comment">  the filter works byte per byte (bytewidth = 1)</span></div>
<div class="line"><a name="l03426"></a><span class="lineno"> 3426</span>&#160;<span class="comment">  precon is the previous unfiltered scanline, recon the result, scanline the current one</span></div>
<div class="line"><a name="l03427"></a><span class="lineno"> 3427</span>&#160;<span class="comment">  the incoming scanlines do NOT include the filtertype byte, that one is given in the parameter filterType instead</span></div>
<div class="line"><a name="l03428"></a><span class="lineno"> 3428</span>&#160;<span class="comment">  recon and scanline MAY be the same memory address! precon must be disjoint.</span></div>
<div class="line"><a name="l03429"></a><span class="lineno"> 3429</span>&#160;<span class="comment">  */</span></div>
<div class="line"><a name="l03430"></a><span class="lineno"> 3430</span>&#160;</div>
<div class="line"><a name="l03431"></a><span class="lineno"> 3431</span>&#160;  <span class="keywordtype">size_t</span> i;</div>
<div class="line"><a name="l03432"></a><span class="lineno"> 3432</span>&#160;  <span class="keywordflow">switch</span>(filterType)</div>
<div class="line"><a name="l03433"></a><span class="lineno"> 3433</span>&#160;  {</div>
<div class="line"><a name="l03434"></a><span class="lineno"> 3434</span>&#160;    <span class="keywordflow">case</span> 0:</div>
<div class="line"><a name="l03435"></a><span class="lineno"> 3435</span>&#160;      <span class="keywordflow">for</span>(i = 0; i &lt; <a class="code" href="_d_l_l_imports_8inl.html#a5720e2b8f4f85b31e0bab5a1b6e69c74">length</a>; i++) recon[i] = scanline[i];</div>
<div class="line"><a name="l03436"></a><span class="lineno"> 3436</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03437"></a><span class="lineno"> 3437</span>&#160;    <span class="keywordflow">case</span> 1:</div>
<div class="line"><a name="l03438"></a><span class="lineno"> 3438</span>&#160;      <span class="keywordflow">for</span>(i =         0; i &lt; bytewidth; i++) recon[i] = scanline[i];</div>
<div class="line"><a name="l03439"></a><span class="lineno"> 3439</span>&#160;      <span class="keywordflow">for</span>(i = bytewidth; i &lt;    <a class="code" href="_d_l_l_imports_8inl.html#a5720e2b8f4f85b31e0bab5a1b6e69c74">length</a>; i++) recon[i] = scanline[i] + recon[i - bytewidth];</div>
<div class="line"><a name="l03440"></a><span class="lineno"> 3440</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03441"></a><span class="lineno"> 3441</span>&#160;    <span class="keywordflow">case</span> 2:</div>
<div class="line"><a name="l03442"></a><span class="lineno"> 3442</span>&#160;      <span class="keywordflow">if</span>(precon)</div>
<div class="line"><a name="l03443"></a><span class="lineno"> 3443</span>&#160;      {</div>
<div class="line"><a name="l03444"></a><span class="lineno"> 3444</span>&#160;        <span class="keywordflow">for</span>(i = 0; i &lt; <a class="code" href="_d_l_l_imports_8inl.html#a5720e2b8f4f85b31e0bab5a1b6e69c74">length</a>; i++) recon[i] = scanline[i] + precon[i];</div>
<div class="line"><a name="l03445"></a><span class="lineno"> 3445</span>&#160;      }</div>
<div class="line"><a name="l03446"></a><span class="lineno"> 3446</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l03447"></a><span class="lineno"> 3447</span>&#160;      {</div>
<div class="line"><a name="l03448"></a><span class="lineno"> 3448</span>&#160;        <span class="keywordflow">for</span>(i = 0; i &lt; <a class="code" href="_d_l_l_imports_8inl.html#a5720e2b8f4f85b31e0bab5a1b6e69c74">length</a>; i++) recon[i] = scanline[i];</div>
<div class="line"><a name="l03449"></a><span class="lineno"> 3449</span>&#160;      }</div>
<div class="line"><a name="l03450"></a><span class="lineno"> 3450</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03451"></a><span class="lineno"> 3451</span>&#160;    <span class="keywordflow">case</span> 3:</div>
<div class="line"><a name="l03452"></a><span class="lineno"> 3452</span>&#160;      <span class="keywordflow">if</span>(precon)</div>
<div class="line"><a name="l03453"></a><span class="lineno"> 3453</span>&#160;      {</div>
<div class="line"><a name="l03454"></a><span class="lineno"> 3454</span>&#160;        <span class="keywordflow">for</span>(i =         0; i &lt; bytewidth; i++) recon[i] = scanline[i] + precon[i] / 2;</div>
<div class="line"><a name="l03455"></a><span class="lineno"> 3455</span>&#160;        <span class="keywordflow">for</span>(i = bytewidth; i &lt;    <a class="code" href="_d_l_l_imports_8inl.html#a5720e2b8f4f85b31e0bab5a1b6e69c74">length</a>; i++) recon[i] = scanline[i] + ((recon[i - bytewidth] + precon[i]) / 2);</div>
<div class="line"><a name="l03456"></a><span class="lineno"> 3456</span>&#160;      }</div>
<div class="line"><a name="l03457"></a><span class="lineno"> 3457</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l03458"></a><span class="lineno"> 3458</span>&#160;      {</div>
<div class="line"><a name="l03459"></a><span class="lineno"> 3459</span>&#160;        <span class="keywordflow">for</span>(i =         0; i &lt; bytewidth; i++) recon[i] = scanline[i];</div>
<div class="line"><a name="l03460"></a><span class="lineno"> 3460</span>&#160;        <span class="keywordflow">for</span>(i = bytewidth; i &lt;    <a class="code" href="_d_l_l_imports_8inl.html#a5720e2b8f4f85b31e0bab5a1b6e69c74">length</a>; i++) recon[i] = scanline[i] + recon[i - bytewidth] / 2;</div>
<div class="line"><a name="l03461"></a><span class="lineno"> 3461</span>&#160;      }</div>
<div class="line"><a name="l03462"></a><span class="lineno"> 3462</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03463"></a><span class="lineno"> 3463</span>&#160;    <span class="keywordflow">case</span> 4:</div>
<div class="line"><a name="l03464"></a><span class="lineno"> 3464</span>&#160;      <span class="keywordflow">if</span>(precon)</div>
<div class="line"><a name="l03465"></a><span class="lineno"> 3465</span>&#160;      {</div>
<div class="line"><a name="l03466"></a><span class="lineno"> 3466</span>&#160;        <span class="keywordflow">for</span>(i = 0; i &lt; bytewidth; i++)</div>
<div class="line"><a name="l03467"></a><span class="lineno"> 3467</span>&#160;        {</div>
<div class="line"><a name="l03468"></a><span class="lineno"> 3468</span>&#160;          recon[i] = (scanline[i] + precon[i]); <span class="comment">/*paethPredictor(0, precon[i], 0) is always precon[i]*/</span></div>
<div class="line"><a name="l03469"></a><span class="lineno"> 3469</span>&#160;        }</div>
<div class="line"><a name="l03470"></a><span class="lineno"> 3470</span>&#160;        <span class="keywordflow">for</span>(i = bytewidth; i &lt; <a class="code" href="_d_l_l_imports_8inl.html#a5720e2b8f4f85b31e0bab5a1b6e69c74">length</a>; i++)</div>
<div class="line"><a name="l03471"></a><span class="lineno"> 3471</span>&#160;        {</div>
<div class="line"><a name="l03472"></a><span class="lineno"> 3472</span>&#160;          recon[i] = (scanline[i] + paethPredictor(recon[i - bytewidth], precon[i], precon[i - bytewidth]));</div>
<div class="line"><a name="l03473"></a><span class="lineno"> 3473</span>&#160;        }</div>
<div class="line"><a name="l03474"></a><span class="lineno"> 3474</span>&#160;      }</div>
<div class="line"><a name="l03475"></a><span class="lineno"> 3475</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l03476"></a><span class="lineno"> 3476</span>&#160;      {</div>
<div class="line"><a name="l03477"></a><span class="lineno"> 3477</span>&#160;        <span class="keywordflow">for</span>(i = 0; i &lt; bytewidth; i++)</div>
<div class="line"><a name="l03478"></a><span class="lineno"> 3478</span>&#160;        {</div>
<div class="line"><a name="l03479"></a><span class="lineno"> 3479</span>&#160;          recon[i] = scanline[i];</div>
<div class="line"><a name="l03480"></a><span class="lineno"> 3480</span>&#160;        }</div>
<div class="line"><a name="l03481"></a><span class="lineno"> 3481</span>&#160;        <span class="keywordflow">for</span>(i = bytewidth; i &lt; <a class="code" href="_d_l_l_imports_8inl.html#a5720e2b8f4f85b31e0bab5a1b6e69c74">length</a>; i++)</div>
<div class="line"><a name="l03482"></a><span class="lineno"> 3482</span>&#160;        {</div>
<div class="line"><a name="l03483"></a><span class="lineno"> 3483</span>&#160;          <span class="comment">/*paethPredictor(recon[i - bytewidth], 0, 0) is always recon[i - bytewidth]*/</span></div>
<div class="line"><a name="l03484"></a><span class="lineno"> 3484</span>&#160;          recon[i] = (scanline[i] + recon[i - bytewidth]);</div>
<div class="line"><a name="l03485"></a><span class="lineno"> 3485</span>&#160;        }</div>
<div class="line"><a name="l03486"></a><span class="lineno"> 3486</span>&#160;      }</div>
<div class="line"><a name="l03487"></a><span class="lineno"> 3487</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03488"></a><span class="lineno"> 3488</span>&#160;    <span class="keywordflow">default</span>: <span class="keywordflow">return</span> 36; <span class="comment">/*error: unexisting filter type given*/</span></div>
<div class="line"><a name="l03489"></a><span class="lineno"> 3489</span>&#160;  }</div>
<div class="line"><a name="l03490"></a><span class="lineno"> 3490</span>&#160;  <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l03491"></a><span class="lineno"> 3491</span>&#160;}</div>
<div class="line"><a name="l03492"></a><span class="lineno"> 3492</span>&#160;</div>
<div class="line"><a name="l03493"></a><span class="lineno"> 3493</span>&#160;<span class="keyword">static</span> <span class="keywordtype">unsigned</span> unfilter(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* out, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* in, <span class="keywordtype">unsigned</span> w, <span class="keywordtype">unsigned</span> h, <span class="keywordtype">unsigned</span> bpp)</div>
<div class="line"><a name="l03494"></a><span class="lineno"> 3494</span>&#160;{</div>
<div class="line"><a name="l03495"></a><span class="lineno"> 3495</span>&#160;  <span class="comment">/*</span></div>
<div class="line"><a name="l03496"></a><span class="lineno"> 3496</span>&#160;<span class="comment">  For PNG filter method 0</span></div>
<div class="line"><a name="l03497"></a><span class="lineno"> 3497</span>&#160;<span class="comment">  this function unfilters a single image (e.g. without interlacing this is called once, with Adam7 seven times)</span></div>
<div class="line"><a name="l03498"></a><span class="lineno"> 3498</span>&#160;<span class="comment">  out must have enough bytes allocated already, in must have the scanlines + 1 filtertype byte per scanline</span></div>
<div class="line"><a name="l03499"></a><span class="lineno"> 3499</span>&#160;<span class="comment">  w and h are image dimensions or dimensions of reduced image, bpp is bits per pixel</span></div>
<div class="line"><a name="l03500"></a><span class="lineno"> 3500</span>&#160;<span class="comment">  in and out are allowed to be the same memory address (but aren&#39;t the same size since in has the extra filter bytes)</span></div>
<div class="line"><a name="l03501"></a><span class="lineno"> 3501</span>&#160;<span class="comment">  */</span></div>
<div class="line"><a name="l03502"></a><span class="lineno"> 3502</span>&#160;</div>
<div class="line"><a name="l03503"></a><span class="lineno"> 3503</span>&#160;  <span class="keywordtype">unsigned</span> <a class="code" href="_d_l_l_imports_8inl.html#af7bcdfc5a984ba9c6720d5f0416f249d">y</a>;</div>
<div class="line"><a name="l03504"></a><span class="lineno"> 3504</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* prevline = 0;</div>
<div class="line"><a name="l03505"></a><span class="lineno"> 3505</span>&#160;</div>
<div class="line"><a name="l03506"></a><span class="lineno"> 3506</span>&#160;  <span class="comment">/*bytewidth is used for filtering, is 1 when bpp &lt; 8, number of bytes per pixel otherwise*/</span></div>
<div class="line"><a name="l03507"></a><span class="lineno"> 3507</span>&#160;  <span class="keywordtype">size_t</span> bytewidth = (bpp + 7) / 8;</div>
<div class="line"><a name="l03508"></a><span class="lineno"> 3508</span>&#160;  <span class="keywordtype">size_t</span> linebytes = (w * bpp + 7) / 8;</div>
<div class="line"><a name="l03509"></a><span class="lineno"> 3509</span>&#160;</div>
<div class="line"><a name="l03510"></a><span class="lineno"> 3510</span>&#160;  <span class="keywordflow">for</span>(y = 0; y &lt; h; y++)</div>
<div class="line"><a name="l03511"></a><span class="lineno"> 3511</span>&#160;  {</div>
<div class="line"><a name="l03512"></a><span class="lineno"> 3512</span>&#160;    <span class="keywordtype">size_t</span> outindex = linebytes * <a class="code" href="_d_l_l_imports_8inl.html#af7bcdfc5a984ba9c6720d5f0416f249d">y</a>;</div>
<div class="line"><a name="l03513"></a><span class="lineno"> 3513</span>&#160;    <span class="keywordtype">size_t</span> inindex = (1 + linebytes) * y; <span class="comment">/*the extra filterbyte added to each row*/</span></div>
<div class="line"><a name="l03514"></a><span class="lineno"> 3514</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> filterType = in[inindex];</div>
<div class="line"><a name="l03515"></a><span class="lineno"> 3515</span>&#160;</div>
<div class="line"><a name="l03516"></a><span class="lineno"> 3516</span>&#160;    <span class="keywordtype">unsigned</span> error = unfilterScanline(&amp;out[outindex], &amp;in[inindex + 1], prevline, bytewidth, filterType, linebytes);</div>
<div class="line"><a name="l03517"></a><span class="lineno"> 3517</span>&#160;    <span class="keywordflow">if</span>(error) <span class="keywordflow">return</span> error;</div>
<div class="line"><a name="l03518"></a><span class="lineno"> 3518</span>&#160;</div>
<div class="line"><a name="l03519"></a><span class="lineno"> 3519</span>&#160;    prevline = &amp;out[outindex];</div>
<div class="line"><a name="l03520"></a><span class="lineno"> 3520</span>&#160;  }</div>
<div class="line"><a name="l03521"></a><span class="lineno"> 3521</span>&#160;</div>
<div class="line"><a name="l03522"></a><span class="lineno"> 3522</span>&#160;  <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l03523"></a><span class="lineno"> 3523</span>&#160;}</div>
<div class="line"><a name="l03524"></a><span class="lineno"> 3524</span>&#160;</div>
<div class="line"><a name="l03525"></a><span class="lineno"> 3525</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> Adam7_deinterlace(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* out, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* in, <span class="keywordtype">unsigned</span> w, <span class="keywordtype">unsigned</span> h, <span class="keywordtype">unsigned</span> bpp)</div>
<div class="line"><a name="l03526"></a><span class="lineno"> 3526</span>&#160;{</div>
<div class="line"><a name="l03527"></a><span class="lineno"> 3527</span>&#160;  <span class="comment">/*Note: this function works on image buffers WITHOUT padding bits at end of scanlines</span></div>
<div class="line"><a name="l03528"></a><span class="lineno"> 3528</span>&#160;<span class="comment">  with non-multiple-of-8 bit amounts, only between reduced images is padding</span></div>
<div class="line"><a name="l03529"></a><span class="lineno"> 3529</span>&#160;<span class="comment">  out must be big enough AND must be 0 everywhere if bpp &lt; 8 in the current implementation</span></div>
<div class="line"><a name="l03530"></a><span class="lineno"> 3530</span>&#160;<span class="comment">  (because that&#39;s likely a little bit faster)*/</span></div>
<div class="line"><a name="l03531"></a><span class="lineno"> 3531</span>&#160;  <span class="keywordtype">unsigned</span> passw[7], passh[7];</div>
<div class="line"><a name="l03532"></a><span class="lineno"> 3532</span>&#160;  <span class="keywordtype">size_t</span> filter_passstart[8], padded_passstart[8], passstart[8];</div>
<div class="line"><a name="l03533"></a><span class="lineno"> 3533</span>&#160;  <span class="keywordtype">unsigned</span> i;</div>
<div class="line"><a name="l03534"></a><span class="lineno"> 3534</span>&#160;</div>
<div class="line"><a name="l03535"></a><span class="lineno"> 3535</span>&#160;  Adam7_getpassvalues(passw, passh, filter_passstart, padded_passstart, passstart, w, h, bpp);</div>
<div class="line"><a name="l03536"></a><span class="lineno"> 3536</span>&#160;</div>
<div class="line"><a name="l03537"></a><span class="lineno"> 3537</span>&#160;  <span class="keywordflow">if</span>(bpp &gt;= 8)</div>
<div class="line"><a name="l03538"></a><span class="lineno"> 3538</span>&#160;  {</div>
<div class="line"><a name="l03539"></a><span class="lineno"> 3539</span>&#160;    <span class="keywordflow">for</span>(i = 0; i &lt; 7; i++)</div>
<div class="line"><a name="l03540"></a><span class="lineno"> 3540</span>&#160;    {</div>
<div class="line"><a name="l03541"></a><span class="lineno"> 3541</span>&#160;      <span class="keywordtype">unsigned</span> <a class="code" href="_d_l_l_imports_8inl.html#a801542531fe9fad1565d31155ba5517b">x</a>, <a class="code" href="_d_l_l_imports_8inl.html#af7bcdfc5a984ba9c6720d5f0416f249d">y</a>, b;</div>
<div class="line"><a name="l03542"></a><span class="lineno"> 3542</span>&#160;      <span class="keywordtype">size_t</span> bytewidth = bpp / 8;</div>
<div class="line"><a name="l03543"></a><span class="lineno"> 3543</span>&#160;      <span class="keywordflow">for</span>(y = 0; y &lt; passh[i]; y++)</div>
<div class="line"><a name="l03544"></a><span class="lineno"> 3544</span>&#160;      <span class="keywordflow">for</span>(x = 0; x &lt; passw[i]; x++)</div>
<div class="line"><a name="l03545"></a><span class="lineno"> 3545</span>&#160;      {</div>
<div class="line"><a name="l03546"></a><span class="lineno"> 3546</span>&#160;        <span class="keywordtype">size_t</span> pixelinstart = passstart[i] + (y * passw[i] + <a class="code" href="_d_l_l_imports_8inl.html#a801542531fe9fad1565d31155ba5517b">x</a>) * bytewidth;</div>
<div class="line"><a name="l03547"></a><span class="lineno"> 3547</span>&#160;        <span class="keywordtype">size_t</span> pixeloutstart = ((ADAM7_IY[i] + y * ADAM7_DY[i]) * w + ADAM7_IX[i] + x * ADAM7_DX[i]) * bytewidth;</div>
<div class="line"><a name="l03548"></a><span class="lineno"> 3548</span>&#160;        <span class="keywordflow">for</span>(b = 0; b &lt; bytewidth; b++)</div>
<div class="line"><a name="l03549"></a><span class="lineno"> 3549</span>&#160;        {</div>
<div class="line"><a name="l03550"></a><span class="lineno"> 3550</span>&#160;          out[pixeloutstart + b] = in[pixelinstart + b];</div>
<div class="line"><a name="l03551"></a><span class="lineno"> 3551</span>&#160;        }</div>
<div class="line"><a name="l03552"></a><span class="lineno"> 3552</span>&#160;      }</div>
<div class="line"><a name="l03553"></a><span class="lineno"> 3553</span>&#160;    }</div>
<div class="line"><a name="l03554"></a><span class="lineno"> 3554</span>&#160;  }</div>
<div class="line"><a name="l03555"></a><span class="lineno"> 3555</span>&#160;  <span class="keywordflow">else</span> <span class="comment">/*bpp &lt; 8: Adam7 with pixels &lt; 8 bit is a bit trickier: with bit pointers*/</span></div>
<div class="line"><a name="l03556"></a><span class="lineno"> 3556</span>&#160;  {</div>
<div class="line"><a name="l03557"></a><span class="lineno"> 3557</span>&#160;    <span class="keywordflow">for</span>(i = 0; i &lt; 7; i++)</div>
<div class="line"><a name="l03558"></a><span class="lineno"> 3558</span>&#160;    {</div>
<div class="line"><a name="l03559"></a><span class="lineno"> 3559</span>&#160;      <span class="keywordtype">unsigned</span> <a class="code" href="_d_l_l_imports_8inl.html#a801542531fe9fad1565d31155ba5517b">x</a>, <a class="code" href="_d_l_l_imports_8inl.html#af7bcdfc5a984ba9c6720d5f0416f249d">y</a>, b;</div>
<div class="line"><a name="l03560"></a><span class="lineno"> 3560</span>&#160;      <span class="keywordtype">unsigned</span> ilinebits = bpp * passw[i];</div>
<div class="line"><a name="l03561"></a><span class="lineno"> 3561</span>&#160;      <span class="keywordtype">unsigned</span> olinebits = bpp * w;</div>
<div class="line"><a name="l03562"></a><span class="lineno"> 3562</span>&#160;      <span class="keywordtype">size_t</span> obp, ibp; <span class="comment">/*bit pointers (for out and in buffer)*/</span></div>
<div class="line"><a name="l03563"></a><span class="lineno"> 3563</span>&#160;      <span class="keywordflow">for</span>(y = 0; y &lt; passh[i]; y++)</div>
<div class="line"><a name="l03564"></a><span class="lineno"> 3564</span>&#160;      <span class="keywordflow">for</span>(x = 0; x &lt; passw[i]; x++)</div>
<div class="line"><a name="l03565"></a><span class="lineno"> 3565</span>&#160;      {</div>
<div class="line"><a name="l03566"></a><span class="lineno"> 3566</span>&#160;        ibp = (8 * passstart[i]) + (y * ilinebits + x * bpp);</div>
<div class="line"><a name="l03567"></a><span class="lineno"> 3567</span>&#160;        obp = (ADAM7_IY[i] + y * ADAM7_DY[i]) * olinebits + (ADAM7_IX[i] + x * ADAM7_DX[i]) * bpp;</div>
<div class="line"><a name="l03568"></a><span class="lineno"> 3568</span>&#160;        <span class="keywordflow">for</span>(b = 0; b &lt; bpp; b++)</div>
<div class="line"><a name="l03569"></a><span class="lineno"> 3569</span>&#160;        {</div>
<div class="line"><a name="l03570"></a><span class="lineno"> 3570</span>&#160;          <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> bit = readBitFromReversedStream(&amp;ibp, in);</div>
<div class="line"><a name="l03571"></a><span class="lineno"> 3571</span>&#160;          <span class="comment">/*note that this function assumes the out buffer is completely 0, use setBitOfReversedStream otherwise*/</span></div>
<div class="line"><a name="l03572"></a><span class="lineno"> 3572</span>&#160;          setBitOfReversedStream0(&amp;obp, out, bit);</div>
<div class="line"><a name="l03573"></a><span class="lineno"> 3573</span>&#160;        }</div>
<div class="line"><a name="l03574"></a><span class="lineno"> 3574</span>&#160;      }</div>
<div class="line"><a name="l03575"></a><span class="lineno"> 3575</span>&#160;    }</div>
<div class="line"><a name="l03576"></a><span class="lineno"> 3576</span>&#160;  }</div>
<div class="line"><a name="l03577"></a><span class="lineno"> 3577</span>&#160;}</div>
<div class="line"><a name="l03578"></a><span class="lineno"> 3578</span>&#160;</div>
<div class="line"><a name="l03579"></a><span class="lineno"> 3579</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> removePaddingBits(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* out, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* in,</div>
<div class="line"><a name="l03580"></a><span class="lineno"> 3580</span>&#160;                              <span class="keywordtype">size_t</span> olinebits, <span class="keywordtype">size_t</span> ilinebits, <span class="keywordtype">unsigned</span> h)</div>
<div class="line"><a name="l03581"></a><span class="lineno"> 3581</span>&#160;{</div>
<div class="line"><a name="l03582"></a><span class="lineno"> 3582</span>&#160;  <span class="comment">/*</span></div>
<div class="line"><a name="l03583"></a><span class="lineno"> 3583</span>&#160;<span class="comment">  After filtering there are still padding bits if scanlines have non multiple of 8 bit amounts. They need</span></div>
<div class="line"><a name="l03584"></a><span class="lineno"> 3584</span>&#160;<span class="comment">  to be removed (except at last scanline of (Adam7-reduced) image) before working with pure image buffers</span></div>
<div class="line"><a name="l03585"></a><span class="lineno"> 3585</span>&#160;<span class="comment">  for the Adam7 code, the color convert code and the output to the user.</span></div>
<div class="line"><a name="l03586"></a><span class="lineno"> 3586</span>&#160;<span class="comment">  in and out are allowed to be the same buffer, in may also be higher but still overlapping; in must</span></div>
<div class="line"><a name="l03587"></a><span class="lineno"> 3587</span>&#160;<span class="comment">  have &gt;= ilinebits*h bits, out must have &gt;= olinebits*h bits, olinebits must be &lt;= ilinebits</span></div>
<div class="line"><a name="l03588"></a><span class="lineno"> 3588</span>&#160;<span class="comment">  also used to move bits after earlier such operations happened, e.g. in a sequence of reduced images from Adam7</span></div>
<div class="line"><a name="l03589"></a><span class="lineno"> 3589</span>&#160;<span class="comment">  only useful if (ilinebits - olinebits) is a value in the range 1..7</span></div>
<div class="line"><a name="l03590"></a><span class="lineno"> 3590</span>&#160;<span class="comment">  */</span></div>
<div class="line"><a name="l03591"></a><span class="lineno"> 3591</span>&#160;  <span class="keywordtype">unsigned</span> <a class="code" href="_d_l_l_imports_8inl.html#af7bcdfc5a984ba9c6720d5f0416f249d">y</a>;</div>
<div class="line"><a name="l03592"></a><span class="lineno"> 3592</span>&#160;  <span class="keywordtype">size_t</span> diff = ilinebits - olinebits;</div>
<div class="line"><a name="l03593"></a><span class="lineno"> 3593</span>&#160;  <span class="keywordtype">size_t</span> ibp = 0, obp = 0; <span class="comment">/*input and output bit pointers*/</span></div>
<div class="line"><a name="l03594"></a><span class="lineno"> 3594</span>&#160;  <span class="keywordflow">for</span>(y = 0; y &lt; h; y++)</div>
<div class="line"><a name="l03595"></a><span class="lineno"> 3595</span>&#160;  {</div>
<div class="line"><a name="l03596"></a><span class="lineno"> 3596</span>&#160;    <span class="keywordtype">size_t</span> <a class="code" href="_d_l_l_imports_8inl.html#a801542531fe9fad1565d31155ba5517b">x</a>;</div>
<div class="line"><a name="l03597"></a><span class="lineno"> 3597</span>&#160;    <span class="keywordflow">for</span>(x = 0; x &lt; olinebits; x++)</div>
<div class="line"><a name="l03598"></a><span class="lineno"> 3598</span>&#160;    {</div>
<div class="line"><a name="l03599"></a><span class="lineno"> 3599</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> bit = readBitFromReversedStream(&amp;ibp, in);</div>
<div class="line"><a name="l03600"></a><span class="lineno"> 3600</span>&#160;      setBitOfReversedStream(&amp;obp, out, bit);</div>
<div class="line"><a name="l03601"></a><span class="lineno"> 3601</span>&#160;    }</div>
<div class="line"><a name="l03602"></a><span class="lineno"> 3602</span>&#160;    ibp += diff;</div>
<div class="line"><a name="l03603"></a><span class="lineno"> 3603</span>&#160;  }</div>
<div class="line"><a name="l03604"></a><span class="lineno"> 3604</span>&#160;}</div>
<div class="line"><a name="l03605"></a><span class="lineno"> 3605</span>&#160;</div>
<div class="line"><a name="l03606"></a><span class="lineno"> 3606</span>&#160;<span class="comment">/*out must be buffer big enough to contain full image, and in must contain the full decompressed data from</span></div>
<div class="line"><a name="l03607"></a><span class="lineno"> 3607</span>&#160;<span class="comment">the IDAT chunks (with filter index bytes and possible padding bits)</span></div>
<div class="line"><a name="l03608"></a><span class="lineno"> 3608</span>&#160;<span class="comment">return value is error*/</span></div>
<div class="line"><a name="l03609"></a><span class="lineno"> 3609</span>&#160;<span class="keyword">static</span> <span class="keywordtype">unsigned</span> postProcessScanlines(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* out, <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* in, <span class="keyword">const</span> <a class="code" href="struct_lode_p_n_g___info_png.html">LodePNG_InfoPng</a>* infoPng)</div>
<div class="line"><a name="l03610"></a><span class="lineno"> 3610</span>&#160;{</div>
<div class="line"><a name="l03611"></a><span class="lineno"> 3611</span>&#160;  <span class="comment">/*</span></div>
<div class="line"><a name="l03612"></a><span class="lineno"> 3612</span>&#160;<span class="comment">  This function converts the filtered-padded-interlaced data into pure 2D image buffer with the PNG&#39;s colortype.</span></div>
<div class="line"><a name="l03613"></a><span class="lineno"> 3613</span>&#160;<span class="comment">  Steps:</span></div>
<div class="line"><a name="l03614"></a><span class="lineno"> 3614</span>&#160;<span class="comment">  *) if no Adam7: 1) unfilter 2) remove padding bits (= posible extra bits per scanline if bpp &lt; 8)</span></div>
<div class="line"><a name="l03615"></a><span class="lineno"> 3615</span>&#160;<span class="comment">  *) if adam7: 1) 7x unfilter 2) 7x remove padding bits 3) Adam7_deinterlace</span></div>
<div class="line"><a name="l03616"></a><span class="lineno"> 3616</span>&#160;<span class="comment">  NOTE: the in buffer will be overwritten with intermediate data!</span></div>
<div class="line"><a name="l03617"></a><span class="lineno"> 3617</span>&#160;<span class="comment">  */</span></div>
<div class="line"><a name="l03618"></a><span class="lineno"> 3618</span>&#160;  <span class="keywordtype">unsigned</span> bpp = <a class="code" href="lodepng_8cpp.html#a81151c0087467b4ac2a815b3234fdb5a">LodePNG_InfoColor_getBpp</a>(&amp;infoPng-&gt;<a class="code" href="struct_lode_p_n_g___info_png.html#acce58518f72f42ba94db4c1cfd69336b">color</a>);</div>
<div class="line"><a name="l03619"></a><span class="lineno"> 3619</span>&#160;  <span class="keywordtype">unsigned</span> w = infoPng-&gt;<a class="code" href="struct_lode_p_n_g___info_png.html#a74be99b177b28f3178c02139c4b7f149">width</a>;</div>
<div class="line"><a name="l03620"></a><span class="lineno"> 3620</span>&#160;  <span class="keywordtype">unsigned</span> h = infoPng-&gt;<a class="code" href="struct_lode_p_n_g___info_png.html#a4b87ec9649e7177af7a5f5e08e5bc491">height</a>;</div>
<div class="line"><a name="l03621"></a><span class="lineno"> 3621</span>&#160;  <span class="keywordtype">unsigned</span> error = 0;</div>
<div class="line"><a name="l03622"></a><span class="lineno"> 3622</span>&#160;  <span class="keywordflow">if</span>(bpp == 0) <span class="keywordflow">return</span> 31; <span class="comment">/*error: invalid colortype*/</span></div>
<div class="line"><a name="l03623"></a><span class="lineno"> 3623</span>&#160;</div>
<div class="line"><a name="l03624"></a><span class="lineno"> 3624</span>&#160;  <span class="keywordflow">if</span>(infoPng-&gt;<a class="code" href="struct_lode_p_n_g___info_png.html#ad261cbe064eb69a92638e880d99347ca">interlaceMethod</a> == 0)</div>
<div class="line"><a name="l03625"></a><span class="lineno"> 3625</span>&#160;  {</div>
<div class="line"><a name="l03626"></a><span class="lineno"> 3626</span>&#160;    <span class="keywordflow">if</span>(bpp &lt; 8 &amp;&amp; w * bpp != ((w * bpp + 7) / 8) * 8)</div>
<div class="line"><a name="l03627"></a><span class="lineno"> 3627</span>&#160;    {</div>
<div class="line"><a name="l03628"></a><span class="lineno"> 3628</span>&#160;      error = unfilter(in, in, w, h, bpp);</div>
<div class="line"><a name="l03629"></a><span class="lineno"> 3629</span>&#160;      <span class="keywordflow">if</span>(error) <span class="keywordflow">return</span> error;</div>
<div class="line"><a name="l03630"></a><span class="lineno"> 3630</span>&#160;      removePaddingBits(out, in, w * bpp, ((w * bpp + 7) / 8) * 8, h);</div>
<div class="line"><a name="l03631"></a><span class="lineno"> 3631</span>&#160;    }</div>
<div class="line"><a name="l03632"></a><span class="lineno"> 3632</span>&#160;    <span class="keywordflow">else</span> error = unfilter(out, in, w, h, bpp); <span class="comment">/*we can immediatly filter into the out buffer, no other steps needed*/</span></div>
<div class="line"><a name="l03633"></a><span class="lineno"> 3633</span>&#160;  }</div>
<div class="line"><a name="l03634"></a><span class="lineno"> 3634</span>&#160;  <span class="keywordflow">else</span> <span class="comment">/*interlaceMethod is 1 (Adam7)*/</span></div>
<div class="line"><a name="l03635"></a><span class="lineno"> 3635</span>&#160;  {</div>
<div class="line"><a name="l03636"></a><span class="lineno"> 3636</span>&#160;    <span class="keywordtype">unsigned</span> passw[7], passh[7]; <span class="keywordtype">size_t</span> filter_passstart[8], padded_passstart[8], passstart[8];</div>
<div class="line"><a name="l03637"></a><span class="lineno"> 3637</span>&#160;    <span class="keywordtype">unsigned</span> i;</div>
<div class="line"><a name="l03638"></a><span class="lineno"> 3638</span>&#160;</div>
<div class="line"><a name="l03639"></a><span class="lineno"> 3639</span>&#160;    Adam7_getpassvalues(passw, passh, filter_passstart, padded_passstart, passstart, w, h, bpp);</div>
<div class="line"><a name="l03640"></a><span class="lineno"> 3640</span>&#160;</div>
<div class="line"><a name="l03641"></a><span class="lineno"> 3641</span>&#160;    <span class="keywordflow">for</span>(i = 0; i &lt; 7; i++)</div>
<div class="line"><a name="l03642"></a><span class="lineno"> 3642</span>&#160;    {</div>
<div class="line"><a name="l03643"></a><span class="lineno"> 3643</span>&#160;      error = unfilter(&amp;in[padded_passstart[i]], &amp;in[filter_passstart[i]], passw[i], passh[i], bpp);</div>
<div class="line"><a name="l03644"></a><span class="lineno"> 3644</span>&#160;      <span class="keywordflow">if</span>(error) <span class="keywordflow">return</span> error;</div>
<div class="line"><a name="l03645"></a><span class="lineno"> 3645</span>&#160;      <span class="comment">/*TODO: possible efficiency improvement: if in this reduced image the bits fit nicely in 1 scanline,</span></div>
<div class="line"><a name="l03646"></a><span class="lineno"> 3646</span>&#160;<span class="comment">      move bytes instead of bits or move not at all*/</span></div>
<div class="line"><a name="l03647"></a><span class="lineno"> 3647</span>&#160;      <span class="keywordflow">if</span>(bpp &lt; 8)</div>
<div class="line"><a name="l03648"></a><span class="lineno"> 3648</span>&#160;      {</div>
<div class="line"><a name="l03649"></a><span class="lineno"> 3649</span>&#160;        <span class="comment">/*remove padding bits in scanlines; after this there still may be padding</span></div>
<div class="line"><a name="l03650"></a><span class="lineno"> 3650</span>&#160;<span class="comment">        bits between the different reduced images: each reduced image still starts nicely at a byte*/</span></div>
<div class="line"><a name="l03651"></a><span class="lineno"> 3651</span>&#160;        removePaddingBits(&amp;in[passstart[i]], &amp;in[padded_passstart[i]], passw[i] * bpp,</div>
<div class="line"><a name="l03652"></a><span class="lineno"> 3652</span>&#160;                          ((passw[i] * bpp + 7) / 8) * 8, passh[i]);</div>
<div class="line"><a name="l03653"></a><span class="lineno"> 3653</span>&#160;      }</div>
<div class="line"><a name="l03654"></a><span class="lineno"> 3654</span>&#160;    }</div>
<div class="line"><a name="l03655"></a><span class="lineno"> 3655</span>&#160;</div>
<div class="line"><a name="l03656"></a><span class="lineno"> 3656</span>&#160;    Adam7_deinterlace(out, in, w, h, bpp);</div>
<div class="line"><a name="l03657"></a><span class="lineno"> 3657</span>&#160;  }</div>
<div class="line"><a name="l03658"></a><span class="lineno"> 3658</span>&#160;</div>
<div class="line"><a name="l03659"></a><span class="lineno"> 3659</span>&#160;  <span class="keywordflow">return</span> error;</div>
<div class="line"><a name="l03660"></a><span class="lineno"> 3660</span>&#160;}</div>
<div class="line"><a name="l03661"></a><span class="lineno"> 3661</span>&#160;</div>
<div class="line"><a name="l03662"></a><span class="lineno"> 3662</span>&#160;<span class="comment">/*read a PNG, the result will be in the same color type as the PNG (hence &quot;generic&quot;)*/</span></div>
<div class="line"><a name="l03663"></a><span class="lineno"> 3663</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> decodeGeneric(<a class="code" href="struct_lode_p_n_g___decoder.html">LodePNG_Decoder</a>* decoder, <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>** out, <span class="keywordtype">size_t</span>* outsize,</div>
<div class="line"><a name="l03664"></a><span class="lineno"> 3664</span>&#160;                          <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* in, <span class="keywordtype">size_t</span> insize)</div>
<div class="line"><a name="l03665"></a><span class="lineno"> 3665</span>&#160;{</div>
<div class="line"><a name="l03666"></a><span class="lineno"> 3666</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> IEND = 0;</div>
<div class="line"><a name="l03667"></a><span class="lineno"> 3667</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* chunk;</div>
<div class="line"><a name="l03668"></a><span class="lineno"> 3668</span>&#160;  <span class="keywordtype">size_t</span> i;</div>
<div class="line"><a name="l03669"></a><span class="lineno"> 3669</span>&#160;  <a class="code" href="structucvector.html">ucvector</a> idat; <span class="comment">/*the data from idat chunks*/</span></div>
<div class="line"><a name="l03670"></a><span class="lineno"> 3670</span>&#160;</div>
<div class="line"><a name="l03671"></a><span class="lineno"> 3671</span>&#160;  <span class="comment">/*for unknown chunk order*/</span></div>
<div class="line"><a name="l03672"></a><span class="lineno"> 3672</span>&#160;  <span class="keywordtype">unsigned</span> unknown = 0;</div>
<div class="line"><a name="l03673"></a><span class="lineno"> 3673</span>&#160;<span class="preprocessor">#ifdef LODEPNG_COMPILE_UNKNOWN_CHUNKS</span></div>
<div class="line"><a name="l03674"></a><span class="lineno"> 3674</span>&#160;<span class="preprocessor"></span>  <span class="keywordtype">unsigned</span> critical_pos = 1; <span class="comment">/*1 = after IHDR, 2 = after PLTE, 3 = after IDAT*/</span></div>
<div class="line"><a name="l03675"></a><span class="lineno"> 3675</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/*LODEPNG_COMPILE_ANCILLARY_CHUNKS*/</span><span class="preprocessor"></span></div>
<div class="line"><a name="l03676"></a><span class="lineno"> 3676</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l03677"></a><span class="lineno"> 3677</span>&#160;  <span class="comment">/*provide some proper output values if error will happen*/</span></div>
<div class="line"><a name="l03678"></a><span class="lineno"> 3678</span>&#160;  *out = 0;</div>
<div class="line"><a name="l03679"></a><span class="lineno"> 3679</span>&#160;  *outsize = 0;</div>
<div class="line"><a name="l03680"></a><span class="lineno"> 3680</span>&#160;</div>
<div class="line"><a name="l03681"></a><span class="lineno"> 3681</span>&#160;  <a class="code" href="lodepng_8cpp.html#afddaefb609ec98a432b3dd0437c849ad">LodePNG_Decoder_inspect</a>(decoder, in, insize); <span class="comment">/*reads header and resets other parameters in decoder-&gt;infoPng*/</span></div>
<div class="line"><a name="l03682"></a><span class="lineno"> 3682</span>&#160;  <span class="keywordflow">if</span>(decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#a1986e8d73bf733140e2de07993685983">error</a>) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l03683"></a><span class="lineno"> 3683</span>&#160;</div>
<div class="line"><a name="l03684"></a><span class="lineno"> 3684</span>&#160;  ucvector_init(&amp;idat);</div>
<div class="line"><a name="l03685"></a><span class="lineno"> 3685</span>&#160;</div>
<div class="line"><a name="l03686"></a><span class="lineno"> 3686</span>&#160;  chunk = &amp;in[33]; <span class="comment">/*first byte of the first chunk after the header*/</span></div>
<div class="line"><a name="l03687"></a><span class="lineno"> 3687</span>&#160;</div>
<div class="line"><a name="l03688"></a><span class="lineno"> 3688</span>&#160;  <span class="comment">/*loop through the chunks, ignoring unknown chunks and stopping at IEND chunk.</span></div>
<div class="line"><a name="l03689"></a><span class="lineno"> 3689</span>&#160;<span class="comment">  IDAT data is put at the start of the in buffer*/</span></div>
<div class="line"><a name="l03690"></a><span class="lineno"> 3690</span>&#160;  <span class="keywordflow">while</span>(!IEND)</div>
<div class="line"><a name="l03691"></a><span class="lineno"> 3691</span>&#160;  {</div>
<div class="line"><a name="l03692"></a><span class="lineno"> 3692</span>&#160;    <span class="keywordtype">unsigned</span> chunkLength;</div>
<div class="line"><a name="l03693"></a><span class="lineno"> 3693</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* <a class="code" href="_d_l_l_imports_8inl.html#a156a9c7e986e0352d0fe500e629d5171">data</a>; <span class="comment">/*the data in the chunk*/</span></div>
<div class="line"><a name="l03694"></a><span class="lineno"> 3694</span>&#160;</div>
<div class="line"><a name="l03695"></a><span class="lineno"> 3695</span>&#160;    <span class="comment">/*error: size of the in buffer too small to contain next chunk*/</span></div>
<div class="line"><a name="l03696"></a><span class="lineno"> 3696</span>&#160;    <span class="keywordflow">if</span>((<span class="keywordtype">size_t</span>)((chunk - in) + 12) &gt; insize || chunk &lt; in) <a class="code" href="lodepng_8cpp.html#af803b1b42c6d252d173df9cd0b32725a">CERROR_BREAK</a>(decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#a1986e8d73bf733140e2de07993685983">error</a>, 30);</div>
<div class="line"><a name="l03697"></a><span class="lineno"> 3697</span>&#160;</div>
<div class="line"><a name="l03698"></a><span class="lineno"> 3698</span>&#160;    <span class="comment">/*length of the data of the chunk, excluding the length bytes, chunk type and CRC bytes*/</span></div>
<div class="line"><a name="l03699"></a><span class="lineno"> 3699</span>&#160;    chunkLength = <a class="code" href="lodepng_8cpp.html#a4e9b1ed7e3242b335ddd8b4a0aba161f">LodePNG_chunk_length</a>(chunk);</div>
<div class="line"><a name="l03700"></a><span class="lineno"> 3700</span>&#160;    <span class="comment">/*error: chunk length larger than the max PNG chunk size*/</span></div>
<div class="line"><a name="l03701"></a><span class="lineno"> 3701</span>&#160;    <span class="keywordflow">if</span>(chunkLength &gt; 2147483647) <a class="code" href="lodepng_8cpp.html#af803b1b42c6d252d173df9cd0b32725a">CERROR_BREAK</a>(decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#a1986e8d73bf733140e2de07993685983">error</a>, 63);</div>
<div class="line"><a name="l03702"></a><span class="lineno"> 3702</span>&#160;</div>
<div class="line"><a name="l03703"></a><span class="lineno"> 3703</span>&#160;    <span class="keywordflow">if</span>((<span class="keywordtype">size_t</span>)((chunk - in) + chunkLength + 12) &gt; insize || (chunk + chunkLength + 12) &lt; in)</div>
<div class="line"><a name="l03704"></a><span class="lineno"> 3704</span>&#160;    {</div>
<div class="line"><a name="l03705"></a><span class="lineno"> 3705</span>&#160;      <a class="code" href="lodepng_8cpp.html#af803b1b42c6d252d173df9cd0b32725a">CERROR_BREAK</a>(decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#a1986e8d73bf733140e2de07993685983">error</a>, 64); <span class="comment">/*error: size of the in buffer too small to contain next chunk*/</span></div>
<div class="line"><a name="l03706"></a><span class="lineno"> 3706</span>&#160;    }</div>
<div class="line"><a name="l03707"></a><span class="lineno"> 3707</span>&#160;</div>
<div class="line"><a name="l03708"></a><span class="lineno"> 3708</span>&#160;    data = <a class="code" href="lodepng_8cpp.html#ab2b9a3341171c2cd4a31bdff0211f007">LodePNG_chunk_data_const</a>(chunk);</div>
<div class="line"><a name="l03709"></a><span class="lineno"> 3709</span>&#160;</div>
<div class="line"><a name="l03710"></a><span class="lineno"> 3710</span>&#160;    <span class="comment">/*IDAT chunk, containing compressed image data*/</span></div>
<div class="line"><a name="l03711"></a><span class="lineno"> 3711</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="lodepng_8cpp.html#a1e3ab3e373966fd2c323bd5a698ccfb1">LodePNG_chunk_type_equals</a>(chunk, <span class="stringliteral">&quot;IDAT&quot;</span>))</div>
<div class="line"><a name="l03712"></a><span class="lineno"> 3712</span>&#160;    {</div>
<div class="line"><a name="l03713"></a><span class="lineno"> 3713</span>&#160;      <span class="keywordtype">size_t</span> oldsize = idat.<a class="code" href="structucvector.html#a27c99c34de0c5b3ca0c242d402c69499">size</a>;</div>
<div class="line"><a name="l03714"></a><span class="lineno"> 3714</span>&#160;      <span class="keywordflow">if</span>(!ucvector_resize(&amp;idat, oldsize + chunkLength)) <a class="code" href="lodepng_8cpp.html#af803b1b42c6d252d173df9cd0b32725a">CERROR_BREAK</a>(decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#a1986e8d73bf733140e2de07993685983">error</a>, 9936 <span class="comment">/*alloc fail*/</span>);</div>
<div class="line"><a name="l03715"></a><span class="lineno"> 3715</span>&#160;      <span class="keywordflow">for</span>(i = 0; i &lt; chunkLength; i++) idat.<a class="code" href="structucvector.html#ace794c5713208c5a20f21762cd87c919">data</a>[oldsize + i] = data[i];</div>
<div class="line"><a name="l03716"></a><span class="lineno"> 3716</span>&#160;#ifdef <a class="code" href="lodepng_8h.html#a156a7a7f60acffc88f67cfc533beff2b">LODEPNG_COMPILE_UNKNOWN_CHUNKS</a></div>
<div class="line"><a name="l03717"></a><span class="lineno"> 3717</span>&#160;      critical_pos = 3;</div>
<div class="line"><a name="l03718"></a><span class="lineno"> 3718</span>&#160;#endif <span class="comment">/*LODEPNG_COMPILE_UNKNOWN_CHUNKS*/</span></div>
<div class="line"><a name="l03719"></a><span class="lineno"> 3719</span>&#160;    }</div>
<div class="line"><a name="l03720"></a><span class="lineno"> 3720</span>&#160;    <span class="comment">/*IEND chunk*/</span></div>
<div class="line"><a name="l03721"></a><span class="lineno"> 3721</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="lodepng_8cpp.html#a1e3ab3e373966fd2c323bd5a698ccfb1">LodePNG_chunk_type_equals</a>(chunk, <span class="stringliteral">&quot;IEND&quot;</span>))</div>
<div class="line"><a name="l03722"></a><span class="lineno"> 3722</span>&#160;    {</div>
<div class="line"><a name="l03723"></a><span class="lineno"> 3723</span>&#160;      IEND = 1;</div>
<div class="line"><a name="l03724"></a><span class="lineno"> 3724</span>&#160;    }</div>
<div class="line"><a name="l03725"></a><span class="lineno"> 3725</span>&#160;    <span class="comment">/*palette chunk (PLTE)*/</span></div>
<div class="line"><a name="l03726"></a><span class="lineno"> 3726</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="lodepng_8cpp.html#a1e3ab3e373966fd2c323bd5a698ccfb1">LodePNG_chunk_type_equals</a>(chunk, <span class="stringliteral">&quot;PLTE&quot;</span>))</div>
<div class="line"><a name="l03727"></a><span class="lineno"> 3727</span>&#160;    {</div>
<div class="line"><a name="l03728"></a><span class="lineno"> 3728</span>&#160;      <span class="keywordtype">unsigned</span> pos = 0;</div>
<div class="line"><a name="l03729"></a><span class="lineno"> 3729</span>&#160;      <span class="keywordflow">if</span>(decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#aa84a32ab83a4e50d909259b2041cb13e">infoPng</a>.<a class="code" href="struct_lode_p_n_g___info_png.html#acce58518f72f42ba94db4c1cfd69336b">color</a>.<a class="code" href="struct_lode_p_n_g___info_color.html#ac6de7ff58cb1f39a73567abb826f72f5">palette</a>) <a class="code" href="namespace_f_w.html#a93be8f55938d6ffb5ca0af1f95f81589">free</a>(decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#aa84a32ab83a4e50d909259b2041cb13e">infoPng</a>.<a class="code" href="struct_lode_p_n_g___info_png.html#acce58518f72f42ba94db4c1cfd69336b">color</a>.<a class="code" href="struct_lode_p_n_g___info_color.html#ac6de7ff58cb1f39a73567abb826f72f5">palette</a>);</div>
<div class="line"><a name="l03730"></a><span class="lineno"> 3730</span>&#160;      decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#aa84a32ab83a4e50d909259b2041cb13e">infoPng</a>.<a class="code" href="struct_lode_p_n_g___info_png.html#acce58518f72f42ba94db4c1cfd69336b">color</a>.<a class="code" href="struct_lode_p_n_g___info_color.html#a49842a304ffd0abc8aa791030c5fa5dd">palettesize</a> = chunkLength / 3;</div>
<div class="line"><a name="l03731"></a><span class="lineno"> 3731</span>&#160;      decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#aa84a32ab83a4e50d909259b2041cb13e">infoPng</a>.<a class="code" href="struct_lode_p_n_g___info_png.html#acce58518f72f42ba94db4c1cfd69336b">color</a>.<a class="code" href="struct_lode_p_n_g___info_color.html#ac6de7ff58cb1f39a73567abb826f72f5">palette</a> = (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>*)<a class="code" href="namespace_f_w.html#a440e071d8fdbc9789b728245caad99c0">malloc</a>(4 * decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#aa84a32ab83a4e50d909259b2041cb13e">infoPng</a>.<a class="code" href="struct_lode_p_n_g___info_png.html#acce58518f72f42ba94db4c1cfd69336b">color</a>.<a class="code" href="struct_lode_p_n_g___info_color.html#a49842a304ffd0abc8aa791030c5fa5dd">palettesize</a>);</div>
<div class="line"><a name="l03732"></a><span class="lineno"> 3732</span>&#160;      <span class="keywordflow">if</span>(!decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#aa84a32ab83a4e50d909259b2041cb13e">infoPng</a>.<a class="code" href="struct_lode_p_n_g___info_png.html#acce58518f72f42ba94db4c1cfd69336b">color</a>.<a class="code" href="struct_lode_p_n_g___info_color.html#ac6de7ff58cb1f39a73567abb826f72f5">palette</a> &amp;&amp; decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#aa84a32ab83a4e50d909259b2041cb13e">infoPng</a>.<a class="code" href="struct_lode_p_n_g___info_png.html#acce58518f72f42ba94db4c1cfd69336b">color</a>.<a class="code" href="struct_lode_p_n_g___info_color.html#a49842a304ffd0abc8aa791030c5fa5dd">palettesize</a>)</div>
<div class="line"><a name="l03733"></a><span class="lineno"> 3733</span>&#160;      {</div>
<div class="line"><a name="l03734"></a><span class="lineno"> 3734</span>&#160;        decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#aa84a32ab83a4e50d909259b2041cb13e">infoPng</a>.<a class="code" href="struct_lode_p_n_g___info_png.html#acce58518f72f42ba94db4c1cfd69336b">color</a>.<a class="code" href="struct_lode_p_n_g___info_color.html#a49842a304ffd0abc8aa791030c5fa5dd">palettesize</a> = 0;</div>
<div class="line"><a name="l03735"></a><span class="lineno"> 3735</span>&#160;        <a class="code" href="lodepng_8cpp.html#af803b1b42c6d252d173df9cd0b32725a">CERROR_BREAK</a>(decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#a1986e8d73bf733140e2de07993685983">error</a>, 9937); <span class="comment">/*alloc fail*/</span></div>
<div class="line"><a name="l03736"></a><span class="lineno"> 3736</span>&#160;      }</div>
<div class="line"><a name="l03737"></a><span class="lineno"> 3737</span>&#160;      <span class="keywordflow">if</span>(decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#aa84a32ab83a4e50d909259b2041cb13e">infoPng</a>.<a class="code" href="struct_lode_p_n_g___info_png.html#acce58518f72f42ba94db4c1cfd69336b">color</a>.<a class="code" href="struct_lode_p_n_g___info_color.html#a49842a304ffd0abc8aa791030c5fa5dd">palettesize</a> &gt; 256) <a class="code" href="lodepng_8cpp.html#af803b1b42c6d252d173df9cd0b32725a">CERROR_BREAK</a>(decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#a1986e8d73bf733140e2de07993685983">error</a>, 38); <span class="comment">/*error: palette too big*/</span></div>
<div class="line"><a name="l03738"></a><span class="lineno"> 3738</span>&#160;</div>
<div class="line"><a name="l03739"></a><span class="lineno"> 3739</span>&#160;      <span class="keywordflow">for</span>(i = 0; i &lt; decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#aa84a32ab83a4e50d909259b2041cb13e">infoPng</a>.<a class="code" href="struct_lode_p_n_g___info_png.html#acce58518f72f42ba94db4c1cfd69336b">color</a>.<a class="code" href="struct_lode_p_n_g___info_color.html#a49842a304ffd0abc8aa791030c5fa5dd">palettesize</a>; i++)</div>
<div class="line"><a name="l03740"></a><span class="lineno"> 3740</span>&#160;      {</div>
<div class="line"><a name="l03741"></a><span class="lineno"> 3741</span>&#160;        decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#aa84a32ab83a4e50d909259b2041cb13e">infoPng</a>.<a class="code" href="struct_lode_p_n_g___info_png.html#acce58518f72f42ba94db4c1cfd69336b">color</a>.<a class="code" href="struct_lode_p_n_g___info_color.html#ac6de7ff58cb1f39a73567abb826f72f5">palette</a>[4 * i + 0] = data[pos++]; <span class="comment">/*R*/</span></div>
<div class="line"><a name="l03742"></a><span class="lineno"> 3742</span>&#160;        decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#aa84a32ab83a4e50d909259b2041cb13e">infoPng</a>.<a class="code" href="struct_lode_p_n_g___info_png.html#acce58518f72f42ba94db4c1cfd69336b">color</a>.<a class="code" href="struct_lode_p_n_g___info_color.html#ac6de7ff58cb1f39a73567abb826f72f5">palette</a>[4 * i + 1] = data[pos++]; <span class="comment">/*G*/</span></div>
<div class="line"><a name="l03743"></a><span class="lineno"> 3743</span>&#160;        decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#aa84a32ab83a4e50d909259b2041cb13e">infoPng</a>.<a class="code" href="struct_lode_p_n_g___info_png.html#acce58518f72f42ba94db4c1cfd69336b">color</a>.<a class="code" href="struct_lode_p_n_g___info_color.html#ac6de7ff58cb1f39a73567abb826f72f5">palette</a>[4 * i + 2] = data[pos++]; <span class="comment">/*B*/</span></div>
<div class="line"><a name="l03744"></a><span class="lineno"> 3744</span>&#160;        decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#aa84a32ab83a4e50d909259b2041cb13e">infoPng</a>.<a class="code" href="struct_lode_p_n_g___info_png.html#acce58518f72f42ba94db4c1cfd69336b">color</a>.<a class="code" href="struct_lode_p_n_g___info_color.html#ac6de7ff58cb1f39a73567abb826f72f5">palette</a>[4 * i + 3] = 255; <span class="comment">/*alpha*/</span></div>
<div class="line"><a name="l03745"></a><span class="lineno"> 3745</span>&#160;      }</div>
<div class="line"><a name="l03746"></a><span class="lineno"> 3746</span>&#160;<span class="preprocessor">#ifdef LODEPNG_COMPILE_UNKNOWN_CHUNKS</span></div>
<div class="line"><a name="l03747"></a><span class="lineno"> 3747</span>&#160;<span class="preprocessor"></span>      critical_pos = 2;</div>
<div class="line"><a name="l03748"></a><span class="lineno"> 3748</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/*LODEPNG_COMPILE_UNKNOWN_CHUNKS*/</span><span class="preprocessor"></span></div>
<div class="line"><a name="l03749"></a><span class="lineno"> 3749</span>&#160;<span class="preprocessor"></span>    }</div>
<div class="line"><a name="l03750"></a><span class="lineno"> 3750</span>&#160;    <span class="comment">/*palette transparency chunk (tRNS)*/</span></div>
<div class="line"><a name="l03751"></a><span class="lineno"> 3751</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="lodepng_8cpp.html#a1e3ab3e373966fd2c323bd5a698ccfb1">LodePNG_chunk_type_equals</a>(chunk, <span class="stringliteral">&quot;tRNS&quot;</span>))</div>
<div class="line"><a name="l03752"></a><span class="lineno"> 3752</span>&#160;    {</div>
<div class="line"><a name="l03753"></a><span class="lineno"> 3753</span>&#160;      <span class="keywordflow">if</span>(decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#aa84a32ab83a4e50d909259b2041cb13e">infoPng</a>.<a class="code" href="struct_lode_p_n_g___info_png.html#acce58518f72f42ba94db4c1cfd69336b">color</a>.<a class="code" href="struct_lode_p_n_g___info_color.html#a4ed18d179c5078137a18e742b1c41a00">colorType</a> == 3)</div>
<div class="line"><a name="l03754"></a><span class="lineno"> 3754</span>&#160;      {</div>
<div class="line"><a name="l03755"></a><span class="lineno"> 3755</span>&#160;        <span class="comment">/*error: more alpha values given than there are palette entries*/</span></div>
<div class="line"><a name="l03756"></a><span class="lineno"> 3756</span>&#160;        <span class="keywordflow">if</span>(chunkLength &gt; decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#aa84a32ab83a4e50d909259b2041cb13e">infoPng</a>.<a class="code" href="struct_lode_p_n_g___info_png.html#acce58518f72f42ba94db4c1cfd69336b">color</a>.<a class="code" href="struct_lode_p_n_g___info_color.html#a49842a304ffd0abc8aa791030c5fa5dd">palettesize</a>) <a class="code" href="lodepng_8cpp.html#af803b1b42c6d252d173df9cd0b32725a">CERROR_BREAK</a>(decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#a1986e8d73bf733140e2de07993685983">error</a>, 38);</div>
<div class="line"><a name="l03757"></a><span class="lineno"> 3757</span>&#160;</div>
<div class="line"><a name="l03758"></a><span class="lineno"> 3758</span>&#160;        <span class="keywordflow">for</span>(i = 0; i &lt; chunkLength; i++) decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#aa84a32ab83a4e50d909259b2041cb13e">infoPng</a>.<a class="code" href="struct_lode_p_n_g___info_png.html#acce58518f72f42ba94db4c1cfd69336b">color</a>.<a class="code" href="struct_lode_p_n_g___info_color.html#ac6de7ff58cb1f39a73567abb826f72f5">palette</a>[4 * i + 3] = data[i];</div>
<div class="line"><a name="l03759"></a><span class="lineno"> 3759</span>&#160;      }</div>
<div class="line"><a name="l03760"></a><span class="lineno"> 3760</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span>(decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#aa84a32ab83a4e50d909259b2041cb13e">infoPng</a>.<a class="code" href="struct_lode_p_n_g___info_png.html#acce58518f72f42ba94db4c1cfd69336b">color</a>.<a class="code" href="struct_lode_p_n_g___info_color.html#a4ed18d179c5078137a18e742b1c41a00">colorType</a> == 0)</div>
<div class="line"><a name="l03761"></a><span class="lineno"> 3761</span>&#160;      {</div>
<div class="line"><a name="l03762"></a><span class="lineno"> 3762</span>&#160;        <span class="comment">/*error: this chunk must be 2 bytes for greyscale image*/</span></div>
<div class="line"><a name="l03763"></a><span class="lineno"> 3763</span>&#160;        <span class="keywordflow">if</span>(chunkLength != 2) <a class="code" href="lodepng_8cpp.html#af803b1b42c6d252d173df9cd0b32725a">CERROR_BREAK</a>(decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#a1986e8d73bf733140e2de07993685983">error</a>, 30);</div>
<div class="line"><a name="l03764"></a><span class="lineno"> 3764</span>&#160;</div>
<div class="line"><a name="l03765"></a><span class="lineno"> 3765</span>&#160;        decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#aa84a32ab83a4e50d909259b2041cb13e">infoPng</a>.<a class="code" href="struct_lode_p_n_g___info_png.html#acce58518f72f42ba94db4c1cfd69336b">color</a>.<a class="code" href="struct_lode_p_n_g___info_color.html#aa0193ce13025c776a0dfb1e6d1bed14a">key_defined</a> = 1;</div>
<div class="line"><a name="l03766"></a><span class="lineno"> 3766</span>&#160;        decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#aa84a32ab83a4e50d909259b2041cb13e">infoPng</a>.<a class="code" href="struct_lode_p_n_g___info_png.html#acce58518f72f42ba94db4c1cfd69336b">color</a>.<a class="code" href="struct_lode_p_n_g___info_color.html#a5536a8859201cd11df789ec7ad8263df">key_r</a> = decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#aa84a32ab83a4e50d909259b2041cb13e">infoPng</a>.<a class="code" href="struct_lode_p_n_g___info_png.html#acce58518f72f42ba94db4c1cfd69336b">color</a>.<a class="code" href="struct_lode_p_n_g___info_color.html#a44bf4906335328972acebd6c8b83a073">key_g</a></div>
<div class="line"><a name="l03767"></a><span class="lineno"> 3767</span>&#160;                                     = decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#aa84a32ab83a4e50d909259b2041cb13e">infoPng</a>.<a class="code" href="struct_lode_p_n_g___info_png.html#acce58518f72f42ba94db4c1cfd69336b">color</a>.<a class="code" href="struct_lode_p_n_g___info_color.html#a9f99cc5b4366f1eed325d13b4f191560">key_b</a> = 256 * data[0] + data[1];</div>
<div class="line"><a name="l03768"></a><span class="lineno"> 3768</span>&#160;      }</div>
<div class="line"><a name="l03769"></a><span class="lineno"> 3769</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span>(decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#aa84a32ab83a4e50d909259b2041cb13e">infoPng</a>.<a class="code" href="struct_lode_p_n_g___info_png.html#acce58518f72f42ba94db4c1cfd69336b">color</a>.<a class="code" href="struct_lode_p_n_g___info_color.html#a4ed18d179c5078137a18e742b1c41a00">colorType</a> == 2)</div>
<div class="line"><a name="l03770"></a><span class="lineno"> 3770</span>&#160;      {</div>
<div class="line"><a name="l03771"></a><span class="lineno"> 3771</span>&#160;        <span class="comment">/*error: this chunk must be 6 bytes for RGB image*/</span></div>
<div class="line"><a name="l03772"></a><span class="lineno"> 3772</span>&#160;        <span class="keywordflow">if</span>(chunkLength != 6) <a class="code" href="lodepng_8cpp.html#af803b1b42c6d252d173df9cd0b32725a">CERROR_BREAK</a>(decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#a1986e8d73bf733140e2de07993685983">error</a>, 41);</div>
<div class="line"><a name="l03773"></a><span class="lineno"> 3773</span>&#160;</div>
<div class="line"><a name="l03774"></a><span class="lineno"> 3774</span>&#160;        decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#aa84a32ab83a4e50d909259b2041cb13e">infoPng</a>.<a class="code" href="struct_lode_p_n_g___info_png.html#acce58518f72f42ba94db4c1cfd69336b">color</a>.<a class="code" href="struct_lode_p_n_g___info_color.html#aa0193ce13025c776a0dfb1e6d1bed14a">key_defined</a> = 1;</div>
<div class="line"><a name="l03775"></a><span class="lineno"> 3775</span>&#160;        decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#aa84a32ab83a4e50d909259b2041cb13e">infoPng</a>.<a class="code" href="struct_lode_p_n_g___info_png.html#acce58518f72f42ba94db4c1cfd69336b">color</a>.<a class="code" href="struct_lode_p_n_g___info_color.html#a5536a8859201cd11df789ec7ad8263df">key_r</a> = 256 * data[0] + data[1];</div>
<div class="line"><a name="l03776"></a><span class="lineno"> 3776</span>&#160;        decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#aa84a32ab83a4e50d909259b2041cb13e">infoPng</a>.<a class="code" href="struct_lode_p_n_g___info_png.html#acce58518f72f42ba94db4c1cfd69336b">color</a>.<a class="code" href="struct_lode_p_n_g___info_color.html#a44bf4906335328972acebd6c8b83a073">key_g</a> = 256 * data[2] + data[3];</div>
<div class="line"><a name="l03777"></a><span class="lineno"> 3777</span>&#160;        decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#aa84a32ab83a4e50d909259b2041cb13e">infoPng</a>.<a class="code" href="struct_lode_p_n_g___info_png.html#acce58518f72f42ba94db4c1cfd69336b">color</a>.<a class="code" href="struct_lode_p_n_g___info_color.html#a9f99cc5b4366f1eed325d13b4f191560">key_b</a> = 256 * data[4] + data[5];</div>
<div class="line"><a name="l03778"></a><span class="lineno"> 3778</span>&#160;      }</div>
<div class="line"><a name="l03779"></a><span class="lineno"> 3779</span>&#160;      <span class="keywordflow">else</span> <a class="code" href="lodepng_8cpp.html#af803b1b42c6d252d173df9cd0b32725a">CERROR_BREAK</a>(decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#a1986e8d73bf733140e2de07993685983">error</a>, 42); <span class="comment">/*error: tRNS chunk not allowed for other color models*/</span></div>
<div class="line"><a name="l03780"></a><span class="lineno"> 3780</span>&#160;    }</div>
<div class="line"><a name="l03781"></a><span class="lineno"> 3781</span>&#160;<span class="preprocessor">#ifdef LODEPNG_COMPILE_ANCILLARY_CHUNKS</span></div>
<div class="line"><a name="l03782"></a><span class="lineno"> 3782</span>&#160;<span class="preprocessor"></span>    <span class="comment">/*background color chunk (bKGD)*/</span></div>
<div class="line"><a name="l03783"></a><span class="lineno"> 3783</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="lodepng_8cpp.html#a1e3ab3e373966fd2c323bd5a698ccfb1">LodePNG_chunk_type_equals</a>(chunk, <span class="stringliteral">&quot;bKGD&quot;</span>))</div>
<div class="line"><a name="l03784"></a><span class="lineno"> 3784</span>&#160;    {</div>
<div class="line"><a name="l03785"></a><span class="lineno"> 3785</span>&#160;      <span class="keywordflow">if</span>(decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#aa84a32ab83a4e50d909259b2041cb13e">infoPng</a>.<a class="code" href="struct_lode_p_n_g___info_png.html#acce58518f72f42ba94db4c1cfd69336b">color</a>.<a class="code" href="struct_lode_p_n_g___info_color.html#a4ed18d179c5078137a18e742b1c41a00">colorType</a> == 3)</div>
<div class="line"><a name="l03786"></a><span class="lineno"> 3786</span>&#160;      {</div>
<div class="line"><a name="l03787"></a><span class="lineno"> 3787</span>&#160;        <span class="comment">/*error: this chunk must be 1 byte for indexed color image*/</span></div>
<div class="line"><a name="l03788"></a><span class="lineno"> 3788</span>&#160;        <span class="keywordflow">if</span>(chunkLength != 1) <a class="code" href="lodepng_8cpp.html#af803b1b42c6d252d173df9cd0b32725a">CERROR_BREAK</a>(decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#a1986e8d73bf733140e2de07993685983">error</a>, 43);</div>
<div class="line"><a name="l03789"></a><span class="lineno"> 3789</span>&#160;</div>
<div class="line"><a name="l03790"></a><span class="lineno"> 3790</span>&#160;        decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#aa84a32ab83a4e50d909259b2041cb13e">infoPng</a>.<a class="code" href="struct_lode_p_n_g___info_png.html#a37f6cddbe33b775fab09a91076b72f4c">background_defined</a> = 1;</div>
<div class="line"><a name="l03791"></a><span class="lineno"> 3791</span>&#160;        decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#aa84a32ab83a4e50d909259b2041cb13e">infoPng</a>.<a class="code" href="struct_lode_p_n_g___info_png.html#afbab2f688332e8c787717f797de8153e">background_r</a> = decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#aa84a32ab83a4e50d909259b2041cb13e">infoPng</a>.<a class="code" href="struct_lode_p_n_g___info_png.html#adbda2bda427f0dd6ae1b85daaab21c6c">background_g</a> = decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#aa84a32ab83a4e50d909259b2041cb13e">infoPng</a>.<a class="code" href="struct_lode_p_n_g___info_png.html#a7b8e98bf898590f785930c7b470254bc">background_b</a> = data[0];</div>
<div class="line"><a name="l03792"></a><span class="lineno"> 3792</span>&#160;      }</div>
<div class="line"><a name="l03793"></a><span class="lineno"> 3793</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span>(decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#aa84a32ab83a4e50d909259b2041cb13e">infoPng</a>.<a class="code" href="struct_lode_p_n_g___info_png.html#acce58518f72f42ba94db4c1cfd69336b">color</a>.<a class="code" href="struct_lode_p_n_g___info_color.html#a4ed18d179c5078137a18e742b1c41a00">colorType</a> == 0 || decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#aa84a32ab83a4e50d909259b2041cb13e">infoPng</a>.<a class="code" href="struct_lode_p_n_g___info_png.html#acce58518f72f42ba94db4c1cfd69336b">color</a>.<a class="code" href="struct_lode_p_n_g___info_color.html#a4ed18d179c5078137a18e742b1c41a00">colorType</a> == 4)</div>
<div class="line"><a name="l03794"></a><span class="lineno"> 3794</span>&#160;      {</div>
<div class="line"><a name="l03795"></a><span class="lineno"> 3795</span>&#160;        <span class="comment">/*error: this chunk must be 2 bytes for greyscale image*/</span></div>
<div class="line"><a name="l03796"></a><span class="lineno"> 3796</span>&#160;        <span class="keywordflow">if</span>(chunkLength != 2) <a class="code" href="lodepng_8cpp.html#af803b1b42c6d252d173df9cd0b32725a">CERROR_BREAK</a>(decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#a1986e8d73bf733140e2de07993685983">error</a>, 44);</div>
<div class="line"><a name="l03797"></a><span class="lineno"> 3797</span>&#160;</div>
<div class="line"><a name="l03798"></a><span class="lineno"> 3798</span>&#160;        decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#aa84a32ab83a4e50d909259b2041cb13e">infoPng</a>.<a class="code" href="struct_lode_p_n_g___info_png.html#a37f6cddbe33b775fab09a91076b72f4c">background_defined</a> = 1;</div>
<div class="line"><a name="l03799"></a><span class="lineno"> 3799</span>&#160;        decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#aa84a32ab83a4e50d909259b2041cb13e">infoPng</a>.<a class="code" href="struct_lode_p_n_g___info_png.html#afbab2f688332e8c787717f797de8153e">background_r</a> = decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#aa84a32ab83a4e50d909259b2041cb13e">infoPng</a>.<a class="code" href="struct_lode_p_n_g___info_png.html#adbda2bda427f0dd6ae1b85daaab21c6c">background_g</a> = decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#aa84a32ab83a4e50d909259b2041cb13e">infoPng</a>.<a class="code" href="struct_lode_p_n_g___info_png.html#a7b8e98bf898590f785930c7b470254bc">background_b</a></div>
<div class="line"><a name="l03800"></a><span class="lineno"> 3800</span>&#160;                                      = 256 * data[0] + data[1];</div>
<div class="line"><a name="l03801"></a><span class="lineno"> 3801</span>&#160;      }</div>
<div class="line"><a name="l03802"></a><span class="lineno"> 3802</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span>(decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#aa84a32ab83a4e50d909259b2041cb13e">infoPng</a>.<a class="code" href="struct_lode_p_n_g___info_png.html#acce58518f72f42ba94db4c1cfd69336b">color</a>.<a class="code" href="struct_lode_p_n_g___info_color.html#a4ed18d179c5078137a18e742b1c41a00">colorType</a> == 2 || decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#aa84a32ab83a4e50d909259b2041cb13e">infoPng</a>.<a class="code" href="struct_lode_p_n_g___info_png.html#acce58518f72f42ba94db4c1cfd69336b">color</a>.<a class="code" href="struct_lode_p_n_g___info_color.html#a4ed18d179c5078137a18e742b1c41a00">colorType</a> == 6)</div>
<div class="line"><a name="l03803"></a><span class="lineno"> 3803</span>&#160;      {</div>
<div class="line"><a name="l03804"></a><span class="lineno"> 3804</span>&#160;        <span class="comment">/*error: this chunk must be 6 bytes for greyscale image*/</span></div>
<div class="line"><a name="l03805"></a><span class="lineno"> 3805</span>&#160;        <span class="keywordflow">if</span>(chunkLength != 6) <a class="code" href="lodepng_8cpp.html#af803b1b42c6d252d173df9cd0b32725a">CERROR_BREAK</a>(decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#a1986e8d73bf733140e2de07993685983">error</a>, 45);</div>
<div class="line"><a name="l03806"></a><span class="lineno"> 3806</span>&#160;</div>
<div class="line"><a name="l03807"></a><span class="lineno"> 3807</span>&#160;        decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#aa84a32ab83a4e50d909259b2041cb13e">infoPng</a>.<a class="code" href="struct_lode_p_n_g___info_png.html#a37f6cddbe33b775fab09a91076b72f4c">background_defined</a> = 1;</div>
<div class="line"><a name="l03808"></a><span class="lineno"> 3808</span>&#160;        decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#aa84a32ab83a4e50d909259b2041cb13e">infoPng</a>.<a class="code" href="struct_lode_p_n_g___info_png.html#afbab2f688332e8c787717f797de8153e">background_r</a> = 256 * data[0] + data[1];</div>
<div class="line"><a name="l03809"></a><span class="lineno"> 3809</span>&#160;        decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#aa84a32ab83a4e50d909259b2041cb13e">infoPng</a>.<a class="code" href="struct_lode_p_n_g___info_png.html#adbda2bda427f0dd6ae1b85daaab21c6c">background_g</a> = 256 * data[2] + data[3];</div>
<div class="line"><a name="l03810"></a><span class="lineno"> 3810</span>&#160;        decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#aa84a32ab83a4e50d909259b2041cb13e">infoPng</a>.<a class="code" href="struct_lode_p_n_g___info_png.html#a7b8e98bf898590f785930c7b470254bc">background_b</a> = 256 * data[4] + data[5];</div>
<div class="line"><a name="l03811"></a><span class="lineno"> 3811</span>&#160;      }</div>
<div class="line"><a name="l03812"></a><span class="lineno"> 3812</span>&#160;    }</div>
<div class="line"><a name="l03813"></a><span class="lineno"> 3813</span>&#160;    <span class="comment">/*text chunk (tEXt)*/</span></div>
<div class="line"><a name="l03814"></a><span class="lineno"> 3814</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="lodepng_8cpp.html#a1e3ab3e373966fd2c323bd5a698ccfb1">LodePNG_chunk_type_equals</a>(chunk, <span class="stringliteral">&quot;tEXt&quot;</span>))</div>
<div class="line"><a name="l03815"></a><span class="lineno"> 3815</span>&#160;    {</div>
<div class="line"><a name="l03816"></a><span class="lineno"> 3816</span>&#160;      <span class="keywordflow">if</span>(decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#a03ad3505caf0cba6de6cadfd41b9067e">settings</a>.<a class="code" href="struct_lode_p_n_g___decode_settings.html#af46b8d4852b5af72cf712a98cf78f44b">readTextChunks</a>)</div>
<div class="line"><a name="l03817"></a><span class="lineno"> 3817</span>&#160;      {</div>
<div class="line"><a name="l03818"></a><span class="lineno"> 3818</span>&#160;        <span class="keywordtype">char</span> *key = 0, *str = 0;</div>
<div class="line"><a name="l03819"></a><span class="lineno"> 3819</span>&#160;</div>
<div class="line"><a name="l03820"></a><span class="lineno"> 3820</span>&#160;        <span class="keywordflow">while</span>(!decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#a1986e8d73bf733140e2de07993685983">error</a>) <span class="comment">/*not really a while loop, only used to break on error*/</span></div>
<div class="line"><a name="l03821"></a><span class="lineno"> 3821</span>&#160;        {</div>
<div class="line"><a name="l03822"></a><span class="lineno"> 3822</span>&#160;          <span class="keywordtype">unsigned</span> <a class="code" href="_d_l_l_imports_8inl.html#a5720e2b8f4f85b31e0bab5a1b6e69c74">length</a>, string2_begin;</div>
<div class="line"><a name="l03823"></a><span class="lineno"> 3823</span>&#160;</div>
<div class="line"><a name="l03824"></a><span class="lineno"> 3824</span>&#160;          length = 0;</div>
<div class="line"><a name="l03825"></a><span class="lineno"> 3825</span>&#160;          <span class="keywordflow">while</span>(length &lt; chunkLength &amp;&amp; data[length] != 0) length++;</div>
<div class="line"><a name="l03826"></a><span class="lineno"> 3826</span>&#160;          <span class="comment">/*error, end reached, no null terminator?*/</span></div>
<div class="line"><a name="l03827"></a><span class="lineno"> 3827</span>&#160;          <span class="keywordflow">if</span>(length + 1 &gt;= chunkLength) <a class="code" href="lodepng_8cpp.html#af803b1b42c6d252d173df9cd0b32725a">CERROR_BREAK</a>(decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#a1986e8d73bf733140e2de07993685983">error</a>, 75);</div>
<div class="line"><a name="l03828"></a><span class="lineno"> 3828</span>&#160;</div>
<div class="line"><a name="l03829"></a><span class="lineno"> 3829</span>&#160;          key = (<span class="keywordtype">char</span>*)<a class="code" href="namespace_f_w.html#a440e071d8fdbc9789b728245caad99c0">malloc</a>(length + 1);</div>
<div class="line"><a name="l03830"></a><span class="lineno"> 3830</span>&#160;          <span class="keywordflow">if</span>(!key) <a class="code" href="lodepng_8cpp.html#af803b1b42c6d252d173df9cd0b32725a">CERROR_BREAK</a>(decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#a1986e8d73bf733140e2de07993685983">error</a>, 9938); <span class="comment">/*alloc fail*/</span></div>
<div class="line"><a name="l03831"></a><span class="lineno"> 3831</span>&#160;</div>
<div class="line"><a name="l03832"></a><span class="lineno"> 3832</span>&#160;          key[<a class="code" href="_d_l_l_imports_8inl.html#a5720e2b8f4f85b31e0bab5a1b6e69c74">length</a>] = 0;</div>
<div class="line"><a name="l03833"></a><span class="lineno"> 3833</span>&#160;          <span class="keywordflow">for</span>(i = 0; i &lt; <a class="code" href="_d_l_l_imports_8inl.html#a5720e2b8f4f85b31e0bab5a1b6e69c74">length</a>; i++) key[i] = data[i];</div>
<div class="line"><a name="l03834"></a><span class="lineno"> 3834</span>&#160;</div>
<div class="line"><a name="l03835"></a><span class="lineno"> 3835</span>&#160;          string2_begin = length + 1;</div>
<div class="line"><a name="l03836"></a><span class="lineno"> 3836</span>&#160;          <span class="comment">/*error, end reached, no null terminator?*/</span></div>
<div class="line"><a name="l03837"></a><span class="lineno"> 3837</span>&#160;          <span class="keywordflow">if</span>(string2_begin &gt; chunkLength) <a class="code" href="lodepng_8cpp.html#af803b1b42c6d252d173df9cd0b32725a">CERROR_BREAK</a>(decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#a1986e8d73bf733140e2de07993685983">error</a>, 75);</div>
<div class="line"><a name="l03838"></a><span class="lineno"> 3838</span>&#160;</div>
<div class="line"><a name="l03839"></a><span class="lineno"> 3839</span>&#160;          length = chunkLength - string2_begin;</div>
<div class="line"><a name="l03840"></a><span class="lineno"> 3840</span>&#160;          str = (<span class="keywordtype">char</span>*)<a class="code" href="namespace_f_w.html#a440e071d8fdbc9789b728245caad99c0">malloc</a>(length + 1);</div>
<div class="line"><a name="l03841"></a><span class="lineno"> 3841</span>&#160;          <span class="keywordflow">if</span>(!str) <a class="code" href="lodepng_8cpp.html#af803b1b42c6d252d173df9cd0b32725a">CERROR_BREAK</a>(decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#a1986e8d73bf733140e2de07993685983">error</a>, 9939); <span class="comment">/*alloc fail*/</span></div>
<div class="line"><a name="l03842"></a><span class="lineno"> 3842</span>&#160;</div>
<div class="line"><a name="l03843"></a><span class="lineno"> 3843</span>&#160;          str[<a class="code" href="_d_l_l_imports_8inl.html#a5720e2b8f4f85b31e0bab5a1b6e69c74">length</a>] = 0;</div>
<div class="line"><a name="l03844"></a><span class="lineno"> 3844</span>&#160;          <span class="keywordflow">for</span>(i = 0; i &lt; <a class="code" href="_d_l_l_imports_8inl.html#a5720e2b8f4f85b31e0bab5a1b6e69c74">length</a>; i++) str[i] = data[string2_begin + i];</div>
<div class="line"><a name="l03845"></a><span class="lineno"> 3845</span>&#160;</div>
<div class="line"><a name="l03846"></a><span class="lineno"> 3846</span>&#160;          decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#a1986e8d73bf733140e2de07993685983">error</a> = <a class="code" href="lodepng_8cpp.html#a9de001414ae7aa2b695c31171b4267ff">LodePNG_Text_add</a>(&amp;decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#aa84a32ab83a4e50d909259b2041cb13e">infoPng</a>.<a class="code" href="struct_lode_p_n_g___info_png.html#a2ba6d900f4eee624a18df252e9df40e9">text</a>, key, str);</div>
<div class="line"><a name="l03847"></a><span class="lineno"> 3847</span>&#160;</div>
<div class="line"><a name="l03848"></a><span class="lineno"> 3848</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03849"></a><span class="lineno"> 3849</span>&#160;        }</div>
<div class="line"><a name="l03850"></a><span class="lineno"> 3850</span>&#160;</div>
<div class="line"><a name="l03851"></a><span class="lineno"> 3851</span>&#160;        <a class="code" href="namespace_f_w.html#a93be8f55938d6ffb5ca0af1f95f81589">free</a>(key);</div>
<div class="line"><a name="l03852"></a><span class="lineno"> 3852</span>&#160;        <a class="code" href="namespace_f_w.html#a93be8f55938d6ffb5ca0af1f95f81589">free</a>(str);</div>
<div class="line"><a name="l03853"></a><span class="lineno"> 3853</span>&#160;      }</div>
<div class="line"><a name="l03854"></a><span class="lineno"> 3854</span>&#160;    }</div>
<div class="line"><a name="l03855"></a><span class="lineno"> 3855</span>&#160;    <span class="comment">/*compressed text chunk (zTXt)*/</span></div>
<div class="line"><a name="l03856"></a><span class="lineno"> 3856</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="lodepng_8cpp.html#a1e3ab3e373966fd2c323bd5a698ccfb1">LodePNG_chunk_type_equals</a>(chunk, <span class="stringliteral">&quot;zTXt&quot;</span>))</div>
<div class="line"><a name="l03857"></a><span class="lineno"> 3857</span>&#160;    {</div>
<div class="line"><a name="l03858"></a><span class="lineno"> 3858</span>&#160;      <span class="keywordflow">if</span>(decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#a03ad3505caf0cba6de6cadfd41b9067e">settings</a>.<a class="code" href="struct_lode_p_n_g___decode_settings.html#af46b8d4852b5af72cf712a98cf78f44b">readTextChunks</a>)</div>
<div class="line"><a name="l03859"></a><span class="lineno"> 3859</span>&#160;      {</div>
<div class="line"><a name="l03860"></a><span class="lineno"> 3860</span>&#160;        <span class="keywordtype">unsigned</span> <a class="code" href="_d_l_l_imports_8inl.html#a5720e2b8f4f85b31e0bab5a1b6e69c74">length</a>, string2_begin;</div>
<div class="line"><a name="l03861"></a><span class="lineno"> 3861</span>&#160;        <span class="keywordtype">char</span> *key = 0;</div>
<div class="line"><a name="l03862"></a><span class="lineno"> 3862</span>&#160;        <a class="code" href="structucvector.html">ucvector</a> decoded;</div>
<div class="line"><a name="l03863"></a><span class="lineno"> 3863</span>&#160;</div>
<div class="line"><a name="l03864"></a><span class="lineno"> 3864</span>&#160;        ucvector_init(&amp;decoded);</div>
<div class="line"><a name="l03865"></a><span class="lineno"> 3865</span>&#160;</div>
<div class="line"><a name="l03866"></a><span class="lineno"> 3866</span>&#160;        <span class="keywordflow">while</span>(!decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#a1986e8d73bf733140e2de07993685983">error</a>) <span class="comment">/*not really a while loop, only used to break on error*/</span></div>
<div class="line"><a name="l03867"></a><span class="lineno"> 3867</span>&#160;        {</div>
<div class="line"><a name="l03868"></a><span class="lineno"> 3868</span>&#160;          <span class="keywordflow">for</span>(length = 0; length &lt; chunkLength &amp;&amp; data[<a class="code" href="_d_l_l_imports_8inl.html#a5720e2b8f4f85b31e0bab5a1b6e69c74">length</a>] != 0; length++) ;</div>
<div class="line"><a name="l03869"></a><span class="lineno"> 3869</span>&#160;          <span class="keywordflow">if</span>(length + 2 &gt;= chunkLength) <a class="code" href="lodepng_8cpp.html#af803b1b42c6d252d173df9cd0b32725a">CERROR_BREAK</a>(decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#a1986e8d73bf733140e2de07993685983">error</a>, 75); <span class="comment">/*no null termination, corrupt?*/</span></div>
<div class="line"><a name="l03870"></a><span class="lineno"> 3870</span>&#160;</div>
<div class="line"><a name="l03871"></a><span class="lineno"> 3871</span>&#160;          key = (<span class="keywordtype">char</span>*)<a class="code" href="namespace_f_w.html#a440e071d8fdbc9789b728245caad99c0">malloc</a>(length + 1);</div>
<div class="line"><a name="l03872"></a><span class="lineno"> 3872</span>&#160;          <span class="keywordflow">if</span>(!key) <a class="code" href="lodepng_8cpp.html#af803b1b42c6d252d173df9cd0b32725a">CERROR_BREAK</a>(decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#a1986e8d73bf733140e2de07993685983">error</a>, 9940); <span class="comment">/*alloc fail*/</span></div>
<div class="line"><a name="l03873"></a><span class="lineno"> 3873</span>&#160;</div>
<div class="line"><a name="l03874"></a><span class="lineno"> 3874</span>&#160;          key[<a class="code" href="_d_l_l_imports_8inl.html#a5720e2b8f4f85b31e0bab5a1b6e69c74">length</a>] = 0;</div>
<div class="line"><a name="l03875"></a><span class="lineno"> 3875</span>&#160;          <span class="keywordflow">for</span>(i = 0; i &lt; <a class="code" href="_d_l_l_imports_8inl.html#a5720e2b8f4f85b31e0bab5a1b6e69c74">length</a>; i++) key[i] = data[i];</div>
<div class="line"><a name="l03876"></a><span class="lineno"> 3876</span>&#160;</div>
<div class="line"><a name="l03877"></a><span class="lineno"> 3877</span>&#160;          <span class="keywordflow">if</span>(data[length + 1] != 0) <a class="code" href="lodepng_8cpp.html#af803b1b42c6d252d173df9cd0b32725a">CERROR_BREAK</a>(decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#a1986e8d73bf733140e2de07993685983">error</a>, 72); <span class="comment">/*the 0 byte indicating compression must be 0*/</span></div>
<div class="line"><a name="l03878"></a><span class="lineno"> 3878</span>&#160;</div>
<div class="line"><a name="l03879"></a><span class="lineno"> 3879</span>&#160;          string2_begin = length + 2;</div>
<div class="line"><a name="l03880"></a><span class="lineno"> 3880</span>&#160;          <span class="keywordflow">if</span>(string2_begin &gt; chunkLength) <a class="code" href="lodepng_8cpp.html#af803b1b42c6d252d173df9cd0b32725a">CERROR_BREAK</a>(decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#a1986e8d73bf733140e2de07993685983">error</a>, 75); <span class="comment">/*no null termination, corrupt?*/</span></div>
<div class="line"><a name="l03881"></a><span class="lineno"> 3881</span>&#160;</div>
<div class="line"><a name="l03882"></a><span class="lineno"> 3882</span>&#160;          length = chunkLength - string2_begin;</div>
<div class="line"><a name="l03883"></a><span class="lineno"> 3883</span>&#160;          decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#a1986e8d73bf733140e2de07993685983">error</a> = <a class="code" href="lodepng_8cpp.html#af11d6ba19787c8d48aa3ed88cf3e6462">LodePNG_zlib_decompress</a>(&amp;decoded.<a class="code" href="structucvector.html#ace794c5713208c5a20f21762cd87c919">data</a>, &amp;decoded.<a class="code" href="structucvector.html#a27c99c34de0c5b3ca0c242d402c69499">size</a>,</div>
<div class="line"><a name="l03884"></a><span class="lineno"> 3884</span>&#160;                                                   (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>*)(&amp;data[string2_begin]),</div>
<div class="line"><a name="l03885"></a><span class="lineno"> 3885</span>&#160;                                                   length, &amp;decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#a03ad3505caf0cba6de6cadfd41b9067e">settings</a>.<a class="code" href="struct_lode_p_n_g___decode_settings.html#af8de90c1410b0ad33c4d2712cafef26e">zlibsettings</a>);</div>
<div class="line"><a name="l03886"></a><span class="lineno"> 3886</span>&#160;          <span class="keywordflow">if</span>(decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#a1986e8d73bf733140e2de07993685983">error</a>) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03887"></a><span class="lineno"> 3887</span>&#160;          ucvector_push_back(&amp;decoded, 0);</div>
<div class="line"><a name="l03888"></a><span class="lineno"> 3888</span>&#160;</div>
<div class="line"><a name="l03889"></a><span class="lineno"> 3889</span>&#160;          decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#a1986e8d73bf733140e2de07993685983">error</a> = <a class="code" href="lodepng_8cpp.html#a9de001414ae7aa2b695c31171b4267ff">LodePNG_Text_add</a>(&amp;decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#aa84a32ab83a4e50d909259b2041cb13e">infoPng</a>.<a class="code" href="struct_lode_p_n_g___info_png.html#a2ba6d900f4eee624a18df252e9df40e9">text</a>, key, (<span class="keywordtype">char</span>*)decoded.<a class="code" href="structucvector.html#ace794c5713208c5a20f21762cd87c919">data</a>);</div>
<div class="line"><a name="l03890"></a><span class="lineno"> 3890</span>&#160;</div>
<div class="line"><a name="l03891"></a><span class="lineno"> 3891</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03892"></a><span class="lineno"> 3892</span>&#160;        }</div>
<div class="line"><a name="l03893"></a><span class="lineno"> 3893</span>&#160;</div>
<div class="line"><a name="l03894"></a><span class="lineno"> 3894</span>&#160;        <a class="code" href="namespace_f_w.html#a93be8f55938d6ffb5ca0af1f95f81589">free</a>(key);</div>
<div class="line"><a name="l03895"></a><span class="lineno"> 3895</span>&#160;        ucvector_cleanup(&amp;decoded);</div>
<div class="line"><a name="l03896"></a><span class="lineno"> 3896</span>&#160;        <span class="keywordflow">if</span>(decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#a1986e8d73bf733140e2de07993685983">error</a>) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03897"></a><span class="lineno"> 3897</span>&#160;      }</div>
<div class="line"><a name="l03898"></a><span class="lineno"> 3898</span>&#160;    }</div>
<div class="line"><a name="l03899"></a><span class="lineno"> 3899</span>&#160;    <span class="comment">/*international text chunk (iTXt)*/</span></div>
<div class="line"><a name="l03900"></a><span class="lineno"> 3900</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="lodepng_8cpp.html#a1e3ab3e373966fd2c323bd5a698ccfb1">LodePNG_chunk_type_equals</a>(chunk, <span class="stringliteral">&quot;iTXt&quot;</span>))</div>
<div class="line"><a name="l03901"></a><span class="lineno"> 3901</span>&#160;    {</div>
<div class="line"><a name="l03902"></a><span class="lineno"> 3902</span>&#160;      <span class="keywordflow">if</span>(decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#a03ad3505caf0cba6de6cadfd41b9067e">settings</a>.<a class="code" href="struct_lode_p_n_g___decode_settings.html#af46b8d4852b5af72cf712a98cf78f44b">readTextChunks</a>)</div>
<div class="line"><a name="l03903"></a><span class="lineno"> 3903</span>&#160;      {</div>
<div class="line"><a name="l03904"></a><span class="lineno"> 3904</span>&#160;        <span class="keywordtype">unsigned</span> <a class="code" href="_d_l_l_imports_8inl.html#a5720e2b8f4f85b31e0bab5a1b6e69c74">length</a>, begin, compressed;</div>
<div class="line"><a name="l03905"></a><span class="lineno"> 3905</span>&#160;        <span class="keywordtype">char</span> *key = 0, *langtag = 0, *transkey = 0;</div>
<div class="line"><a name="l03906"></a><span class="lineno"> 3906</span>&#160;        <a class="code" href="structucvector.html">ucvector</a> decoded;</div>
<div class="line"><a name="l03907"></a><span class="lineno"> 3907</span>&#160;        ucvector_init(&amp;decoded);</div>
<div class="line"><a name="l03908"></a><span class="lineno"> 3908</span>&#160;</div>
<div class="line"><a name="l03909"></a><span class="lineno"> 3909</span>&#160;        <span class="keywordflow">while</span>(!decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#a1986e8d73bf733140e2de07993685983">error</a>) <span class="comment">/*not really a while loop, only used to break on error*/</span></div>
<div class="line"><a name="l03910"></a><span class="lineno"> 3910</span>&#160;        {</div>
<div class="line"><a name="l03911"></a><span class="lineno"> 3911</span>&#160;          <span class="comment">/*Quick check if the chunk length isn&#39;t too small. Even without check</span></div>
<div class="line"><a name="l03912"></a><span class="lineno"> 3912</span>&#160;<span class="comment">          it&#39;d still fail with other error checks below if it&#39;s too short. This just gives a different error code.*/</span></div>
<div class="line"><a name="l03913"></a><span class="lineno"> 3913</span>&#160;          <span class="keywordflow">if</span>(chunkLength &lt; 5) <a class="code" href="lodepng_8cpp.html#af803b1b42c6d252d173df9cd0b32725a">CERROR_BREAK</a>(decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#a1986e8d73bf733140e2de07993685983">error</a>, 30); <span class="comment">/*iTXt chunk too short*/</span></div>
<div class="line"><a name="l03914"></a><span class="lineno"> 3914</span>&#160;</div>
<div class="line"><a name="l03915"></a><span class="lineno"> 3915</span>&#160;          <span class="comment">/*read the key*/</span></div>
<div class="line"><a name="l03916"></a><span class="lineno"> 3916</span>&#160;          <span class="keywordflow">for</span>(length = 0; length &lt; chunkLength &amp;&amp; data[<a class="code" href="_d_l_l_imports_8inl.html#a5720e2b8f4f85b31e0bab5a1b6e69c74">length</a>] != 0; length++) ;</div>
<div class="line"><a name="l03917"></a><span class="lineno"> 3917</span>&#160;          <span class="keywordflow">if</span>(length + 2 &gt;= chunkLength) <a class="code" href="lodepng_8cpp.html#af803b1b42c6d252d173df9cd0b32725a">CERROR_BREAK</a>(decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#a1986e8d73bf733140e2de07993685983">error</a>, 75); <span class="comment">/*no null termination char found*/</span></div>
<div class="line"><a name="l03918"></a><span class="lineno"> 3918</span>&#160;</div>
<div class="line"><a name="l03919"></a><span class="lineno"> 3919</span>&#160;          key = (<span class="keywordtype">char</span>*)<a class="code" href="namespace_f_w.html#a440e071d8fdbc9789b728245caad99c0">malloc</a>(length + 1);</div>
<div class="line"><a name="l03920"></a><span class="lineno"> 3920</span>&#160;          <span class="keywordflow">if</span>(!key) <a class="code" href="lodepng_8cpp.html#af803b1b42c6d252d173df9cd0b32725a">CERROR_BREAK</a>(decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#a1986e8d73bf733140e2de07993685983">error</a>, 9941); <span class="comment">/*alloc fail*/</span></div>
<div class="line"><a name="l03921"></a><span class="lineno"> 3921</span>&#160;</div>
<div class="line"><a name="l03922"></a><span class="lineno"> 3922</span>&#160;          key[<a class="code" href="_d_l_l_imports_8inl.html#a5720e2b8f4f85b31e0bab5a1b6e69c74">length</a>] = 0;</div>
<div class="line"><a name="l03923"></a><span class="lineno"> 3923</span>&#160;          <span class="keywordflow">for</span>(i = 0; i &lt; <a class="code" href="_d_l_l_imports_8inl.html#a5720e2b8f4f85b31e0bab5a1b6e69c74">length</a>; i++) key[i] = data[i];</div>
<div class="line"><a name="l03924"></a><span class="lineno"> 3924</span>&#160;</div>
<div class="line"><a name="l03925"></a><span class="lineno"> 3925</span>&#160;          <span class="comment">/*read the compression method*/</span></div>
<div class="line"><a name="l03926"></a><span class="lineno"> 3926</span>&#160;          compressed = data[length + 1];</div>
<div class="line"><a name="l03927"></a><span class="lineno"> 3927</span>&#160;          <span class="keywordflow">if</span>(data[length + 2] != 0) <a class="code" href="lodepng_8cpp.html#af803b1b42c6d252d173df9cd0b32725a">CERROR_BREAK</a>(decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#a1986e8d73bf733140e2de07993685983">error</a>, 72); <span class="comment">/*the 0 byte indicating compression must be 0*/</span></div>
<div class="line"><a name="l03928"></a><span class="lineno"> 3928</span>&#160;</div>
<div class="line"><a name="l03929"></a><span class="lineno"> 3929</span>&#160;          <span class="comment">/*read the langtag*/</span></div>
<div class="line"><a name="l03930"></a><span class="lineno"> 3930</span>&#160;          begin = length + 3;</div>
<div class="line"><a name="l03931"></a><span class="lineno"> 3931</span>&#160;          length = 0;</div>
<div class="line"><a name="l03932"></a><span class="lineno"> 3932</span>&#160;          <span class="keywordflow">for</span>(i = begin; i &lt; chunkLength &amp;&amp; data[i] != 0; i++) length++;</div>
<div class="line"><a name="l03933"></a><span class="lineno"> 3933</span>&#160;          <span class="keywordflow">if</span>(begin + length + 1 &gt;= chunkLength) <a class="code" href="lodepng_8cpp.html#af803b1b42c6d252d173df9cd0b32725a">CERROR_BREAK</a>(decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#a1986e8d73bf733140e2de07993685983">error</a>, 75); <span class="comment">/*no null termination char found*/</span></div>
<div class="line"><a name="l03934"></a><span class="lineno"> 3934</span>&#160;</div>
<div class="line"><a name="l03935"></a><span class="lineno"> 3935</span>&#160;          langtag = (<span class="keywordtype">char</span>*)<a class="code" href="namespace_f_w.html#a440e071d8fdbc9789b728245caad99c0">malloc</a>(length + 1);</div>
<div class="line"><a name="l03936"></a><span class="lineno"> 3936</span>&#160;          <span class="keywordflow">if</span>(!langtag) <a class="code" href="lodepng_8cpp.html#af803b1b42c6d252d173df9cd0b32725a">CERROR_BREAK</a>(decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#a1986e8d73bf733140e2de07993685983">error</a>, 9942); <span class="comment">/*alloc fail*/</span></div>
<div class="line"><a name="l03937"></a><span class="lineno"> 3937</span>&#160;</div>
<div class="line"><a name="l03938"></a><span class="lineno"> 3938</span>&#160;          langtag[<a class="code" href="_d_l_l_imports_8inl.html#a5720e2b8f4f85b31e0bab5a1b6e69c74">length</a>] = 0;</div>
<div class="line"><a name="l03939"></a><span class="lineno"> 3939</span>&#160;          <span class="keywordflow">for</span>(i = 0; i &lt; <a class="code" href="_d_l_l_imports_8inl.html#a5720e2b8f4f85b31e0bab5a1b6e69c74">length</a>; i++) langtag[i] = data[begin + i];</div>
<div class="line"><a name="l03940"></a><span class="lineno"> 3940</span>&#160;</div>
<div class="line"><a name="l03941"></a><span class="lineno"> 3941</span>&#160;          <span class="comment">/*read the transkey*/</span></div>
<div class="line"><a name="l03942"></a><span class="lineno"> 3942</span>&#160;          begin += length + 1;</div>
<div class="line"><a name="l03943"></a><span class="lineno"> 3943</span>&#160;          length = 0;</div>
<div class="line"><a name="l03944"></a><span class="lineno"> 3944</span>&#160;          <span class="keywordflow">for</span>(i = begin; i &lt; chunkLength &amp;&amp; data[i] != 0; i++) length++;</div>
<div class="line"><a name="l03945"></a><span class="lineno"> 3945</span>&#160;          <span class="keywordflow">if</span>(begin + length + 1 &gt;= chunkLength) <a class="code" href="lodepng_8cpp.html#af803b1b42c6d252d173df9cd0b32725a">CERROR_BREAK</a>(decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#a1986e8d73bf733140e2de07993685983">error</a>, 75); <span class="comment">/*no null termination, corrupt?*/</span></div>
<div class="line"><a name="l03946"></a><span class="lineno"> 3946</span>&#160;</div>
<div class="line"><a name="l03947"></a><span class="lineno"> 3947</span>&#160;          transkey = (<span class="keywordtype">char</span>*)<a class="code" href="namespace_f_w.html#a440e071d8fdbc9789b728245caad99c0">malloc</a>(length + 1);</div>
<div class="line"><a name="l03948"></a><span class="lineno"> 3948</span>&#160;          <span class="keywordflow">if</span>(!transkey) <a class="code" href="lodepng_8cpp.html#af803b1b42c6d252d173df9cd0b32725a">CERROR_BREAK</a>(decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#a1986e8d73bf733140e2de07993685983">error</a>, 9943); <span class="comment">/*alloc fail*/</span></div>
<div class="line"><a name="l03949"></a><span class="lineno"> 3949</span>&#160;</div>
<div class="line"><a name="l03950"></a><span class="lineno"> 3950</span>&#160;          transkey[<a class="code" href="_d_l_l_imports_8inl.html#a5720e2b8f4f85b31e0bab5a1b6e69c74">length</a>] = 0;</div>
<div class="line"><a name="l03951"></a><span class="lineno"> 3951</span>&#160;          <span class="keywordflow">for</span>(i = 0; i &lt; <a class="code" href="_d_l_l_imports_8inl.html#a5720e2b8f4f85b31e0bab5a1b6e69c74">length</a>; i++) transkey[i] = data[begin + i];</div>
<div class="line"><a name="l03952"></a><span class="lineno"> 3952</span>&#160;</div>
<div class="line"><a name="l03953"></a><span class="lineno"> 3953</span>&#160;          <span class="comment">/*read the actual text*/</span></div>
<div class="line"><a name="l03954"></a><span class="lineno"> 3954</span>&#160;          begin += length + 1;</div>
<div class="line"><a name="l03955"></a><span class="lineno"> 3955</span>&#160;          <span class="keywordflow">if</span>(begin &gt; chunkLength) <a class="code" href="lodepng_8cpp.html#af803b1b42c6d252d173df9cd0b32725a">CERROR_BREAK</a>(decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#a1986e8d73bf733140e2de07993685983">error</a>, 75); <span class="comment">/*no null termination, corrupt?*/</span></div>
<div class="line"><a name="l03956"></a><span class="lineno"> 3956</span>&#160;</div>
<div class="line"><a name="l03957"></a><span class="lineno"> 3957</span>&#160;          length = chunkLength - begin;</div>
<div class="line"><a name="l03958"></a><span class="lineno"> 3958</span>&#160;</div>
<div class="line"><a name="l03959"></a><span class="lineno"> 3959</span>&#160;          <span class="keywordflow">if</span>(compressed)</div>
<div class="line"><a name="l03960"></a><span class="lineno"> 3960</span>&#160;          {</div>
<div class="line"><a name="l03961"></a><span class="lineno"> 3961</span>&#160;            decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#a1986e8d73bf733140e2de07993685983">error</a> = <a class="code" href="lodepng_8cpp.html#af11d6ba19787c8d48aa3ed88cf3e6462">LodePNG_zlib_decompress</a>(&amp;decoded.<a class="code" href="structucvector.html#ace794c5713208c5a20f21762cd87c919">data</a>, &amp;decoded.<a class="code" href="structucvector.html#a27c99c34de0c5b3ca0c242d402c69499">size</a>,</div>
<div class="line"><a name="l03962"></a><span class="lineno"> 3962</span>&#160;                                                     (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>*)(&amp;data[begin]),</div>
<div class="line"><a name="l03963"></a><span class="lineno"> 3963</span>&#160;                                                      length, &amp;decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#a03ad3505caf0cba6de6cadfd41b9067e">settings</a>.<a class="code" href="struct_lode_p_n_g___decode_settings.html#af8de90c1410b0ad33c4d2712cafef26e">zlibsettings</a>);</div>
<div class="line"><a name="l03964"></a><span class="lineno"> 3964</span>&#160;            <span class="keywordflow">if</span>(decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#a1986e8d73bf733140e2de07993685983">error</a>) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03965"></a><span class="lineno"> 3965</span>&#160;            ucvector_push_back(&amp;decoded, 0);</div>
<div class="line"><a name="l03966"></a><span class="lineno"> 3966</span>&#160;          }</div>
<div class="line"><a name="l03967"></a><span class="lineno"> 3967</span>&#160;          <span class="keywordflow">else</span></div>
<div class="line"><a name="l03968"></a><span class="lineno"> 3968</span>&#160;          {</div>
<div class="line"><a name="l03969"></a><span class="lineno"> 3969</span>&#160;            <span class="keywordflow">if</span>(!ucvector_resize(&amp;decoded, length + 1)) <a class="code" href="lodepng_8cpp.html#af803b1b42c6d252d173df9cd0b32725a">CERROR_BREAK</a>(decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#a1986e8d73bf733140e2de07993685983">error</a>, 9944 <span class="comment">/*alloc fail*/</span>);</div>
<div class="line"><a name="l03970"></a><span class="lineno"> 3970</span>&#160;</div>
<div class="line"><a name="l03971"></a><span class="lineno"> 3971</span>&#160;            decoded.<a class="code" href="structucvector.html#ace794c5713208c5a20f21762cd87c919">data</a>[<a class="code" href="_d_l_l_imports_8inl.html#a5720e2b8f4f85b31e0bab5a1b6e69c74">length</a>] = 0;</div>
<div class="line"><a name="l03972"></a><span class="lineno"> 3972</span>&#160;            <span class="keywordflow">for</span>(i = 0; i &lt; <a class="code" href="_d_l_l_imports_8inl.html#a5720e2b8f4f85b31e0bab5a1b6e69c74">length</a>; i++) decoded.<a class="code" href="structucvector.html#ace794c5713208c5a20f21762cd87c919">data</a>[i] = data[begin + i];</div>
<div class="line"><a name="l03973"></a><span class="lineno"> 3973</span>&#160;          }</div>
<div class="line"><a name="l03974"></a><span class="lineno"> 3974</span>&#160;</div>
<div class="line"><a name="l03975"></a><span class="lineno"> 3975</span>&#160;          decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#a1986e8d73bf733140e2de07993685983">error</a> = <a class="code" href="lodepng_8cpp.html#a637a6754fae89a90ea3ba46b1fa99df3">LodePNG_IText_add</a>(&amp;decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#aa84a32ab83a4e50d909259b2041cb13e">infoPng</a>.<a class="code" href="struct_lode_p_n_g___info_png.html#a6a25d5f857d5e8d1c326997b78d9daf1">itext</a>, key, langtag, transkey, (<span class="keywordtype">char</span>*)decoded.<a class="code" href="structucvector.html#ace794c5713208c5a20f21762cd87c919">data</a>);</div>
<div class="line"><a name="l03976"></a><span class="lineno"> 3976</span>&#160;</div>
<div class="line"><a name="l03977"></a><span class="lineno"> 3977</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03978"></a><span class="lineno"> 3978</span>&#160;        }</div>
<div class="line"><a name="l03979"></a><span class="lineno"> 3979</span>&#160;</div>
<div class="line"><a name="l03980"></a><span class="lineno"> 3980</span>&#160;        <a class="code" href="namespace_f_w.html#a93be8f55938d6ffb5ca0af1f95f81589">free</a>(key);</div>
<div class="line"><a name="l03981"></a><span class="lineno"> 3981</span>&#160;        <a class="code" href="namespace_f_w.html#a93be8f55938d6ffb5ca0af1f95f81589">free</a>(langtag);</div>
<div class="line"><a name="l03982"></a><span class="lineno"> 3982</span>&#160;        <a class="code" href="namespace_f_w.html#a93be8f55938d6ffb5ca0af1f95f81589">free</a>(transkey);</div>
<div class="line"><a name="l03983"></a><span class="lineno"> 3983</span>&#160;        ucvector_cleanup(&amp;decoded);</div>
<div class="line"><a name="l03984"></a><span class="lineno"> 3984</span>&#160;        <span class="keywordflow">if</span>(decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#a1986e8d73bf733140e2de07993685983">error</a>) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03985"></a><span class="lineno"> 3985</span>&#160;      }</div>
<div class="line"><a name="l03986"></a><span class="lineno"> 3986</span>&#160;    }</div>
<div class="line"><a name="l03987"></a><span class="lineno"> 3987</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="lodepng_8cpp.html#a1e3ab3e373966fd2c323bd5a698ccfb1">LodePNG_chunk_type_equals</a>(chunk, <span class="stringliteral">&quot;tIME&quot;</span>))</div>
<div class="line"><a name="l03988"></a><span class="lineno"> 3988</span>&#160;    {</div>
<div class="line"><a name="l03989"></a><span class="lineno"> 3989</span>&#160;      <span class="keywordflow">if</span>(chunkLength != 7) <a class="code" href="lodepng_8cpp.html#af803b1b42c6d252d173df9cd0b32725a">CERROR_BREAK</a>(decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#a1986e8d73bf733140e2de07993685983">error</a>, 73); <span class="comment">/*invalid tIME chunk size*/</span></div>
<div class="line"><a name="l03990"></a><span class="lineno"> 3990</span>&#160;</div>
<div class="line"><a name="l03991"></a><span class="lineno"> 3991</span>&#160;      decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#aa84a32ab83a4e50d909259b2041cb13e">infoPng</a>.<a class="code" href="struct_lode_p_n_g___info_png.html#aa220d359b0f73b1f61a87f1c3bf8aad6">time_defined</a> = 1;</div>
<div class="line"><a name="l03992"></a><span class="lineno"> 3992</span>&#160;      decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#aa84a32ab83a4e50d909259b2041cb13e">infoPng</a>.<a class="code" href="struct_lode_p_n_g___info_png.html#a52e3f42ce7942e5ebd0c60db6737056a">time</a>.<a class="code" href="struct_lode_p_n_g___time.html#ae00d9df8a901579a2b563b683cc85169">year</a> = 256 * data[0] + data[+ 1];</div>
<div class="line"><a name="l03993"></a><span class="lineno"> 3993</span>&#160;      decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#aa84a32ab83a4e50d909259b2041cb13e">infoPng</a>.<a class="code" href="struct_lode_p_n_g___info_png.html#a52e3f42ce7942e5ebd0c60db6737056a">time</a>.<a class="code" href="struct_lode_p_n_g___time.html#a68ba78f192f4ed04bed783591df81405">month</a> = data[2];</div>
<div class="line"><a name="l03994"></a><span class="lineno"> 3994</span>&#160;      decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#aa84a32ab83a4e50d909259b2041cb13e">infoPng</a>.<a class="code" href="struct_lode_p_n_g___info_png.html#a52e3f42ce7942e5ebd0c60db6737056a">time</a>.<a class="code" href="struct_lode_p_n_g___time.html#a298fdd9a10f4a122e4921624d3bfd78b">day</a> = data[3];</div>
<div class="line"><a name="l03995"></a><span class="lineno"> 3995</span>&#160;      decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#aa84a32ab83a4e50d909259b2041cb13e">infoPng</a>.<a class="code" href="struct_lode_p_n_g___info_png.html#a52e3f42ce7942e5ebd0c60db6737056a">time</a>.<a class="code" href="struct_lode_p_n_g___time.html#a7ebc5c1cff16ed456268f6b4de66f4d7">hour</a> = data[4];</div>
<div class="line"><a name="l03996"></a><span class="lineno"> 3996</span>&#160;      decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#aa84a32ab83a4e50d909259b2041cb13e">infoPng</a>.<a class="code" href="struct_lode_p_n_g___info_png.html#a52e3f42ce7942e5ebd0c60db6737056a">time</a>.<a class="code" href="struct_lode_p_n_g___time.html#a7990f2e77aee4b5bd87e417e850d5352">minute</a> = data[5];</div>
<div class="line"><a name="l03997"></a><span class="lineno"> 3997</span>&#160;      decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#aa84a32ab83a4e50d909259b2041cb13e">infoPng</a>.<a class="code" href="struct_lode_p_n_g___info_png.html#a52e3f42ce7942e5ebd0c60db6737056a">time</a>.<a class="code" href="struct_lode_p_n_g___time.html#a68daf5323e84b536893b9b21e50022c1">second</a> = data[6];</div>
<div class="line"><a name="l03998"></a><span class="lineno"> 3998</span>&#160;    }</div>
<div class="line"><a name="l03999"></a><span class="lineno"> 3999</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="lodepng_8cpp.html#a1e3ab3e373966fd2c323bd5a698ccfb1">LodePNG_chunk_type_equals</a>(chunk, <span class="stringliteral">&quot;pHYs&quot;</span>))</div>
<div class="line"><a name="l04000"></a><span class="lineno"> 4000</span>&#160;    {</div>
<div class="line"><a name="l04001"></a><span class="lineno"> 4001</span>&#160;      <span class="keywordflow">if</span>(chunkLength != 9) <a class="code" href="lodepng_8cpp.html#af803b1b42c6d252d173df9cd0b32725a">CERROR_BREAK</a>(decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#a1986e8d73bf733140e2de07993685983">error</a>, 74); <span class="comment">/*invalid pHYs chunk size*/</span></div>
<div class="line"><a name="l04002"></a><span class="lineno"> 4002</span>&#160;</div>
<div class="line"><a name="l04003"></a><span class="lineno"> 4003</span>&#160;      decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#aa84a32ab83a4e50d909259b2041cb13e">infoPng</a>.<a class="code" href="struct_lode_p_n_g___info_png.html#a0f0b0d882e5c099d06d608c79295ba2d">phys_defined</a> = 1;</div>
<div class="line"><a name="l04004"></a><span class="lineno"> 4004</span>&#160;      decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#aa84a32ab83a4e50d909259b2041cb13e">infoPng</a>.<a class="code" href="struct_lode_p_n_g___info_png.html#a9c0f6237cfefc693ed17dbc3a843fe0f">phys_x</a> = 16777216 * data[0] + 65536 * data[1] + 256 * data[2] + data[3];</div>
<div class="line"><a name="l04005"></a><span class="lineno"> 4005</span>&#160;      decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#aa84a32ab83a4e50d909259b2041cb13e">infoPng</a>.<a class="code" href="struct_lode_p_n_g___info_png.html#aea8ade694048f5912c235478b4ec1a35">phys_y</a> = 16777216 * data[4] + 65536 * data[5] + 256 * data[6] + data[7];</div>
<div class="line"><a name="l04006"></a><span class="lineno"> 4006</span>&#160;      decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#aa84a32ab83a4e50d909259b2041cb13e">infoPng</a>.<a class="code" href="struct_lode_p_n_g___info_png.html#aab80ead40f4068cd89e71056143b1cd5">phys_unit</a> = data[8];</div>
<div class="line"><a name="l04007"></a><span class="lineno"> 4007</span>&#160;    }</div>
<div class="line"><a name="l04008"></a><span class="lineno"> 4008</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/*LODEPNG_COMPILE_ANCILLARY_CHUNKS*/</span><span class="preprocessor"></span></div>
<div class="line"><a name="l04009"></a><span class="lineno"> 4009</span>&#160;<span class="preprocessor"></span>    <span class="keywordflow">else</span> <span class="comment">/*it&#39;s not an implemented chunk type, so ignore it: skip over the data*/</span></div>
<div class="line"><a name="l04010"></a><span class="lineno"> 4010</span>&#160;    {</div>
<div class="line"><a name="l04011"></a><span class="lineno"> 4011</span>&#160;      <span class="comment">/*error: unknown critical chunk (5th bit of first byte of chunk type is 0)*/</span></div>
<div class="line"><a name="l04012"></a><span class="lineno"> 4012</span>&#160;      <span class="keywordflow">if</span>(<a class="code" href="lodepng_8cpp.html#abaf9330852c93cddc2e633f975e56193">LodePNG_chunk_critical</a>(chunk)) <a class="code" href="lodepng_8cpp.html#af803b1b42c6d252d173df9cd0b32725a">CERROR_BREAK</a>(decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#a1986e8d73bf733140e2de07993685983">error</a>, 69);</div>
<div class="line"><a name="l04013"></a><span class="lineno"> 4013</span>&#160;</div>
<div class="line"><a name="l04014"></a><span class="lineno"> 4014</span>&#160;      unknown = 1;</div>
<div class="line"><a name="l04015"></a><span class="lineno"> 4015</span>&#160;<span class="preprocessor">#ifdef LODEPNG_COMPILE_UNKNOWN_CHUNKS</span></div>
<div class="line"><a name="l04016"></a><span class="lineno"> 4016</span>&#160;<span class="preprocessor"></span>      <span class="keywordflow">if</span>(decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#a03ad3505caf0cba6de6cadfd41b9067e">settings</a>.<a class="code" href="struct_lode_p_n_g___decode_settings.html#aeab30cd87a6bb9334a77e4f32422a4b8">rememberUnknownChunks</a>)</div>
<div class="line"><a name="l04017"></a><span class="lineno"> 4017</span>&#160;      {</div>
<div class="line"><a name="l04018"></a><span class="lineno"> 4018</span>&#160;        <a class="code" href="struct_lode_p_n_g___unknown_chunks.html">LodePNG_UnknownChunks</a>* unknown = &amp;decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#aa84a32ab83a4e50d909259b2041cb13e">infoPng</a>.<a class="code" href="struct_lode_p_n_g___info_png.html#a97faa43bfd4e8f8df1cd836c713edac3">unknown_chunks</a>;</div>
<div class="line"><a name="l04019"></a><span class="lineno"> 4019</span>&#160;        decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#a1986e8d73bf733140e2de07993685983">error</a> = <a class="code" href="lodepng_8cpp.html#a8047414db7062af3671e20c90a4a4ae7">LodePNG_append_chunk</a>(&amp;unknown-&gt;<a class="code" href="struct_lode_p_n_g___unknown_chunks.html#a9923d61d31e17e7093194da5182eda97">data</a>[critical_pos - 1],</div>
<div class="line"><a name="l04020"></a><span class="lineno"> 4020</span>&#160;                                              &amp;unknown-&gt;<a class="code" href="struct_lode_p_n_g___unknown_chunks.html#ab124de165db15c6cd5db43378c8ae15a">datasize</a>[critical_pos - 1], chunk);</div>
<div class="line"><a name="l04021"></a><span class="lineno"> 4021</span>&#160;        <span class="keywordflow">if</span>(decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#a1986e8d73bf733140e2de07993685983">error</a>) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04022"></a><span class="lineno"> 4022</span>&#160;      }</div>
<div class="line"><a name="l04023"></a><span class="lineno"> 4023</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/*LODEPNG_COMPILE_UNKNOWN_CHUNKS*/</span><span class="preprocessor"></span></div>
<div class="line"><a name="l04024"></a><span class="lineno"> 4024</span>&#160;<span class="preprocessor"></span>    }</div>
<div class="line"><a name="l04025"></a><span class="lineno"> 4025</span>&#160;</div>
<div class="line"><a name="l04026"></a><span class="lineno"> 4026</span>&#160;    <span class="keywordflow">if</span>(!decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#a03ad3505caf0cba6de6cadfd41b9067e">settings</a>.<a class="code" href="struct_lode_p_n_g___decode_settings.html#a08d95fa78ebdfcdeb8dcb05ccee6716c">ignoreCrc</a> &amp;&amp; !unknown) <span class="comment">/*check CRC if wanted, only on known chunk types*/</span></div>
<div class="line"><a name="l04027"></a><span class="lineno"> 4027</span>&#160;    {</div>
<div class="line"><a name="l04028"></a><span class="lineno"> 4028</span>&#160;      <span class="keywordflow">if</span>(<a class="code" href="lodepng_8cpp.html#a1d08e922a7f80b5afcde010489db6579">LodePNG_chunk_check_crc</a>(chunk)) <a class="code" href="lodepng_8cpp.html#af803b1b42c6d252d173df9cd0b32725a">CERROR_BREAK</a>(decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#a1986e8d73bf733140e2de07993685983">error</a>, 57); <span class="comment">/*invalid CRC*/</span></div>
<div class="line"><a name="l04029"></a><span class="lineno"> 4029</span>&#160;    }</div>
<div class="line"><a name="l04030"></a><span class="lineno"> 4030</span>&#160;</div>
<div class="line"><a name="l04031"></a><span class="lineno"> 4031</span>&#160;    <span class="keywordflow">if</span>(!IEND) chunk = <a class="code" href="lodepng_8cpp.html#a16e9565fa7d5805df2256db07ed49177">LodePNG_chunk_next_const</a>(chunk);</div>
<div class="line"><a name="l04032"></a><span class="lineno"> 4032</span>&#160;  }</div>
<div class="line"><a name="l04033"></a><span class="lineno"> 4033</span>&#160;</div>
<div class="line"><a name="l04034"></a><span class="lineno"> 4034</span>&#160;  <span class="keywordflow">if</span>(!decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#a1986e8d73bf733140e2de07993685983">error</a>)</div>
<div class="line"><a name="l04035"></a><span class="lineno"> 4035</span>&#160;  {</div>
<div class="line"><a name="l04036"></a><span class="lineno"> 4036</span>&#160;    <a class="code" href="structucvector.html">ucvector</a> scanlines;</div>
<div class="line"><a name="l04037"></a><span class="lineno"> 4037</span>&#160;    ucvector_init(&amp;scanlines);</div>
<div class="line"><a name="l04038"></a><span class="lineno"> 4038</span>&#160;</div>
<div class="line"><a name="l04039"></a><span class="lineno"> 4039</span>&#160;    <span class="comment">/*maximum final image length is already reserved in the vector&#39;s length - this is not really necessary*/</span></div>
<div class="line"><a name="l04040"></a><span class="lineno"> 4040</span>&#160;    <span class="keywordflow">if</span>(!ucvector_resize(&amp;scanlines, ((decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#aa84a32ab83a4e50d909259b2041cb13e">infoPng</a>.<a class="code" href="struct_lode_p_n_g___info_png.html#a74be99b177b28f3178c02139c4b7f149">width</a> * (decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#aa84a32ab83a4e50d909259b2041cb13e">infoPng</a>.<a class="code" href="struct_lode_p_n_g___info_png.html#a4b87ec9649e7177af7a5f5e08e5bc491">height</a></div>
<div class="line"><a name="l04041"></a><span class="lineno"> 4041</span>&#160;       * <a class="code" href="lodepng_8cpp.html#a81151c0087467b4ac2a815b3234fdb5a">LodePNG_InfoColor_getBpp</a>(&amp;decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#aa84a32ab83a4e50d909259b2041cb13e">infoPng</a>.<a class="code" href="struct_lode_p_n_g___info_png.html#acce58518f72f42ba94db4c1cfd69336b">color</a>) + 7)) / 8) + decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#aa84a32ab83a4e50d909259b2041cb13e">infoPng</a>.<a class="code" href="struct_lode_p_n_g___info_png.html#a4b87ec9649e7177af7a5f5e08e5bc491">height</a>))</div>
<div class="line"><a name="l04042"></a><span class="lineno"> 4042</span>&#160;    {</div>
<div class="line"><a name="l04043"></a><span class="lineno"> 4043</span>&#160;      decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#a1986e8d73bf733140e2de07993685983">error</a> = 9945; <span class="comment">/*alloc fail*/</span></div>
<div class="line"><a name="l04044"></a><span class="lineno"> 4044</span>&#160;    }</div>
<div class="line"><a name="l04045"></a><span class="lineno"> 4045</span>&#160;    <span class="keywordflow">if</span>(!decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#a1986e8d73bf733140e2de07993685983">error</a>)</div>
<div class="line"><a name="l04046"></a><span class="lineno"> 4046</span>&#160;    {</div>
<div class="line"><a name="l04047"></a><span class="lineno"> 4047</span>&#160;      <span class="comment">/*decompress with the Zlib decompressor*/</span></div>
<div class="line"><a name="l04048"></a><span class="lineno"> 4048</span>&#160;      decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#a1986e8d73bf733140e2de07993685983">error</a> = <a class="code" href="lodepng_8cpp.html#af11d6ba19787c8d48aa3ed88cf3e6462">LodePNG_zlib_decompress</a>(&amp;scanlines.<a class="code" href="structucvector.html#ace794c5713208c5a20f21762cd87c919">data</a>, &amp;scanlines.<a class="code" href="structucvector.html#a27c99c34de0c5b3ca0c242d402c69499">size</a>, idat.<a class="code" href="structucvector.html#ace794c5713208c5a20f21762cd87c919">data</a>,</div>
<div class="line"><a name="l04049"></a><span class="lineno"> 4049</span>&#160;                                               idat.<a class="code" href="structucvector.html#a27c99c34de0c5b3ca0c242d402c69499">size</a>, &amp;decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#a03ad3505caf0cba6de6cadfd41b9067e">settings</a>.<a class="code" href="struct_lode_p_n_g___decode_settings.html#af8de90c1410b0ad33c4d2712cafef26e">zlibsettings</a>);</div>
<div class="line"><a name="l04050"></a><span class="lineno"> 4050</span>&#160;    }</div>
<div class="line"><a name="l04051"></a><span class="lineno"> 4051</span>&#160;</div>
<div class="line"><a name="l04052"></a><span class="lineno"> 4052</span>&#160;    <span class="keywordflow">if</span>(!decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#a1986e8d73bf733140e2de07993685983">error</a>)</div>
<div class="line"><a name="l04053"></a><span class="lineno"> 4053</span>&#160;    {</div>
<div class="line"><a name="l04054"></a><span class="lineno"> 4054</span>&#160;      <a class="code" href="structucvector.html">ucvector</a> outv;</div>
<div class="line"><a name="l04055"></a><span class="lineno"> 4055</span>&#160;      ucvector_init(&amp;outv);</div>
<div class="line"><a name="l04056"></a><span class="lineno"> 4056</span>&#160;      <span class="keywordflow">if</span>(!ucvector_resizev(&amp;outv, (decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#aa84a32ab83a4e50d909259b2041cb13e">infoPng</a>.<a class="code" href="struct_lode_p_n_g___info_png.html#a4b87ec9649e7177af7a5f5e08e5bc491">height</a> * decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#aa84a32ab83a4e50d909259b2041cb13e">infoPng</a>.<a class="code" href="struct_lode_p_n_g___info_png.html#a74be99b177b28f3178c02139c4b7f149">width</a></div>
<div class="line"><a name="l04057"></a><span class="lineno"> 4057</span>&#160;         * <a class="code" href="lodepng_8cpp.html#a81151c0087467b4ac2a815b3234fdb5a">LodePNG_InfoColor_getBpp</a>(&amp;decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#aa84a32ab83a4e50d909259b2041cb13e">infoPng</a>.<a class="code" href="struct_lode_p_n_g___info_png.html#acce58518f72f42ba94db4c1cfd69336b">color</a>) + 7) / 8, 0)) decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#a1986e8d73bf733140e2de07993685983">error</a> = 9946; <span class="comment">/*alloc fail*/</span></div>
<div class="line"><a name="l04058"></a><span class="lineno"> 4058</span>&#160;      <span class="keywordflow">if</span>(!decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#a1986e8d73bf733140e2de07993685983">error</a>) decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#a1986e8d73bf733140e2de07993685983">error</a> = postProcessScanlines(outv.<a class="code" href="structucvector.html#ace794c5713208c5a20f21762cd87c919">data</a>, scanlines.<a class="code" href="structucvector.html#ace794c5713208c5a20f21762cd87c919">data</a>, &amp;decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#aa84a32ab83a4e50d909259b2041cb13e">infoPng</a>);</div>
<div class="line"><a name="l04059"></a><span class="lineno"> 4059</span>&#160;      *out = outv.<a class="code" href="structucvector.html#ace794c5713208c5a20f21762cd87c919">data</a>;</div>
<div class="line"><a name="l04060"></a><span class="lineno"> 4060</span>&#160;      *outsize = outv.<a class="code" href="structucvector.html#a27c99c34de0c5b3ca0c242d402c69499">size</a>;</div>
<div class="line"><a name="l04061"></a><span class="lineno"> 4061</span>&#160;    }</div>
<div class="line"><a name="l04062"></a><span class="lineno"> 4062</span>&#160;    ucvector_cleanup(&amp;scanlines);</div>
<div class="line"><a name="l04063"></a><span class="lineno"> 4063</span>&#160;  }</div>
<div class="line"><a name="l04064"></a><span class="lineno"> 4064</span>&#160;</div>
<div class="line"><a name="l04065"></a><span class="lineno"> 4065</span>&#160;  ucvector_cleanup(&amp;idat);</div>
<div class="line"><a name="l04066"></a><span class="lineno"> 4066</span>&#160;}</div>
<div class="line"><a name="l04067"></a><span class="lineno"> 4067</span>&#160;</div>
<div class="line"><a name="l04068"></a><span class="lineno"><a class="line" href="lodepng_8h.html#a3d29161f6cf08ed35dd9751e6d25cd12"> 4068</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="lodepng_8cpp.html#a3d29161f6cf08ed35dd9751e6d25cd12">LodePNG_Decoder_decode</a>(<a class="code" href="struct_lode_p_n_g___decoder.html">LodePNG_Decoder</a>* decoder, <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>** out, <span class="keywordtype">size_t</span>* outsize,</div>
<div class="line"><a name="l04069"></a><span class="lineno"> 4069</span>&#160;                            <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* in, <span class="keywordtype">size_t</span> insize)</div>
<div class="line"><a name="l04070"></a><span class="lineno"> 4070</span>&#160;{</div>
<div class="line"><a name="l04071"></a><span class="lineno"> 4071</span>&#160;  *out = 0;</div>
<div class="line"><a name="l04072"></a><span class="lineno"> 4072</span>&#160;  *outsize = 0;</div>
<div class="line"><a name="l04073"></a><span class="lineno"> 4073</span>&#160;  decodeGeneric(decoder, out, outsize, in, insize);</div>
<div class="line"><a name="l04074"></a><span class="lineno"> 4074</span>&#160;  <span class="keywordflow">if</span>(decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#a1986e8d73bf733140e2de07993685983">error</a>) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l04075"></a><span class="lineno"> 4075</span>&#160;  <span class="keywordflow">if</span>(!decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#a03ad3505caf0cba6de6cadfd41b9067e">settings</a>.<a class="code" href="struct_lode_p_n_g___decode_settings.html#a30c0660818a6551d0ffdc1600ad42167">color_convert</a> || <a class="code" href="lodepng_8cpp.html#ac1a87f6ae0de91fe9c7716ff5dc3fbea">LodePNG_InfoColor_equal</a>(&amp;decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#abfd722a76000f55a38d99b34ec596720">infoRaw</a>.<a class="code" href="struct_lode_p_n_g___info_raw.html#ae9fa1c020358980be41f861ab71589fb">color</a>, &amp;decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#aa84a32ab83a4e50d909259b2041cb13e">infoPng</a>.<a class="code" href="struct_lode_p_n_g___info_png.html#acce58518f72f42ba94db4c1cfd69336b">color</a>))</div>
<div class="line"><a name="l04076"></a><span class="lineno"> 4076</span>&#160;  {</div>
<div class="line"><a name="l04077"></a><span class="lineno"> 4077</span>&#160;    <span class="comment">/*same color type, no copying or converting of data needed*/</span></div>
<div class="line"><a name="l04078"></a><span class="lineno"> 4078</span>&#160;    <span class="comment">/*store the infoPng color settings on the infoRaw so that the infoRaw still reflects what colorType</span></div>
<div class="line"><a name="l04079"></a><span class="lineno"> 4079</span>&#160;<span class="comment">    the raw image has to the end user*/</span></div>
<div class="line"><a name="l04080"></a><span class="lineno"> 4080</span>&#160;    <span class="keywordflow">if</span>(!decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#a03ad3505caf0cba6de6cadfd41b9067e">settings</a>.<a class="code" href="struct_lode_p_n_g___decode_settings.html#a30c0660818a6551d0ffdc1600ad42167">color_convert</a>)</div>
<div class="line"><a name="l04081"></a><span class="lineno"> 4081</span>&#160;    {</div>
<div class="line"><a name="l04082"></a><span class="lineno"> 4082</span>&#160;      decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#a1986e8d73bf733140e2de07993685983">error</a> = <a class="code" href="lodepng_8cpp.html#ad7beb96e92dd01a605c669af79a54a00">LodePNG_InfoColor_copy</a>(&amp;decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#abfd722a76000f55a38d99b34ec596720">infoRaw</a>.<a class="code" href="struct_lode_p_n_g___info_raw.html#ae9fa1c020358980be41f861ab71589fb">color</a>, &amp;decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#aa84a32ab83a4e50d909259b2041cb13e">infoPng</a>.<a class="code" href="struct_lode_p_n_g___info_png.html#acce58518f72f42ba94db4c1cfd69336b">color</a>);</div>
<div class="line"><a name="l04083"></a><span class="lineno"> 4083</span>&#160;      <span class="keywordflow">if</span>(decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#a1986e8d73bf733140e2de07993685983">error</a>) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l04084"></a><span class="lineno"> 4084</span>&#160;    }</div>
<div class="line"><a name="l04085"></a><span class="lineno"> 4085</span>&#160;  }</div>
<div class="line"><a name="l04086"></a><span class="lineno"> 4086</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l04087"></a><span class="lineno"> 4087</span>&#160;  {</div>
<div class="line"><a name="l04088"></a><span class="lineno"> 4088</span>&#160;    <span class="comment">/*color conversion needed; sort of copy of the data*/</span></div>
<div class="line"><a name="l04089"></a><span class="lineno"> 4089</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* data = *out;</div>
<div class="line"><a name="l04090"></a><span class="lineno"> 4090</span>&#160;</div>
<div class="line"><a name="l04091"></a><span class="lineno"> 4091</span>&#160;    <span class="comment">/*TODO: check if this works according to the statement in the documentation: &quot;The converter can convert</span></div>
<div class="line"><a name="l04092"></a><span class="lineno"> 4092</span>&#160;<span class="comment">    from greyscale input color type, to 8-bit greyscale or greyscale with alpha&quot;*/</span></div>
<div class="line"><a name="l04093"></a><span class="lineno"> 4093</span>&#160;    <span class="keywordflow">if</span>(!(decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#abfd722a76000f55a38d99b34ec596720">infoRaw</a>.<a class="code" href="struct_lode_p_n_g___info_raw.html#ae9fa1c020358980be41f861ab71589fb">color</a>.<a class="code" href="struct_lode_p_n_g___info_color.html#a4ed18d179c5078137a18e742b1c41a00">colorType</a> == 2 || decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#abfd722a76000f55a38d99b34ec596720">infoRaw</a>.<a class="code" href="struct_lode_p_n_g___info_raw.html#ae9fa1c020358980be41f861ab71589fb">color</a>.<a class="code" href="struct_lode_p_n_g___info_color.html#a4ed18d179c5078137a18e742b1c41a00">colorType</a> == 6)</div>
<div class="line"><a name="l04094"></a><span class="lineno"> 4094</span>&#160;       &amp;&amp; !(decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#abfd722a76000f55a38d99b34ec596720">infoRaw</a>.<a class="code" href="struct_lode_p_n_g___info_raw.html#ae9fa1c020358980be41f861ab71589fb">color</a>.<a class="code" href="struct_lode_p_n_g___info_color.html#a9d538965a46d59bbdea744da8b290591">bitDepth</a> == 8))</div>
<div class="line"><a name="l04095"></a><span class="lineno"> 4095</span>&#160;    {</div>
<div class="line"><a name="l04096"></a><span class="lineno"> 4096</span>&#160;      decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#a1986e8d73bf733140e2de07993685983">error</a> = 56; <span class="comment">/*unsupported color mode conversion*/</span></div>
<div class="line"><a name="l04097"></a><span class="lineno"> 4097</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l04098"></a><span class="lineno"> 4098</span>&#160;    }</div>
<div class="line"><a name="l04099"></a><span class="lineno"> 4099</span>&#160;</div>
<div class="line"><a name="l04100"></a><span class="lineno"> 4100</span>&#160;    *outsize = (decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#aa84a32ab83a4e50d909259b2041cb13e">infoPng</a>.<a class="code" href="struct_lode_p_n_g___info_png.html#a74be99b177b28f3178c02139c4b7f149">width</a> * decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#aa84a32ab83a4e50d909259b2041cb13e">infoPng</a>.<a class="code" href="struct_lode_p_n_g___info_png.html#a4b87ec9649e7177af7a5f5e08e5bc491">height</a></div>
<div class="line"><a name="l04101"></a><span class="lineno"> 4101</span>&#160;                * <a class="code" href="lodepng_8cpp.html#a81151c0087467b4ac2a815b3234fdb5a">LodePNG_InfoColor_getBpp</a>(&amp;decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#abfd722a76000f55a38d99b34ec596720">infoRaw</a>.<a class="code" href="struct_lode_p_n_g___info_raw.html#ae9fa1c020358980be41f861ab71589fb">color</a>) + 7) / 8;</div>
<div class="line"><a name="l04102"></a><span class="lineno"> 4102</span>&#160;    *out = (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>*)<a class="code" href="namespace_f_w.html#a440e071d8fdbc9789b728245caad99c0">malloc</a>(*outsize);</div>
<div class="line"><a name="l04103"></a><span class="lineno"> 4103</span>&#160;    <span class="keywordflow">if</span>(!(*out))</div>
<div class="line"><a name="l04104"></a><span class="lineno"> 4104</span>&#160;    {</div>
<div class="line"><a name="l04105"></a><span class="lineno"> 4105</span>&#160;      decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#a1986e8d73bf733140e2de07993685983">error</a> = 9947; <span class="comment">/*alloc fail*/</span></div>
<div class="line"><a name="l04106"></a><span class="lineno"> 4106</span>&#160;      *outsize = 0;</div>
<div class="line"><a name="l04107"></a><span class="lineno"> 4107</span>&#160;    }</div>
<div class="line"><a name="l04108"></a><span class="lineno"> 4108</span>&#160;    <span class="keywordflow">else</span> decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#a1986e8d73bf733140e2de07993685983">error</a> = <a class="code" href="lodepng_8cpp.html#a9e7ce5d1928b44ba6a7c30465b996c68">LodePNG_convert</a>(*out, data, &amp;decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#abfd722a76000f55a38d99b34ec596720">infoRaw</a>.<a class="code" href="struct_lode_p_n_g___info_raw.html#ae9fa1c020358980be41f861ab71589fb">color</a>, &amp;decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#aa84a32ab83a4e50d909259b2041cb13e">infoPng</a>.<a class="code" href="struct_lode_p_n_g___info_png.html#acce58518f72f42ba94db4c1cfd69336b">color</a>,</div>
<div class="line"><a name="l04109"></a><span class="lineno"> 4109</span>&#160;                                          decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#aa84a32ab83a4e50d909259b2041cb13e">infoPng</a>.<a class="code" href="struct_lode_p_n_g___info_png.html#a74be99b177b28f3178c02139c4b7f149">width</a>, decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#aa84a32ab83a4e50d909259b2041cb13e">infoPng</a>.<a class="code" href="struct_lode_p_n_g___info_png.html#a4b87ec9649e7177af7a5f5e08e5bc491">height</a>);</div>
<div class="line"><a name="l04110"></a><span class="lineno"> 4110</span>&#160;    <a class="code" href="namespace_f_w.html#a93be8f55938d6ffb5ca0af1f95f81589">free</a>(data);</div>
<div class="line"><a name="l04111"></a><span class="lineno"> 4111</span>&#160;  }</div>
<div class="line"><a name="l04112"></a><span class="lineno"> 4112</span>&#160;}</div>
<div class="line"><a name="l04113"></a><span class="lineno"> 4113</span>&#160;</div>
<div class="line"><a name="l04114"></a><span class="lineno"><a class="line" href="lodepng_8h.html#a720d71deb4b13a7ca7ab683e9367a61e"> 4114</a></span>&#160;<span class="keywordtype">unsigned</span> <a class="code" href="lodepng_8cpp.html#a720d71deb4b13a7ca7ab683e9367a61e">LodePNG_decode</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>** out, <span class="keywordtype">unsigned</span>* w, <span class="keywordtype">unsigned</span>* h, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* in,</div>
<div class="line"><a name="l04115"></a><span class="lineno"> 4115</span>&#160;                        <span class="keywordtype">size_t</span> insize, <span class="keywordtype">unsigned</span> colorType, <span class="keywordtype">unsigned</span> bitDepth)</div>
<div class="line"><a name="l04116"></a><span class="lineno"> 4116</span>&#160;{</div>
<div class="line"><a name="l04117"></a><span class="lineno"> 4117</span>&#160;  <span class="keywordtype">unsigned</span> error;</div>
<div class="line"><a name="l04118"></a><span class="lineno"> 4118</span>&#160;  <span class="keywordtype">size_t</span> dummy_size;</div>
<div class="line"><a name="l04119"></a><span class="lineno"> 4119</span>&#160;  <a class="code" href="struct_lode_p_n_g___decoder.html">LodePNG_Decoder</a> decoder;</div>
<div class="line"><a name="l04120"></a><span class="lineno"> 4120</span>&#160;  <a class="code" href="lodepng_8cpp.html#a313e972622f025eba50616c62ff033d0">LodePNG_Decoder_init</a>(&amp;decoder);</div>
<div class="line"><a name="l04121"></a><span class="lineno"> 4121</span>&#160;  decoder.<a class="code" href="struct_lode_p_n_g___decoder.html#abfd722a76000f55a38d99b34ec596720">infoRaw</a>.<a class="code" href="struct_lode_p_n_g___info_raw.html#ae9fa1c020358980be41f861ab71589fb">color</a>.<a class="code" href="struct_lode_p_n_g___info_color.html#a4ed18d179c5078137a18e742b1c41a00">colorType</a> = colorType;</div>
<div class="line"><a name="l04122"></a><span class="lineno"> 4122</span>&#160;  decoder.<a class="code" href="struct_lode_p_n_g___decoder.html#abfd722a76000f55a38d99b34ec596720">infoRaw</a>.<a class="code" href="struct_lode_p_n_g___info_raw.html#ae9fa1c020358980be41f861ab71589fb">color</a>.<a class="code" href="struct_lode_p_n_g___info_color.html#a9d538965a46d59bbdea744da8b290591">bitDepth</a> = bitDepth;</div>
<div class="line"><a name="l04123"></a><span class="lineno"> 4123</span>&#160;  <a class="code" href="lodepng_8cpp.html#a3d29161f6cf08ed35dd9751e6d25cd12">LodePNG_Decoder_decode</a>(&amp;decoder, out, &amp;dummy_size, in, insize);</div>
<div class="line"><a name="l04124"></a><span class="lineno"> 4124</span>&#160;  error = decoder.<a class="code" href="struct_lode_p_n_g___decoder.html#a1986e8d73bf733140e2de07993685983">error</a>;</div>
<div class="line"><a name="l04125"></a><span class="lineno"> 4125</span>&#160;  *w = decoder.<a class="code" href="struct_lode_p_n_g___decoder.html#aa84a32ab83a4e50d909259b2041cb13e">infoPng</a>.<a class="code" href="struct_lode_p_n_g___info_png.html#a74be99b177b28f3178c02139c4b7f149">width</a>;</div>
<div class="line"><a name="l04126"></a><span class="lineno"> 4126</span>&#160;  *h = decoder.<a class="code" href="struct_lode_p_n_g___decoder.html#aa84a32ab83a4e50d909259b2041cb13e">infoPng</a>.<a class="code" href="struct_lode_p_n_g___info_png.html#a4b87ec9649e7177af7a5f5e08e5bc491">height</a>;</div>
<div class="line"><a name="l04127"></a><span class="lineno"> 4127</span>&#160;  <a class="code" href="lodepng_8cpp.html#aa28cca4bd765525e9f777bc4a7c50ced">LodePNG_Decoder_cleanup</a>(&amp;decoder);</div>
<div class="line"><a name="l04128"></a><span class="lineno"> 4128</span>&#160;  <span class="keywordflow">return</span> error;</div>
<div class="line"><a name="l04129"></a><span class="lineno"> 4129</span>&#160;}</div>
<div class="line"><a name="l04130"></a><span class="lineno"> 4130</span>&#160;</div>
<div class="line"><a name="l04131"></a><span class="lineno"><a class="line" href="lodepng_8h.html#a08b94fef98f8164a529fc60330647479"> 4131</a></span>&#160;<span class="keywordtype">unsigned</span> <a class="code" href="lodepng_8cpp.html#a08b94fef98f8164a529fc60330647479">LodePNG_decode32</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>** out, <span class="keywordtype">unsigned</span>* w, <span class="keywordtype">unsigned</span>* h, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* in, <span class="keywordtype">size_t</span> insize)</div>
<div class="line"><a name="l04132"></a><span class="lineno"> 4132</span>&#160;{</div>
<div class="line"><a name="l04133"></a><span class="lineno"> 4133</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="lodepng_8cpp.html#a720d71deb4b13a7ca7ab683e9367a61e">LodePNG_decode</a>(out, w, h, in, insize, 6, 8);</div>
<div class="line"><a name="l04134"></a><span class="lineno"> 4134</span>&#160;}</div>
<div class="line"><a name="l04135"></a><span class="lineno"> 4135</span>&#160;</div>
<div class="line"><a name="l04136"></a><span class="lineno"><a class="line" href="lodepng_8h.html#aa45fcc1f7d9966d67adf624481dd6ff4"> 4136</a></span>&#160;<span class="keywordtype">unsigned</span> <a class="code" href="lodepng_8cpp.html#aa45fcc1f7d9966d67adf624481dd6ff4">LodePNG_decode24</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>** out, <span class="keywordtype">unsigned</span>* w, <span class="keywordtype">unsigned</span>* h, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* in, <span class="keywordtype">size_t</span> insize)</div>
<div class="line"><a name="l04137"></a><span class="lineno"> 4137</span>&#160;{</div>
<div class="line"><a name="l04138"></a><span class="lineno"> 4138</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="lodepng_8cpp.html#a720d71deb4b13a7ca7ab683e9367a61e">LodePNG_decode</a>(out, w, h, in, insize, 2, 8);</div>
<div class="line"><a name="l04139"></a><span class="lineno"> 4139</span>&#160;}</div>
<div class="line"><a name="l04140"></a><span class="lineno"> 4140</span>&#160;</div>
<div class="line"><a name="l04141"></a><span class="lineno"> 4141</span>&#160;<span class="preprocessor">#ifdef LODEPNG_COMPILE_DISK</span></div>
<div class="line"><a name="l04142"></a><span class="lineno"><a class="line" href="lodepng_8h.html#a988f89f0cd9d740e7310ecdfa79db5d5"> 4142</a></span>&#160;<span class="preprocessor"></span><span class="keywordtype">unsigned</span> <a class="code" href="lodepng_8cpp.html#a988f89f0cd9d740e7310ecdfa79db5d5">LodePNG_decode_file</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>** out, <span class="keywordtype">unsigned</span>* w, <span class="keywordtype">unsigned</span>* h, <span class="keyword">const</span> <span class="keywordtype">char</span>* filename,</div>
<div class="line"><a name="l04143"></a><span class="lineno"> 4143</span>&#160;                             <span class="keywordtype">unsigned</span> colorType, <span class="keywordtype">unsigned</span> bitDepth)</div>
<div class="line"><a name="l04144"></a><span class="lineno"> 4144</span>&#160;{</div>
<div class="line"><a name="l04145"></a><span class="lineno"> 4145</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* <a class="code" href="_d_l_l_imports_8inl.html#a9dbca2ffca3195a70ff9a21d5c97b242">buffer</a>;</div>
<div class="line"><a name="l04146"></a><span class="lineno"> 4146</span>&#160;  <span class="keywordtype">size_t</span> buffersize;</div>
<div class="line"><a name="l04147"></a><span class="lineno"> 4147</span>&#160;  <span class="keywordtype">unsigned</span> error;</div>
<div class="line"><a name="l04148"></a><span class="lineno"> 4148</span>&#160;  error = <a class="code" href="lodepng_8cpp.html#aca6d9a07dd0805433de47feb04e0fc52">LodePNG_loadFile</a>(&amp;buffer, &amp;buffersize, filename);</div>
<div class="line"><a name="l04149"></a><span class="lineno"> 4149</span>&#160;  <span class="keywordflow">if</span>(!error) error = <a class="code" href="lodepng_8cpp.html#a720d71deb4b13a7ca7ab683e9367a61e">LodePNG_decode</a>(out, w, h, buffer, buffersize, colorType, bitDepth);</div>
<div class="line"><a name="l04150"></a><span class="lineno"> 4150</span>&#160;  <a class="code" href="namespace_f_w.html#a93be8f55938d6ffb5ca0af1f95f81589">free</a>(buffer);</div>
<div class="line"><a name="l04151"></a><span class="lineno"> 4151</span>&#160;  <span class="keywordflow">return</span> error;</div>
<div class="line"><a name="l04152"></a><span class="lineno"> 4152</span>&#160;}</div>
<div class="line"><a name="l04153"></a><span class="lineno"> 4153</span>&#160;</div>
<div class="line"><a name="l04154"></a><span class="lineno"><a class="line" href="lodepng_8h.html#aaddd7d56dc63d15b1e142e803c4a408a"> 4154</a></span>&#160;<span class="keywordtype">unsigned</span> <a class="code" href="lodepng_8cpp.html#aaddd7d56dc63d15b1e142e803c4a408a">LodePNG_decode32_file</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>** out, <span class="keywordtype">unsigned</span>* w, <span class="keywordtype">unsigned</span>* h, <span class="keyword">const</span> <span class="keywordtype">char</span>* filename)</div>
<div class="line"><a name="l04155"></a><span class="lineno"> 4155</span>&#160;{</div>
<div class="line"><a name="l04156"></a><span class="lineno"> 4156</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="lodepng_8cpp.html#a988f89f0cd9d740e7310ecdfa79db5d5">LodePNG_decode_file</a>(out, w, h, filename, 6, 8);</div>
<div class="line"><a name="l04157"></a><span class="lineno"> 4157</span>&#160;}</div>
<div class="line"><a name="l04158"></a><span class="lineno"> 4158</span>&#160;</div>
<div class="line"><a name="l04159"></a><span class="lineno"><a class="line" href="lodepng_8h.html#ac88579bb0993b9f3df5d634a10afb74f"> 4159</a></span>&#160;<span class="keywordtype">unsigned</span> <a class="code" href="lodepng_8cpp.html#ac88579bb0993b9f3df5d634a10afb74f">LodePNG_decode24_file</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>** out, <span class="keywordtype">unsigned</span>* w, <span class="keywordtype">unsigned</span>* h, <span class="keyword">const</span> <span class="keywordtype">char</span>* filename)</div>
<div class="line"><a name="l04160"></a><span class="lineno"> 4160</span>&#160;{</div>
<div class="line"><a name="l04161"></a><span class="lineno"> 4161</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="lodepng_8cpp.html#a988f89f0cd9d740e7310ecdfa79db5d5">LodePNG_decode_file</a>(out, w, h, filename, 2, 8);</div>
<div class="line"><a name="l04162"></a><span class="lineno"> 4162</span>&#160;}</div>
<div class="line"><a name="l04163"></a><span class="lineno"> 4163</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/*LODEPNG_COMPILE_DISK*/</span><span class="preprocessor"></span></div>
<div class="line"><a name="l04164"></a><span class="lineno"> 4164</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l04165"></a><span class="lineno"><a class="line" href="lodepng_8h.html#aa9aea0a1381bbd4357058eaecb56cbb3"> 4165</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="lodepng_8cpp.html#aa9aea0a1381bbd4357058eaecb56cbb3">LodePNG_DecodeSettings_init</a>(<a class="code" href="struct_lode_p_n_g___decode_settings.html">LodePNG_DecodeSettings</a>* settings)</div>
<div class="line"><a name="l04166"></a><span class="lineno"> 4166</span>&#160;{</div>
<div class="line"><a name="l04167"></a><span class="lineno"> 4167</span>&#160;  settings-&gt;<a class="code" href="struct_lode_p_n_g___decode_settings.html#a30c0660818a6551d0ffdc1600ad42167">color_convert</a> = 1;</div>
<div class="line"><a name="l04168"></a><span class="lineno"> 4168</span>&#160;<span class="preprocessor">#ifdef LODEPNG_COMPILE_ANCILLARY_CHUNKS</span></div>
<div class="line"><a name="l04169"></a><span class="lineno"> 4169</span>&#160;<span class="preprocessor"></span>  settings-&gt;<a class="code" href="struct_lode_p_n_g___decode_settings.html#af46b8d4852b5af72cf712a98cf78f44b">readTextChunks</a> = 1;</div>
<div class="line"><a name="l04170"></a><span class="lineno"> 4170</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/*LODEPNG_COMPILE_ANCILLARY_CHUNKS*/</span><span class="preprocessor"></span></div>
<div class="line"><a name="l04171"></a><span class="lineno"> 4171</span>&#160;<span class="preprocessor"></span>  settings-&gt;<a class="code" href="struct_lode_p_n_g___decode_settings.html#a08d95fa78ebdfcdeb8dcb05ccee6716c">ignoreCrc</a> = 0;</div>
<div class="line"><a name="l04172"></a><span class="lineno"> 4172</span>&#160;<span class="preprocessor">#ifdef LODEPNG_COMPILE_UNKNOWN_CHUNKS</span></div>
<div class="line"><a name="l04173"></a><span class="lineno"> 4173</span>&#160;<span class="preprocessor"></span>  settings-&gt;<a class="code" href="struct_lode_p_n_g___decode_settings.html#aeab30cd87a6bb9334a77e4f32422a4b8">rememberUnknownChunks</a> = 0;</div>
<div class="line"><a name="l04174"></a><span class="lineno"> 4174</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/*LODEPNG_COMPILE_UNKNOWN_CHUNKS*/</span><span class="preprocessor"></span></div>
<div class="line"><a name="l04175"></a><span class="lineno"> 4175</span>&#160;<span class="preprocessor"></span>  <a class="code" href="lodepng_8cpp.html#a5ac964beddc20407668774ebf7804fc4">LodePNG_DecompressSettings_init</a>(&amp;settings-&gt;<a class="code" href="struct_lode_p_n_g___decode_settings.html#af8de90c1410b0ad33c4d2712cafef26e">zlibsettings</a>);</div>
<div class="line"><a name="l04176"></a><span class="lineno"> 4176</span>&#160;}</div>
<div class="line"><a name="l04177"></a><span class="lineno"> 4177</span>&#160;</div>
<div class="line"><a name="l04178"></a><span class="lineno"><a class="line" href="lodepng_8h.html#a313e972622f025eba50616c62ff033d0"> 4178</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="lodepng_8cpp.html#a313e972622f025eba50616c62ff033d0">LodePNG_Decoder_init</a>(<a class="code" href="struct_lode_p_n_g___decoder.html">LodePNG_Decoder</a>* decoder)</div>
<div class="line"><a name="l04179"></a><span class="lineno"> 4179</span>&#160;{</div>
<div class="line"><a name="l04180"></a><span class="lineno"> 4180</span>&#160;  <a class="code" href="lodepng_8cpp.html#aa9aea0a1381bbd4357058eaecb56cbb3">LodePNG_DecodeSettings_init</a>(&amp;decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#a03ad3505caf0cba6de6cadfd41b9067e">settings</a>);</div>
<div class="line"><a name="l04181"></a><span class="lineno"> 4181</span>&#160;  <a class="code" href="lodepng_8cpp.html#a279c66151f5c87b2225ebe866ce98f71">LodePNG_InfoRaw_init</a>(&amp;decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#abfd722a76000f55a38d99b34ec596720">infoRaw</a>);</div>
<div class="line"><a name="l04182"></a><span class="lineno"> 4182</span>&#160;  <a class="code" href="lodepng_8cpp.html#a66ddccc82c59e05d746086f56997b4cd">LodePNG_InfoPng_init</a>(&amp;decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#aa84a32ab83a4e50d909259b2041cb13e">infoPng</a>);</div>
<div class="line"><a name="l04183"></a><span class="lineno"> 4183</span>&#160;  decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#a1986e8d73bf733140e2de07993685983">error</a> = 1;</div>
<div class="line"><a name="l04184"></a><span class="lineno"> 4184</span>&#160;}</div>
<div class="line"><a name="l04185"></a><span class="lineno"> 4185</span>&#160;</div>
<div class="line"><a name="l04186"></a><span class="lineno"><a class="line" href="lodepng_8h.html#aa28cca4bd765525e9f777bc4a7c50ced"> 4186</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="lodepng_8cpp.html#aa28cca4bd765525e9f777bc4a7c50ced">LodePNG_Decoder_cleanup</a>(<a class="code" href="struct_lode_p_n_g___decoder.html">LodePNG_Decoder</a>* decoder)</div>
<div class="line"><a name="l04187"></a><span class="lineno"> 4187</span>&#160;{</div>
<div class="line"><a name="l04188"></a><span class="lineno"> 4188</span>&#160;  <a class="code" href="lodepng_8cpp.html#ae8ee35b701bba217323f27723d2690f5">LodePNG_InfoRaw_cleanup</a>(&amp;decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#abfd722a76000f55a38d99b34ec596720">infoRaw</a>);</div>
<div class="line"><a name="l04189"></a><span class="lineno"> 4189</span>&#160;  <a class="code" href="lodepng_8cpp.html#a7884592df167f7136fc928cacf1efd36">LodePNG_InfoPng_cleanup</a>(&amp;decoder-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#aa84a32ab83a4e50d909259b2041cb13e">infoPng</a>);</div>
<div class="line"><a name="l04190"></a><span class="lineno"> 4190</span>&#160;}</div>
<div class="line"><a name="l04191"></a><span class="lineno"> 4191</span>&#160;</div>
<div class="line"><a name="l04192"></a><span class="lineno"><a class="line" href="lodepng_8h.html#af9bcef894a1ff5d76f2fabd23365d289"> 4192</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="lodepng_8cpp.html#af9bcef894a1ff5d76f2fabd23365d289">LodePNG_Decoder_copy</a>(<a class="code" href="struct_lode_p_n_g___decoder.html">LodePNG_Decoder</a>* dest, <span class="keyword">const</span> <a class="code" href="struct_lode_p_n_g___decoder.html">LodePNG_Decoder</a>* source)</div>
<div class="line"><a name="l04193"></a><span class="lineno"> 4193</span>&#160;{</div>
<div class="line"><a name="l04194"></a><span class="lineno"> 4194</span>&#160;  <a class="code" href="lodepng_8cpp.html#aa28cca4bd765525e9f777bc4a7c50ced">LodePNG_Decoder_cleanup</a>(dest);</div>
<div class="line"><a name="l04195"></a><span class="lineno"> 4195</span>&#160;  *dest = *source;</div>
<div class="line"><a name="l04196"></a><span class="lineno"> 4196</span>&#160;  <a class="code" href="lodepng_8cpp.html#a279c66151f5c87b2225ebe866ce98f71">LodePNG_InfoRaw_init</a>(&amp;dest-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#abfd722a76000f55a38d99b34ec596720">infoRaw</a>);</div>
<div class="line"><a name="l04197"></a><span class="lineno"> 4197</span>&#160;  <a class="code" href="lodepng_8cpp.html#a66ddccc82c59e05d746086f56997b4cd">LodePNG_InfoPng_init</a>(&amp;dest-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#aa84a32ab83a4e50d909259b2041cb13e">infoPng</a>);</div>
<div class="line"><a name="l04198"></a><span class="lineno"> 4198</span>&#160;  dest-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#a1986e8d73bf733140e2de07993685983">error</a> = <a class="code" href="lodepng_8cpp.html#a745b94bf14f6c3497b6280863e71e5a6">LodePNG_InfoRaw_copy</a>(&amp;dest-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#abfd722a76000f55a38d99b34ec596720">infoRaw</a>, &amp;source-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#abfd722a76000f55a38d99b34ec596720">infoRaw</a>); <span class="keywordflow">if</span>(dest-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#a1986e8d73bf733140e2de07993685983">error</a>) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l04199"></a><span class="lineno"> 4199</span>&#160;  dest-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#a1986e8d73bf733140e2de07993685983">error</a> = <a class="code" href="lodepng_8cpp.html#a0e188efe0b87e1b7d11a01ff85881368">LodePNG_InfoPng_copy</a>(&amp;dest-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#aa84a32ab83a4e50d909259b2041cb13e">infoPng</a>, &amp;source-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#aa84a32ab83a4e50d909259b2041cb13e">infoPng</a>); <span class="keywordflow">if</span>(dest-&gt;<a class="code" href="struct_lode_p_n_g___decoder.html#a1986e8d73bf733140e2de07993685983">error</a>) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l04200"></a><span class="lineno"> 4200</span>&#160;}</div>
<div class="line"><a name="l04201"></a><span class="lineno"> 4201</span>&#160;</div>
<div class="line"><a name="l04202"></a><span class="lineno"> 4202</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/*LODEPNG_COMPILE_DECODER*/</span><span class="preprocessor"></span></div>
<div class="line"><a name="l04203"></a><span class="lineno"> 4203</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l04204"></a><span class="lineno"> 4204</span>&#160;<span class="preprocessor">#ifdef LODEPNG_COMPILE_ENCODER</span></div>
<div class="line"><a name="l04205"></a><span class="lineno"> 4205</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l04206"></a><span class="lineno"> 4206</span>&#160;<span class="comment">/* ////////////////////////////////////////////////////////////////////////// */</span></div>
<div class="line"><a name="l04207"></a><span class="lineno"> 4207</span>&#160;<span class="comment">/* / PNG Encoder                                                            / */</span></div>
<div class="line"><a name="l04208"></a><span class="lineno"> 4208</span>&#160;<span class="comment">/* ////////////////////////////////////////////////////////////////////////// */</span></div>
<div class="line"><a name="l04209"></a><span class="lineno"> 4209</span>&#160;</div>
<div class="line"><a name="l04210"></a><span class="lineno"> 4210</span>&#160;<span class="comment">/*chunkName must be string of 4 characters*/</span></div>
<div class="line"><a name="l04211"></a><span class="lineno"> 4211</span>&#160;<span class="keyword">static</span> <span class="keywordtype">unsigned</span> addChunk(<a class="code" href="structucvector.html">ucvector</a>* out, <span class="keyword">const</span> <span class="keywordtype">char</span>* chunkName, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* data, <span class="keywordtype">size_t</span> length)</div>
<div class="line"><a name="l04212"></a><span class="lineno"> 4212</span>&#160;{</div>
<div class="line"><a name="l04213"></a><span class="lineno"> 4213</span>&#160;  <span class="keywordtype">unsigned</span> error = <a class="code" href="lodepng_8cpp.html#a75457d20497de64abea3a34daefc4f8c">LodePNG_create_chunk</a>(&amp;out-&gt;<a class="code" href="structucvector.html#ace794c5713208c5a20f21762cd87c919">data</a>, &amp;out-&gt;<a class="code" href="structucvector.html#a27c99c34de0c5b3ca0c242d402c69499">size</a>, (<span class="keywordtype">unsigned</span>)length, chunkName, data);</div>
<div class="line"><a name="l04214"></a><span class="lineno"> 4214</span>&#160;  <span class="keywordflow">if</span>(error) <span class="keywordflow">return</span> error;</div>
<div class="line"><a name="l04215"></a><span class="lineno"> 4215</span>&#160;  out-&gt;<a class="code" href="structucvector.html#a235168baac13f0c78bd3e309dc170f90">allocsize</a> = out-&gt;<a class="code" href="structucvector.html#a27c99c34de0c5b3ca0c242d402c69499">size</a>; <span class="comment">/*fix the allocsize again*/</span></div>
<div class="line"><a name="l04216"></a><span class="lineno"> 4216</span>&#160;  <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l04217"></a><span class="lineno"> 4217</span>&#160;}</div>
<div class="line"><a name="l04218"></a><span class="lineno"> 4218</span>&#160;</div>
<div class="line"><a name="l04219"></a><span class="lineno"> 4219</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> writeSignature(<a class="code" href="structucvector.html">ucvector</a>* out)</div>
<div class="line"><a name="l04220"></a><span class="lineno"> 4220</span>&#160;{</div>
<div class="line"><a name="l04221"></a><span class="lineno"> 4221</span>&#160;  <span class="comment">/*8 bytes PNG signature, aka the magic bytes*/</span></div>
<div class="line"><a name="l04222"></a><span class="lineno"> 4222</span>&#160;  ucvector_push_back(out, 137);</div>
<div class="line"><a name="l04223"></a><span class="lineno"> 4223</span>&#160;  ucvector_push_back(out, 80);</div>
<div class="line"><a name="l04224"></a><span class="lineno"> 4224</span>&#160;  ucvector_push_back(out, 78);</div>
<div class="line"><a name="l04225"></a><span class="lineno"> 4225</span>&#160;  ucvector_push_back(out, 71);</div>
<div class="line"><a name="l04226"></a><span class="lineno"> 4226</span>&#160;  ucvector_push_back(out, 13);</div>
<div class="line"><a name="l04227"></a><span class="lineno"> 4227</span>&#160;  ucvector_push_back(out, 10);</div>
<div class="line"><a name="l04228"></a><span class="lineno"> 4228</span>&#160;  ucvector_push_back(out, 26);</div>
<div class="line"><a name="l04229"></a><span class="lineno"> 4229</span>&#160;  ucvector_push_back(out, 10);</div>
<div class="line"><a name="l04230"></a><span class="lineno"> 4230</span>&#160;}</div>
<div class="line"><a name="l04231"></a><span class="lineno"> 4231</span>&#160;</div>
<div class="line"><a name="l04232"></a><span class="lineno"> 4232</span>&#160;<span class="keyword">static</span> <span class="keywordtype">unsigned</span> addChunk_IHDR(<a class="code" href="structucvector.html">ucvector</a>* out, <span class="keywordtype">unsigned</span> w, <span class="keywordtype">unsigned</span> h, <span class="keywordtype">unsigned</span> bitDepth,</div>
<div class="line"><a name="l04233"></a><span class="lineno"> 4233</span>&#160;                              <span class="keywordtype">unsigned</span> colorType, <span class="keywordtype">unsigned</span> interlaceMethod)</div>
<div class="line"><a name="l04234"></a><span class="lineno"> 4234</span>&#160;{</div>
<div class="line"><a name="l04235"></a><span class="lineno"> 4235</span>&#160;  <span class="keywordtype">unsigned</span> error = 0;</div>
<div class="line"><a name="l04236"></a><span class="lineno"> 4236</span>&#160;  <a class="code" href="structucvector.html">ucvector</a> header;</div>
<div class="line"><a name="l04237"></a><span class="lineno"> 4237</span>&#160;  ucvector_init(&amp;header);</div>
<div class="line"><a name="l04238"></a><span class="lineno"> 4238</span>&#160;</div>
<div class="line"><a name="l04239"></a><span class="lineno"> 4239</span>&#160;  LodePNG_add32bitInt(&amp;header, w); <span class="comment">/*width*/</span></div>
<div class="line"><a name="l04240"></a><span class="lineno"> 4240</span>&#160;  LodePNG_add32bitInt(&amp;header, h); <span class="comment">/*height*/</span></div>
<div class="line"><a name="l04241"></a><span class="lineno"> 4241</span>&#160;  ucvector_push_back(&amp;header, (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>)bitDepth); <span class="comment">/*bit depth*/</span></div>
<div class="line"><a name="l04242"></a><span class="lineno"> 4242</span>&#160;  ucvector_push_back(&amp;header, (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>)colorType); <span class="comment">/*color type*/</span></div>
<div class="line"><a name="l04243"></a><span class="lineno"> 4243</span>&#160;  ucvector_push_back(&amp;header, 0); <span class="comment">/*compression method*/</span></div>
<div class="line"><a name="l04244"></a><span class="lineno"> 4244</span>&#160;  ucvector_push_back(&amp;header, 0); <span class="comment">/*filter method*/</span></div>
<div class="line"><a name="l04245"></a><span class="lineno"> 4245</span>&#160;  ucvector_push_back(&amp;header, interlaceMethod); <span class="comment">/*interlace method*/</span></div>
<div class="line"><a name="l04246"></a><span class="lineno"> 4246</span>&#160;</div>
<div class="line"><a name="l04247"></a><span class="lineno"> 4247</span>&#160;  error = addChunk(out, <span class="stringliteral">&quot;IHDR&quot;</span>, header.<a class="code" href="structucvector.html#ace794c5713208c5a20f21762cd87c919">data</a>, header.<a class="code" href="structucvector.html#a27c99c34de0c5b3ca0c242d402c69499">size</a>);</div>
<div class="line"><a name="l04248"></a><span class="lineno"> 4248</span>&#160;  ucvector_cleanup(&amp;header);</div>
<div class="line"><a name="l04249"></a><span class="lineno"> 4249</span>&#160;</div>
<div class="line"><a name="l04250"></a><span class="lineno"> 4250</span>&#160;  <span class="keywordflow">return</span> error;</div>
<div class="line"><a name="l04251"></a><span class="lineno"> 4251</span>&#160;}</div>
<div class="line"><a name="l04252"></a><span class="lineno"> 4252</span>&#160;</div>
<div class="line"><a name="l04253"></a><span class="lineno"> 4253</span>&#160;<span class="keyword">static</span> <span class="keywordtype">unsigned</span> addChunk_PLTE(<a class="code" href="structucvector.html">ucvector</a>* out, <span class="keyword">const</span> <a class="code" href="struct_lode_p_n_g___info_color.html">LodePNG_InfoColor</a>* info)</div>
<div class="line"><a name="l04254"></a><span class="lineno"> 4254</span>&#160;{</div>
<div class="line"><a name="l04255"></a><span class="lineno"> 4255</span>&#160;  <span class="keywordtype">unsigned</span> error = 0;</div>
<div class="line"><a name="l04256"></a><span class="lineno"> 4256</span>&#160;  <span class="keywordtype">size_t</span> i;</div>
<div class="line"><a name="l04257"></a><span class="lineno"> 4257</span>&#160;  <a class="code" href="structucvector.html">ucvector</a> PLTE;</div>
<div class="line"><a name="l04258"></a><span class="lineno"> 4258</span>&#160;  ucvector_init(&amp;PLTE);</div>
<div class="line"><a name="l04259"></a><span class="lineno"> 4259</span>&#160;  <span class="keywordflow">for</span>(i = 0; i &lt; info-&gt;<a class="code" href="struct_lode_p_n_g___info_color.html#a49842a304ffd0abc8aa791030c5fa5dd">palettesize</a> * 4; i++)</div>
<div class="line"><a name="l04260"></a><span class="lineno"> 4260</span>&#160;  {</div>
<div class="line"><a name="l04261"></a><span class="lineno"> 4261</span>&#160;    <span class="comment">/*add all channels except alpha channel*/</span></div>
<div class="line"><a name="l04262"></a><span class="lineno"> 4262</span>&#160;    <span class="keywordflow">if</span>(i % 4 != 3) ucvector_push_back(&amp;PLTE, info-&gt;<a class="code" href="struct_lode_p_n_g___info_color.html#ac6de7ff58cb1f39a73567abb826f72f5">palette</a>[i]);</div>
<div class="line"><a name="l04263"></a><span class="lineno"> 4263</span>&#160;  }</div>
<div class="line"><a name="l04264"></a><span class="lineno"> 4264</span>&#160;  error = addChunk(out, <span class="stringliteral">&quot;PLTE&quot;</span>, PLTE.<a class="code" href="structucvector.html#ace794c5713208c5a20f21762cd87c919">data</a>, PLTE.<a class="code" href="structucvector.html#a27c99c34de0c5b3ca0c242d402c69499">size</a>);</div>
<div class="line"><a name="l04265"></a><span class="lineno"> 4265</span>&#160;  ucvector_cleanup(&amp;PLTE);</div>
<div class="line"><a name="l04266"></a><span class="lineno"> 4266</span>&#160;</div>
<div class="line"><a name="l04267"></a><span class="lineno"> 4267</span>&#160;  <span class="keywordflow">return</span> error;</div>
<div class="line"><a name="l04268"></a><span class="lineno"> 4268</span>&#160;}</div>
<div class="line"><a name="l04269"></a><span class="lineno"> 4269</span>&#160;</div>
<div class="line"><a name="l04270"></a><span class="lineno"> 4270</span>&#160;<span class="keyword">static</span> <span class="keywordtype">unsigned</span> addChunk_tRNS(<a class="code" href="structucvector.html">ucvector</a>* out, <span class="keyword">const</span> <a class="code" href="struct_lode_p_n_g___info_color.html">LodePNG_InfoColor</a>* info)</div>
<div class="line"><a name="l04271"></a><span class="lineno"> 4271</span>&#160;{</div>
<div class="line"><a name="l04272"></a><span class="lineno"> 4272</span>&#160;  <span class="keywordtype">unsigned</span> error = 0;</div>
<div class="line"><a name="l04273"></a><span class="lineno"> 4273</span>&#160;  <span class="keywordtype">size_t</span> i;</div>
<div class="line"><a name="l04274"></a><span class="lineno"> 4274</span>&#160;  <a class="code" href="structucvector.html">ucvector</a> tRNS;</div>
<div class="line"><a name="l04275"></a><span class="lineno"> 4275</span>&#160;  ucvector_init(&amp;tRNS);</div>
<div class="line"><a name="l04276"></a><span class="lineno"> 4276</span>&#160;  <span class="keywordflow">if</span>(info-&gt;<a class="code" href="struct_lode_p_n_g___info_color.html#a4ed18d179c5078137a18e742b1c41a00">colorType</a> == 3)</div>
<div class="line"><a name="l04277"></a><span class="lineno"> 4277</span>&#160;  {</div>
<div class="line"><a name="l04278"></a><span class="lineno"> 4278</span>&#160;    <span class="comment">/*add only alpha channel*/</span></div>
<div class="line"><a name="l04279"></a><span class="lineno"> 4279</span>&#160;    <span class="keywordflow">for</span>(i = 0; i &lt; info-&gt;<a class="code" href="struct_lode_p_n_g___info_color.html#a49842a304ffd0abc8aa791030c5fa5dd">palettesize</a>; i++) ucvector_push_back(&amp;tRNS, info-&gt;<a class="code" href="struct_lode_p_n_g___info_color.html#ac6de7ff58cb1f39a73567abb826f72f5">palette</a>[4 * i + 3]);</div>
<div class="line"><a name="l04280"></a><span class="lineno"> 4280</span>&#160;  }</div>
<div class="line"><a name="l04281"></a><span class="lineno"> 4281</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span>(info-&gt;<a class="code" href="struct_lode_p_n_g___info_color.html#a4ed18d179c5078137a18e742b1c41a00">colorType</a> == 0)</div>
<div class="line"><a name="l04282"></a><span class="lineno"> 4282</span>&#160;  {</div>
<div class="line"><a name="l04283"></a><span class="lineno"> 4283</span>&#160;    <span class="keywordflow">if</span>(info-&gt;<a class="code" href="struct_lode_p_n_g___info_color.html#aa0193ce13025c776a0dfb1e6d1bed14a">key_defined</a>)</div>
<div class="line"><a name="l04284"></a><span class="lineno"> 4284</span>&#160;    {</div>
<div class="line"><a name="l04285"></a><span class="lineno"> 4285</span>&#160;      ucvector_push_back(&amp;tRNS, (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>)(info-&gt;<a class="code" href="struct_lode_p_n_g___info_color.html#a5536a8859201cd11df789ec7ad8263df">key_r</a> / 256));</div>
<div class="line"><a name="l04286"></a><span class="lineno"> 4286</span>&#160;      ucvector_push_back(&amp;tRNS, (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>)(info-&gt;<a class="code" href="struct_lode_p_n_g___info_color.html#a5536a8859201cd11df789ec7ad8263df">key_r</a> % 256));</div>
<div class="line"><a name="l04287"></a><span class="lineno"> 4287</span>&#160;    }</div>
<div class="line"><a name="l04288"></a><span class="lineno"> 4288</span>&#160;  }</div>
<div class="line"><a name="l04289"></a><span class="lineno"> 4289</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span>(info-&gt;<a class="code" href="struct_lode_p_n_g___info_color.html#a4ed18d179c5078137a18e742b1c41a00">colorType</a> == 2)</div>
<div class="line"><a name="l04290"></a><span class="lineno"> 4290</span>&#160;  {</div>
<div class="line"><a name="l04291"></a><span class="lineno"> 4291</span>&#160;    <span class="keywordflow">if</span>(info-&gt;<a class="code" href="struct_lode_p_n_g___info_color.html#aa0193ce13025c776a0dfb1e6d1bed14a">key_defined</a>)</div>
<div class="line"><a name="l04292"></a><span class="lineno"> 4292</span>&#160;    {</div>
<div class="line"><a name="l04293"></a><span class="lineno"> 4293</span>&#160;      ucvector_push_back(&amp;tRNS, (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>)(info-&gt;<a class="code" href="struct_lode_p_n_g___info_color.html#a5536a8859201cd11df789ec7ad8263df">key_r</a> / 256));</div>
<div class="line"><a name="l04294"></a><span class="lineno"> 4294</span>&#160;      ucvector_push_back(&amp;tRNS, (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>)(info-&gt;<a class="code" href="struct_lode_p_n_g___info_color.html#a5536a8859201cd11df789ec7ad8263df">key_r</a> % 256));</div>
<div class="line"><a name="l04295"></a><span class="lineno"> 4295</span>&#160;      ucvector_push_back(&amp;tRNS, (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>)(info-&gt;<a class="code" href="struct_lode_p_n_g___info_color.html#a44bf4906335328972acebd6c8b83a073">key_g</a> / 256));</div>
<div class="line"><a name="l04296"></a><span class="lineno"> 4296</span>&#160;      ucvector_push_back(&amp;tRNS, (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>)(info-&gt;<a class="code" href="struct_lode_p_n_g___info_color.html#a44bf4906335328972acebd6c8b83a073">key_g</a> % 256));</div>
<div class="line"><a name="l04297"></a><span class="lineno"> 4297</span>&#160;      ucvector_push_back(&amp;tRNS, (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>)(info-&gt;<a class="code" href="struct_lode_p_n_g___info_color.html#a9f99cc5b4366f1eed325d13b4f191560">key_b</a> / 256));</div>
<div class="line"><a name="l04298"></a><span class="lineno"> 4298</span>&#160;      ucvector_push_back(&amp;tRNS, (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>)(info-&gt;<a class="code" href="struct_lode_p_n_g___info_color.html#a9f99cc5b4366f1eed325d13b4f191560">key_b</a> % 256));</div>
<div class="line"><a name="l04299"></a><span class="lineno"> 4299</span>&#160;    }</div>
<div class="line"><a name="l04300"></a><span class="lineno"> 4300</span>&#160;  }</div>
<div class="line"><a name="l04301"></a><span class="lineno"> 4301</span>&#160;</div>
<div class="line"><a name="l04302"></a><span class="lineno"> 4302</span>&#160;  error = addChunk(out, <span class="stringliteral">&quot;tRNS&quot;</span>, tRNS.<a class="code" href="structucvector.html#ace794c5713208c5a20f21762cd87c919">data</a>, tRNS.<a class="code" href="structucvector.html#a27c99c34de0c5b3ca0c242d402c69499">size</a>);</div>
<div class="line"><a name="l04303"></a><span class="lineno"> 4303</span>&#160;  ucvector_cleanup(&amp;tRNS);</div>
<div class="line"><a name="l04304"></a><span class="lineno"> 4304</span>&#160;</div>
<div class="line"><a name="l04305"></a><span class="lineno"> 4305</span>&#160;  <span class="keywordflow">return</span> error;</div>
<div class="line"><a name="l04306"></a><span class="lineno"> 4306</span>&#160;}</div>
<div class="line"><a name="l04307"></a><span class="lineno"> 4307</span>&#160;</div>
<div class="line"><a name="l04308"></a><span class="lineno"> 4308</span>&#160;<span class="keyword">static</span> <span class="keywordtype">unsigned</span> addChunk_IDAT(<a class="code" href="structucvector.html">ucvector</a>* out, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* data, <span class="keywordtype">size_t</span> datasize,</div>
<div class="line"><a name="l04309"></a><span class="lineno"> 4309</span>&#160;                              <a class="code" href="struct_lode_p_n_g___compress_settings.html">LodePNG_CompressSettings</a>* zlibsettings)</div>
<div class="line"><a name="l04310"></a><span class="lineno"> 4310</span>&#160;{</div>
<div class="line"><a name="l04311"></a><span class="lineno"> 4311</span>&#160;  <a class="code" href="structucvector.html">ucvector</a> zlibdata;</div>
<div class="line"><a name="l04312"></a><span class="lineno"> 4312</span>&#160;  <span class="keywordtype">unsigned</span> error = 0;</div>
<div class="line"><a name="l04313"></a><span class="lineno"> 4313</span>&#160;</div>
<div class="line"><a name="l04314"></a><span class="lineno"> 4314</span>&#160;  <span class="comment">/*compress with the Zlib compressor*/</span></div>
<div class="line"><a name="l04315"></a><span class="lineno"> 4315</span>&#160;  ucvector_init(&amp;zlibdata);</div>
<div class="line"><a name="l04316"></a><span class="lineno"> 4316</span>&#160;  error = <a class="code" href="lodepng_8cpp.html#aa2ff174234767c087c7ba974ba862be9">LodePNG_zlib_compress</a>(&amp;zlibdata.<a class="code" href="structucvector.html#ace794c5713208c5a20f21762cd87c919">data</a>, &amp;zlibdata.<a class="code" href="structucvector.html#a27c99c34de0c5b3ca0c242d402c69499">size</a>, data, datasize, zlibsettings);</div>
<div class="line"><a name="l04317"></a><span class="lineno"> 4317</span>&#160;  <span class="keywordflow">if</span>(!error) error = addChunk(out, <span class="stringliteral">&quot;IDAT&quot;</span>, zlibdata.<a class="code" href="structucvector.html#ace794c5713208c5a20f21762cd87c919">data</a>, zlibdata.<a class="code" href="structucvector.html#a27c99c34de0c5b3ca0c242d402c69499">size</a>);</div>
<div class="line"><a name="l04318"></a><span class="lineno"> 4318</span>&#160;  ucvector_cleanup(&amp;zlibdata);</div>
<div class="line"><a name="l04319"></a><span class="lineno"> 4319</span>&#160;</div>
<div class="line"><a name="l04320"></a><span class="lineno"> 4320</span>&#160;  <span class="keywordflow">return</span> error;</div>
<div class="line"><a name="l04321"></a><span class="lineno"> 4321</span>&#160;}</div>
<div class="line"><a name="l04322"></a><span class="lineno"> 4322</span>&#160;</div>
<div class="line"><a name="l04323"></a><span class="lineno"> 4323</span>&#160;<span class="keyword">static</span> <span class="keywordtype">unsigned</span> addChunk_IEND(<a class="code" href="structucvector.html">ucvector</a>* out)</div>
<div class="line"><a name="l04324"></a><span class="lineno"> 4324</span>&#160;{</div>
<div class="line"><a name="l04325"></a><span class="lineno"> 4325</span>&#160;  <span class="keywordtype">unsigned</span> error = 0;</div>
<div class="line"><a name="l04326"></a><span class="lineno"> 4326</span>&#160;  error = addChunk(out, <span class="stringliteral">&quot;IEND&quot;</span>, 0, 0);</div>
<div class="line"><a name="l04327"></a><span class="lineno"> 4327</span>&#160;  <span class="keywordflow">return</span> error;</div>
<div class="line"><a name="l04328"></a><span class="lineno"> 4328</span>&#160;}</div>
<div class="line"><a name="l04329"></a><span class="lineno"> 4329</span>&#160;</div>
<div class="line"><a name="l04330"></a><span class="lineno"> 4330</span>&#160;<span class="preprocessor">#ifdef LODEPNG_COMPILE_ANCILLARY_CHUNKS</span></div>
<div class="line"><a name="l04331"></a><span class="lineno"> 4331</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l04332"></a><span class="lineno"> 4332</span>&#160;<span class="keyword">static</span> <span class="keywordtype">unsigned</span> addChunk_tEXt(<a class="code" href="structucvector.html">ucvector</a>* out, <span class="keyword">const</span> <span class="keywordtype">char</span>* keyword, <span class="keyword">const</span> <span class="keywordtype">char</span>* textstring)</div>
<div class="line"><a name="l04333"></a><span class="lineno"> 4333</span>&#160;{</div>
<div class="line"><a name="l04334"></a><span class="lineno"> 4334</span>&#160;  <span class="keywordtype">unsigned</span> error = 0;</div>
<div class="line"><a name="l04335"></a><span class="lineno"> 4335</span>&#160;  <span class="keywordtype">size_t</span> i;</div>
<div class="line"><a name="l04336"></a><span class="lineno"> 4336</span>&#160;  <a class="code" href="structucvector.html">ucvector</a> text;</div>
<div class="line"><a name="l04337"></a><span class="lineno"> 4337</span>&#160;  ucvector_init(&amp;text);</div>
<div class="line"><a name="l04338"></a><span class="lineno"> 4338</span>&#160;  <span class="keywordflow">for</span>(i = 0; keyword[i] != 0; i++) ucvector_push_back(&amp;text, (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>)keyword[i]);</div>
<div class="line"><a name="l04339"></a><span class="lineno"> 4339</span>&#160;  ucvector_push_back(&amp;text, 0);</div>
<div class="line"><a name="l04340"></a><span class="lineno"> 4340</span>&#160;  <span class="keywordflow">for</span>(i = 0; textstring[i] != 0; i++) ucvector_push_back(&amp;text, (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>)textstring[i]);</div>
<div class="line"><a name="l04341"></a><span class="lineno"> 4341</span>&#160;  error = addChunk(out, <span class="stringliteral">&quot;tEXt&quot;</span>, text.<a class="code" href="structucvector.html#ace794c5713208c5a20f21762cd87c919">data</a>, text.<a class="code" href="structucvector.html#a27c99c34de0c5b3ca0c242d402c69499">size</a>);</div>
<div class="line"><a name="l04342"></a><span class="lineno"> 4342</span>&#160;  ucvector_cleanup(&amp;text);</div>
<div class="line"><a name="l04343"></a><span class="lineno"> 4343</span>&#160;</div>
<div class="line"><a name="l04344"></a><span class="lineno"> 4344</span>&#160;  <span class="keywordflow">return</span> error;</div>
<div class="line"><a name="l04345"></a><span class="lineno"> 4345</span>&#160;}</div>
<div class="line"><a name="l04346"></a><span class="lineno"> 4346</span>&#160;</div>
<div class="line"><a name="l04347"></a><span class="lineno"> 4347</span>&#160;<span class="keyword">static</span> <span class="keywordtype">unsigned</span> addChunk_zTXt(<a class="code" href="structucvector.html">ucvector</a>* out, <span class="keyword">const</span> <span class="keywordtype">char</span>* keyword, <span class="keyword">const</span> <span class="keywordtype">char</span>* textstring,</div>
<div class="line"><a name="l04348"></a><span class="lineno"> 4348</span>&#160;                              <a class="code" href="struct_lode_p_n_g___compress_settings.html">LodePNG_CompressSettings</a>* zlibsettings)</div>
<div class="line"><a name="l04349"></a><span class="lineno"> 4349</span>&#160;{</div>
<div class="line"><a name="l04350"></a><span class="lineno"> 4350</span>&#160;  <span class="keywordtype">unsigned</span> error = 0;</div>
<div class="line"><a name="l04351"></a><span class="lineno"> 4351</span>&#160;  <a class="code" href="structucvector.html">ucvector</a> <a class="code" href="_d_l_l_imports_8inl.html#a156a9c7e986e0352d0fe500e629d5171">data</a>, compressed;</div>
<div class="line"><a name="l04352"></a><span class="lineno"> 4352</span>&#160;  <span class="keywordtype">size_t</span> i, textsize = strlen(textstring);</div>
<div class="line"><a name="l04353"></a><span class="lineno"> 4353</span>&#160;</div>
<div class="line"><a name="l04354"></a><span class="lineno"> 4354</span>&#160;  ucvector_init(&amp;data);</div>
<div class="line"><a name="l04355"></a><span class="lineno"> 4355</span>&#160;  ucvector_init(&amp;compressed);</div>
<div class="line"><a name="l04356"></a><span class="lineno"> 4356</span>&#160;  <span class="keywordflow">for</span>(i = 0; keyword[i] != 0; i++) ucvector_push_back(&amp;data, (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>)keyword[i]);</div>
<div class="line"><a name="l04357"></a><span class="lineno"> 4357</span>&#160;  ucvector_push_back(&amp;data, 0); <span class="comment">/* 0 termination char*/</span></div>
<div class="line"><a name="l04358"></a><span class="lineno"> 4358</span>&#160;  ucvector_push_back(&amp;data, 0); <span class="comment">/*compression method: 0*/</span></div>
<div class="line"><a name="l04359"></a><span class="lineno"> 4359</span>&#160;</div>
<div class="line"><a name="l04360"></a><span class="lineno"> 4360</span>&#160;  error = <a class="code" href="lodepng_8cpp.html#aa2ff174234767c087c7ba974ba862be9">LodePNG_zlib_compress</a>(&amp;compressed.<a class="code" href="structucvector.html#ace794c5713208c5a20f21762cd87c919">data</a>, &amp;compressed.<a class="code" href="structucvector.html#a27c99c34de0c5b3ca0c242d402c69499">size</a>,</div>
<div class="line"><a name="l04361"></a><span class="lineno"> 4361</span>&#160;                                (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>*)textstring, textsize, zlibsettings);</div>
<div class="line"><a name="l04362"></a><span class="lineno"> 4362</span>&#160;  <span class="keywordflow">if</span>(!error)</div>
<div class="line"><a name="l04363"></a><span class="lineno"> 4363</span>&#160;  {</div>
<div class="line"><a name="l04364"></a><span class="lineno"> 4364</span>&#160;    <span class="keywordflow">for</span>(i = 0; i &lt; compressed.<a class="code" href="structucvector.html#a27c99c34de0c5b3ca0c242d402c69499">size</a>; i++) ucvector_push_back(&amp;data, compressed.<a class="code" href="structucvector.html#ace794c5713208c5a20f21762cd87c919">data</a>[i]);</div>
<div class="line"><a name="l04365"></a><span class="lineno"> 4365</span>&#160;    error = addChunk(out, <span class="stringliteral">&quot;zTXt&quot;</span>, data.<a class="code" href="structucvector.html#ace794c5713208c5a20f21762cd87c919">data</a>, data.<a class="code" href="structucvector.html#a27c99c34de0c5b3ca0c242d402c69499">size</a>);</div>
<div class="line"><a name="l04366"></a><span class="lineno"> 4366</span>&#160;  }</div>
<div class="line"><a name="l04367"></a><span class="lineno"> 4367</span>&#160;</div>
<div class="line"><a name="l04368"></a><span class="lineno"> 4368</span>&#160;  ucvector_cleanup(&amp;compressed);</div>
<div class="line"><a name="l04369"></a><span class="lineno"> 4369</span>&#160;  ucvector_cleanup(&amp;data);</div>
<div class="line"><a name="l04370"></a><span class="lineno"> 4370</span>&#160;  <span class="keywordflow">return</span> error;</div>
<div class="line"><a name="l04371"></a><span class="lineno"> 4371</span>&#160;}</div>
<div class="line"><a name="l04372"></a><span class="lineno"> 4372</span>&#160;</div>
<div class="line"><a name="l04373"></a><span class="lineno"> 4373</span>&#160;<span class="keyword">static</span> <span class="keywordtype">unsigned</span> addChunk_iTXt(<a class="code" href="structucvector.html">ucvector</a>* out, <span class="keywordtype">unsigned</span> compressed, <span class="keyword">const</span> <span class="keywordtype">char</span>* keyword, <span class="keyword">const</span> <span class="keywordtype">char</span>* langtag,</div>
<div class="line"><a name="l04374"></a><span class="lineno"> 4374</span>&#160;                              <span class="keyword">const</span> <span class="keywordtype">char</span>* transkey, <span class="keyword">const</span> <span class="keywordtype">char</span>* textstring, <a class="code" href="struct_lode_p_n_g___compress_settings.html">LodePNG_CompressSettings</a>* zlibsettings)</div>
<div class="line"><a name="l04375"></a><span class="lineno"> 4375</span>&#160;{</div>
<div class="line"><a name="l04376"></a><span class="lineno"> 4376</span>&#160;  <span class="keywordtype">unsigned</span> error = 0;</div>
<div class="line"><a name="l04377"></a><span class="lineno"> 4377</span>&#160;  <a class="code" href="structucvector.html">ucvector</a> <a class="code" href="_d_l_l_imports_8inl.html#a156a9c7e986e0352d0fe500e629d5171">data</a>, compressed_data;</div>
<div class="line"><a name="l04378"></a><span class="lineno"> 4378</span>&#160;  <span class="keywordtype">size_t</span> i, textsize = strlen(textstring);</div>
<div class="line"><a name="l04379"></a><span class="lineno"> 4379</span>&#160;</div>
<div class="line"><a name="l04380"></a><span class="lineno"> 4380</span>&#160;  ucvector_init(&amp;data);</div>
<div class="line"><a name="l04381"></a><span class="lineno"> 4381</span>&#160;</div>
<div class="line"><a name="l04382"></a><span class="lineno"> 4382</span>&#160;  <span class="keywordflow">for</span>(i = 0; keyword[i] != 0; i++) ucvector_push_back(&amp;data, (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>)keyword[i]);</div>
<div class="line"><a name="l04383"></a><span class="lineno"> 4383</span>&#160;  ucvector_push_back(&amp;data, 0); <span class="comment">/*null termination char*/</span></div>
<div class="line"><a name="l04384"></a><span class="lineno"> 4384</span>&#160;  ucvector_push_back(&amp;data, compressed ? 1 : 0); <span class="comment">/*compression flag*/</span></div>
<div class="line"><a name="l04385"></a><span class="lineno"> 4385</span>&#160;  ucvector_push_back(&amp;data, 0); <span class="comment">/*compression method*/</span></div>
<div class="line"><a name="l04386"></a><span class="lineno"> 4386</span>&#160;  <span class="keywordflow">for</span>(i = 0; langtag[i] != 0; i++) ucvector_push_back(&amp;data, (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>)langtag[i]);</div>
<div class="line"><a name="l04387"></a><span class="lineno"> 4387</span>&#160;  ucvector_push_back(&amp;data, 0); <span class="comment">/*null termination char*/</span></div>
<div class="line"><a name="l04388"></a><span class="lineno"> 4388</span>&#160;  <span class="keywordflow">for</span>(i = 0; transkey[i] != 0; i++) ucvector_push_back(&amp;data, (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>)transkey[i]);</div>
<div class="line"><a name="l04389"></a><span class="lineno"> 4389</span>&#160;  ucvector_push_back(&amp;data, 0); <span class="comment">/*null termination char*/</span></div>
<div class="line"><a name="l04390"></a><span class="lineno"> 4390</span>&#160;</div>
<div class="line"><a name="l04391"></a><span class="lineno"> 4391</span>&#160;  <span class="keywordflow">if</span>(compressed)</div>
<div class="line"><a name="l04392"></a><span class="lineno"> 4392</span>&#160;  {</div>
<div class="line"><a name="l04393"></a><span class="lineno"> 4393</span>&#160;    ucvector_init(&amp;compressed_data);</div>
<div class="line"><a name="l04394"></a><span class="lineno"> 4394</span>&#160;    error = <a class="code" href="lodepng_8cpp.html#aa2ff174234767c087c7ba974ba862be9">LodePNG_zlib_compress</a>(&amp;compressed_data.<a class="code" href="structucvector.html#ace794c5713208c5a20f21762cd87c919">data</a>, &amp;compressed_data.<a class="code" href="structucvector.html#a27c99c34de0c5b3ca0c242d402c69499">size</a>,</div>
<div class="line"><a name="l04395"></a><span class="lineno"> 4395</span>&#160;                                  (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>*)textstring, textsize, zlibsettings);</div>
<div class="line"><a name="l04396"></a><span class="lineno"> 4396</span>&#160;    <span class="keywordflow">if</span>(!error)</div>
<div class="line"><a name="l04397"></a><span class="lineno"> 4397</span>&#160;    {</div>
<div class="line"><a name="l04398"></a><span class="lineno"> 4398</span>&#160;      <span class="keywordflow">for</span>(i = 0; i &lt; compressed_data.<a class="code" href="structucvector.html#a27c99c34de0c5b3ca0c242d402c69499">size</a>; i++) ucvector_push_back(&amp;data, compressed_data.<a class="code" href="structucvector.html#ace794c5713208c5a20f21762cd87c919">data</a>[i]);</div>
<div class="line"><a name="l04399"></a><span class="lineno"> 4399</span>&#160;      <span class="keywordflow">for</span>(i = 0; textstring[i] != 0; i++) ucvector_push_back(&amp;data, (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>)textstring[i]);</div>
<div class="line"><a name="l04400"></a><span class="lineno"> 4400</span>&#160;    }</div>
<div class="line"><a name="l04401"></a><span class="lineno"> 4401</span>&#160;  }</div>
<div class="line"><a name="l04402"></a><span class="lineno"> 4402</span>&#160;  <span class="keywordflow">else</span> <span class="comment">/*not compressed*/</span></div>
<div class="line"><a name="l04403"></a><span class="lineno"> 4403</span>&#160;  {</div>
<div class="line"><a name="l04404"></a><span class="lineno"> 4404</span>&#160;    <span class="keywordflow">for</span>(i = 0; textstring[i] != 0; i++) ucvector_push_back(&amp;data, (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>)textstring[i]);</div>
<div class="line"><a name="l04405"></a><span class="lineno"> 4405</span>&#160;  }</div>
<div class="line"><a name="l04406"></a><span class="lineno"> 4406</span>&#160;</div>
<div class="line"><a name="l04407"></a><span class="lineno"> 4407</span>&#160;  <span class="keywordflow">if</span>(!error) error = addChunk(out, <span class="stringliteral">&quot;iTXt&quot;</span>, data.<a class="code" href="structucvector.html#ace794c5713208c5a20f21762cd87c919">data</a>, data.<a class="code" href="structucvector.html#a27c99c34de0c5b3ca0c242d402c69499">size</a>);</div>
<div class="line"><a name="l04408"></a><span class="lineno"> 4408</span>&#160;  ucvector_cleanup(&amp;data);</div>
<div class="line"><a name="l04409"></a><span class="lineno"> 4409</span>&#160;  <span class="keywordflow">return</span> error;</div>
<div class="line"><a name="l04410"></a><span class="lineno"> 4410</span>&#160;}</div>
<div class="line"><a name="l04411"></a><span class="lineno"> 4411</span>&#160;</div>
<div class="line"><a name="l04412"></a><span class="lineno"> 4412</span>&#160;<span class="keyword">static</span> <span class="keywordtype">unsigned</span> addChunk_bKGD(<a class="code" href="structucvector.html">ucvector</a>* out, <span class="keyword">const</span> <a class="code" href="struct_lode_p_n_g___info_png.html">LodePNG_InfoPng</a>* info)</div>
<div class="line"><a name="l04413"></a><span class="lineno"> 4413</span>&#160;{</div>
<div class="line"><a name="l04414"></a><span class="lineno"> 4414</span>&#160;  <span class="keywordtype">unsigned</span> error = 0;</div>
<div class="line"><a name="l04415"></a><span class="lineno"> 4415</span>&#160;  <a class="code" href="structucvector.html">ucvector</a> bKGD;</div>
<div class="line"><a name="l04416"></a><span class="lineno"> 4416</span>&#160;  ucvector_init(&amp;bKGD);</div>
<div class="line"><a name="l04417"></a><span class="lineno"> 4417</span>&#160;  <span class="keywordflow">if</span>(info-&gt;<a class="code" href="struct_lode_p_n_g___info_png.html#acce58518f72f42ba94db4c1cfd69336b">color</a>.<a class="code" href="struct_lode_p_n_g___info_color.html#a4ed18d179c5078137a18e742b1c41a00">colorType</a> == 0 || info-&gt;<a class="code" href="struct_lode_p_n_g___info_png.html#acce58518f72f42ba94db4c1cfd69336b">color</a>.<a class="code" href="struct_lode_p_n_g___info_color.html#a4ed18d179c5078137a18e742b1c41a00">colorType</a> == 4)</div>
<div class="line"><a name="l04418"></a><span class="lineno"> 4418</span>&#160;  {</div>
<div class="line"><a name="l04419"></a><span class="lineno"> 4419</span>&#160;    ucvector_push_back(&amp;bKGD, (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>)(info-&gt;<a class="code" href="struct_lode_p_n_g___info_png.html#afbab2f688332e8c787717f797de8153e">background_r</a> / 256));</div>
<div class="line"><a name="l04420"></a><span class="lineno"> 4420</span>&#160;    ucvector_push_back(&amp;bKGD, (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>)(info-&gt;<a class="code" href="struct_lode_p_n_g___info_png.html#afbab2f688332e8c787717f797de8153e">background_r</a> % 256));</div>
<div class="line"><a name="l04421"></a><span class="lineno"> 4421</span>&#160;  }</div>
<div class="line"><a name="l04422"></a><span class="lineno"> 4422</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span>(info-&gt;<a class="code" href="struct_lode_p_n_g___info_png.html#acce58518f72f42ba94db4c1cfd69336b">color</a>.<a class="code" href="struct_lode_p_n_g___info_color.html#a4ed18d179c5078137a18e742b1c41a00">colorType</a> == 2 || info-&gt;<a class="code" href="struct_lode_p_n_g___info_png.html#acce58518f72f42ba94db4c1cfd69336b">color</a>.<a class="code" href="struct_lode_p_n_g___info_color.html#a4ed18d179c5078137a18e742b1c41a00">colorType</a> == 6)</div>
<div class="line"><a name="l04423"></a><span class="lineno"> 4423</span>&#160;  {</div>
<div class="line"><a name="l04424"></a><span class="lineno"> 4424</span>&#160;    ucvector_push_back(&amp;bKGD, (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>)(info-&gt;<a class="code" href="struct_lode_p_n_g___info_png.html#afbab2f688332e8c787717f797de8153e">background_r</a> / 256));</div>
<div class="line"><a name="l04425"></a><span class="lineno"> 4425</span>&#160;    ucvector_push_back(&amp;bKGD, (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>)(info-&gt;<a class="code" href="struct_lode_p_n_g___info_png.html#afbab2f688332e8c787717f797de8153e">background_r</a> % 256));</div>
<div class="line"><a name="l04426"></a><span class="lineno"> 4426</span>&#160;    ucvector_push_back(&amp;bKGD, (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>)(info-&gt;<a class="code" href="struct_lode_p_n_g___info_png.html#adbda2bda427f0dd6ae1b85daaab21c6c">background_g</a> / 256));</div>
<div class="line"><a name="l04427"></a><span class="lineno"> 4427</span>&#160;    ucvector_push_back(&amp;bKGD, (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>)(info-&gt;<a class="code" href="struct_lode_p_n_g___info_png.html#adbda2bda427f0dd6ae1b85daaab21c6c">background_g</a> % 256));</div>
<div class="line"><a name="l04428"></a><span class="lineno"> 4428</span>&#160;    ucvector_push_back(&amp;bKGD, (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>)(info-&gt;<a class="code" href="struct_lode_p_n_g___info_png.html#a7b8e98bf898590f785930c7b470254bc">background_b</a> / 256));</div>
<div class="line"><a name="l04429"></a><span class="lineno"> 4429</span>&#160;    ucvector_push_back(&amp;bKGD, (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>)(info-&gt;<a class="code" href="struct_lode_p_n_g___info_png.html#a7b8e98bf898590f785930c7b470254bc">background_b</a> % 256));</div>
<div class="line"><a name="l04430"></a><span class="lineno"> 4430</span>&#160;  }</div>
<div class="line"><a name="l04431"></a><span class="lineno"> 4431</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span>(info-&gt;<a class="code" href="struct_lode_p_n_g___info_png.html#acce58518f72f42ba94db4c1cfd69336b">color</a>.<a class="code" href="struct_lode_p_n_g___info_color.html#a4ed18d179c5078137a18e742b1c41a00">colorType</a> == 3)</div>
<div class="line"><a name="l04432"></a><span class="lineno"> 4432</span>&#160;  {</div>
<div class="line"><a name="l04433"></a><span class="lineno"> 4433</span>&#160;    ucvector_push_back(&amp;bKGD, (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>)(info-&gt;<a class="code" href="struct_lode_p_n_g___info_png.html#afbab2f688332e8c787717f797de8153e">background_r</a> % 256)); <span class="comment">/*palette index*/</span></div>
<div class="line"><a name="l04434"></a><span class="lineno"> 4434</span>&#160;  }</div>
<div class="line"><a name="l04435"></a><span class="lineno"> 4435</span>&#160;</div>
<div class="line"><a name="l04436"></a><span class="lineno"> 4436</span>&#160;  error = addChunk(out, <span class="stringliteral">&quot;bKGD&quot;</span>, bKGD.<a class="code" href="structucvector.html#ace794c5713208c5a20f21762cd87c919">data</a>, bKGD.<a class="code" href="structucvector.html#a27c99c34de0c5b3ca0c242d402c69499">size</a>);</div>
<div class="line"><a name="l04437"></a><span class="lineno"> 4437</span>&#160;  ucvector_cleanup(&amp;bKGD);</div>
<div class="line"><a name="l04438"></a><span class="lineno"> 4438</span>&#160;</div>
<div class="line"><a name="l04439"></a><span class="lineno"> 4439</span>&#160;  <span class="keywordflow">return</span> error;</div>
<div class="line"><a name="l04440"></a><span class="lineno"> 4440</span>&#160;}</div>
<div class="line"><a name="l04441"></a><span class="lineno"> 4441</span>&#160;</div>
<div class="line"><a name="l04442"></a><span class="lineno"> 4442</span>&#160;<span class="keyword">static</span> <span class="keywordtype">unsigned</span> addChunk_tIME(<a class="code" href="structucvector.html">ucvector</a>* out, <span class="keyword">const</span> <a class="code" href="struct_lode_p_n_g___time.html">LodePNG_Time</a>* time)</div>
<div class="line"><a name="l04443"></a><span class="lineno"> 4443</span>&#160;{</div>
<div class="line"><a name="l04444"></a><span class="lineno"> 4444</span>&#160;  <span class="keywordtype">unsigned</span> error = 0;</div>
<div class="line"><a name="l04445"></a><span class="lineno"> 4445</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* data = (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>*)<a class="code" href="namespace_f_w.html#a440e071d8fdbc9789b728245caad99c0">malloc</a>(7);</div>
<div class="line"><a name="l04446"></a><span class="lineno"> 4446</span>&#160;  <span class="keywordflow">if</span>(!data) <span class="keywordflow">return</span> 9948; <span class="comment">/*alloc fail*/</span></div>
<div class="line"><a name="l04447"></a><span class="lineno"> 4447</span>&#160;  data[0] = (<span class="keywordtype">unsigned</span> char)(time-&gt;<a class="code" href="struct_lode_p_n_g___time.html#ae00d9df8a901579a2b563b683cc85169">year</a> / 256);</div>
<div class="line"><a name="l04448"></a><span class="lineno"> 4448</span>&#160;  data[1] = (<span class="keywordtype">unsigned</span> char)(time-&gt;<a class="code" href="struct_lode_p_n_g___time.html#ae00d9df8a901579a2b563b683cc85169">year</a> % 256);</div>
<div class="line"><a name="l04449"></a><span class="lineno"> 4449</span>&#160;  data[2] = time-&gt;<a class="code" href="struct_lode_p_n_g___time.html#a68ba78f192f4ed04bed783591df81405">month</a>;</div>
<div class="line"><a name="l04450"></a><span class="lineno"> 4450</span>&#160;  data[3] = time-&gt;<a class="code" href="struct_lode_p_n_g___time.html#a298fdd9a10f4a122e4921624d3bfd78b">day</a>;</div>
<div class="line"><a name="l04451"></a><span class="lineno"> 4451</span>&#160;  data[4] = time-&gt;<a class="code" href="struct_lode_p_n_g___time.html#a7ebc5c1cff16ed456268f6b4de66f4d7">hour</a>;</div>
<div class="line"><a name="l04452"></a><span class="lineno"> 4452</span>&#160;  data[5] = time-&gt;<a class="code" href="struct_lode_p_n_g___time.html#a7990f2e77aee4b5bd87e417e850d5352">minute</a>;</div>
<div class="line"><a name="l04453"></a><span class="lineno"> 4453</span>&#160;  data[6] = time-&gt;<a class="code" href="struct_lode_p_n_g___time.html#a68daf5323e84b536893b9b21e50022c1">second</a>;</div>
<div class="line"><a name="l04454"></a><span class="lineno"> 4454</span>&#160;  error = addChunk(out, <span class="stringliteral">&quot;tIME&quot;</span>, data, 7);</div>
<div class="line"><a name="l04455"></a><span class="lineno"> 4455</span>&#160;  <a class="code" href="namespace_f_w.html#a93be8f55938d6ffb5ca0af1f95f81589">free</a>(data);</div>
<div class="line"><a name="l04456"></a><span class="lineno"> 4456</span>&#160;  <span class="keywordflow">return</span> error;</div>
<div class="line"><a name="l04457"></a><span class="lineno"> 4457</span>&#160;}</div>
<div class="line"><a name="l04458"></a><span class="lineno"> 4458</span>&#160;</div>
<div class="line"><a name="l04459"></a><span class="lineno"> 4459</span>&#160;<span class="keyword">static</span> <span class="keywordtype">unsigned</span> addChunk_pHYs(<a class="code" href="structucvector.html">ucvector</a>* out, <span class="keyword">const</span> <a class="code" href="struct_lode_p_n_g___info_png.html">LodePNG_InfoPng</a>* info)</div>
<div class="line"><a name="l04460"></a><span class="lineno"> 4460</span>&#160;{</div>
<div class="line"><a name="l04461"></a><span class="lineno"> 4461</span>&#160;  <span class="keywordtype">unsigned</span> error = 0;</div>
<div class="line"><a name="l04462"></a><span class="lineno"> 4462</span>&#160;  <a class="code" href="structucvector.html">ucvector</a> <a class="code" href="_d_l_l_imports_8inl.html#a156a9c7e986e0352d0fe500e629d5171">data</a>;</div>
<div class="line"><a name="l04463"></a><span class="lineno"> 4463</span>&#160;  ucvector_init(&amp;data);</div>
<div class="line"><a name="l04464"></a><span class="lineno"> 4464</span>&#160;</div>
<div class="line"><a name="l04465"></a><span class="lineno"> 4465</span>&#160;  LodePNG_add32bitInt(&amp;data, info-&gt;<a class="code" href="struct_lode_p_n_g___info_png.html#a9c0f6237cfefc693ed17dbc3a843fe0f">phys_x</a>);</div>
<div class="line"><a name="l04466"></a><span class="lineno"> 4466</span>&#160;  LodePNG_add32bitInt(&amp;data, info-&gt;<a class="code" href="struct_lode_p_n_g___info_png.html#aea8ade694048f5912c235478b4ec1a35">phys_y</a>);</div>
<div class="line"><a name="l04467"></a><span class="lineno"> 4467</span>&#160;  ucvector_push_back(&amp;data, info-&gt;<a class="code" href="struct_lode_p_n_g___info_png.html#aab80ead40f4068cd89e71056143b1cd5">phys_unit</a>);</div>
<div class="line"><a name="l04468"></a><span class="lineno"> 4468</span>&#160;</div>
<div class="line"><a name="l04469"></a><span class="lineno"> 4469</span>&#160;  error = addChunk(out, <span class="stringliteral">&quot;pHYs&quot;</span>, data.<a class="code" href="structucvector.html#ace794c5713208c5a20f21762cd87c919">data</a>, data.<a class="code" href="structucvector.html#a27c99c34de0c5b3ca0c242d402c69499">size</a>);</div>
<div class="line"><a name="l04470"></a><span class="lineno"> 4470</span>&#160;  ucvector_cleanup(&amp;data);</div>
<div class="line"><a name="l04471"></a><span class="lineno"> 4471</span>&#160;</div>
<div class="line"><a name="l04472"></a><span class="lineno"> 4472</span>&#160;  <span class="keywordflow">return</span> error;</div>
<div class="line"><a name="l04473"></a><span class="lineno"> 4473</span>&#160;}</div>
<div class="line"><a name="l04474"></a><span class="lineno"> 4474</span>&#160;</div>
<div class="line"><a name="l04475"></a><span class="lineno"> 4475</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/*LODEPNG_COMPILE_ANCILLARY_CHUNKS*/</span><span class="preprocessor"></span></div>
<div class="line"><a name="l04476"></a><span class="lineno"> 4476</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l04477"></a><span class="lineno"> 4477</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> filterScanline(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* out, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* scanline, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* prevline,</div>
<div class="line"><a name="l04478"></a><span class="lineno"> 4478</span>&#160;                           <span class="keywordtype">size_t</span> length, <span class="keywordtype">size_t</span> bytewidth, <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> filterType)</div>
<div class="line"><a name="l04479"></a><span class="lineno"> 4479</span>&#160;{</div>
<div class="line"><a name="l04480"></a><span class="lineno"> 4480</span>&#160;  <span class="keywordtype">size_t</span> i;</div>
<div class="line"><a name="l04481"></a><span class="lineno"> 4481</span>&#160;  <span class="keywordflow">switch</span>(filterType)</div>
<div class="line"><a name="l04482"></a><span class="lineno"> 4482</span>&#160;  {</div>
<div class="line"><a name="l04483"></a><span class="lineno"> 4483</span>&#160;    <span class="keywordflow">case</span> 0: <span class="comment">/*None*/</span></div>
<div class="line"><a name="l04484"></a><span class="lineno"> 4484</span>&#160;      <span class="keywordflow">for</span>(i = 0; i &lt; <a class="code" href="_d_l_l_imports_8inl.html#a5720e2b8f4f85b31e0bab5a1b6e69c74">length</a>; i++) out[i] = scanline[i];</div>
<div class="line"><a name="l04485"></a><span class="lineno"> 4485</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04486"></a><span class="lineno"> 4486</span>&#160;    <span class="keywordflow">case</span> 1: <span class="comment">/*Sub*/</span></div>
<div class="line"><a name="l04487"></a><span class="lineno"> 4487</span>&#160;      <span class="keywordflow">if</span>(prevline)</div>
<div class="line"><a name="l04488"></a><span class="lineno"> 4488</span>&#160;      {</div>
<div class="line"><a name="l04489"></a><span class="lineno"> 4489</span>&#160;        <span class="keywordflow">for</span>(i = 0; i &lt; bytewidth; i++) out[i] = scanline[i];</div>
<div class="line"><a name="l04490"></a><span class="lineno"> 4490</span>&#160;        <span class="keywordflow">for</span>(i = bytewidth; i &lt; <a class="code" href="_d_l_l_imports_8inl.html#a5720e2b8f4f85b31e0bab5a1b6e69c74">length</a>   ; i++) out[i] = scanline[i] - scanline[i - bytewidth];</div>
<div class="line"><a name="l04491"></a><span class="lineno"> 4491</span>&#160;      }</div>
<div class="line"><a name="l04492"></a><span class="lineno"> 4492</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l04493"></a><span class="lineno"> 4493</span>&#160;      {</div>
<div class="line"><a name="l04494"></a><span class="lineno"> 4494</span>&#160;        <span class="keywordflow">for</span>(i = 0; i &lt; bytewidth; i++) out[i] = scanline[i];</div>
<div class="line"><a name="l04495"></a><span class="lineno"> 4495</span>&#160;        <span class="keywordflow">for</span>(i = bytewidth; i &lt;    <a class="code" href="_d_l_l_imports_8inl.html#a5720e2b8f4f85b31e0bab5a1b6e69c74">length</a>; i++) out[i] = scanline[i] - scanline[i - bytewidth];</div>
<div class="line"><a name="l04496"></a><span class="lineno"> 4496</span>&#160;      }</div>
<div class="line"><a name="l04497"></a><span class="lineno"> 4497</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04498"></a><span class="lineno"> 4498</span>&#160;    <span class="keywordflow">case</span> 2: <span class="comment">/*Up*/</span></div>
<div class="line"><a name="l04499"></a><span class="lineno"> 4499</span>&#160;      <span class="keywordflow">if</span>(prevline)</div>
<div class="line"><a name="l04500"></a><span class="lineno"> 4500</span>&#160;      {</div>
<div class="line"><a name="l04501"></a><span class="lineno"> 4501</span>&#160;        <span class="keywordflow">for</span>(i = 0; i &lt; <a class="code" href="_d_l_l_imports_8inl.html#a5720e2b8f4f85b31e0bab5a1b6e69c74">length</a>; i++) out[i] = scanline[i] - prevline[i];</div>
<div class="line"><a name="l04502"></a><span class="lineno"> 4502</span>&#160;      }</div>
<div class="line"><a name="l04503"></a><span class="lineno"> 4503</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l04504"></a><span class="lineno"> 4504</span>&#160;      {</div>
<div class="line"><a name="l04505"></a><span class="lineno"> 4505</span>&#160;        <span class="keywordflow">for</span>(i = 0; i &lt; <a class="code" href="_d_l_l_imports_8inl.html#a5720e2b8f4f85b31e0bab5a1b6e69c74">length</a>; i++) out[i] = scanline[i];</div>
<div class="line"><a name="l04506"></a><span class="lineno"> 4506</span>&#160;      }</div>
<div class="line"><a name="l04507"></a><span class="lineno"> 4507</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04508"></a><span class="lineno"> 4508</span>&#160;    <span class="keywordflow">case</span> 3: <span class="comment">/*Average*/</span></div>
<div class="line"><a name="l04509"></a><span class="lineno"> 4509</span>&#160;      <span class="keywordflow">if</span>(prevline)</div>
<div class="line"><a name="l04510"></a><span class="lineno"> 4510</span>&#160;      {</div>
<div class="line"><a name="l04511"></a><span class="lineno"> 4511</span>&#160;        <span class="keywordflow">for</span>(i = 0; i &lt; bytewidth; i++) out[i] = scanline[i] - prevline[i] / 2;</div>
<div class="line"><a name="l04512"></a><span class="lineno"> 4512</span>&#160;        <span class="keywordflow">for</span>(i = bytewidth; i &lt; <a class="code" href="_d_l_l_imports_8inl.html#a5720e2b8f4f85b31e0bab5a1b6e69c74">length</a>; i++) out[i] = scanline[i] - ((scanline[i - bytewidth] + prevline[i]) / 2);</div>
<div class="line"><a name="l04513"></a><span class="lineno"> 4513</span>&#160;      }</div>
<div class="line"><a name="l04514"></a><span class="lineno"> 4514</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l04515"></a><span class="lineno"> 4515</span>&#160;      {</div>
<div class="line"><a name="l04516"></a><span class="lineno"> 4516</span>&#160;        <span class="keywordflow">for</span>(i = 0; i &lt; bytewidth; i++) out[i] = scanline[i];</div>
<div class="line"><a name="l04517"></a><span class="lineno"> 4517</span>&#160;        <span class="keywordflow">for</span>(i = bytewidth; i &lt; <a class="code" href="_d_l_l_imports_8inl.html#a5720e2b8f4f85b31e0bab5a1b6e69c74">length</a>; i++) out[i] = scanline[i] - scanline[i - bytewidth] / 2;</div>
<div class="line"><a name="l04518"></a><span class="lineno"> 4518</span>&#160;      }</div>
<div class="line"><a name="l04519"></a><span class="lineno"> 4519</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04520"></a><span class="lineno"> 4520</span>&#160;    <span class="keywordflow">case</span> 4: <span class="comment">/*Paeth*/</span></div>
<div class="line"><a name="l04521"></a><span class="lineno"> 4521</span>&#160;      <span class="keywordflow">if</span>(prevline)</div>
<div class="line"><a name="l04522"></a><span class="lineno"> 4522</span>&#160;      {</div>
<div class="line"><a name="l04523"></a><span class="lineno"> 4523</span>&#160;        <span class="comment">/*paethPredictor(0, prevline[i], 0) is always prevline[i]*/</span></div>
<div class="line"><a name="l04524"></a><span class="lineno"> 4524</span>&#160;        <span class="keywordflow">for</span>(i = 0; i &lt; bytewidth; i++) out[i] = (scanline[i] - prevline[i]);</div>
<div class="line"><a name="l04525"></a><span class="lineno"> 4525</span>&#160;        <span class="keywordflow">for</span>(i = bytewidth; i &lt; <a class="code" href="_d_l_l_imports_8inl.html#a5720e2b8f4f85b31e0bab5a1b6e69c74">length</a>; i++)</div>
<div class="line"><a name="l04526"></a><span class="lineno"> 4526</span>&#160;        {</div>
<div class="line"><a name="l04527"></a><span class="lineno"> 4527</span>&#160;          out[i] = (scanline[i] - paethPredictor(scanline[i - bytewidth], prevline[i], prevline[i - bytewidth]));</div>
<div class="line"><a name="l04528"></a><span class="lineno"> 4528</span>&#160;        }</div>
<div class="line"><a name="l04529"></a><span class="lineno"> 4529</span>&#160;      }</div>
<div class="line"><a name="l04530"></a><span class="lineno"> 4530</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l04531"></a><span class="lineno"> 4531</span>&#160;      {</div>
<div class="line"><a name="l04532"></a><span class="lineno"> 4532</span>&#160;        <span class="keywordflow">for</span>(i = 0; i &lt; bytewidth; i++) out[i] = scanline[i];</div>
<div class="line"><a name="l04533"></a><span class="lineno"> 4533</span>&#160;        <span class="comment">/*paethPredictor(scanline[i - bytewidth], 0, 0) is always scanline[i - bytewidth]*/</span></div>
<div class="line"><a name="l04534"></a><span class="lineno"> 4534</span>&#160;        <span class="keywordflow">for</span>(i = bytewidth; i &lt; <a class="code" href="_d_l_l_imports_8inl.html#a5720e2b8f4f85b31e0bab5a1b6e69c74">length</a>; i++) out[i] = (scanline[i] - scanline[i - bytewidth]);</div>
<div class="line"><a name="l04535"></a><span class="lineno"> 4535</span>&#160;      }</div>
<div class="line"><a name="l04536"></a><span class="lineno"> 4536</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04537"></a><span class="lineno"> 4537</span>&#160;    <span class="keywordflow">default</span>: <span class="keywordflow">return</span>; <span class="comment">/*unexisting filter type given*/</span></div>
<div class="line"><a name="l04538"></a><span class="lineno"> 4538</span>&#160;  }</div>
<div class="line"><a name="l04539"></a><span class="lineno"> 4539</span>&#160;}</div>
<div class="line"><a name="l04540"></a><span class="lineno"> 4540</span>&#160;</div>
<div class="line"><a name="l04541"></a><span class="lineno"> 4541</span>&#160;<span class="keyword">static</span> <span class="keywordtype">unsigned</span> filter(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* out, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* in, <span class="keywordtype">unsigned</span> w, <span class="keywordtype">unsigned</span> h,</div>
<div class="line"><a name="l04542"></a><span class="lineno"> 4542</span>&#160;                       <span class="keyword">const</span> <a class="code" href="struct_lode_p_n_g___info_color.html">LodePNG_InfoColor</a>* info, <span class="keyword">const</span> <a class="code" href="struct_lode_p_n_g___encode_settings.html">LodePNG_EncodeSettings</a>* settings)</div>
<div class="line"><a name="l04543"></a><span class="lineno"> 4543</span>&#160;{</div>
<div class="line"><a name="l04544"></a><span class="lineno"> 4544</span>&#160;  <span class="comment">/*</span></div>
<div class="line"><a name="l04545"></a><span class="lineno"> 4545</span>&#160;<span class="comment">  For PNG filter method 0</span></div>
<div class="line"><a name="l04546"></a><span class="lineno"> 4546</span>&#160;<span class="comment">  out must be a buffer with as size: h + (w * h * bpp + 7) / 8, because there are</span></div>
<div class="line"><a name="l04547"></a><span class="lineno"> 4547</span>&#160;<span class="comment">  the scanlines with 1 extra byte per scanline</span></div>
<div class="line"><a name="l04548"></a><span class="lineno"> 4548</span>&#160;<span class="comment">  */</span></div>
<div class="line"><a name="l04549"></a><span class="lineno"> 4549</span>&#160;</div>
<div class="line"><a name="l04550"></a><span class="lineno"> 4550</span>&#160;  <span class="keywordtype">unsigned</span> bpp = <a class="code" href="lodepng_8cpp.html#a81151c0087467b4ac2a815b3234fdb5a">LodePNG_InfoColor_getBpp</a>(info);</div>
<div class="line"><a name="l04551"></a><span class="lineno"> 4551</span>&#160;  <span class="comment">/*the width of a scanline in bytes, not including the filter type*/</span></div>
<div class="line"><a name="l04552"></a><span class="lineno"> 4552</span>&#160;  <span class="keywordtype">size_t</span> linebytes = (w * bpp + 7) / 8;</div>
<div class="line"><a name="l04553"></a><span class="lineno"> 4553</span>&#160;  <span class="comment">/*bytewidth is used for filtering, is 1 when bpp &lt; 8, number of bytes per pixel otherwise*/</span></div>
<div class="line"><a name="l04554"></a><span class="lineno"> 4554</span>&#160;  <span class="keywordtype">size_t</span> bytewidth = (bpp + 7) / 8;</div>
<div class="line"><a name="l04555"></a><span class="lineno"> 4555</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* prevline = 0;</div>
<div class="line"><a name="l04556"></a><span class="lineno"> 4556</span>&#160;  <span class="keywordtype">unsigned</span> <a class="code" href="_d_l_l_imports_8inl.html#a801542531fe9fad1565d31155ba5517b">x</a>, <a class="code" href="_d_l_l_imports_8inl.html#af7bcdfc5a984ba9c6720d5f0416f249d">y</a>;</div>
<div class="line"><a name="l04557"></a><span class="lineno"> 4557</span>&#160;  <span class="keywordtype">unsigned</span> error = 0;</div>
<div class="line"><a name="l04558"></a><span class="lineno"> 4558</span>&#160;</div>
<div class="line"><a name="l04559"></a><span class="lineno"> 4559</span>&#160;  <span class="keywordflow">if</span>(bpp == 0) <span class="keywordflow">return</span> 31; <span class="comment">/*error: invalid color type*/</span></div>
<div class="line"><a name="l04560"></a><span class="lineno"> 4560</span>&#160;</div>
<div class="line"><a name="l04561"></a><span class="lineno"> 4561</span>&#160;  <span class="keywordflow">if</span>(!settings-&gt;<a class="code" href="struct_lode_p_n_g___encode_settings.html#a1bb1c6043e4bcf65ddebd204ac3ab7f5">bruteForceFilters</a>)</div>
<div class="line"><a name="l04562"></a><span class="lineno"> 4562</span>&#160;  {</div>
<div class="line"><a name="l04563"></a><span class="lineno"> 4563</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l04564"></a><span class="lineno"> 4564</span>&#160;<span class="comment">    There is a heuristic called the minimum sum of absolute differences heuristic, suggested by the PNG standard:</span></div>
<div class="line"><a name="l04565"></a><span class="lineno"> 4565</span>&#160;<span class="comment">       *  If the image type is Palette, or the bit depth is smaller than 8, then do not filter the image (i.e.</span></div>
<div class="line"><a name="l04566"></a><span class="lineno"> 4566</span>&#160;<span class="comment">          use fixed filtering, with the filter None).</span></div>
<div class="line"><a name="l04567"></a><span class="lineno"> 4567</span>&#160;<span class="comment">       * (The other case) If the image type is Grayscale or RGB (with or without Alpha), and the bit depth is</span></div>
<div class="line"><a name="l04568"></a><span class="lineno"> 4568</span>&#160;<span class="comment">         not smaller than 8, then use adaptive filtering heuristic as follows: independently for each row, apply</span></div>
<div class="line"><a name="l04569"></a><span class="lineno"> 4569</span>&#160;<span class="comment">         all five filters and select the filter that produces the smallest sum of absolute values per row.</span></div>
<div class="line"><a name="l04570"></a><span class="lineno"> 4570</span>&#160;<span class="comment">    */</span></div>
<div class="line"><a name="l04571"></a><span class="lineno"> 4571</span>&#160;    <span class="keywordflow">if</span>(info-&gt;<a class="code" href="struct_lode_p_n_g___info_color.html#a4ed18d179c5078137a18e742b1c41a00">colorType</a> == 3 || info-&gt;<a class="code" href="struct_lode_p_n_g___info_color.html#a9d538965a46d59bbdea744da8b290591">bitDepth</a> &lt; 8) <span class="comment">/*None filtertype for everything*/</span></div>
<div class="line"><a name="l04572"></a><span class="lineno"> 4572</span>&#160;    {</div>
<div class="line"><a name="l04573"></a><span class="lineno"> 4573</span>&#160;      <span class="keywordflow">for</span>(y = 0; y &lt; h; y++)</div>
<div class="line"><a name="l04574"></a><span class="lineno"> 4574</span>&#160;      {</div>
<div class="line"><a name="l04575"></a><span class="lineno"> 4575</span>&#160;        <span class="keywordtype">size_t</span> outindex = (1 + linebytes) * y; <span class="comment">/*the extra filterbyte added to each row*/</span></div>
<div class="line"><a name="l04576"></a><span class="lineno"> 4576</span>&#160;        <span class="keywordtype">size_t</span> inindex = linebytes * <a class="code" href="_d_l_l_imports_8inl.html#af7bcdfc5a984ba9c6720d5f0416f249d">y</a>;</div>
<div class="line"><a name="l04577"></a><span class="lineno"> 4577</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> TYPE = 0;</div>
<div class="line"><a name="l04578"></a><span class="lineno"> 4578</span>&#160;        out[outindex] = TYPE; <span class="comment">/*filter type byte*/</span></div>
<div class="line"><a name="l04579"></a><span class="lineno"> 4579</span>&#160;        filterScanline(&amp;out[outindex + 1], &amp;in[inindex], prevline, linebytes, bytewidth, TYPE);</div>
<div class="line"><a name="l04580"></a><span class="lineno"> 4580</span>&#160;        prevline = &amp;in[inindex];</div>
<div class="line"><a name="l04581"></a><span class="lineno"> 4581</span>&#160;      }</div>
<div class="line"><a name="l04582"></a><span class="lineno"> 4582</span>&#160;    }</div>
<div class="line"><a name="l04583"></a><span class="lineno"> 4583</span>&#160;    <span class="keywordflow">else</span> <span class="comment">/*adaptive filtering*/</span></div>
<div class="line"><a name="l04584"></a><span class="lineno"> 4584</span>&#160;    {</div>
<div class="line"><a name="l04585"></a><span class="lineno"> 4585</span>&#160;      <span class="keywordtype">size_t</span> sum[5];</div>
<div class="line"><a name="l04586"></a><span class="lineno"> 4586</span>&#160;      <a class="code" href="structucvector.html">ucvector</a> attempt[5]; <span class="comment">/*five filtering attempts, one for each filter type*/</span></div>
<div class="line"><a name="l04587"></a><span class="lineno"> 4587</span>&#160;      <span class="keywordtype">size_t</span> smallest = 0;</div>
<div class="line"><a name="l04588"></a><span class="lineno"> 4588</span>&#160;      <span class="keywordtype">unsigned</span> <a class="code" href="_d_l_l_imports_8inl.html#a1d14bae93fe47a03f0ace206fef6a34e">type</a>, bestType = 0;</div>
<div class="line"><a name="l04589"></a><span class="lineno"> 4589</span>&#160;</div>
<div class="line"><a name="l04590"></a><span class="lineno"> 4590</span>&#160;      <span class="keywordflow">for</span>(type = 0; type &lt; 5; type++) ucvector_init(&amp;attempt[type]);</div>
<div class="line"><a name="l04591"></a><span class="lineno"> 4591</span>&#160;      <span class="keywordflow">for</span>(type = 0; type &lt; 5; type++)</div>
<div class="line"><a name="l04592"></a><span class="lineno"> 4592</span>&#160;      {</div>
<div class="line"><a name="l04593"></a><span class="lineno"> 4593</span>&#160;        <span class="keywordflow">if</span>(!ucvector_resize(&amp;attempt[type], linebytes)) <a class="code" href="lodepng_8cpp.html#a691b23954341613b96b6d98ce67d339c">ERROR_BREAK</a>(9949 <span class="comment">/*alloc fail*/</span>);</div>
<div class="line"><a name="l04594"></a><span class="lineno"> 4594</span>&#160;      }</div>
<div class="line"><a name="l04595"></a><span class="lineno"> 4595</span>&#160;</div>
<div class="line"><a name="l04596"></a><span class="lineno"> 4596</span>&#160;      <span class="keywordflow">if</span>(!error)</div>
<div class="line"><a name="l04597"></a><span class="lineno"> 4597</span>&#160;      {</div>
<div class="line"><a name="l04598"></a><span class="lineno"> 4598</span>&#160;        <span class="keywordflow">for</span>(y = 0; y &lt; h; y++)</div>
<div class="line"><a name="l04599"></a><span class="lineno"> 4599</span>&#160;        {</div>
<div class="line"><a name="l04600"></a><span class="lineno"> 4600</span>&#160;          <span class="comment">/*try the 5 filter types*/</span></div>
<div class="line"><a name="l04601"></a><span class="lineno"> 4601</span>&#160;          <span class="keywordflow">for</span>(type = 0; type &lt; 5; type++)</div>
<div class="line"><a name="l04602"></a><span class="lineno"> 4602</span>&#160;          {</div>
<div class="line"><a name="l04603"></a><span class="lineno"> 4603</span>&#160;            filterScanline(attempt[type].data, &amp;in[y * linebytes], prevline, linebytes, bytewidth, type);</div>
<div class="line"><a name="l04604"></a><span class="lineno"> 4604</span>&#160;</div>
<div class="line"><a name="l04605"></a><span class="lineno"> 4605</span>&#160;            <span class="comment">/*calculate the sum of the result*/</span></div>
<div class="line"><a name="l04606"></a><span class="lineno"> 4606</span>&#160;            sum[<a class="code" href="_d_l_l_imports_8inl.html#a1d14bae93fe47a03f0ace206fef6a34e">type</a>] = 0;</div>
<div class="line"><a name="l04607"></a><span class="lineno"> 4607</span>&#160;            <span class="comment">/*note that not all pixels are checked to speed this up while still having probably the best choice*/</span></div>
<div class="line"><a name="l04608"></a><span class="lineno"> 4608</span>&#160;            <span class="keywordflow">for</span>(x = 0; x &lt; attempt[<a class="code" href="_d_l_l_imports_8inl.html#a1d14bae93fe47a03f0ace206fef6a34e">type</a>].<a class="code" href="structucvector.html#a27c99c34de0c5b3ca0c242d402c69499">size</a>; x+=3)</div>
<div class="line"><a name="l04609"></a><span class="lineno"> 4609</span>&#160;            {</div>
<div class="line"><a name="l04610"></a><span class="lineno"> 4610</span>&#160;              <span class="comment">/*For differences, each byte should be treated as signed, values above 127 are negative</span></div>
<div class="line"><a name="l04611"></a><span class="lineno"> 4611</span>&#160;<span class="comment">              (converted to signed char). Filtertype 0 isn&#39;t a difference though, so use unsigned there.</span></div>
<div class="line"><a name="l04612"></a><span class="lineno"> 4612</span>&#160;<span class="comment">              This means filtertype 0 is almost never chosen, but that is justified.*/</span></div>
<div class="line"><a name="l04613"></a><span class="lineno"> 4613</span>&#160;              <span class="keywordflow">if</span>(type == 0) sum[<a class="code" href="_d_l_l_imports_8inl.html#a1d14bae93fe47a03f0ace206fef6a34e">type</a>] += (<span class="keywordtype">unsigned</span> char)(attempt[type].data[x]);</div>
<div class="line"><a name="l04614"></a><span class="lineno"> 4614</span>&#160;              <span class="keywordflow">else</span></div>
<div class="line"><a name="l04615"></a><span class="lineno"> 4615</span>&#160;              {</div>
<div class="line"><a name="l04616"></a><span class="lineno"> 4616</span>&#160;                <span class="keywordtype">signed</span> <span class="keywordtype">char</span> s = (<span class="keywordtype">signed</span> char)(attempt[type].data[x]);</div>
<div class="line"><a name="l04617"></a><span class="lineno"> 4617</span>&#160;                sum[<a class="code" href="_d_l_l_imports_8inl.html#a1d14bae93fe47a03f0ace206fef6a34e">type</a>] += s &lt; 0 ? -s : s;</div>
<div class="line"><a name="l04618"></a><span class="lineno"> 4618</span>&#160;              }</div>
<div class="line"><a name="l04619"></a><span class="lineno"> 4619</span>&#160;            }</div>
<div class="line"><a name="l04620"></a><span class="lineno"> 4620</span>&#160;</div>
<div class="line"><a name="l04621"></a><span class="lineno"> 4621</span>&#160;            <span class="comment">/*check if this is smallest sum (or if type == 0 it&#39;s the first case so always store the values)*/</span></div>
<div class="line"><a name="l04622"></a><span class="lineno"> 4622</span>&#160;            <span class="keywordflow">if</span>(type == 0 || sum[type] &lt; smallest)</div>
<div class="line"><a name="l04623"></a><span class="lineno"> 4623</span>&#160;            {</div>
<div class="line"><a name="l04624"></a><span class="lineno"> 4624</span>&#160;              bestType = <a class="code" href="_d_l_l_imports_8inl.html#a1d14bae93fe47a03f0ace206fef6a34e">type</a>;</div>
<div class="line"><a name="l04625"></a><span class="lineno"> 4625</span>&#160;              smallest = sum[<a class="code" href="_d_l_l_imports_8inl.html#a1d14bae93fe47a03f0ace206fef6a34e">type</a>];</div>
<div class="line"><a name="l04626"></a><span class="lineno"> 4626</span>&#160;            }</div>
<div class="line"><a name="l04627"></a><span class="lineno"> 4627</span>&#160;          }</div>
<div class="line"><a name="l04628"></a><span class="lineno"> 4628</span>&#160;</div>
<div class="line"><a name="l04629"></a><span class="lineno"> 4629</span>&#160;          prevline = &amp;in[y * linebytes];</div>
<div class="line"><a name="l04630"></a><span class="lineno"> 4630</span>&#160;</div>
<div class="line"><a name="l04631"></a><span class="lineno"> 4631</span>&#160;          <span class="comment">/*now fill the out values*/</span></div>
<div class="line"><a name="l04632"></a><span class="lineno"> 4632</span>&#160;          out[y * (linebytes + 1)] = bestType; <span class="comment">/*the first byte of a scanline will be the filter type*/</span></div>
<div class="line"><a name="l04633"></a><span class="lineno"> 4633</span>&#160;          <span class="keywordflow">for</span>(x = 0; x &lt; linebytes; x++) out[y * (linebytes + 1) + 1 + <a class="code" href="_d_l_l_imports_8inl.html#a801542531fe9fad1565d31155ba5517b">x</a>] = attempt[bestType].<a class="code" href="structucvector.html#ace794c5713208c5a20f21762cd87c919">data</a>[<a class="code" href="_d_l_l_imports_8inl.html#a801542531fe9fad1565d31155ba5517b">x</a>];</div>
<div class="line"><a name="l04634"></a><span class="lineno"> 4634</span>&#160;        }</div>
<div class="line"><a name="l04635"></a><span class="lineno"> 4635</span>&#160;      }</div>
<div class="line"><a name="l04636"></a><span class="lineno"> 4636</span>&#160;</div>
<div class="line"><a name="l04637"></a><span class="lineno"> 4637</span>&#160;      <span class="keywordflow">for</span>(type = 0; type &lt; 5; type++) ucvector_cleanup(&amp;attempt[type]);</div>
<div class="line"><a name="l04638"></a><span class="lineno"> 4638</span>&#160;    }</div>
<div class="line"><a name="l04639"></a><span class="lineno"> 4639</span>&#160;  }</div>
<div class="line"><a name="l04640"></a><span class="lineno"> 4640</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l04641"></a><span class="lineno"> 4641</span>&#160;  {</div>
<div class="line"><a name="l04642"></a><span class="lineno"> 4642</span>&#160;    <span class="comment">/*brute force filter chooser.</span></div>
<div class="line"><a name="l04643"></a><span class="lineno"> 4643</span>&#160;<span class="comment">    deflate the scanline after every filter attempt to see which one deflates best.</span></div>
<div class="line"><a name="l04644"></a><span class="lineno"> 4644</span>&#160;<span class="comment">    This is very slow and gives only slightly smaller, sometimes even larger, result*/</span></div>
<div class="line"><a name="l04645"></a><span class="lineno"> 4645</span>&#160;    <span class="keywordtype">size_t</span> size[5];</div>
<div class="line"><a name="l04646"></a><span class="lineno"> 4646</span>&#160;    <a class="code" href="structucvector.html">ucvector</a> attempt[5]; <span class="comment">/*five filtering attempts, one for each filter type*/</span></div>
<div class="line"><a name="l04647"></a><span class="lineno"> 4647</span>&#160;    <span class="keywordtype">size_t</span> smallest;</div>
<div class="line"><a name="l04648"></a><span class="lineno"> 4648</span>&#160;    <span class="keywordtype">unsigned</span> type = 0, bestType = 0;</div>
<div class="line"><a name="l04649"></a><span class="lineno"> 4649</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* dummy;</div>
<div class="line"><a name="l04650"></a><span class="lineno"> 4650</span>&#160;    <a class="code" href="struct_lode_p_n_g___compress_settings.html">LodePNG_CompressSettings</a> zlibsettings = settings-&gt;<a class="code" href="struct_lode_p_n_g___encode_settings.html#ae2d55a9f02c8711e426c08f54d268279">zlibsettings</a>;</div>
<div class="line"><a name="l04651"></a><span class="lineno"> 4651</span>&#160;    <span class="comment">/*use fixed tree on the attempts so that the tree is not adapted to the filtertype on purpose,</span></div>
<div class="line"><a name="l04652"></a><span class="lineno"> 4652</span>&#160;<span class="comment">    to simulate the true case where the tree is the same for the whole image. Sometimes it gives</span></div>
<div class="line"><a name="l04653"></a><span class="lineno"> 4653</span>&#160;<span class="comment">    better result with dynamic tree anyway. Using the fixed tree sometimes gives worse, but in rare</span></div>
<div class="line"><a name="l04654"></a><span class="lineno"> 4654</span>&#160;<span class="comment">    cases better compression. It does make this a bit less slow, so it&#39;s worth doing this.*/</span></div>
<div class="line"><a name="l04655"></a><span class="lineno"> 4655</span>&#160;    zlibsettings.<a class="code" href="struct_lode_p_n_g___compress_settings.html#aafec7ef311a7ad4e2ad3b1184e2aa805">btype</a> = 1;</div>
<div class="line"><a name="l04656"></a><span class="lineno"> 4656</span>&#160;    <span class="keywordflow">for</span>(type = 0; type &lt; 5; type++)</div>
<div class="line"><a name="l04657"></a><span class="lineno"> 4657</span>&#160;    {</div>
<div class="line"><a name="l04658"></a><span class="lineno"> 4658</span>&#160;      ucvector_init(&amp;attempt[type]);</div>
<div class="line"><a name="l04659"></a><span class="lineno"> 4659</span>&#160;      ucvector_resize(&amp;attempt[type], linebytes); <span class="comment">/*todo: give error if resize failed*/</span></div>
<div class="line"><a name="l04660"></a><span class="lineno"> 4660</span>&#160;    }</div>
<div class="line"><a name="l04661"></a><span class="lineno"> 4661</span>&#160;    <span class="keywordflow">for</span>(y = 0; y &lt; h; y++) <span class="comment">/*try the 5 filter types*/</span></div>
<div class="line"><a name="l04662"></a><span class="lineno"> 4662</span>&#160;    {</div>
<div class="line"><a name="l04663"></a><span class="lineno"> 4663</span>&#160;      <span class="keywordflow">for</span>(type = 0; type &lt; 5; type++)</div>
<div class="line"><a name="l04664"></a><span class="lineno"> 4664</span>&#160;      {</div>
<div class="line"><a name="l04665"></a><span class="lineno"> 4665</span>&#160;        <span class="keywordtype">unsigned</span> testsize = attempt[<a class="code" href="_d_l_l_imports_8inl.html#a1d14bae93fe47a03f0ace206fef6a34e">type</a>].<a class="code" href="structucvector.html#a27c99c34de0c5b3ca0c242d402c69499">size</a>;</div>
<div class="line"><a name="l04666"></a><span class="lineno"> 4666</span>&#160;        <span class="comment">/*unsigned testsize = attempt[type].size / 8;*/</span> <span class="comment">/*it already works good enough by testing a part of the row*/</span></div>
<div class="line"><a name="l04667"></a><span class="lineno"> 4667</span>&#160;        <span class="comment">/*if(testsize == 0) testsize = attempt[type].size;*/</span></div>
<div class="line"><a name="l04668"></a><span class="lineno"> 4668</span>&#160;</div>
<div class="line"><a name="l04669"></a><span class="lineno"> 4669</span>&#160;        filterScanline(attempt[type].data, &amp;in[y * linebytes], prevline, linebytes, bytewidth, type);</div>
<div class="line"><a name="l04670"></a><span class="lineno"> 4670</span>&#160;        size[<a class="code" href="_d_l_l_imports_8inl.html#a1d14bae93fe47a03f0ace206fef6a34e">type</a>] = 0;</div>
<div class="line"><a name="l04671"></a><span class="lineno"> 4671</span>&#160;        dummy = 0;</div>
<div class="line"><a name="l04672"></a><span class="lineno"> 4672</span>&#160;        <a class="code" href="lodepng_8cpp.html#aa2ff174234767c087c7ba974ba862be9">LodePNG_zlib_compress</a>(&amp;dummy, &amp;size[type], attempt[type].data, testsize, &amp;zlibsettings);</div>
<div class="line"><a name="l04673"></a><span class="lineno"> 4673</span>&#160;        <a class="code" href="namespace_f_w.html#a93be8f55938d6ffb5ca0af1f95f81589">free</a>(dummy);</div>
<div class="line"><a name="l04674"></a><span class="lineno"> 4674</span>&#160;        <span class="comment">/*check if this is smallest size (or if type == 0 it&#39;s the first case so always store the values)*/</span></div>
<div class="line"><a name="l04675"></a><span class="lineno"> 4675</span>&#160;        <span class="keywordflow">if</span>(type == 0 || size[type] &lt; smallest)</div>
<div class="line"><a name="l04676"></a><span class="lineno"> 4676</span>&#160;        {</div>
<div class="line"><a name="l04677"></a><span class="lineno"> 4677</span>&#160;          bestType = <a class="code" href="_d_l_l_imports_8inl.html#a1d14bae93fe47a03f0ace206fef6a34e">type</a>;</div>
<div class="line"><a name="l04678"></a><span class="lineno"> 4678</span>&#160;          smallest = size[<a class="code" href="_d_l_l_imports_8inl.html#a1d14bae93fe47a03f0ace206fef6a34e">type</a>];</div>
<div class="line"><a name="l04679"></a><span class="lineno"> 4679</span>&#160;        }</div>
<div class="line"><a name="l04680"></a><span class="lineno"> 4680</span>&#160;      }</div>
<div class="line"><a name="l04681"></a><span class="lineno"> 4681</span>&#160;      prevline = &amp;in[y * linebytes];</div>
<div class="line"><a name="l04682"></a><span class="lineno"> 4682</span>&#160;      out[y * (linebytes + 1)] = bestType; <span class="comment">/*the first byte of a scanline will be the filter type*/</span></div>
<div class="line"><a name="l04683"></a><span class="lineno"> 4683</span>&#160;      <span class="keywordflow">for</span>(x = 0; x &lt; linebytes; x++) out[y * (linebytes + 1) + 1 + <a class="code" href="_d_l_l_imports_8inl.html#a801542531fe9fad1565d31155ba5517b">x</a>] = attempt[bestType].<a class="code" href="structucvector.html#ace794c5713208c5a20f21762cd87c919">data</a>[<a class="code" href="_d_l_l_imports_8inl.html#a801542531fe9fad1565d31155ba5517b">x</a>];</div>
<div class="line"><a name="l04684"></a><span class="lineno"> 4684</span>&#160;    }</div>
<div class="line"><a name="l04685"></a><span class="lineno"> 4685</span>&#160;    <span class="keywordflow">for</span>(type = 0; type &lt; 5; type++) ucvector_cleanup(&amp;attempt[type]);</div>
<div class="line"><a name="l04686"></a><span class="lineno"> 4686</span>&#160;  }</div>
<div class="line"><a name="l04687"></a><span class="lineno"> 4687</span>&#160;</div>
<div class="line"><a name="l04688"></a><span class="lineno"> 4688</span>&#160;  <span class="keywordflow">return</span> error;</div>
<div class="line"><a name="l04689"></a><span class="lineno"> 4689</span>&#160;}</div>
<div class="line"><a name="l04690"></a><span class="lineno"> 4690</span>&#160;</div>
<div class="line"><a name="l04691"></a><span class="lineno"> 4691</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> addPaddingBits(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* out, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* in,</div>
<div class="line"><a name="l04692"></a><span class="lineno"> 4692</span>&#160;                           <span class="keywordtype">size_t</span> olinebits, <span class="keywordtype">size_t</span> ilinebits, <span class="keywordtype">unsigned</span> h)</div>
<div class="line"><a name="l04693"></a><span class="lineno"> 4693</span>&#160;{</div>
<div class="line"><a name="l04694"></a><span class="lineno"> 4694</span>&#160;  <span class="comment">/*The opposite of the removePaddingBits function</span></div>
<div class="line"><a name="l04695"></a><span class="lineno"> 4695</span>&#160;<span class="comment">  olinebits must be &gt;= ilinebits*/</span></div>
<div class="line"><a name="l04696"></a><span class="lineno"> 4696</span>&#160;  <span class="keywordtype">unsigned</span> <a class="code" href="_d_l_l_imports_8inl.html#af7bcdfc5a984ba9c6720d5f0416f249d">y</a>;</div>
<div class="line"><a name="l04697"></a><span class="lineno"> 4697</span>&#160;  <span class="keywordtype">size_t</span> diff = olinebits - ilinebits;</div>
<div class="line"><a name="l04698"></a><span class="lineno"> 4698</span>&#160;  <span class="keywordtype">size_t</span> obp = 0, ibp = 0; <span class="comment">/*bit pointers*/</span></div>
<div class="line"><a name="l04699"></a><span class="lineno"> 4699</span>&#160;  <span class="keywordflow">for</span>(y = 0; y &lt; h; y++)</div>
<div class="line"><a name="l04700"></a><span class="lineno"> 4700</span>&#160;  {</div>
<div class="line"><a name="l04701"></a><span class="lineno"> 4701</span>&#160;    <span class="keywordtype">size_t</span> <a class="code" href="_d_l_l_imports_8inl.html#a801542531fe9fad1565d31155ba5517b">x</a>;</div>
<div class="line"><a name="l04702"></a><span class="lineno"> 4702</span>&#160;    <span class="keywordflow">for</span>(x = 0; x &lt; ilinebits; x++)</div>
<div class="line"><a name="l04703"></a><span class="lineno"> 4703</span>&#160;    {</div>
<div class="line"><a name="l04704"></a><span class="lineno"> 4704</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> bit = readBitFromReversedStream(&amp;ibp, in);</div>
<div class="line"><a name="l04705"></a><span class="lineno"> 4705</span>&#160;      setBitOfReversedStream(&amp;obp, out, bit);</div>
<div class="line"><a name="l04706"></a><span class="lineno"> 4706</span>&#160;    }</div>
<div class="line"><a name="l04707"></a><span class="lineno"> 4707</span>&#160;    <span class="comment">/*obp += diff; --&gt; no, fill in some value in the padding bits too, to avoid</span></div>
<div class="line"><a name="l04708"></a><span class="lineno"> 4708</span>&#160;<span class="comment">    &quot;Use of uninitialised value of size ###&quot; warning from valgrind*/</span></div>
<div class="line"><a name="l04709"></a><span class="lineno"> 4709</span>&#160;    <span class="keywordflow">for</span>(x = 0; x &lt; diff; x++) setBitOfReversedStream(&amp;obp, out, 0);</div>
<div class="line"><a name="l04710"></a><span class="lineno"> 4710</span>&#160;  }</div>
<div class="line"><a name="l04711"></a><span class="lineno"> 4711</span>&#160;}</div>
<div class="line"><a name="l04712"></a><span class="lineno"> 4712</span>&#160;</div>
<div class="line"><a name="l04713"></a><span class="lineno"> 4713</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> Adam7_interlace(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* out, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* in, <span class="keywordtype">unsigned</span> w, <span class="keywordtype">unsigned</span> h, <span class="keywordtype">unsigned</span> bpp)</div>
<div class="line"><a name="l04714"></a><span class="lineno"> 4714</span>&#160;{</div>
<div class="line"><a name="l04715"></a><span class="lineno"> 4715</span>&#160;  <span class="comment">/*Note: this function works on image buffers WITHOUT padding bits at end of scanlines with non-multiple-of-8</span></div>
<div class="line"><a name="l04716"></a><span class="lineno"> 4716</span>&#160;<span class="comment">  bit amounts, only between reduced images is padding*/</span></div>
<div class="line"><a name="l04717"></a><span class="lineno"> 4717</span>&#160;  <span class="keywordtype">unsigned</span> passw[7], passh[7];</div>
<div class="line"><a name="l04718"></a><span class="lineno"> 4718</span>&#160;  <span class="keywordtype">size_t</span> filter_passstart[8], padded_passstart[8], passstart[8];</div>
<div class="line"><a name="l04719"></a><span class="lineno"> 4719</span>&#160;  <span class="keywordtype">unsigned</span> i;</div>
<div class="line"><a name="l04720"></a><span class="lineno"> 4720</span>&#160;</div>
<div class="line"><a name="l04721"></a><span class="lineno"> 4721</span>&#160;  Adam7_getpassvalues(passw, passh, filter_passstart, padded_passstart, passstart, w, h, bpp);</div>
<div class="line"><a name="l04722"></a><span class="lineno"> 4722</span>&#160;</div>
<div class="line"><a name="l04723"></a><span class="lineno"> 4723</span>&#160;  <span class="keywordflow">if</span>(bpp &gt;= 8)</div>
<div class="line"><a name="l04724"></a><span class="lineno"> 4724</span>&#160;  {</div>
<div class="line"><a name="l04725"></a><span class="lineno"> 4725</span>&#160;    <span class="keywordflow">for</span>(i = 0; i &lt; 7; i++)</div>
<div class="line"><a name="l04726"></a><span class="lineno"> 4726</span>&#160;    {</div>
<div class="line"><a name="l04727"></a><span class="lineno"> 4727</span>&#160;      <span class="keywordtype">unsigned</span> <a class="code" href="_d_l_l_imports_8inl.html#a801542531fe9fad1565d31155ba5517b">x</a>, <a class="code" href="_d_l_l_imports_8inl.html#af7bcdfc5a984ba9c6720d5f0416f249d">y</a>, b;</div>
<div class="line"><a name="l04728"></a><span class="lineno"> 4728</span>&#160;      <span class="keywordtype">size_t</span> bytewidth = bpp / 8;</div>
<div class="line"><a name="l04729"></a><span class="lineno"> 4729</span>&#160;      <span class="keywordflow">for</span>(y = 0; y &lt; passh[i]; y++)</div>
<div class="line"><a name="l04730"></a><span class="lineno"> 4730</span>&#160;      <span class="keywordflow">for</span>(x = 0; x &lt; passw[i]; x++)</div>
<div class="line"><a name="l04731"></a><span class="lineno"> 4731</span>&#160;      {</div>
<div class="line"><a name="l04732"></a><span class="lineno"> 4732</span>&#160;        <span class="keywordtype">size_t</span> pixelinstart = ((ADAM7_IY[i] + y * ADAM7_DY[i]) * w + ADAM7_IX[i] + x * ADAM7_DX[i]) * bytewidth;</div>
<div class="line"><a name="l04733"></a><span class="lineno"> 4733</span>&#160;        <span class="keywordtype">size_t</span> pixeloutstart = passstart[i] + (y * passw[i] + <a class="code" href="_d_l_l_imports_8inl.html#a801542531fe9fad1565d31155ba5517b">x</a>) * bytewidth;</div>
<div class="line"><a name="l04734"></a><span class="lineno"> 4734</span>&#160;        <span class="keywordflow">for</span>(b = 0; b &lt; bytewidth; b++)</div>
<div class="line"><a name="l04735"></a><span class="lineno"> 4735</span>&#160;        {</div>
<div class="line"><a name="l04736"></a><span class="lineno"> 4736</span>&#160;          out[pixeloutstart + b] = in[pixelinstart + b];</div>
<div class="line"><a name="l04737"></a><span class="lineno"> 4737</span>&#160;        }</div>
<div class="line"><a name="l04738"></a><span class="lineno"> 4738</span>&#160;      }</div>
<div class="line"><a name="l04739"></a><span class="lineno"> 4739</span>&#160;    }</div>
<div class="line"><a name="l04740"></a><span class="lineno"> 4740</span>&#160;  }</div>
<div class="line"><a name="l04741"></a><span class="lineno"> 4741</span>&#160;  <span class="keywordflow">else</span> <span class="comment">/*bpp &lt; 8: Adam7 with pixels &lt; 8 bit is a bit trickier: with bit pointers*/</span></div>
<div class="line"><a name="l04742"></a><span class="lineno"> 4742</span>&#160;  {</div>
<div class="line"><a name="l04743"></a><span class="lineno"> 4743</span>&#160;    <span class="keywordflow">for</span>(i = 0; i &lt; 7; i++)</div>
<div class="line"><a name="l04744"></a><span class="lineno"> 4744</span>&#160;    {</div>
<div class="line"><a name="l04745"></a><span class="lineno"> 4745</span>&#160;      <span class="keywordtype">unsigned</span> <a class="code" href="_d_l_l_imports_8inl.html#a801542531fe9fad1565d31155ba5517b">x</a>, <a class="code" href="_d_l_l_imports_8inl.html#af7bcdfc5a984ba9c6720d5f0416f249d">y</a>, b;</div>
<div class="line"><a name="l04746"></a><span class="lineno"> 4746</span>&#160;      <span class="keywordtype">unsigned</span> ilinebits = bpp * passw[i];</div>
<div class="line"><a name="l04747"></a><span class="lineno"> 4747</span>&#160;      <span class="keywordtype">unsigned</span> olinebits = bpp * w;</div>
<div class="line"><a name="l04748"></a><span class="lineno"> 4748</span>&#160;      <span class="keywordtype">size_t</span> obp, ibp; <span class="comment">/*bit pointers (for out and in buffer)*/</span></div>
<div class="line"><a name="l04749"></a><span class="lineno"> 4749</span>&#160;      <span class="keywordflow">for</span>(y = 0; y &lt; passh[i]; y++)</div>
<div class="line"><a name="l04750"></a><span class="lineno"> 4750</span>&#160;      <span class="keywordflow">for</span>(x = 0; x &lt; passw[i]; x++)</div>
<div class="line"><a name="l04751"></a><span class="lineno"> 4751</span>&#160;      {</div>
<div class="line"><a name="l04752"></a><span class="lineno"> 4752</span>&#160;        ibp = (ADAM7_IY[i] + y * ADAM7_DY[i]) * olinebits + (ADAM7_IX[i] + x * ADAM7_DX[i]) * bpp;</div>
<div class="line"><a name="l04753"></a><span class="lineno"> 4753</span>&#160;        obp = (8 * passstart[i]) + (y * ilinebits + x * bpp);</div>
<div class="line"><a name="l04754"></a><span class="lineno"> 4754</span>&#160;        <span class="keywordflow">for</span>(b = 0; b &lt; bpp; b++)</div>
<div class="line"><a name="l04755"></a><span class="lineno"> 4755</span>&#160;        {</div>
<div class="line"><a name="l04756"></a><span class="lineno"> 4756</span>&#160;          <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> bit = readBitFromReversedStream(&amp;ibp, in);</div>
<div class="line"><a name="l04757"></a><span class="lineno"> 4757</span>&#160;          setBitOfReversedStream(&amp;obp, out, bit);</div>
<div class="line"><a name="l04758"></a><span class="lineno"> 4758</span>&#160;        }</div>
<div class="line"><a name="l04759"></a><span class="lineno"> 4759</span>&#160;      }</div>
<div class="line"><a name="l04760"></a><span class="lineno"> 4760</span>&#160;    }</div>
<div class="line"><a name="l04761"></a><span class="lineno"> 4761</span>&#160;  }</div>
<div class="line"><a name="l04762"></a><span class="lineno"> 4762</span>&#160;}</div>
<div class="line"><a name="l04763"></a><span class="lineno"> 4763</span>&#160;</div>
<div class="line"><a name="l04764"></a><span class="lineno"> 4764</span>&#160;<span class="comment">/*out must be buffer big enough to contain uncompressed IDAT chunk data, and in must contain the full image.</span></div>
<div class="line"><a name="l04765"></a><span class="lineno"> 4765</span>&#160;<span class="comment">return value is error**/</span></div>
<div class="line"><a name="l04766"></a><span class="lineno"> 4766</span>&#160;<span class="keyword">static</span> <span class="keywordtype">unsigned</span> preProcessScanlines(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>** out, <span class="keywordtype">size_t</span>* outsize, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* in,</div>
<div class="line"><a name="l04767"></a><span class="lineno"> 4767</span>&#160;                                    <span class="keyword">const</span> <a class="code" href="struct_lode_p_n_g___info_png.html">LodePNG_InfoPng</a>* infoPng, <span class="keyword">const</span> <a class="code" href="struct_lode_p_n_g___encode_settings.html">LodePNG_EncodeSettings</a>* settings)</div>
<div class="line"><a name="l04768"></a><span class="lineno"> 4768</span>&#160;{</div>
<div class="line"><a name="l04769"></a><span class="lineno"> 4769</span>&#160;  <span class="comment">/*</span></div>
<div class="line"><a name="l04770"></a><span class="lineno"> 4770</span>&#160;<span class="comment">  This function converts the pure 2D image with the PNG&#39;s colortype, into filtered-padded-interlaced data. Steps:</span></div>
<div class="line"><a name="l04771"></a><span class="lineno"> 4771</span>&#160;<span class="comment">  *) if no Adam7: 1) add padding bits (= posible extra bits per scanline if bpp &lt; 8) 2) filter</span></div>
<div class="line"><a name="l04772"></a><span class="lineno"> 4772</span>&#160;<span class="comment">  *) if adam7: 1) Adam7_interlace 2) 7x add padding bits 3) 7x filter</span></div>
<div class="line"><a name="l04773"></a><span class="lineno"> 4773</span>&#160;<span class="comment">  */</span></div>
<div class="line"><a name="l04774"></a><span class="lineno"> 4774</span>&#160;  <span class="keywordtype">unsigned</span> bpp = <a class="code" href="lodepng_8cpp.html#a81151c0087467b4ac2a815b3234fdb5a">LodePNG_InfoColor_getBpp</a>(&amp;infoPng-&gt;<a class="code" href="struct_lode_p_n_g___info_png.html#acce58518f72f42ba94db4c1cfd69336b">color</a>);</div>
<div class="line"><a name="l04775"></a><span class="lineno"> 4775</span>&#160;  <span class="keywordtype">unsigned</span> w = infoPng-&gt;<a class="code" href="struct_lode_p_n_g___info_png.html#a74be99b177b28f3178c02139c4b7f149">width</a>;</div>
<div class="line"><a name="l04776"></a><span class="lineno"> 4776</span>&#160;  <span class="keywordtype">unsigned</span> h = infoPng-&gt;<a class="code" href="struct_lode_p_n_g___info_png.html#a4b87ec9649e7177af7a5f5e08e5bc491">height</a>;</div>
<div class="line"><a name="l04777"></a><span class="lineno"> 4777</span>&#160;  <span class="keywordtype">unsigned</span> error = 0;</div>
<div class="line"><a name="l04778"></a><span class="lineno"> 4778</span>&#160;</div>
<div class="line"><a name="l04779"></a><span class="lineno"> 4779</span>&#160;  <span class="keywordflow">if</span>(infoPng-&gt;<a class="code" href="struct_lode_p_n_g___info_png.html#ad261cbe064eb69a92638e880d99347ca">interlaceMethod</a> == 0)</div>
<div class="line"><a name="l04780"></a><span class="lineno"> 4780</span>&#160;  {</div>
<div class="line"><a name="l04781"></a><span class="lineno"> 4781</span>&#160;    *outsize = h + (h * ((w * bpp + 7) / 8)); <span class="comment">/*image size plus an extra byte per scanline + possible padding bits*/</span></div>
<div class="line"><a name="l04782"></a><span class="lineno"> 4782</span>&#160;    *out = (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>*)<a class="code" href="namespace_f_w.html#a440e071d8fdbc9789b728245caad99c0">malloc</a>(*outsize);</div>
<div class="line"><a name="l04783"></a><span class="lineno"> 4783</span>&#160;    <span class="keywordflow">if</span>(!(*out) &amp;&amp; (*outsize)) error = 9950; <span class="comment">/*alloc fail*/</span></div>
<div class="line"><a name="l04784"></a><span class="lineno"> 4784</span>&#160;</div>
<div class="line"><a name="l04785"></a><span class="lineno"> 4785</span>&#160;    <span class="keywordflow">if</span>(!error)</div>
<div class="line"><a name="l04786"></a><span class="lineno"> 4786</span>&#160;    {</div>
<div class="line"><a name="l04787"></a><span class="lineno"> 4787</span>&#160;      <span class="comment">/*non multiple of 8 bits per scanline, padding bits needed per scanline*/</span></div>
<div class="line"><a name="l04788"></a><span class="lineno"> 4788</span>&#160;      <span class="keywordflow">if</span>(bpp &lt; 8 &amp;&amp; w * bpp != ((w * bpp + 7) / 8) * 8)</div>
<div class="line"><a name="l04789"></a><span class="lineno"> 4789</span>&#160;      {</div>
<div class="line"><a name="l04790"></a><span class="lineno"> 4790</span>&#160;        <a class="code" href="structucvector.html">ucvector</a> padded;</div>
<div class="line"><a name="l04791"></a><span class="lineno"> 4791</span>&#160;        ucvector_init(&amp;padded);</div>
<div class="line"><a name="l04792"></a><span class="lineno"> 4792</span>&#160;        <span class="keywordflow">if</span>(!ucvector_resize(&amp;padded, h * ((w * bpp + 7) / 8))) error = 9951; <span class="comment">/*alloc fail*/</span></div>
<div class="line"><a name="l04793"></a><span class="lineno"> 4793</span>&#160;        <span class="keywordflow">if</span>(!error)</div>
<div class="line"><a name="l04794"></a><span class="lineno"> 4794</span>&#160;        {</div>
<div class="line"><a name="l04795"></a><span class="lineno"> 4795</span>&#160;          addPaddingBits(padded.<a class="code" href="structucvector.html#ace794c5713208c5a20f21762cd87c919">data</a>, in, ((w * bpp + 7) / 8) * 8, w * bpp, h);</div>
<div class="line"><a name="l04796"></a><span class="lineno"> 4796</span>&#160;          error = filter(*out, padded.<a class="code" href="structucvector.html#ace794c5713208c5a20f21762cd87c919">data</a>, w, h, &amp;infoPng-&gt;<a class="code" href="struct_lode_p_n_g___info_png.html#acce58518f72f42ba94db4c1cfd69336b">color</a>, settings);</div>
<div class="line"><a name="l04797"></a><span class="lineno"> 4797</span>&#160;        }</div>
<div class="line"><a name="l04798"></a><span class="lineno"> 4798</span>&#160;        ucvector_cleanup(&amp;padded);</div>
<div class="line"><a name="l04799"></a><span class="lineno"> 4799</span>&#160;      }</div>
<div class="line"><a name="l04800"></a><span class="lineno"> 4800</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l04801"></a><span class="lineno"> 4801</span>&#160;      {</div>
<div class="line"><a name="l04802"></a><span class="lineno"> 4802</span>&#160;        <span class="comment">/*we can immediatly filter into the out buffer, no other steps needed*/</span></div>
<div class="line"><a name="l04803"></a><span class="lineno"> 4803</span>&#160;        error = filter(*out, in, w, h, &amp;infoPng-&gt;<a class="code" href="struct_lode_p_n_g___info_png.html#acce58518f72f42ba94db4c1cfd69336b">color</a>, settings);</div>
<div class="line"><a name="l04804"></a><span class="lineno"> 4804</span>&#160;      }</div>
<div class="line"><a name="l04805"></a><span class="lineno"> 4805</span>&#160;    }</div>
<div class="line"><a name="l04806"></a><span class="lineno"> 4806</span>&#160;  }</div>
<div class="line"><a name="l04807"></a><span class="lineno"> 4807</span>&#160;  <span class="keywordflow">else</span> <span class="comment">/*interlaceMethod is 1 (Adam7)*/</span></div>
<div class="line"><a name="l04808"></a><span class="lineno"> 4808</span>&#160;  {</div>
<div class="line"><a name="l04809"></a><span class="lineno"> 4809</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* adam7 = (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>*)<a class="code" href="namespace_f_w.html#a440e071d8fdbc9789b728245caad99c0">malloc</a>((h * w * bpp + 7) / 8);</div>
<div class="line"><a name="l04810"></a><span class="lineno"> 4810</span>&#160;    <span class="keywordflow">if</span>(!adam7 &amp;&amp; ((h * w * bpp + 7) / 8)) error = 9952; <span class="comment">/*alloc fail*/</span></div>
<div class="line"><a name="l04811"></a><span class="lineno"> 4811</span>&#160;</div>
<div class="line"><a name="l04812"></a><span class="lineno"> 4812</span>&#160;    <span class="keywordflow">while</span>(!error) <span class="comment">/*not a real while loop, used to break out to cleanup to avoid a goto*/</span></div>
<div class="line"><a name="l04813"></a><span class="lineno"> 4813</span>&#160;    {</div>
<div class="line"><a name="l04814"></a><span class="lineno"> 4814</span>&#160;      <span class="keywordtype">unsigned</span> passw[7], passh[7];</div>
<div class="line"><a name="l04815"></a><span class="lineno"> 4815</span>&#160;      <span class="keywordtype">size_t</span> filter_passstart[8], padded_passstart[8], passstart[8];</div>
<div class="line"><a name="l04816"></a><span class="lineno"> 4816</span>&#160;      <span class="keywordtype">unsigned</span> i;</div>
<div class="line"><a name="l04817"></a><span class="lineno"> 4817</span>&#160;</div>
<div class="line"><a name="l04818"></a><span class="lineno"> 4818</span>&#160;      Adam7_getpassvalues(passw, passh, filter_passstart, padded_passstart, passstart, w, h, bpp);</div>
<div class="line"><a name="l04819"></a><span class="lineno"> 4819</span>&#160;</div>
<div class="line"><a name="l04820"></a><span class="lineno"> 4820</span>&#160;      *outsize = filter_passstart[7]; <span class="comment">/*image size plus an extra byte per scanline + possible padding bits*/</span></div>
<div class="line"><a name="l04821"></a><span class="lineno"> 4821</span>&#160;      *out = (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>*)<a class="code" href="namespace_f_w.html#a440e071d8fdbc9789b728245caad99c0">malloc</a>(*outsize);</div>
<div class="line"><a name="l04822"></a><span class="lineno"> 4822</span>&#160;      <span class="keywordflow">if</span>(!(*out) &amp;&amp; (*outsize)) <a class="code" href="lodepng_8cpp.html#a691b23954341613b96b6d98ce67d339c">ERROR_BREAK</a>(9953 <span class="comment">/*alloc fail*/</span>);</div>
<div class="line"><a name="l04823"></a><span class="lineno"> 4823</span>&#160;</div>
<div class="line"><a name="l04824"></a><span class="lineno"> 4824</span>&#160;      Adam7_interlace(adam7, in, w, h, bpp);</div>
<div class="line"><a name="l04825"></a><span class="lineno"> 4825</span>&#160;</div>
<div class="line"><a name="l04826"></a><span class="lineno"> 4826</span>&#160;      <span class="keywordflow">for</span>(i = 0; i &lt; 7; i++)</div>
<div class="line"><a name="l04827"></a><span class="lineno"> 4827</span>&#160;      {</div>
<div class="line"><a name="l04828"></a><span class="lineno"> 4828</span>&#160;        <span class="keywordflow">if</span>(bpp &lt; 8)</div>
<div class="line"><a name="l04829"></a><span class="lineno"> 4829</span>&#160;        {</div>
<div class="line"><a name="l04830"></a><span class="lineno"> 4830</span>&#160;          <a class="code" href="structucvector.html">ucvector</a> padded;</div>
<div class="line"><a name="l04831"></a><span class="lineno"> 4831</span>&#160;          ucvector_init(&amp;padded);</div>
<div class="line"><a name="l04832"></a><span class="lineno"> 4832</span>&#160;          <span class="keywordflow">if</span>(!ucvector_resize(&amp;padded, h * ((w * bpp + 7) / 8))) error = 9954; <span class="comment">/*alloc fail*/</span></div>
<div class="line"><a name="l04833"></a><span class="lineno"> 4833</span>&#160;          <span class="keywordflow">if</span>(!error)</div>
<div class="line"><a name="l04834"></a><span class="lineno"> 4834</span>&#160;          {</div>
<div class="line"><a name="l04835"></a><span class="lineno"> 4835</span>&#160;            addPaddingBits(&amp;padded.<a class="code" href="structucvector.html#ace794c5713208c5a20f21762cd87c919">data</a>[padded_passstart[i]], &amp;adam7[passstart[i]],</div>
<div class="line"><a name="l04836"></a><span class="lineno"> 4836</span>&#160;                           ((passw[i] * bpp + 7) / 8) * 8, passw[i] * bpp, passh[i]);</div>
<div class="line"><a name="l04837"></a><span class="lineno"> 4837</span>&#160;            error = filter(&amp;(*out)[filter_passstart[i]], &amp;padded.<a class="code" href="structucvector.html#ace794c5713208c5a20f21762cd87c919">data</a>[padded_passstart[i]],</div>
<div class="line"><a name="l04838"></a><span class="lineno"> 4838</span>&#160;                           passw[i], passh[i], &amp;infoPng-&gt;<a class="code" href="struct_lode_p_n_g___info_png.html#acce58518f72f42ba94db4c1cfd69336b">color</a>, settings);</div>
<div class="line"><a name="l04839"></a><span class="lineno"> 4839</span>&#160;          }</div>
<div class="line"><a name="l04840"></a><span class="lineno"> 4840</span>&#160;</div>
<div class="line"><a name="l04841"></a><span class="lineno"> 4841</span>&#160;          ucvector_cleanup(&amp;padded);</div>
<div class="line"><a name="l04842"></a><span class="lineno"> 4842</span>&#160;        }</div>
<div class="line"><a name="l04843"></a><span class="lineno"> 4843</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l04844"></a><span class="lineno"> 4844</span>&#160;        {</div>
<div class="line"><a name="l04845"></a><span class="lineno"> 4845</span>&#160;          error = filter(&amp;(*out)[filter_passstart[i]], &amp;adam7[padded_passstart[i]],</div>
<div class="line"><a name="l04846"></a><span class="lineno"> 4846</span>&#160;                         passw[i], passh[i], &amp;infoPng-&gt;<a class="code" href="struct_lode_p_n_g___info_png.html#acce58518f72f42ba94db4c1cfd69336b">color</a>, settings);</div>
<div class="line"><a name="l04847"></a><span class="lineno"> 4847</span>&#160;        }</div>
<div class="line"><a name="l04848"></a><span class="lineno"> 4848</span>&#160;      }</div>
<div class="line"><a name="l04849"></a><span class="lineno"> 4849</span>&#160;</div>
<div class="line"><a name="l04850"></a><span class="lineno"> 4850</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04851"></a><span class="lineno"> 4851</span>&#160;    }</div>
<div class="line"><a name="l04852"></a><span class="lineno"> 4852</span>&#160;</div>
<div class="line"><a name="l04853"></a><span class="lineno"> 4853</span>&#160;    <a class="code" href="namespace_f_w.html#a93be8f55938d6ffb5ca0af1f95f81589">free</a>(adam7);</div>
<div class="line"><a name="l04854"></a><span class="lineno"> 4854</span>&#160;  }</div>
<div class="line"><a name="l04855"></a><span class="lineno"> 4855</span>&#160;</div>
<div class="line"><a name="l04856"></a><span class="lineno"> 4856</span>&#160;  <span class="keywordflow">return</span> error;</div>
<div class="line"><a name="l04857"></a><span class="lineno"> 4857</span>&#160;}</div>
<div class="line"><a name="l04858"></a><span class="lineno"> 4858</span>&#160;</div>
<div class="line"><a name="l04859"></a><span class="lineno"> 4859</span>&#160;<span class="comment">/*palette must have 4 * palettesize bytes allocated, and given in format RGBARGBARGBARGBA...*/</span></div>
<div class="line"><a name="l04860"></a><span class="lineno"> 4860</span>&#160;<span class="keyword">static</span> <span class="keywordtype">unsigned</span> isPaletteFullyOpaque(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* palette, <span class="keywordtype">size_t</span> palettesize)</div>
<div class="line"><a name="l04861"></a><span class="lineno"> 4861</span>&#160;{</div>
<div class="line"><a name="l04862"></a><span class="lineno"> 4862</span>&#160;  <span class="keywordtype">size_t</span> i;</div>
<div class="line"><a name="l04863"></a><span class="lineno"> 4863</span>&#160;  <span class="keywordflow">for</span>(i = 0; i &lt; palettesize; i++)</div>
<div class="line"><a name="l04864"></a><span class="lineno"> 4864</span>&#160;  {</div>
<div class="line"><a name="l04865"></a><span class="lineno"> 4865</span>&#160;    <span class="keywordflow">if</span>(palette[4 * i + 3] != 255) <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l04866"></a><span class="lineno"> 4866</span>&#160;  }</div>
<div class="line"><a name="l04867"></a><span class="lineno"> 4867</span>&#160;  <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l04868"></a><span class="lineno"> 4868</span>&#160;}</div>
<div class="line"><a name="l04869"></a><span class="lineno"> 4869</span>&#160;</div>
<div class="line"><a name="l04870"></a><span class="lineno"> 4870</span>&#160;<span class="comment">/*this function checks if the input image given by the user has no transparent pixels*/</span></div>
<div class="line"><a name="l04871"></a><span class="lineno"> 4871</span>&#160;<span class="keyword">static</span> <span class="keywordtype">unsigned</span> isFullyOpaque(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* <a class="code" href="_d_l_l_imports_8inl.html#af213c44c249febd5dd9ecd01be302487">image</a>, <span class="keywordtype">unsigned</span> w, <span class="keywordtype">unsigned</span> h, <span class="keyword">const</span> <a class="code" href="struct_lode_p_n_g___info_color.html">LodePNG_InfoColor</a>* info)</div>
<div class="line"><a name="l04872"></a><span class="lineno"> 4872</span>&#160;{</div>
<div class="line"><a name="l04873"></a><span class="lineno"> 4873</span>&#160;  <span class="comment">/*TODO: When the user specified a color key for the input image, then this function must</span></div>
<div class="line"><a name="l04874"></a><span class="lineno"> 4874</span>&#160;<span class="comment">  also check for pixels that are the same as the color key and treat those as transparent.*/</span></div>
<div class="line"><a name="l04875"></a><span class="lineno"> 4875</span>&#160;</div>
<div class="line"><a name="l04876"></a><span class="lineno"> 4876</span>&#160;  <span class="keywordtype">unsigned</span> i, numpixels = w * h;</div>
<div class="line"><a name="l04877"></a><span class="lineno"> 4877</span>&#160;  <span class="keywordflow">if</span>(info-&gt;<a class="code" href="struct_lode_p_n_g___info_color.html#a4ed18d179c5078137a18e742b1c41a00">colorType</a> == 6)</div>
<div class="line"><a name="l04878"></a><span class="lineno"> 4878</span>&#160;  {</div>
<div class="line"><a name="l04879"></a><span class="lineno"> 4879</span>&#160;    <span class="keywordflow">if</span>(info-&gt;<a class="code" href="struct_lode_p_n_g___info_color.html#a9d538965a46d59bbdea744da8b290591">bitDepth</a> == 8)</div>
<div class="line"><a name="l04880"></a><span class="lineno"> 4880</span>&#160;    {</div>
<div class="line"><a name="l04881"></a><span class="lineno"> 4881</span>&#160;      <span class="keywordflow">for</span>(i = 0; i &lt; numpixels; i++)</div>
<div class="line"><a name="l04882"></a><span class="lineno"> 4882</span>&#160;      {</div>
<div class="line"><a name="l04883"></a><span class="lineno"> 4883</span>&#160;        <span class="keywordflow">if</span>(image[i * 4 + 3] != 255) <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l04884"></a><span class="lineno"> 4884</span>&#160;      }</div>
<div class="line"><a name="l04885"></a><span class="lineno"> 4885</span>&#160;    }</div>
<div class="line"><a name="l04886"></a><span class="lineno"> 4886</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l04887"></a><span class="lineno"> 4887</span>&#160;    {</div>
<div class="line"><a name="l04888"></a><span class="lineno"> 4888</span>&#160;      <span class="keywordflow">for</span>(i = 0; i &lt; numpixels; i++)</div>
<div class="line"><a name="l04889"></a><span class="lineno"> 4889</span>&#160;      {</div>
<div class="line"><a name="l04890"></a><span class="lineno"> 4890</span>&#160;        <span class="keywordflow">if</span>(image[i * 8 + 6] != 255 || image[i * 8 + 7] != 255) <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l04891"></a><span class="lineno"> 4891</span>&#160;      }</div>
<div class="line"><a name="l04892"></a><span class="lineno"> 4892</span>&#160;    }</div>
<div class="line"><a name="l04893"></a><span class="lineno"> 4893</span>&#160;    <span class="keywordflow">return</span> 1; <span class="comment">/*no single pixel with alpha channel other than 255 found*/</span></div>
<div class="line"><a name="l04894"></a><span class="lineno"> 4894</span>&#160;  }</div>
<div class="line"><a name="l04895"></a><span class="lineno"> 4895</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span>(info-&gt;<a class="code" href="struct_lode_p_n_g___info_color.html#a4ed18d179c5078137a18e742b1c41a00">colorType</a> == 4)</div>
<div class="line"><a name="l04896"></a><span class="lineno"> 4896</span>&#160;  {</div>
<div class="line"><a name="l04897"></a><span class="lineno"> 4897</span>&#160;    <span class="keywordflow">if</span>(info-&gt;<a class="code" href="struct_lode_p_n_g___info_color.html#a9d538965a46d59bbdea744da8b290591">bitDepth</a> == 8)</div>
<div class="line"><a name="l04898"></a><span class="lineno"> 4898</span>&#160;    {</div>
<div class="line"><a name="l04899"></a><span class="lineno"> 4899</span>&#160;      <span class="keywordflow">for</span>(i = 0; i &lt; numpixels; i++)</div>
<div class="line"><a name="l04900"></a><span class="lineno"> 4900</span>&#160;      {</div>
<div class="line"><a name="l04901"></a><span class="lineno"> 4901</span>&#160;        <span class="keywordflow">if</span>(image[i * 2 + 1] != 255) <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l04902"></a><span class="lineno"> 4902</span>&#160;      }</div>
<div class="line"><a name="l04903"></a><span class="lineno"> 4903</span>&#160;    }</div>
<div class="line"><a name="l04904"></a><span class="lineno"> 4904</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l04905"></a><span class="lineno"> 4905</span>&#160;    {</div>
<div class="line"><a name="l04906"></a><span class="lineno"> 4906</span>&#160;      <span class="keywordflow">for</span>(i = 0; i &lt; numpixels; i++)</div>
<div class="line"><a name="l04907"></a><span class="lineno"> 4907</span>&#160;      {</div>
<div class="line"><a name="l04908"></a><span class="lineno"> 4908</span>&#160;        <span class="keywordflow">if</span>(image[i * 4 + 2] != 255 || image[i * 4 + 3] != 255) <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l04909"></a><span class="lineno"> 4909</span>&#160;      }</div>
<div class="line"><a name="l04910"></a><span class="lineno"> 4910</span>&#160;    }</div>
<div class="line"><a name="l04911"></a><span class="lineno"> 4911</span>&#160;    <span class="keywordflow">return</span> 1; <span class="comment">/*no single pixel with alpha channel other than 255 found*/</span></div>
<div class="line"><a name="l04912"></a><span class="lineno"> 4912</span>&#160;  }</div>
<div class="line"><a name="l04913"></a><span class="lineno"> 4913</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span>(info-&gt;<a class="code" href="struct_lode_p_n_g___info_color.html#a4ed18d179c5078137a18e742b1c41a00">colorType</a> == 3)</div>
<div class="line"><a name="l04914"></a><span class="lineno"> 4914</span>&#160;  {</div>
<div class="line"><a name="l04915"></a><span class="lineno"> 4915</span>&#160;    <span class="comment">/*when there&#39;s a palette, we could check every pixel for translucency,</span></div>
<div class="line"><a name="l04916"></a><span class="lineno"> 4916</span>&#160;<span class="comment">    but much quicker is to just check the palette*/</span></div>
<div class="line"><a name="l04917"></a><span class="lineno"> 4917</span>&#160;    <span class="keywordflow">return</span>(isPaletteFullyOpaque(info-&gt;<a class="code" href="struct_lode_p_n_g___info_color.html#ac6de7ff58cb1f39a73567abb826f72f5">palette</a>, info-&gt;<a class="code" href="struct_lode_p_n_g___info_color.html#a49842a304ffd0abc8aa791030c5fa5dd">palettesize</a>));</div>
<div class="line"><a name="l04918"></a><span class="lineno"> 4918</span>&#160;  }</div>
<div class="line"><a name="l04919"></a><span class="lineno"> 4919</span>&#160;</div>
<div class="line"><a name="l04920"></a><span class="lineno"> 4920</span>&#160;  <span class="keywordflow">return</span> 0; <span class="comment">/*color type that isn&#39;t supported by this function yet, so assume there is transparency to be safe*/</span></div>
<div class="line"><a name="l04921"></a><span class="lineno"> 4921</span>&#160;}</div>
<div class="line"><a name="l04922"></a><span class="lineno"> 4922</span>&#160;</div>
<div class="line"><a name="l04923"></a><span class="lineno"> 4923</span>&#160;<span class="preprocessor">#ifdef LODEPNG_COMPILE_UNKNOWN_CHUNKS</span></div>
<div class="line"><a name="l04924"></a><span class="lineno"> 4924</span>&#160;<span class="preprocessor"></span><span class="keyword">static</span> <span class="keywordtype">unsigned</span> addUnknownChunks(<a class="code" href="structucvector.html">ucvector</a>* out, <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* data, <span class="keywordtype">size_t</span> datasize)</div>
<div class="line"><a name="l04925"></a><span class="lineno"> 4925</span>&#160;{</div>
<div class="line"><a name="l04926"></a><span class="lineno"> 4926</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* inchunk = <a class="code" href="_d_l_l_imports_8inl.html#a156a9c7e986e0352d0fe500e629d5171">data</a>;</div>
<div class="line"><a name="l04927"></a><span class="lineno"> 4927</span>&#160;  <span class="keywordflow">while</span>((<span class="keywordtype">size_t</span>)(inchunk - data) &lt; datasize)</div>
<div class="line"><a name="l04928"></a><span class="lineno"> 4928</span>&#160;  {</div>
<div class="line"><a name="l04929"></a><span class="lineno"> 4929</span>&#160;    <span class="keywordtype">unsigned</span> error = <a class="code" href="lodepng_8cpp.html#a8047414db7062af3671e20c90a4a4ae7">LodePNG_append_chunk</a>(&amp;out-&gt;<a class="code" href="structucvector.html#ace794c5713208c5a20f21762cd87c919">data</a>, &amp;out-&gt;<a class="code" href="structucvector.html#a27c99c34de0c5b3ca0c242d402c69499">size</a>, inchunk);</div>
<div class="line"><a name="l04930"></a><span class="lineno"> 4930</span>&#160;    <span class="keywordflow">if</span>(error) <span class="keywordflow">return</span> error; <span class="comment">/*error: not enough memory*/</span></div>
<div class="line"><a name="l04931"></a><span class="lineno"> 4931</span>&#160;    out-&gt;<a class="code" href="structucvector.html#a235168baac13f0c78bd3e309dc170f90">allocsize</a> = out-&gt;<a class="code" href="structucvector.html#a27c99c34de0c5b3ca0c242d402c69499">size</a>; <span class="comment">/*fix the allocsize again*/</span></div>
<div class="line"><a name="l04932"></a><span class="lineno"> 4932</span>&#160;    inchunk = <a class="code" href="lodepng_8cpp.html#ab1a96344114c67ce549c848c44a9597b">LodePNG_chunk_next</a>(inchunk);</div>
<div class="line"><a name="l04933"></a><span class="lineno"> 4933</span>&#160;  }</div>
<div class="line"><a name="l04934"></a><span class="lineno"> 4934</span>&#160;  <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l04935"></a><span class="lineno"> 4935</span>&#160;}</div>
<div class="line"><a name="l04936"></a><span class="lineno"> 4936</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/*LODEPNG_COMPILE_UNKNOWN_CHUNKS*/</span><span class="preprocessor"></span></div>
<div class="line"><a name="l04937"></a><span class="lineno"> 4937</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l04938"></a><span class="lineno"><a class="line" href="lodepng_8h.html#a125bf00fe358f550d268f19b48527ef3"> 4938</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="lodepng_8cpp.html#a125bf00fe358f550d268f19b48527ef3">LodePNG_Encoder_encode</a>(<a class="code" href="struct_lode_p_n_g___encoder.html">LodePNG_Encoder</a>* encoder, <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>** out, <span class="keywordtype">size_t</span>* outsize,</div>
<div class="line"><a name="l04939"></a><span class="lineno"> 4939</span>&#160;                            <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* image, <span class="keywordtype">unsigned</span> w, <span class="keywordtype">unsigned</span> h)</div>
<div class="line"><a name="l04940"></a><span class="lineno"> 4940</span>&#160;{</div>
<div class="line"><a name="l04941"></a><span class="lineno"> 4941</span>&#160;  <a class="code" href="struct_lode_p_n_g___info_png.html">LodePNG_InfoPng</a> info;</div>
<div class="line"><a name="l04942"></a><span class="lineno"> 4942</span>&#160;  <a class="code" href="structucvector.html">ucvector</a> outv;</div>
<div class="line"><a name="l04943"></a><span class="lineno"> 4943</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* data = 0; <span class="comment">/*uncompressed version of the IDAT chunk data*/</span></div>
<div class="line"><a name="l04944"></a><span class="lineno"> 4944</span>&#160;  <span class="keywordtype">size_t</span> datasize = 0;</div>
<div class="line"><a name="l04945"></a><span class="lineno"> 4945</span>&#160;</div>
<div class="line"><a name="l04946"></a><span class="lineno"> 4946</span>&#160;  <span class="comment">/*provide some proper output values if error will happen*/</span></div>
<div class="line"><a name="l04947"></a><span class="lineno"> 4947</span>&#160;  *out = 0;</div>
<div class="line"><a name="l04948"></a><span class="lineno"> 4948</span>&#160;  *outsize = 0;</div>
<div class="line"><a name="l04949"></a><span class="lineno"> 4949</span>&#160;  encoder-&gt;<a class="code" href="struct_lode_p_n_g___encoder.html#a18e658a08db22dd34fc26c138f3eb2df">error</a> = 0;</div>
<div class="line"><a name="l04950"></a><span class="lineno"> 4950</span>&#160;</div>
<div class="line"><a name="l04951"></a><span class="lineno"> 4951</span>&#160;  <span class="comment">/*UNSAFE copy to avoid having to cleanup! but we will only change primitive parameters,</span></div>
<div class="line"><a name="l04952"></a><span class="lineno"> 4952</span>&#160;<span class="comment">  and not invoke the cleanup function nor touch the palette&#39;s buffer so we use it safely*/</span></div>
<div class="line"><a name="l04953"></a><span class="lineno"> 4953</span>&#160;  info = encoder-&gt;<a class="code" href="struct_lode_p_n_g___encoder.html#a5c4bc6d9be898fbcc14b5d762d69457e">infoPng</a>;</div>
<div class="line"><a name="l04954"></a><span class="lineno"> 4954</span>&#160;  info.<a class="code" href="struct_lode_p_n_g___info_png.html#a74be99b177b28f3178c02139c4b7f149">width</a> = w;</div>
<div class="line"><a name="l04955"></a><span class="lineno"> 4955</span>&#160;  info.<a class="code" href="struct_lode_p_n_g___info_png.html#a4b87ec9649e7177af7a5f5e08e5bc491">height</a> = h;</div>
<div class="line"><a name="l04956"></a><span class="lineno"> 4956</span>&#160;</div>
<div class="line"><a name="l04957"></a><span class="lineno"> 4957</span>&#160;  <span class="keywordflow">if</span>(encoder-&gt;<a class="code" href="struct_lode_p_n_g___encoder.html#ae36ceb21b9d1007491f4edbb2be12bab">settings</a>.<a class="code" href="struct_lode_p_n_g___encode_settings.html#a5074182840fae2ac4399ca9fa6660b41">autoLeaveOutAlphaChannel</a> &amp;&amp; isFullyOpaque(image, w, h, &amp;encoder-&gt;<a class="code" href="struct_lode_p_n_g___encoder.html#af37ca9b0bcecd5d1d68756fd293ab998">infoRaw</a>.<a class="code" href="struct_lode_p_n_g___info_raw.html#ae9fa1c020358980be41f861ab71589fb">color</a>))</div>
<div class="line"><a name="l04958"></a><span class="lineno"> 4958</span>&#160;  {</div>
<div class="line"><a name="l04959"></a><span class="lineno"> 4959</span>&#160;    <span class="comment">/*go to a color type without alpha channel*/</span></div>
<div class="line"><a name="l04960"></a><span class="lineno"> 4960</span>&#160;    <span class="keywordflow">if</span>(info.<a class="code" href="struct_lode_p_n_g___info_png.html#acce58518f72f42ba94db4c1cfd69336b">color</a>.<a class="code" href="struct_lode_p_n_g___info_color.html#a4ed18d179c5078137a18e742b1c41a00">colorType</a> == 6) info.<a class="code" href="struct_lode_p_n_g___info_png.html#acce58518f72f42ba94db4c1cfd69336b">color</a>.<a class="code" href="struct_lode_p_n_g___info_color.html#a4ed18d179c5078137a18e742b1c41a00">colorType</a> = 2;</div>
<div class="line"><a name="l04961"></a><span class="lineno"> 4961</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(info.<a class="code" href="struct_lode_p_n_g___info_png.html#acce58518f72f42ba94db4c1cfd69336b">color</a>.<a class="code" href="struct_lode_p_n_g___info_color.html#a4ed18d179c5078137a18e742b1c41a00">colorType</a> == 4) info.<a class="code" href="struct_lode_p_n_g___info_png.html#acce58518f72f42ba94db4c1cfd69336b">color</a>.<a class="code" href="struct_lode_p_n_g___info_color.html#a4ed18d179c5078137a18e742b1c41a00">colorType</a> = 0;</div>
<div class="line"><a name="l04962"></a><span class="lineno"> 4962</span>&#160;  }</div>
<div class="line"><a name="l04963"></a><span class="lineno"> 4963</span>&#160;</div>
<div class="line"><a name="l04964"></a><span class="lineno"> 4964</span>&#160;  <span class="keywordflow">if</span>(encoder-&gt;<a class="code" href="struct_lode_p_n_g___encoder.html#ae36ceb21b9d1007491f4edbb2be12bab">settings</a>.<a class="code" href="struct_lode_p_n_g___encode_settings.html#ae2d55a9f02c8711e426c08f54d268279">zlibsettings</a>.<a class="code" href="struct_lode_p_n_g___compress_settings.html#adaebb6134716768bd1636aa97ec68b90">windowSize</a> &gt; 32768)</div>
<div class="line"><a name="l04965"></a><span class="lineno"> 4965</span>&#160;  {</div>
<div class="line"><a name="l04966"></a><span class="lineno"> 4966</span>&#160;    encoder-&gt;<a class="code" href="struct_lode_p_n_g___encoder.html#a18e658a08db22dd34fc26c138f3eb2df">error</a> = 60; <span class="comment">/*error: windowsize larger than allowed*/</span></div>
<div class="line"><a name="l04967"></a><span class="lineno"> 4967</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l04968"></a><span class="lineno"> 4968</span>&#160;  }</div>
<div class="line"><a name="l04969"></a><span class="lineno"> 4969</span>&#160;  <span class="keywordflow">if</span>(encoder-&gt;<a class="code" href="struct_lode_p_n_g___encoder.html#ae36ceb21b9d1007491f4edbb2be12bab">settings</a>.<a class="code" href="struct_lode_p_n_g___encode_settings.html#ae2d55a9f02c8711e426c08f54d268279">zlibsettings</a>.<a class="code" href="struct_lode_p_n_g___compress_settings.html#aafec7ef311a7ad4e2ad3b1184e2aa805">btype</a> &gt; 2)</div>
<div class="line"><a name="l04970"></a><span class="lineno"> 4970</span>&#160;  {</div>
<div class="line"><a name="l04971"></a><span class="lineno"> 4971</span>&#160;    encoder-&gt;<a class="code" href="struct_lode_p_n_g___encoder.html#a18e658a08db22dd34fc26c138f3eb2df">error</a> = 61; <span class="comment">/*error: unexisting btype*/</span></div>
<div class="line"><a name="l04972"></a><span class="lineno"> 4972</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l04973"></a><span class="lineno"> 4973</span>&#160;  }</div>
<div class="line"><a name="l04974"></a><span class="lineno"> 4974</span>&#160;  <span class="keywordflow">if</span>(encoder-&gt;<a class="code" href="struct_lode_p_n_g___encoder.html#a5c4bc6d9be898fbcc14b5d762d69457e">infoPng</a>.<a class="code" href="struct_lode_p_n_g___info_png.html#ad261cbe064eb69a92638e880d99347ca">interlaceMethod</a> &gt; 1)</div>
<div class="line"><a name="l04975"></a><span class="lineno"> 4975</span>&#160;  {</div>
<div class="line"><a name="l04976"></a><span class="lineno"> 4976</span>&#160;    encoder-&gt;<a class="code" href="struct_lode_p_n_g___encoder.html#a18e658a08db22dd34fc26c138f3eb2df">error</a> = 71; <span class="comment">/*error: unexisting interlace mode*/</span></div>
<div class="line"><a name="l04977"></a><span class="lineno"> 4977</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l04978"></a><span class="lineno"> 4978</span>&#160;  }</div>
<div class="line"><a name="l04979"></a><span class="lineno"> 4979</span>&#160;  <span class="comment">/*error: unexisting color type given*/</span></div>
<div class="line"><a name="l04980"></a><span class="lineno"> 4980</span>&#160;  <span class="keywordflow">if</span>((encoder-&gt;<a class="code" href="struct_lode_p_n_g___encoder.html#a18e658a08db22dd34fc26c138f3eb2df">error</a> = checkColorValidity(info.<a class="code" href="struct_lode_p_n_g___info_png.html#acce58518f72f42ba94db4c1cfd69336b">color</a>.<a class="code" href="struct_lode_p_n_g___info_color.html#a4ed18d179c5078137a18e742b1c41a00">colorType</a>, info.<a class="code" href="struct_lode_p_n_g___info_png.html#acce58518f72f42ba94db4c1cfd69336b">color</a>.<a class="code" href="struct_lode_p_n_g___info_color.html#a9d538965a46d59bbdea744da8b290591">bitDepth</a>))) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l04981"></a><span class="lineno"> 4981</span>&#160;  <span class="comment">/*error: unexisting color type given*/</span></div>
<div class="line"><a name="l04982"></a><span class="lineno"> 4982</span>&#160;  <span class="keywordflow">if</span>((encoder-&gt;<a class="code" href="struct_lode_p_n_g___encoder.html#a18e658a08db22dd34fc26c138f3eb2df">error</a> = checkColorValidity(encoder-&gt;<a class="code" href="struct_lode_p_n_g___encoder.html#af37ca9b0bcecd5d1d68756fd293ab998">infoRaw</a>.<a class="code" href="struct_lode_p_n_g___info_raw.html#ae9fa1c020358980be41f861ab71589fb">color</a>.<a class="code" href="struct_lode_p_n_g___info_color.html#a4ed18d179c5078137a18e742b1c41a00">colorType</a>, encoder-&gt;<a class="code" href="struct_lode_p_n_g___encoder.html#af37ca9b0bcecd5d1d68756fd293ab998">infoRaw</a>.<a class="code" href="struct_lode_p_n_g___info_raw.html#ae9fa1c020358980be41f861ab71589fb">color</a>.<a class="code" href="struct_lode_p_n_g___info_color.html#a9d538965a46d59bbdea744da8b290591">bitDepth</a>))) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l04983"></a><span class="lineno"> 4983</span>&#160;</div>
<div class="line"><a name="l04984"></a><span class="lineno"> 4984</span>&#160;  <span class="keywordflow">if</span>(!<a class="code" href="lodepng_8cpp.html#ac1a87f6ae0de91fe9c7716ff5dc3fbea">LodePNG_InfoColor_equal</a>(&amp;encoder-&gt;<a class="code" href="struct_lode_p_n_g___encoder.html#af37ca9b0bcecd5d1d68756fd293ab998">infoRaw</a>.<a class="code" href="struct_lode_p_n_g___info_raw.html#ae9fa1c020358980be41f861ab71589fb">color</a>, &amp;info.<a class="code" href="struct_lode_p_n_g___info_png.html#acce58518f72f42ba94db4c1cfd69336b">color</a>))</div>
<div class="line"><a name="l04985"></a><span class="lineno"> 4985</span>&#160;  {</div>
<div class="line"><a name="l04986"></a><span class="lineno"> 4986</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* converted;</div>
<div class="line"><a name="l04987"></a><span class="lineno"> 4987</span>&#160;    <span class="keywordtype">size_t</span> size = (w * h * <a class="code" href="lodepng_8cpp.html#a81151c0087467b4ac2a815b3234fdb5a">LodePNG_InfoColor_getBpp</a>(&amp;info.<a class="code" href="struct_lode_p_n_g___info_png.html#acce58518f72f42ba94db4c1cfd69336b">color</a>) + 7) / 8;</div>
<div class="line"><a name="l04988"></a><span class="lineno"> 4988</span>&#160;</div>
<div class="line"><a name="l04989"></a><span class="lineno"> 4989</span>&#160;    <span class="keywordflow">if</span>((info.<a class="code" href="struct_lode_p_n_g___info_png.html#acce58518f72f42ba94db4c1cfd69336b">color</a>.<a class="code" href="struct_lode_p_n_g___info_color.html#a4ed18d179c5078137a18e742b1c41a00">colorType</a> != 6 &amp;&amp; info.<a class="code" href="struct_lode_p_n_g___info_png.html#acce58518f72f42ba94db4c1cfd69336b">color</a>.<a class="code" href="struct_lode_p_n_g___info_color.html#a4ed18d179c5078137a18e742b1c41a00">colorType</a> != 2) || (info.<a class="code" href="struct_lode_p_n_g___info_png.html#acce58518f72f42ba94db4c1cfd69336b">color</a>.<a class="code" href="struct_lode_p_n_g___info_color.html#a9d538965a46d59bbdea744da8b290591">bitDepth</a> != 8))</div>
<div class="line"><a name="l04990"></a><span class="lineno"> 4990</span>&#160;    {</div>
<div class="line"><a name="l04991"></a><span class="lineno"> 4991</span>&#160;      encoder-&gt;<a class="code" href="struct_lode_p_n_g___encoder.html#a18e658a08db22dd34fc26c138f3eb2df">error</a> = 59; <span class="comment">/*for the output image, only these types are supported*/</span></div>
<div class="line"><a name="l04992"></a><span class="lineno"> 4992</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l04993"></a><span class="lineno"> 4993</span>&#160;    }</div>
<div class="line"><a name="l04994"></a><span class="lineno"> 4994</span>&#160;    converted = (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>*)<a class="code" href="namespace_f_w.html#a440e071d8fdbc9789b728245caad99c0">malloc</a>(size);</div>
<div class="line"><a name="l04995"></a><span class="lineno"> 4995</span>&#160;    <span class="keywordflow">if</span>(!converted &amp;&amp; size) encoder-&gt;<a class="code" href="struct_lode_p_n_g___encoder.html#a18e658a08db22dd34fc26c138f3eb2df">error</a> = 9955; <span class="comment">/*alloc fail*/</span></div>
<div class="line"><a name="l04996"></a><span class="lineno"> 4996</span>&#160;    <span class="keywordflow">if</span>(!encoder-&gt;<a class="code" href="struct_lode_p_n_g___encoder.html#a18e658a08db22dd34fc26c138f3eb2df">error</a>)</div>
<div class="line"><a name="l04997"></a><span class="lineno"> 4997</span>&#160;    {</div>
<div class="line"><a name="l04998"></a><span class="lineno"> 4998</span>&#160;      encoder-&gt;<a class="code" href="struct_lode_p_n_g___encoder.html#a18e658a08db22dd34fc26c138f3eb2df">error</a> = <a class="code" href="lodepng_8cpp.html#a9e7ce5d1928b44ba6a7c30465b996c68">LodePNG_convert</a>(converted, image, &amp;info.<a class="code" href="struct_lode_p_n_g___info_png.html#acce58518f72f42ba94db4c1cfd69336b">color</a>, &amp;encoder-&gt;<a class="code" href="struct_lode_p_n_g___encoder.html#af37ca9b0bcecd5d1d68756fd293ab998">infoRaw</a>.<a class="code" href="struct_lode_p_n_g___info_raw.html#ae9fa1c020358980be41f861ab71589fb">color</a>, w, h);</div>
<div class="line"><a name="l04999"></a><span class="lineno"> 4999</span>&#160;    }</div>
<div class="line"><a name="l05000"></a><span class="lineno"> 5000</span>&#160;    <span class="keywordflow">if</span>(!encoder-&gt;<a class="code" href="struct_lode_p_n_g___encoder.html#a18e658a08db22dd34fc26c138f3eb2df">error</a>) preProcessScanlines(&amp;data, &amp;datasize, converted, &amp;info, &amp;encoder-&gt;<a class="code" href="struct_lode_p_n_g___encoder.html#ae36ceb21b9d1007491f4edbb2be12bab">settings</a>);</div>
<div class="line"><a name="l05001"></a><span class="lineno"> 5001</span>&#160;    <a class="code" href="namespace_f_w.html#a93be8f55938d6ffb5ca0af1f95f81589">free</a>(converted);</div>
<div class="line"><a name="l05002"></a><span class="lineno"> 5002</span>&#160;  }</div>
<div class="line"><a name="l05003"></a><span class="lineno"> 5003</span>&#160;  <span class="keywordflow">else</span> preProcessScanlines(&amp;data, &amp;datasize, image, &amp;info, &amp;encoder-&gt;<a class="code" href="struct_lode_p_n_g___encoder.html#ae36ceb21b9d1007491f4edbb2be12bab">settings</a>);</div>
<div class="line"><a name="l05004"></a><span class="lineno"> 5004</span>&#160;</div>
<div class="line"><a name="l05005"></a><span class="lineno"> 5005</span>&#160;  ucvector_init(&amp;outv);</div>
<div class="line"><a name="l05006"></a><span class="lineno"> 5006</span>&#160;  <span class="keywordflow">while</span>(!encoder-&gt;<a class="code" href="struct_lode_p_n_g___encoder.html#a18e658a08db22dd34fc26c138f3eb2df">error</a>) <span class="comment">/*while only executed once, to break on error*/</span></div>
<div class="line"><a name="l05007"></a><span class="lineno"> 5007</span>&#160;  {</div>
<div class="line"><a name="l05008"></a><span class="lineno"> 5008</span>&#160;<span class="preprocessor">#ifdef LODEPNG_COMPILE_ANCILLARY_CHUNKS</span></div>
<div class="line"><a name="l05009"></a><span class="lineno"> 5009</span>&#160;<span class="preprocessor"></span>    <span class="keywordtype">size_t</span> i;</div>
<div class="line"><a name="l05010"></a><span class="lineno"> 5010</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/*LODEPNG_COMPILE_ANCILLARY_CHUNKS*/</span><span class="preprocessor"></span></div>
<div class="line"><a name="l05011"></a><span class="lineno"> 5011</span>&#160;<span class="preprocessor"></span>    <span class="comment">/*write signature and chunks*/</span></div>
<div class="line"><a name="l05012"></a><span class="lineno"> 5012</span>&#160;    writeSignature(&amp;outv);</div>
<div class="line"><a name="l05013"></a><span class="lineno"> 5013</span>&#160;    <span class="comment">/*IHDR*/</span></div>
<div class="line"><a name="l05014"></a><span class="lineno"> 5014</span>&#160;    addChunk_IHDR(&amp;outv, w, h, info.<a class="code" href="struct_lode_p_n_g___info_png.html#acce58518f72f42ba94db4c1cfd69336b">color</a>.<a class="code" href="struct_lode_p_n_g___info_color.html#a9d538965a46d59bbdea744da8b290591">bitDepth</a>, info.<a class="code" href="struct_lode_p_n_g___info_png.html#acce58518f72f42ba94db4c1cfd69336b">color</a>.<a class="code" href="struct_lode_p_n_g___info_color.html#a4ed18d179c5078137a18e742b1c41a00">colorType</a>, info.<a class="code" href="struct_lode_p_n_g___info_png.html#ad261cbe064eb69a92638e880d99347ca">interlaceMethod</a>);</div>
<div class="line"><a name="l05015"></a><span class="lineno"> 5015</span>&#160;<span class="preprocessor">#ifdef LODEPNG_COMPILE_UNKNOWN_CHUNKS</span></div>
<div class="line"><a name="l05016"></a><span class="lineno"> 5016</span>&#160;<span class="preprocessor"></span>    <span class="comment">/*unknown chunks between IHDR and PLTE*/</span></div>
<div class="line"><a name="l05017"></a><span class="lineno"> 5017</span>&#160;    <span class="keywordflow">if</span>(info.<a class="code" href="struct_lode_p_n_g___info_png.html#a97faa43bfd4e8f8df1cd836c713edac3">unknown_chunks</a>.<a class="code" href="struct_lode_p_n_g___unknown_chunks.html#a9923d61d31e17e7093194da5182eda97">data</a>[0])</div>
<div class="line"><a name="l05018"></a><span class="lineno"> 5018</span>&#160;    {</div>
<div class="line"><a name="l05019"></a><span class="lineno"> 5019</span>&#160;      encoder-&gt;<a class="code" href="struct_lode_p_n_g___encoder.html#a18e658a08db22dd34fc26c138f3eb2df">error</a> = addUnknownChunks(&amp;outv, info.<a class="code" href="struct_lode_p_n_g___info_png.html#a97faa43bfd4e8f8df1cd836c713edac3">unknown_chunks</a>.<a class="code" href="struct_lode_p_n_g___unknown_chunks.html#a9923d61d31e17e7093194da5182eda97">data</a>[0], info.<a class="code" href="struct_lode_p_n_g___info_png.html#a97faa43bfd4e8f8df1cd836c713edac3">unknown_chunks</a>.<a class="code" href="struct_lode_p_n_g___unknown_chunks.html#ab124de165db15c6cd5db43378c8ae15a">datasize</a>[0]);</div>
<div class="line"><a name="l05020"></a><span class="lineno"> 5020</span>&#160;      <span class="keywordflow">if</span>(encoder-&gt;<a class="code" href="struct_lode_p_n_g___encoder.html#a18e658a08db22dd34fc26c138f3eb2df">error</a>) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l05021"></a><span class="lineno"> 5021</span>&#160;    }</div>
<div class="line"><a name="l05022"></a><span class="lineno"> 5022</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/*LODEPNG_COMPILE_UNKNOWN_CHUNKS*/</span><span class="preprocessor"></span></div>
<div class="line"><a name="l05023"></a><span class="lineno"> 5023</span>&#160;<span class="preprocessor"></span>    <span class="comment">/*PLTE*/</span></div>
<div class="line"><a name="l05024"></a><span class="lineno"> 5024</span>&#160;    <span class="keywordflow">if</span>(info.<a class="code" href="struct_lode_p_n_g___info_png.html#acce58518f72f42ba94db4c1cfd69336b">color</a>.<a class="code" href="struct_lode_p_n_g___info_color.html#a4ed18d179c5078137a18e742b1c41a00">colorType</a> == 3)</div>
<div class="line"><a name="l05025"></a><span class="lineno"> 5025</span>&#160;    {</div>
<div class="line"><a name="l05026"></a><span class="lineno"> 5026</span>&#160;      <span class="keywordflow">if</span>(info.<a class="code" href="struct_lode_p_n_g___info_png.html#acce58518f72f42ba94db4c1cfd69336b">color</a>.<a class="code" href="struct_lode_p_n_g___info_color.html#a49842a304ffd0abc8aa791030c5fa5dd">palettesize</a> == 0 || info.<a class="code" href="struct_lode_p_n_g___info_png.html#acce58518f72f42ba94db4c1cfd69336b">color</a>.<a class="code" href="struct_lode_p_n_g___info_color.html#a49842a304ffd0abc8aa791030c5fa5dd">palettesize</a> &gt; 256)</div>
<div class="line"><a name="l05027"></a><span class="lineno"> 5027</span>&#160;      {</div>
<div class="line"><a name="l05028"></a><span class="lineno"> 5028</span>&#160;        encoder-&gt;<a class="code" href="struct_lode_p_n_g___encoder.html#a18e658a08db22dd34fc26c138f3eb2df">error</a> = 68; <span class="comment">/*invalid palette size*/</span></div>
<div class="line"><a name="l05029"></a><span class="lineno"> 5029</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l05030"></a><span class="lineno"> 5030</span>&#160;      }</div>
<div class="line"><a name="l05031"></a><span class="lineno"> 5031</span>&#160;      addChunk_PLTE(&amp;outv, &amp;info.<a class="code" href="struct_lode_p_n_g___info_png.html#acce58518f72f42ba94db4c1cfd69336b">color</a>);</div>
<div class="line"><a name="l05032"></a><span class="lineno"> 5032</span>&#160;    }</div>
<div class="line"><a name="l05033"></a><span class="lineno"> 5033</span>&#160;    <span class="keywordflow">if</span>(encoder-&gt;<a class="code" href="struct_lode_p_n_g___encoder.html#ae36ceb21b9d1007491f4edbb2be12bab">settings</a>.<a class="code" href="struct_lode_p_n_g___encode_settings.html#a44de1047cd9f3bfd55bf8c5313620065">force_palette</a> &amp;&amp; (info.<a class="code" href="struct_lode_p_n_g___info_png.html#acce58518f72f42ba94db4c1cfd69336b">color</a>.<a class="code" href="struct_lode_p_n_g___info_color.html#a4ed18d179c5078137a18e742b1c41a00">colorType</a> == 2 || info.<a class="code" href="struct_lode_p_n_g___info_png.html#acce58518f72f42ba94db4c1cfd69336b">color</a>.<a class="code" href="struct_lode_p_n_g___info_color.html#a4ed18d179c5078137a18e742b1c41a00">colorType</a> == 6))</div>
<div class="line"><a name="l05034"></a><span class="lineno"> 5034</span>&#160;    {</div>
<div class="line"><a name="l05035"></a><span class="lineno"> 5035</span>&#160;      <span class="keywordflow">if</span>(info.<a class="code" href="struct_lode_p_n_g___info_png.html#acce58518f72f42ba94db4c1cfd69336b">color</a>.<a class="code" href="struct_lode_p_n_g___info_color.html#a49842a304ffd0abc8aa791030c5fa5dd">palettesize</a> == 0 || info.<a class="code" href="struct_lode_p_n_g___info_png.html#acce58518f72f42ba94db4c1cfd69336b">color</a>.<a class="code" href="struct_lode_p_n_g___info_color.html#a49842a304ffd0abc8aa791030c5fa5dd">palettesize</a> &gt; 256)</div>
<div class="line"><a name="l05036"></a><span class="lineno"> 5036</span>&#160;      {</div>
<div class="line"><a name="l05037"></a><span class="lineno"> 5037</span>&#160;        encoder-&gt;<a class="code" href="struct_lode_p_n_g___encoder.html#a18e658a08db22dd34fc26c138f3eb2df">error</a> = 68; <span class="comment">/*invalid palette size*/</span></div>
<div class="line"><a name="l05038"></a><span class="lineno"> 5038</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l05039"></a><span class="lineno"> 5039</span>&#160;      }</div>
<div class="line"><a name="l05040"></a><span class="lineno"> 5040</span>&#160;      addChunk_PLTE(&amp;outv, &amp;info.<a class="code" href="struct_lode_p_n_g___info_png.html#acce58518f72f42ba94db4c1cfd69336b">color</a>);</div>
<div class="line"><a name="l05041"></a><span class="lineno"> 5041</span>&#160;    }</div>
<div class="line"><a name="l05042"></a><span class="lineno"> 5042</span>&#160;    <span class="comment">/*tRNS*/</span></div>
<div class="line"><a name="l05043"></a><span class="lineno"> 5043</span>&#160;    <span class="keywordflow">if</span>(info.<a class="code" href="struct_lode_p_n_g___info_png.html#acce58518f72f42ba94db4c1cfd69336b">color</a>.<a class="code" href="struct_lode_p_n_g___info_color.html#a4ed18d179c5078137a18e742b1c41a00">colorType</a> == 3 &amp;&amp; !isPaletteFullyOpaque(info.<a class="code" href="struct_lode_p_n_g___info_png.html#acce58518f72f42ba94db4c1cfd69336b">color</a>.<a class="code" href="struct_lode_p_n_g___info_color.html#ac6de7ff58cb1f39a73567abb826f72f5">palette</a>, info.<a class="code" href="struct_lode_p_n_g___info_png.html#acce58518f72f42ba94db4c1cfd69336b">color</a>.<a class="code" href="struct_lode_p_n_g___info_color.html#a49842a304ffd0abc8aa791030c5fa5dd">palettesize</a>))</div>
<div class="line"><a name="l05044"></a><span class="lineno"> 5044</span>&#160;    {</div>
<div class="line"><a name="l05045"></a><span class="lineno"> 5045</span>&#160;      addChunk_tRNS(&amp;outv, &amp;info.<a class="code" href="struct_lode_p_n_g___info_png.html#acce58518f72f42ba94db4c1cfd69336b">color</a>);</div>
<div class="line"><a name="l05046"></a><span class="lineno"> 5046</span>&#160;    }</div>
<div class="line"><a name="l05047"></a><span class="lineno"> 5047</span>&#160;    <span class="keywordflow">if</span>((info.<a class="code" href="struct_lode_p_n_g___info_png.html#acce58518f72f42ba94db4c1cfd69336b">color</a>.<a class="code" href="struct_lode_p_n_g___info_color.html#a4ed18d179c5078137a18e742b1c41a00">colorType</a> == 0 || info.<a class="code" href="struct_lode_p_n_g___info_png.html#acce58518f72f42ba94db4c1cfd69336b">color</a>.<a class="code" href="struct_lode_p_n_g___info_color.html#a4ed18d179c5078137a18e742b1c41a00">colorType</a> == 2) &amp;&amp; info.<a class="code" href="struct_lode_p_n_g___info_png.html#acce58518f72f42ba94db4c1cfd69336b">color</a>.<a class="code" href="struct_lode_p_n_g___info_color.html#aa0193ce13025c776a0dfb1e6d1bed14a">key_defined</a>)</div>
<div class="line"><a name="l05048"></a><span class="lineno"> 5048</span>&#160;    {</div>
<div class="line"><a name="l05049"></a><span class="lineno"> 5049</span>&#160;      addChunk_tRNS(&amp;outv, &amp;info.<a class="code" href="struct_lode_p_n_g___info_png.html#acce58518f72f42ba94db4c1cfd69336b">color</a>);</div>
<div class="line"><a name="l05050"></a><span class="lineno"> 5050</span>&#160;    }</div>
<div class="line"><a name="l05051"></a><span class="lineno"> 5051</span>&#160;<span class="preprocessor">#ifdef LODEPNG_COMPILE_ANCILLARY_CHUNKS</span></div>
<div class="line"><a name="l05052"></a><span class="lineno"> 5052</span>&#160;<span class="preprocessor"></span>    <span class="comment">/*bKGD (must come between PLTE and the IDAt chunks*/</span></div>
<div class="line"><a name="l05053"></a><span class="lineno"> 5053</span>&#160;    <span class="keywordflow">if</span>(info.<a class="code" href="struct_lode_p_n_g___info_png.html#a37f6cddbe33b775fab09a91076b72f4c">background_defined</a>) addChunk_bKGD(&amp;outv, &amp;info);</div>
<div class="line"><a name="l05054"></a><span class="lineno"> 5054</span>&#160;    <span class="comment">/*pHYs (must come before the IDAT chunks)*/</span></div>
<div class="line"><a name="l05055"></a><span class="lineno"> 5055</span>&#160;    <span class="keywordflow">if</span>(info.<a class="code" href="struct_lode_p_n_g___info_png.html#a0f0b0d882e5c099d06d608c79295ba2d">phys_defined</a>) addChunk_pHYs(&amp;outv, &amp;info);</div>
<div class="line"><a name="l05056"></a><span class="lineno"> 5056</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/*LODEPNG_COMPILE_ANCILLARY_CHUNKS*/</span><span class="preprocessor"></span></div>
<div class="line"><a name="l05057"></a><span class="lineno"> 5057</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef LODEPNG_COMPILE_UNKNOWN_CHUNKS</span></div>
<div class="line"><a name="l05058"></a><span class="lineno"> 5058</span>&#160;<span class="preprocessor"></span>    <span class="comment">/*unknown chunks between PLTE and IDAT*/</span></div>
<div class="line"><a name="l05059"></a><span class="lineno"> 5059</span>&#160;    <span class="keywordflow">if</span>(info.<a class="code" href="struct_lode_p_n_g___info_png.html#a97faa43bfd4e8f8df1cd836c713edac3">unknown_chunks</a>.<a class="code" href="struct_lode_p_n_g___unknown_chunks.html#a9923d61d31e17e7093194da5182eda97">data</a>[1])</div>
<div class="line"><a name="l05060"></a><span class="lineno"> 5060</span>&#160;    {</div>
<div class="line"><a name="l05061"></a><span class="lineno"> 5061</span>&#160;      encoder-&gt;<a class="code" href="struct_lode_p_n_g___encoder.html#a18e658a08db22dd34fc26c138f3eb2df">error</a> = addUnknownChunks(&amp;outv, info.<a class="code" href="struct_lode_p_n_g___info_png.html#a97faa43bfd4e8f8df1cd836c713edac3">unknown_chunks</a>.<a class="code" href="struct_lode_p_n_g___unknown_chunks.html#a9923d61d31e17e7093194da5182eda97">data</a>[1], info.<a class="code" href="struct_lode_p_n_g___info_png.html#a97faa43bfd4e8f8df1cd836c713edac3">unknown_chunks</a>.<a class="code" href="struct_lode_p_n_g___unknown_chunks.html#ab124de165db15c6cd5db43378c8ae15a">datasize</a>[1]);</div>
<div class="line"><a name="l05062"></a><span class="lineno"> 5062</span>&#160;      <span class="keywordflow">if</span>(encoder-&gt;<a class="code" href="struct_lode_p_n_g___encoder.html#a18e658a08db22dd34fc26c138f3eb2df">error</a>) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l05063"></a><span class="lineno"> 5063</span>&#160;    }</div>
<div class="line"><a name="l05064"></a><span class="lineno"> 5064</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/*LODEPNG_COMPILE_UNKNOWN_CHUNKS*/</span><span class="preprocessor"></span></div>
<div class="line"><a name="l05065"></a><span class="lineno"> 5065</span>&#160;<span class="preprocessor"></span>    <span class="comment">/*IDAT (multiple IDAT chunks must be consecutive)*/</span></div>
<div class="line"><a name="l05066"></a><span class="lineno"> 5066</span>&#160;    encoder-&gt;<a class="code" href="struct_lode_p_n_g___encoder.html#a18e658a08db22dd34fc26c138f3eb2df">error</a> = addChunk_IDAT(&amp;outv, data, datasize, &amp;encoder-&gt;<a class="code" href="struct_lode_p_n_g___encoder.html#ae36ceb21b9d1007491f4edbb2be12bab">settings</a>.<a class="code" href="struct_lode_p_n_g___encode_settings.html#ae2d55a9f02c8711e426c08f54d268279">zlibsettings</a>);</div>
<div class="line"><a name="l05067"></a><span class="lineno"> 5067</span>&#160;    <span class="keywordflow">if</span>(encoder-&gt;<a class="code" href="struct_lode_p_n_g___encoder.html#a18e658a08db22dd34fc26c138f3eb2df">error</a>) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l05068"></a><span class="lineno"> 5068</span>&#160;<span class="preprocessor">#ifdef LODEPNG_COMPILE_ANCILLARY_CHUNKS</span></div>
<div class="line"><a name="l05069"></a><span class="lineno"> 5069</span>&#160;<span class="preprocessor"></span>    <span class="comment">/*tIME*/</span></div>
<div class="line"><a name="l05070"></a><span class="lineno"> 5070</span>&#160;    <span class="keywordflow">if</span>(info.<a class="code" href="struct_lode_p_n_g___info_png.html#aa220d359b0f73b1f61a87f1c3bf8aad6">time_defined</a>) addChunk_tIME(&amp;outv, &amp;info.<a class="code" href="struct_lode_p_n_g___info_png.html#a52e3f42ce7942e5ebd0c60db6737056a">time</a>);</div>
<div class="line"><a name="l05071"></a><span class="lineno"> 5071</span>&#160;    <span class="comment">/*tEXt and/or zTXt*/</span></div>
<div class="line"><a name="l05072"></a><span class="lineno"> 5072</span>&#160;    <span class="keywordflow">for</span>(i = 0; i &lt; info.<a class="code" href="struct_lode_p_n_g___info_png.html#a2ba6d900f4eee624a18df252e9df40e9">text</a>.<a class="code" href="struct_lode_p_n_g___text.html#ac85227f4c54ecda3f8beaff52e19b5c9">num</a>; i++)</div>
<div class="line"><a name="l05073"></a><span class="lineno"> 5073</span>&#160;    {</div>
<div class="line"><a name="l05074"></a><span class="lineno"> 5074</span>&#160;      <span class="keywordflow">if</span>(strlen(info.<a class="code" href="struct_lode_p_n_g___info_png.html#a2ba6d900f4eee624a18df252e9df40e9">text</a>.<a class="code" href="struct_lode_p_n_g___text.html#a51f019c99f3759befdf3ba5c8f6de70f">keys</a>[i]) &gt; 79)</div>
<div class="line"><a name="l05075"></a><span class="lineno"> 5075</span>&#160;      {</div>
<div class="line"><a name="l05076"></a><span class="lineno"> 5076</span>&#160;        encoder-&gt;<a class="code" href="struct_lode_p_n_g___encoder.html#a18e658a08db22dd34fc26c138f3eb2df">error</a> = 66; <span class="comment">/*text chunk too large*/</span></div>
<div class="line"><a name="l05077"></a><span class="lineno"> 5077</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l05078"></a><span class="lineno"> 5078</span>&#160;      }</div>
<div class="line"><a name="l05079"></a><span class="lineno"> 5079</span>&#160;      <span class="keywordflow">if</span>(strlen(info.<a class="code" href="struct_lode_p_n_g___info_png.html#a2ba6d900f4eee624a18df252e9df40e9">text</a>.<a class="code" href="struct_lode_p_n_g___text.html#a51f019c99f3759befdf3ba5c8f6de70f">keys</a>[i]) &lt; 1)</div>
<div class="line"><a name="l05080"></a><span class="lineno"> 5080</span>&#160;      {</div>
<div class="line"><a name="l05081"></a><span class="lineno"> 5081</span>&#160;        encoder-&gt;<a class="code" href="struct_lode_p_n_g___encoder.html#a18e658a08db22dd34fc26c138f3eb2df">error</a> = 67; <span class="comment">/*text chunk too small*/</span></div>
<div class="line"><a name="l05082"></a><span class="lineno"> 5082</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l05083"></a><span class="lineno"> 5083</span>&#160;      }</div>
<div class="line"><a name="l05084"></a><span class="lineno"> 5084</span>&#160;      <span class="keywordflow">if</span>(encoder-&gt;<a class="code" href="struct_lode_p_n_g___encoder.html#ae36ceb21b9d1007491f4edbb2be12bab">settings</a>.<a class="code" href="struct_lode_p_n_g___encode_settings.html#aec49a17d50b61c20a5e08a79bc6c9d2d">text_compression</a>)</div>
<div class="line"><a name="l05085"></a><span class="lineno"> 5085</span>&#160;        addChunk_zTXt(&amp;outv, info.<a class="code" href="struct_lode_p_n_g___info_png.html#a2ba6d900f4eee624a18df252e9df40e9">text</a>.<a class="code" href="struct_lode_p_n_g___text.html#a51f019c99f3759befdf3ba5c8f6de70f">keys</a>[i], info.<a class="code" href="struct_lode_p_n_g___info_png.html#a2ba6d900f4eee624a18df252e9df40e9">text</a>.<a class="code" href="struct_lode_p_n_g___text.html#a341513a6ccbcccaa482eb4a356408dd4">strings</a>[i], &amp;encoder-&gt;<a class="code" href="struct_lode_p_n_g___encoder.html#ae36ceb21b9d1007491f4edbb2be12bab">settings</a>.<a class="code" href="struct_lode_p_n_g___encode_settings.html#ae2d55a9f02c8711e426c08f54d268279">zlibsettings</a>);</div>
<div class="line"><a name="l05086"></a><span class="lineno"> 5086</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l05087"></a><span class="lineno"> 5087</span>&#160;        addChunk_tEXt(&amp;outv, info.<a class="code" href="struct_lode_p_n_g___info_png.html#a2ba6d900f4eee624a18df252e9df40e9">text</a>.<a class="code" href="struct_lode_p_n_g___text.html#a51f019c99f3759befdf3ba5c8f6de70f">keys</a>[i], info.<a class="code" href="struct_lode_p_n_g___info_png.html#a2ba6d900f4eee624a18df252e9df40e9">text</a>.<a class="code" href="struct_lode_p_n_g___text.html#a341513a6ccbcccaa482eb4a356408dd4">strings</a>[i]);</div>
<div class="line"><a name="l05088"></a><span class="lineno"> 5088</span>&#160;    }</div>
<div class="line"><a name="l05089"></a><span class="lineno"> 5089</span>&#160;    <span class="comment">/*LodePNG version id in text chunk*/</span></div>
<div class="line"><a name="l05090"></a><span class="lineno"> 5090</span>&#160;    <span class="keywordflow">if</span>(encoder-&gt;<a class="code" href="struct_lode_p_n_g___encoder.html#ae36ceb21b9d1007491f4edbb2be12bab">settings</a>.<a class="code" href="struct_lode_p_n_g___encode_settings.html#a0f14cf8e264027f702bff5d9ed9a0ade">add_id</a>)</div>
<div class="line"><a name="l05091"></a><span class="lineno"> 5091</span>&#160;    {</div>
<div class="line"><a name="l05092"></a><span class="lineno"> 5092</span>&#160;      <span class="keywordtype">unsigned</span> alread_added_id_text = 0;</div>
<div class="line"><a name="l05093"></a><span class="lineno"> 5093</span>&#160;      <span class="keywordflow">for</span>(i = 0; i &lt; info.<a class="code" href="struct_lode_p_n_g___info_png.html#a2ba6d900f4eee624a18df252e9df40e9">text</a>.<a class="code" href="struct_lode_p_n_g___text.html#ac85227f4c54ecda3f8beaff52e19b5c9">num</a>; i++)</div>
<div class="line"><a name="l05094"></a><span class="lineno"> 5094</span>&#160;      {</div>
<div class="line"><a name="l05095"></a><span class="lineno"> 5095</span>&#160;        <span class="keywordflow">if</span>(!strcmp(info.<a class="code" href="struct_lode_p_n_g___info_png.html#a2ba6d900f4eee624a18df252e9df40e9">text</a>.<a class="code" href="struct_lode_p_n_g___text.html#a51f019c99f3759befdf3ba5c8f6de70f">keys</a>[i], <span class="stringliteral">&quot;LodePNG&quot;</span>))</div>
<div class="line"><a name="l05096"></a><span class="lineno"> 5096</span>&#160;        {</div>
<div class="line"><a name="l05097"></a><span class="lineno"> 5097</span>&#160;          alread_added_id_text = 1;</div>
<div class="line"><a name="l05098"></a><span class="lineno"> 5098</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l05099"></a><span class="lineno"> 5099</span>&#160;        }</div>
<div class="line"><a name="l05100"></a><span class="lineno"> 5100</span>&#160;      }</div>
<div class="line"><a name="l05101"></a><span class="lineno"> 5101</span>&#160;      <span class="keywordflow">if</span>(alread_added_id_text == 0)</div>
<div class="line"><a name="l05102"></a><span class="lineno"> 5102</span>&#160;        addChunk_tEXt(&amp;outv, <span class="stringliteral">&quot;LodePNG&quot;</span>, <a class="code" href="lodepng_8cpp.html#a698acb89e1bf5837b33c30ef35c30044">VERSION_STRING</a>); <span class="comment">/*it&#39;s shorter as tEXt than as zTXt chunk*/</span></div>
<div class="line"><a name="l05103"></a><span class="lineno"> 5103</span>&#160;    }</div>
<div class="line"><a name="l05104"></a><span class="lineno"> 5104</span>&#160;    <span class="comment">/*iTXt*/</span></div>
<div class="line"><a name="l05105"></a><span class="lineno"> 5105</span>&#160;    <span class="keywordflow">for</span>(i = 0; i &lt; info.<a class="code" href="struct_lode_p_n_g___info_png.html#a6a25d5f857d5e8d1c326997b78d9daf1">itext</a>.<a class="code" href="struct_lode_p_n_g___i_text.html#a5af6eb21b9963d7f49e28d7ea181763c">num</a>; i++)</div>
<div class="line"><a name="l05106"></a><span class="lineno"> 5106</span>&#160;    {</div>
<div class="line"><a name="l05107"></a><span class="lineno"> 5107</span>&#160;      <span class="keywordflow">if</span>(strlen(info.<a class="code" href="struct_lode_p_n_g___info_png.html#a6a25d5f857d5e8d1c326997b78d9daf1">itext</a>.<a class="code" href="struct_lode_p_n_g___i_text.html#a487ca35406b7c5fdd13fd32e9c148c21">keys</a>[i]) &gt; 79)</div>
<div class="line"><a name="l05108"></a><span class="lineno"> 5108</span>&#160;      {</div>
<div class="line"><a name="l05109"></a><span class="lineno"> 5109</span>&#160;        encoder-&gt;<a class="code" href="struct_lode_p_n_g___encoder.html#a18e658a08db22dd34fc26c138f3eb2df">error</a> = 66; <span class="comment">/*text chunk too large*/</span></div>
<div class="line"><a name="l05110"></a><span class="lineno"> 5110</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l05111"></a><span class="lineno"> 5111</span>&#160;      }</div>
<div class="line"><a name="l05112"></a><span class="lineno"> 5112</span>&#160;      <span class="keywordflow">if</span>(strlen(info.<a class="code" href="struct_lode_p_n_g___info_png.html#a6a25d5f857d5e8d1c326997b78d9daf1">itext</a>.<a class="code" href="struct_lode_p_n_g___i_text.html#a487ca35406b7c5fdd13fd32e9c148c21">keys</a>[i]) &lt; 1)</div>
<div class="line"><a name="l05113"></a><span class="lineno"> 5113</span>&#160;      {</div>
<div class="line"><a name="l05114"></a><span class="lineno"> 5114</span>&#160;        encoder-&gt;<a class="code" href="struct_lode_p_n_g___encoder.html#a18e658a08db22dd34fc26c138f3eb2df">error</a> = 67; <span class="comment">/*text chunk too small*/</span></div>
<div class="line"><a name="l05115"></a><span class="lineno"> 5115</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l05116"></a><span class="lineno"> 5116</span>&#160;      }</div>
<div class="line"><a name="l05117"></a><span class="lineno"> 5117</span>&#160;      addChunk_iTXt(&amp;outv, encoder-&gt;<a class="code" href="struct_lode_p_n_g___encoder.html#ae36ceb21b9d1007491f4edbb2be12bab">settings</a>.<a class="code" href="struct_lode_p_n_g___encode_settings.html#aec49a17d50b61c20a5e08a79bc6c9d2d">text_compression</a>,</div>
<div class="line"><a name="l05118"></a><span class="lineno"> 5118</span>&#160;                    info.<a class="code" href="struct_lode_p_n_g___info_png.html#a6a25d5f857d5e8d1c326997b78d9daf1">itext</a>.<a class="code" href="struct_lode_p_n_g___i_text.html#a487ca35406b7c5fdd13fd32e9c148c21">keys</a>[i], info.<a class="code" href="struct_lode_p_n_g___info_png.html#a6a25d5f857d5e8d1c326997b78d9daf1">itext</a>.<a class="code" href="struct_lode_p_n_g___i_text.html#abcb2f7a9848f6cf561e15e7c7f43fcb3">langtags</a>[i], info.<a class="code" href="struct_lode_p_n_g___info_png.html#a6a25d5f857d5e8d1c326997b78d9daf1">itext</a>.<a class="code" href="struct_lode_p_n_g___i_text.html#af20920b249db552b73ec00f259500cfc">transkeys</a>[i], info.<a class="code" href="struct_lode_p_n_g___info_png.html#a6a25d5f857d5e8d1c326997b78d9daf1">itext</a>.<a class="code" href="struct_lode_p_n_g___i_text.html#aa4e0811fdc21677603e387168179e66e">strings</a>[i],</div>
<div class="line"><a name="l05119"></a><span class="lineno"> 5119</span>&#160;                    &amp;encoder-&gt;<a class="code" href="struct_lode_p_n_g___encoder.html#ae36ceb21b9d1007491f4edbb2be12bab">settings</a>.<a class="code" href="struct_lode_p_n_g___encode_settings.html#ae2d55a9f02c8711e426c08f54d268279">zlibsettings</a>);</div>
<div class="line"><a name="l05120"></a><span class="lineno"> 5120</span>&#160;    }</div>
<div class="line"><a name="l05121"></a><span class="lineno"> 5121</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/*LODEPNG_COMPILE_ANCILLARY_CHUNKS*/</span><span class="preprocessor"></span></div>
<div class="line"><a name="l05122"></a><span class="lineno"> 5122</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef LODEPNG_COMPILE_UNKNOWN_CHUNKS</span></div>
<div class="line"><a name="l05123"></a><span class="lineno"> 5123</span>&#160;<span class="preprocessor"></span>    <span class="comment">/*unknown chunks between IDAT and IEND*/</span></div>
<div class="line"><a name="l05124"></a><span class="lineno"> 5124</span>&#160;    <span class="keywordflow">if</span>(info.<a class="code" href="struct_lode_p_n_g___info_png.html#a97faa43bfd4e8f8df1cd836c713edac3">unknown_chunks</a>.<a class="code" href="struct_lode_p_n_g___unknown_chunks.html#a9923d61d31e17e7093194da5182eda97">data</a>[2])</div>
<div class="line"><a name="l05125"></a><span class="lineno"> 5125</span>&#160;    {</div>
<div class="line"><a name="l05126"></a><span class="lineno"> 5126</span>&#160;      encoder-&gt;<a class="code" href="struct_lode_p_n_g___encoder.html#a18e658a08db22dd34fc26c138f3eb2df">error</a> = addUnknownChunks(&amp;outv, info.<a class="code" href="struct_lode_p_n_g___info_png.html#a97faa43bfd4e8f8df1cd836c713edac3">unknown_chunks</a>.<a class="code" href="struct_lode_p_n_g___unknown_chunks.html#a9923d61d31e17e7093194da5182eda97">data</a>[2], info.<a class="code" href="struct_lode_p_n_g___info_png.html#a97faa43bfd4e8f8df1cd836c713edac3">unknown_chunks</a>.<a class="code" href="struct_lode_p_n_g___unknown_chunks.html#ab124de165db15c6cd5db43378c8ae15a">datasize</a>[2]);</div>
<div class="line"><a name="l05127"></a><span class="lineno"> 5127</span>&#160;      <span class="keywordflow">if</span>(encoder-&gt;<a class="code" href="struct_lode_p_n_g___encoder.html#a18e658a08db22dd34fc26c138f3eb2df">error</a>) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l05128"></a><span class="lineno"> 5128</span>&#160;    }</div>
<div class="line"><a name="l05129"></a><span class="lineno"> 5129</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/*LODEPNG_COMPILE_UNKNOWN_CHUNKS*/</span><span class="preprocessor"></span></div>
<div class="line"><a name="l05130"></a><span class="lineno"> 5130</span>&#160;<span class="preprocessor"></span>    <span class="comment">/*IEND*/</span></div>
<div class="line"><a name="l05131"></a><span class="lineno"> 5131</span>&#160;    addChunk_IEND(&amp;outv);</div>
<div class="line"><a name="l05132"></a><span class="lineno"> 5132</span>&#160;</div>
<div class="line"><a name="l05133"></a><span class="lineno"> 5133</span>&#160;    <span class="keywordflow">break</span>; <span class="comment">/*this isn&#39;t really a while loop; no error happened so break out now!*/</span></div>
<div class="line"><a name="l05134"></a><span class="lineno"> 5134</span>&#160;  }</div>
<div class="line"><a name="l05135"></a><span class="lineno"> 5135</span>&#160;</div>
<div class="line"><a name="l05136"></a><span class="lineno"> 5136</span>&#160;  <a class="code" href="namespace_f_w.html#a93be8f55938d6ffb5ca0af1f95f81589">free</a>(data);</div>
<div class="line"><a name="l05137"></a><span class="lineno"> 5137</span>&#160;  <span class="comment">/*instead of cleaning the vector up, give it to the output*/</span></div>
<div class="line"><a name="l05138"></a><span class="lineno"> 5138</span>&#160;  *out = outv.<a class="code" href="structucvector.html#ace794c5713208c5a20f21762cd87c919">data</a>;</div>
<div class="line"><a name="l05139"></a><span class="lineno"> 5139</span>&#160;  *outsize = outv.<a class="code" href="structucvector.html#a27c99c34de0c5b3ca0c242d402c69499">size</a>;</div>
<div class="line"><a name="l05140"></a><span class="lineno"> 5140</span>&#160;}</div>
<div class="line"><a name="l05141"></a><span class="lineno"> 5141</span>&#160;</div>
<div class="line"><a name="l05142"></a><span class="lineno"><a class="line" href="lodepng_8h.html#aeebb8a3150e965e39e3cea345e4f875a"> 5142</a></span>&#160;<span class="keywordtype">unsigned</span> <a class="code" href="lodepng_8cpp.html#aeebb8a3150e965e39e3cea345e4f875a">LodePNG_encode</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>** out, <span class="keywordtype">size_t</span>* outsize, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* image,</div>
<div class="line"><a name="l05143"></a><span class="lineno"> 5143</span>&#160;                        <span class="keywordtype">unsigned</span> w, <span class="keywordtype">unsigned</span> h, <span class="keywordtype">unsigned</span> colorType, <span class="keywordtype">unsigned</span> bitDepth)</div>
<div class="line"><a name="l05144"></a><span class="lineno"> 5144</span>&#160;{</div>
<div class="line"><a name="l05145"></a><span class="lineno"> 5145</span>&#160;  <span class="keywordtype">unsigned</span> error;</div>
<div class="line"><a name="l05146"></a><span class="lineno"> 5146</span>&#160;  <a class="code" href="struct_lode_p_n_g___encoder.html">LodePNG_Encoder</a> encoder;</div>
<div class="line"><a name="l05147"></a><span class="lineno"> 5147</span>&#160;  <a class="code" href="lodepng_8cpp.html#a187956c5e5784f77f5b17181310be304">LodePNG_Encoder_init</a>(&amp;encoder);</div>
<div class="line"><a name="l05148"></a><span class="lineno"> 5148</span>&#160;  encoder.<a class="code" href="struct_lode_p_n_g___encoder.html#af37ca9b0bcecd5d1d68756fd293ab998">infoRaw</a>.<a class="code" href="struct_lode_p_n_g___info_raw.html#ae9fa1c020358980be41f861ab71589fb">color</a>.<a class="code" href="struct_lode_p_n_g___info_color.html#a4ed18d179c5078137a18e742b1c41a00">colorType</a> = colorType;</div>
<div class="line"><a name="l05149"></a><span class="lineno"> 5149</span>&#160;  encoder.<a class="code" href="struct_lode_p_n_g___encoder.html#af37ca9b0bcecd5d1d68756fd293ab998">infoRaw</a>.<a class="code" href="struct_lode_p_n_g___info_raw.html#ae9fa1c020358980be41f861ab71589fb">color</a>.<a class="code" href="struct_lode_p_n_g___info_color.html#a9d538965a46d59bbdea744da8b290591">bitDepth</a> = bitDepth;</div>
<div class="line"><a name="l05150"></a><span class="lineno"> 5150</span>&#160;  encoder.<a class="code" href="struct_lode_p_n_g___encoder.html#a5c4bc6d9be898fbcc14b5d762d69457e">infoPng</a>.<a class="code" href="struct_lode_p_n_g___info_png.html#acce58518f72f42ba94db4c1cfd69336b">color</a>.<a class="code" href="struct_lode_p_n_g___info_color.html#a4ed18d179c5078137a18e742b1c41a00">colorType</a> = colorType;</div>
<div class="line"><a name="l05151"></a><span class="lineno"> 5151</span>&#160;  encoder.<a class="code" href="struct_lode_p_n_g___encoder.html#a5c4bc6d9be898fbcc14b5d762d69457e">infoPng</a>.<a class="code" href="struct_lode_p_n_g___info_png.html#acce58518f72f42ba94db4c1cfd69336b">color</a>.<a class="code" href="struct_lode_p_n_g___info_color.html#a9d538965a46d59bbdea744da8b290591">bitDepth</a> = bitDepth;</div>
<div class="line"><a name="l05152"></a><span class="lineno"> 5152</span>&#160;  <a class="code" href="lodepng_8cpp.html#a125bf00fe358f550d268f19b48527ef3">LodePNG_Encoder_encode</a>(&amp;encoder, out, outsize, image, w, h);</div>
<div class="line"><a name="l05153"></a><span class="lineno"> 5153</span>&#160;  error = encoder.<a class="code" href="struct_lode_p_n_g___encoder.html#a18e658a08db22dd34fc26c138f3eb2df">error</a>;</div>
<div class="line"><a name="l05154"></a><span class="lineno"> 5154</span>&#160;  <a class="code" href="lodepng_8cpp.html#a7269f380122edb94715d5e2e87eab835">LodePNG_Encoder_cleanup</a>(&amp;encoder);</div>
<div class="line"><a name="l05155"></a><span class="lineno"> 5155</span>&#160;  <span class="keywordflow">return</span> error;</div>
<div class="line"><a name="l05156"></a><span class="lineno"> 5156</span>&#160;}</div>
<div class="line"><a name="l05157"></a><span class="lineno"> 5157</span>&#160;</div>
<div class="line"><a name="l05158"></a><span class="lineno"><a class="line" href="lodepng_8h.html#a75be5c73ab8b78aa8e583976007a363f"> 5158</a></span>&#160;<span class="keywordtype">unsigned</span> <a class="code" href="lodepng_8cpp.html#a75be5c73ab8b78aa8e583976007a363f">LodePNG_encode32</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>** out, <span class="keywordtype">size_t</span>* outsize, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* image, <span class="keywordtype">unsigned</span> w, <span class="keywordtype">unsigned</span> h)</div>
<div class="line"><a name="l05159"></a><span class="lineno"> 5159</span>&#160;{</div>
<div class="line"><a name="l05160"></a><span class="lineno"> 5160</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="lodepng_8cpp.html#aeebb8a3150e965e39e3cea345e4f875a">LodePNG_encode</a>(out, outsize, image, w, h, 6, 8);</div>
<div class="line"><a name="l05161"></a><span class="lineno"> 5161</span>&#160;}</div>
<div class="line"><a name="l05162"></a><span class="lineno"> 5162</span>&#160;</div>
<div class="line"><a name="l05163"></a><span class="lineno"><a class="line" href="lodepng_8h.html#a163707b72a32eb5d48d39c1b4e6837fb"> 5163</a></span>&#160;<span class="keywordtype">unsigned</span> <a class="code" href="lodepng_8cpp.html#a163707b72a32eb5d48d39c1b4e6837fb">LodePNG_encode24</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>** out, <span class="keywordtype">size_t</span>* outsize, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* image, <span class="keywordtype">unsigned</span> w, <span class="keywordtype">unsigned</span> h)</div>
<div class="line"><a name="l05164"></a><span class="lineno"> 5164</span>&#160;{</div>
<div class="line"><a name="l05165"></a><span class="lineno"> 5165</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="lodepng_8cpp.html#aeebb8a3150e965e39e3cea345e4f875a">LodePNG_encode</a>(out, outsize, image, w, h, 2, 8);</div>
<div class="line"><a name="l05166"></a><span class="lineno"> 5166</span>&#160;}</div>
<div class="line"><a name="l05167"></a><span class="lineno"> 5167</span>&#160;</div>
<div class="line"><a name="l05168"></a><span class="lineno"> 5168</span>&#160;<span class="preprocessor">#ifdef LODEPNG_COMPILE_DISK</span></div>
<div class="line"><a name="l05169"></a><span class="lineno"><a class="line" href="lodepng_8h.html#a8614eb41779500a05b72943a7a8f06ae"> 5169</a></span>&#160;<span class="preprocessor"></span><span class="keywordtype">unsigned</span> <a class="code" href="lodepng_8cpp.html#a8614eb41779500a05b72943a7a8f06ae">LodePNG_encode_file</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* filename, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* image, <span class="keywordtype">unsigned</span> w, <span class="keywordtype">unsigned</span> h,</div>
<div class="line"><a name="l05170"></a><span class="lineno"> 5170</span>&#160;                             <span class="keywordtype">unsigned</span> colorType, <span class="keywordtype">unsigned</span> bitDepth)</div>
<div class="line"><a name="l05171"></a><span class="lineno"> 5171</span>&#160;{</div>
<div class="line"><a name="l05172"></a><span class="lineno"> 5172</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* <a class="code" href="_d_l_l_imports_8inl.html#a9dbca2ffca3195a70ff9a21d5c97b242">buffer</a>;</div>
<div class="line"><a name="l05173"></a><span class="lineno"> 5173</span>&#160;  <span class="keywordtype">size_t</span> buffersize;</div>
<div class="line"><a name="l05174"></a><span class="lineno"> 5174</span>&#160;  <span class="keywordtype">unsigned</span> error = <a class="code" href="lodepng_8cpp.html#aeebb8a3150e965e39e3cea345e4f875a">LodePNG_encode</a>(&amp;buffer, &amp;buffersize, image, w, h, colorType, bitDepth);</div>
<div class="line"><a name="l05175"></a><span class="lineno"> 5175</span>&#160;  <span class="keywordflow">if</span>(!error) error = <a class="code" href="lodepng_8cpp.html#a35604ddb7255afb1526979ca40815987">LodePNG_saveFile</a>(buffer, buffersize, filename);</div>
<div class="line"><a name="l05176"></a><span class="lineno"> 5176</span>&#160;  <a class="code" href="namespace_f_w.html#a93be8f55938d6ffb5ca0af1f95f81589">free</a>(buffer);</div>
<div class="line"><a name="l05177"></a><span class="lineno"> 5177</span>&#160;  <span class="keywordflow">return</span> error;</div>
<div class="line"><a name="l05178"></a><span class="lineno"> 5178</span>&#160;}</div>
<div class="line"><a name="l05179"></a><span class="lineno"> 5179</span>&#160;</div>
<div class="line"><a name="l05180"></a><span class="lineno"><a class="line" href="lodepng_8h.html#a1433657518ac8048e15943b47abe953e"> 5180</a></span>&#160;<span class="keywordtype">unsigned</span> <a class="code" href="lodepng_8cpp.html#a1433657518ac8048e15943b47abe953e">LodePNG_encode32_file</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* filename, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* image, <span class="keywordtype">unsigned</span> w, <span class="keywordtype">unsigned</span> h)</div>
<div class="line"><a name="l05181"></a><span class="lineno"> 5181</span>&#160;{</div>
<div class="line"><a name="l05182"></a><span class="lineno"> 5182</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="lodepng_8cpp.html#a8614eb41779500a05b72943a7a8f06ae">LodePNG_encode_file</a>(filename, image, w, h, 6, 8);</div>
<div class="line"><a name="l05183"></a><span class="lineno"> 5183</span>&#160;}</div>
<div class="line"><a name="l05184"></a><span class="lineno"> 5184</span>&#160;</div>
<div class="line"><a name="l05185"></a><span class="lineno"><a class="line" href="lodepng_8h.html#a90de60ea21ee48b050fcd9c7a45b6a78"> 5185</a></span>&#160;<span class="keywordtype">unsigned</span> <a class="code" href="lodepng_8cpp.html#a90de60ea21ee48b050fcd9c7a45b6a78">LodePNG_encode24_file</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* filename, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* image, <span class="keywordtype">unsigned</span> w, <span class="keywordtype">unsigned</span> h)</div>
<div class="line"><a name="l05186"></a><span class="lineno"> 5186</span>&#160;{</div>
<div class="line"><a name="l05187"></a><span class="lineno"> 5187</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="lodepng_8cpp.html#a8614eb41779500a05b72943a7a8f06ae">LodePNG_encode_file</a>(filename, image, w, h, 2, 8);</div>
<div class="line"><a name="l05188"></a><span class="lineno"> 5188</span>&#160;}</div>
<div class="line"><a name="l05189"></a><span class="lineno"> 5189</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/*LODEPNG_COMPILE_DISK*/</span><span class="preprocessor"></span></div>
<div class="line"><a name="l05190"></a><span class="lineno"> 5190</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l05191"></a><span class="lineno"><a class="line" href="lodepng_8h.html#a3cd7cc1583795fd14b7fe1179e005ab1"> 5191</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="lodepng_8cpp.html#a3cd7cc1583795fd14b7fe1179e005ab1">LodePNG_EncodeSettings_init</a>(<a class="code" href="struct_lode_p_n_g___encode_settings.html">LodePNG_EncodeSettings</a>* settings)</div>
<div class="line"><a name="l05192"></a><span class="lineno"> 5192</span>&#160;{</div>
<div class="line"><a name="l05193"></a><span class="lineno"> 5193</span>&#160;  <a class="code" href="lodepng_8cpp.html#a1887de65d8e8d03605c736ace1c9f3aa">LodePNG_CompressSettings_init</a>(&amp;settings-&gt;<a class="code" href="struct_lode_p_n_g___encode_settings.html#ae2d55a9f02c8711e426c08f54d268279">zlibsettings</a>);</div>
<div class="line"><a name="l05194"></a><span class="lineno"> 5194</span>&#160;  settings-&gt;<a class="code" href="struct_lode_p_n_g___encode_settings.html#a1bb1c6043e4bcf65ddebd204ac3ab7f5">bruteForceFilters</a> = 0;</div>
<div class="line"><a name="l05195"></a><span class="lineno"> 5195</span>&#160;  settings-&gt;<a class="code" href="struct_lode_p_n_g___encode_settings.html#a5074182840fae2ac4399ca9fa6660b41">autoLeaveOutAlphaChannel</a> = 1;</div>
<div class="line"><a name="l05196"></a><span class="lineno"> 5196</span>&#160;  settings-&gt;<a class="code" href="struct_lode_p_n_g___encode_settings.html#a44de1047cd9f3bfd55bf8c5313620065">force_palette</a> = 0;</div>
<div class="line"><a name="l05197"></a><span class="lineno"> 5197</span>&#160;<span class="preprocessor">#ifdef LODEPNG_COMPILE_ANCILLARY_CHUNKS</span></div>
<div class="line"><a name="l05198"></a><span class="lineno"> 5198</span>&#160;<span class="preprocessor"></span>  settings-&gt;<a class="code" href="struct_lode_p_n_g___encode_settings.html#a0f14cf8e264027f702bff5d9ed9a0ade">add_id</a> = 1;</div>
<div class="line"><a name="l05199"></a><span class="lineno"> 5199</span>&#160;  settings-&gt;<a class="code" href="struct_lode_p_n_g___encode_settings.html#aec49a17d50b61c20a5e08a79bc6c9d2d">text_compression</a> = 0;</div>
<div class="line"><a name="l05200"></a><span class="lineno"> 5200</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/*LODEPNG_COMPILE_ANCILLARY_CHUNKS*/</span><span class="preprocessor"></span></div>
<div class="line"><a name="l05201"></a><span class="lineno"> 5201</span>&#160;<span class="preprocessor"></span>}</div>
<div class="line"><a name="l05202"></a><span class="lineno"> 5202</span>&#160;</div>
<div class="line"><a name="l05203"></a><span class="lineno"><a class="line" href="lodepng_8h.html#a187956c5e5784f77f5b17181310be304"> 5203</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="lodepng_8cpp.html#a187956c5e5784f77f5b17181310be304">LodePNG_Encoder_init</a>(<a class="code" href="struct_lode_p_n_g___encoder.html">LodePNG_Encoder</a>* encoder)</div>
<div class="line"><a name="l05204"></a><span class="lineno"> 5204</span>&#160;{</div>
<div class="line"><a name="l05205"></a><span class="lineno"> 5205</span>&#160;  <a class="code" href="lodepng_8cpp.html#a3cd7cc1583795fd14b7fe1179e005ab1">LodePNG_EncodeSettings_init</a>(&amp;encoder-&gt;<a class="code" href="struct_lode_p_n_g___encoder.html#ae36ceb21b9d1007491f4edbb2be12bab">settings</a>);</div>
<div class="line"><a name="l05206"></a><span class="lineno"> 5206</span>&#160;  <a class="code" href="lodepng_8cpp.html#a66ddccc82c59e05d746086f56997b4cd">LodePNG_InfoPng_init</a>(&amp;encoder-&gt;<a class="code" href="struct_lode_p_n_g___encoder.html#a5c4bc6d9be898fbcc14b5d762d69457e">infoPng</a>);</div>
<div class="line"><a name="l05207"></a><span class="lineno"> 5207</span>&#160;  <a class="code" href="lodepng_8cpp.html#a279c66151f5c87b2225ebe866ce98f71">LodePNG_InfoRaw_init</a>(&amp;encoder-&gt;<a class="code" href="struct_lode_p_n_g___encoder.html#af37ca9b0bcecd5d1d68756fd293ab998">infoRaw</a>);</div>
<div class="line"><a name="l05208"></a><span class="lineno"> 5208</span>&#160;  encoder-&gt;<a class="code" href="struct_lode_p_n_g___encoder.html#a18e658a08db22dd34fc26c138f3eb2df">error</a> = 1;</div>
<div class="line"><a name="l05209"></a><span class="lineno"> 5209</span>&#160;}</div>
<div class="line"><a name="l05210"></a><span class="lineno"> 5210</span>&#160;</div>
<div class="line"><a name="l05211"></a><span class="lineno"><a class="line" href="lodepng_8h.html#a7269f380122edb94715d5e2e87eab835"> 5211</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="lodepng_8cpp.html#a7269f380122edb94715d5e2e87eab835">LodePNG_Encoder_cleanup</a>(<a class="code" href="struct_lode_p_n_g___encoder.html">LodePNG_Encoder</a>* encoder)</div>
<div class="line"><a name="l05212"></a><span class="lineno"> 5212</span>&#160;{</div>
<div class="line"><a name="l05213"></a><span class="lineno"> 5213</span>&#160;  <a class="code" href="lodepng_8cpp.html#a7884592df167f7136fc928cacf1efd36">LodePNG_InfoPng_cleanup</a>(&amp;encoder-&gt;<a class="code" href="struct_lode_p_n_g___encoder.html#a5c4bc6d9be898fbcc14b5d762d69457e">infoPng</a>);</div>
<div class="line"><a name="l05214"></a><span class="lineno"> 5214</span>&#160;  <a class="code" href="lodepng_8cpp.html#ae8ee35b701bba217323f27723d2690f5">LodePNG_InfoRaw_cleanup</a>(&amp;encoder-&gt;<a class="code" href="struct_lode_p_n_g___encoder.html#af37ca9b0bcecd5d1d68756fd293ab998">infoRaw</a>);</div>
<div class="line"><a name="l05215"></a><span class="lineno"> 5215</span>&#160;}</div>
<div class="line"><a name="l05216"></a><span class="lineno"> 5216</span>&#160;</div>
<div class="line"><a name="l05217"></a><span class="lineno"><a class="line" href="lodepng_8h.html#a0c0160b2f998d5966324922a153ee557"> 5217</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="lodepng_8cpp.html#a0c0160b2f998d5966324922a153ee557">LodePNG_Encoder_copy</a>(<a class="code" href="struct_lode_p_n_g___encoder.html">LodePNG_Encoder</a>* dest, <span class="keyword">const</span> <a class="code" href="struct_lode_p_n_g___encoder.html">LodePNG_Encoder</a>* source)</div>
<div class="line"><a name="l05218"></a><span class="lineno"> 5218</span>&#160;{</div>
<div class="line"><a name="l05219"></a><span class="lineno"> 5219</span>&#160;  <a class="code" href="lodepng_8cpp.html#a7269f380122edb94715d5e2e87eab835">LodePNG_Encoder_cleanup</a>(dest);</div>
<div class="line"><a name="l05220"></a><span class="lineno"> 5220</span>&#160;  *dest = *source;</div>
<div class="line"><a name="l05221"></a><span class="lineno"> 5221</span>&#160;  <a class="code" href="lodepng_8cpp.html#a66ddccc82c59e05d746086f56997b4cd">LodePNG_InfoPng_init</a>(&amp;dest-&gt;<a class="code" href="struct_lode_p_n_g___encoder.html#a5c4bc6d9be898fbcc14b5d762d69457e">infoPng</a>);</div>
<div class="line"><a name="l05222"></a><span class="lineno"> 5222</span>&#160;  <a class="code" href="lodepng_8cpp.html#a279c66151f5c87b2225ebe866ce98f71">LodePNG_InfoRaw_init</a>(&amp;dest-&gt;<a class="code" href="struct_lode_p_n_g___encoder.html#af37ca9b0bcecd5d1d68756fd293ab998">infoRaw</a>);</div>
<div class="line"><a name="l05223"></a><span class="lineno"> 5223</span>&#160;  dest-&gt;<a class="code" href="struct_lode_p_n_g___encoder.html#a18e658a08db22dd34fc26c138f3eb2df">error</a> = <a class="code" href="lodepng_8cpp.html#a0e188efe0b87e1b7d11a01ff85881368">LodePNG_InfoPng_copy</a>(&amp;dest-&gt;<a class="code" href="struct_lode_p_n_g___encoder.html#a5c4bc6d9be898fbcc14b5d762d69457e">infoPng</a>, &amp;source-&gt;<a class="code" href="struct_lode_p_n_g___encoder.html#a5c4bc6d9be898fbcc14b5d762d69457e">infoPng</a>);</div>
<div class="line"><a name="l05224"></a><span class="lineno"> 5224</span>&#160;  <span class="keywordflow">if</span>(dest-&gt;<a class="code" href="struct_lode_p_n_g___encoder.html#a18e658a08db22dd34fc26c138f3eb2df">error</a>) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l05225"></a><span class="lineno"> 5225</span>&#160;  dest-&gt;<a class="code" href="struct_lode_p_n_g___encoder.html#a18e658a08db22dd34fc26c138f3eb2df">error</a> = <a class="code" href="lodepng_8cpp.html#a745b94bf14f6c3497b6280863e71e5a6">LodePNG_InfoRaw_copy</a>(&amp;dest-&gt;<a class="code" href="struct_lode_p_n_g___encoder.html#af37ca9b0bcecd5d1d68756fd293ab998">infoRaw</a>, &amp;source-&gt;<a class="code" href="struct_lode_p_n_g___encoder.html#af37ca9b0bcecd5d1d68756fd293ab998">infoRaw</a>);</div>
<div class="line"><a name="l05226"></a><span class="lineno"> 5226</span>&#160;  <span class="keywordflow">if</span>(dest-&gt;<a class="code" href="struct_lode_p_n_g___encoder.html#a18e658a08db22dd34fc26c138f3eb2df">error</a>) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l05227"></a><span class="lineno"> 5227</span>&#160;}</div>
<div class="line"><a name="l05228"></a><span class="lineno"> 5228</span>&#160;</div>
<div class="line"><a name="l05229"></a><span class="lineno"> 5229</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/*LODEPNG_COMPILE_ENCODER*/</span><span class="preprocessor"></span></div>
<div class="line"><a name="l05230"></a><span class="lineno"> 5230</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l05231"></a><span class="lineno"> 5231</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/*LODEPNG_COMPILE_PNG*/</span><span class="preprocessor"></span></div>
<div class="line"><a name="l05232"></a><span class="lineno"> 5232</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l05233"></a><span class="lineno"> 5233</span>&#160;<span class="preprocessor">#ifdef LODEPNG_COMPILE_ERROR_TEXT</span></div>
<div class="line"><a name="l05234"></a><span class="lineno"> 5234</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l05235"></a><span class="lineno"> 5235</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l05236"></a><span class="lineno"> 5236</span>&#160;<span class="comment">This returns the description of a numerical error code in English. This is also</span></div>
<div class="line"><a name="l05237"></a><span class="lineno"> 5237</span>&#160;<span class="comment">the documentation of all the error codes.</span></div>
<div class="line"><a name="l05238"></a><span class="lineno"> 5238</span>&#160;<span class="comment">*/</span></div>
<div class="line"><a name="l05239"></a><span class="lineno"><a class="line" href="lodepng_8h.html#a7835adf81910eb662237cc15c0ed8ee3"> 5239</a></span>&#160;<span class="keyword">const</span> <span class="keywordtype">char</span>* <a class="code" href="lodepng_8cpp.html#a7835adf81910eb662237cc15c0ed8ee3">LodePNG_error_text</a>(<span class="keywordtype">unsigned</span> code)</div>
<div class="line"><a name="l05240"></a><span class="lineno"> 5240</span>&#160;{</div>
<div class="line"><a name="l05241"></a><span class="lineno"> 5241</span>&#160;  <span class="keywordflow">switch</span>(code)</div>
<div class="line"><a name="l05242"></a><span class="lineno"> 5242</span>&#160;  {</div>
<div class="line"><a name="l05243"></a><span class="lineno"> 5243</span>&#160;    <span class="keywordflow">case</span> 0: <span class="keywordflow">return</span> <span class="stringliteral">&quot;no error, everything went ok&quot;</span>;</div>
<div class="line"><a name="l05244"></a><span class="lineno"> 5244</span>&#160;    <span class="keywordflow">case</span> 1: <span class="keywordflow">return</span> <span class="stringliteral">&quot;nothing done yet&quot;</span>; <span class="comment">/*the Encoder/Decoder has done nothing yet, error checking makes no sense yet*/</span></div>
<div class="line"><a name="l05245"></a><span class="lineno"> 5245</span>&#160;    <span class="keywordflow">case</span> 10: <span class="keywordflow">return</span> <span class="stringliteral">&quot;end of input memory reached without huffman end code&quot;</span>; <span class="comment">/*while huffman decoding*/</span></div>
<div class="line"><a name="l05246"></a><span class="lineno"> 5246</span>&#160;    <span class="keywordflow">case</span> 11: <span class="keywordflow">return</span> <span class="stringliteral">&quot;error in code tree made it jump outside of huffman tree&quot;</span>; <span class="comment">/*while huffman decoding*/</span></div>
<div class="line"><a name="l05247"></a><span class="lineno"> 5247</span>&#160;    <span class="keywordflow">case</span> 13: <span class="keywordflow">return</span> <span class="stringliteral">&quot;problem while processing dynamic deflate block&quot;</span>;</div>
<div class="line"><a name="l05248"></a><span class="lineno"> 5248</span>&#160;    <span class="keywordflow">case</span> 14: <span class="keywordflow">return</span> <span class="stringliteral">&quot;problem while processing dynamic deflate block&quot;</span>;</div>
<div class="line"><a name="l05249"></a><span class="lineno"> 5249</span>&#160;    <span class="keywordflow">case</span> 15: <span class="keywordflow">return</span> <span class="stringliteral">&quot;problem while processing dynamic deflate block&quot;</span>;</div>
<div class="line"><a name="l05250"></a><span class="lineno"> 5250</span>&#160;    <span class="keywordflow">case</span> 16: <span class="keywordflow">return</span> <span class="stringliteral">&quot;unexisting code while processing dynamic deflate block&quot;</span>;</div>
<div class="line"><a name="l05251"></a><span class="lineno"> 5251</span>&#160;    <span class="keywordflow">case</span> 17: <span class="keywordflow">return</span> <span class="stringliteral">&quot;end of out buffer memory reached while inflating&quot;</span>;</div>
<div class="line"><a name="l05252"></a><span class="lineno"> 5252</span>&#160;    <span class="keywordflow">case</span> 18: <span class="keywordflow">return</span> <span class="stringliteral">&quot;invalid distance code while inflating&quot;</span>;</div>
<div class="line"><a name="l05253"></a><span class="lineno"> 5253</span>&#160;    <span class="keywordflow">case</span> 19: <span class="keywordflow">return</span> <span class="stringliteral">&quot;end of out buffer memory reached while inflating&quot;</span>;</div>
<div class="line"><a name="l05254"></a><span class="lineno"> 5254</span>&#160;    <span class="keywordflow">case</span> 20: <span class="keywordflow">return</span> <span class="stringliteral">&quot;invalid deflate block BTYPE encountered while decoding&quot;</span>;</div>
<div class="line"><a name="l05255"></a><span class="lineno"> 5255</span>&#160;    <span class="keywordflow">case</span> 21: <span class="keywordflow">return</span> <span class="stringliteral">&quot;NLEN is not ones complement of LEN in a deflate block&quot;</span>;</div>
<div class="line"><a name="l05256"></a><span class="lineno"> 5256</span>&#160;</div>
<div class="line"><a name="l05257"></a><span class="lineno"> 5257</span>&#160;     <span class="comment">/*end of out buffer memory reached while inflating:</span></div>
<div class="line"><a name="l05258"></a><span class="lineno"> 5258</span>&#160;<span class="comment">     This can happen if the inflated deflate data is longer than the amount of bytes required to fill up</span></div>
<div class="line"><a name="l05259"></a><span class="lineno"> 5259</span>&#160;<span class="comment">     all the pixels of the image, given the color depth and image dimensions. Something that doesn&#39;t</span></div>
<div class="line"><a name="l05260"></a><span class="lineno"> 5260</span>&#160;<span class="comment">     happen in a normal, well encoded, PNG image.*/</span></div>
<div class="line"><a name="l05261"></a><span class="lineno"> 5261</span>&#160;    <span class="keywordflow">case</span> 22: <span class="keywordflow">return</span> <span class="stringliteral">&quot;end of out buffer memory reached while inflating&quot;</span>;</div>
<div class="line"><a name="l05262"></a><span class="lineno"> 5262</span>&#160;    </div>
<div class="line"><a name="l05263"></a><span class="lineno"> 5263</span>&#160;    <span class="keywordflow">case</span> 23: <span class="keywordflow">return</span> <span class="stringliteral">&quot;end of in buffer memory reached while inflating&quot;</span>;</div>
<div class="line"><a name="l05264"></a><span class="lineno"> 5264</span>&#160;    <span class="keywordflow">case</span> 24: <span class="keywordflow">return</span> <span class="stringliteral">&quot;invalid FCHECK in zlib header&quot;</span>;</div>
<div class="line"><a name="l05265"></a><span class="lineno"> 5265</span>&#160;    <span class="keywordflow">case</span> 25: <span class="keywordflow">return</span> <span class="stringliteral">&quot;invalid compression method in zlib header&quot;</span>;</div>
<div class="line"><a name="l05266"></a><span class="lineno"> 5266</span>&#160;    <span class="keywordflow">case</span> 26: <span class="keywordflow">return</span> <span class="stringliteral">&quot;FDICT encountered in zlib header while it&#39;s not used for PNG&quot;</span>;</div>
<div class="line"><a name="l05267"></a><span class="lineno"> 5267</span>&#160;    <span class="keywordflow">case</span> 27: <span class="keywordflow">return</span> <span class="stringliteral">&quot;PNG file is smaller than a PNG header&quot;</span>;</div>
<div class="line"><a name="l05268"></a><span class="lineno"> 5268</span>&#160;    <span class="comment">/*Checks the magic file header, the first 8 bytes of the PNG file*/</span></div>
<div class="line"><a name="l05269"></a><span class="lineno"> 5269</span>&#160;    <span class="keywordflow">case</span> 28: <span class="keywordflow">return</span> <span class="stringliteral">&quot;incorrect PNG signature, it&#39;s no PNG or corrupted&quot;</span>;</div>
<div class="line"><a name="l05270"></a><span class="lineno"> 5270</span>&#160;    <span class="keywordflow">case</span> 29: <span class="keywordflow">return</span> <span class="stringliteral">&quot;first chunk is not the header chunk&quot;</span>;</div>
<div class="line"><a name="l05271"></a><span class="lineno"> 5271</span>&#160;    <span class="keywordflow">case</span> 30: <span class="keywordflow">return</span> <span class="stringliteral">&quot;chunk length too large, chunk broken off at end of file&quot;</span>;</div>
<div class="line"><a name="l05272"></a><span class="lineno"> 5272</span>&#160;    <span class="keywordflow">case</span> 31: <span class="keywordflow">return</span> <span class="stringliteral">&quot;illegal PNG color type or bpp&quot;</span>;</div>
<div class="line"><a name="l05273"></a><span class="lineno"> 5273</span>&#160;    <span class="keywordflow">case</span> 32: <span class="keywordflow">return</span> <span class="stringliteral">&quot;illegal PNG compression method&quot;</span>;</div>
<div class="line"><a name="l05274"></a><span class="lineno"> 5274</span>&#160;    <span class="keywordflow">case</span> 33: <span class="keywordflow">return</span> <span class="stringliteral">&quot;illegal PNG filter method&quot;</span>;</div>
<div class="line"><a name="l05275"></a><span class="lineno"> 5275</span>&#160;    <span class="keywordflow">case</span> 34: <span class="keywordflow">return</span> <span class="stringliteral">&quot;illegal PNG interlace method&quot;</span>;</div>
<div class="line"><a name="l05276"></a><span class="lineno"> 5276</span>&#160;    <span class="keywordflow">case</span> 35: <span class="keywordflow">return</span> <span class="stringliteral">&quot;chunk length of a chunk is too large or the chunk too small&quot;</span>;</div>
<div class="line"><a name="l05277"></a><span class="lineno"> 5277</span>&#160;    <span class="keywordflow">case</span> 36: <span class="keywordflow">return</span> <span class="stringliteral">&quot;illegal PNG filter type encountered&quot;</span>;</div>
<div class="line"><a name="l05278"></a><span class="lineno"> 5278</span>&#160;    <span class="keywordflow">case</span> 37: <span class="keywordflow">return</span> <span class="stringliteral">&quot;illegal bit depth for this color type given&quot;</span>;</div>
<div class="line"><a name="l05279"></a><span class="lineno"> 5279</span>&#160;    <span class="keywordflow">case</span> 38: <span class="keywordflow">return</span> <span class="stringliteral">&quot;the palette is too big&quot;</span>; <span class="comment">/*more than 256 colors*/</span></div>
<div class="line"><a name="l05280"></a><span class="lineno"> 5280</span>&#160;    <span class="keywordflow">case</span> 39: <span class="keywordflow">return</span> <span class="stringliteral">&quot;more palette alpha values given in tRNS chunk than there are colors in the palette&quot;</span>;</div>
<div class="line"><a name="l05281"></a><span class="lineno"> 5281</span>&#160;    <span class="keywordflow">case</span> 40: <span class="keywordflow">return</span> <span class="stringliteral">&quot;tRNS chunk has wrong size for greyscale image&quot;</span>;</div>
<div class="line"><a name="l05282"></a><span class="lineno"> 5282</span>&#160;    <span class="keywordflow">case</span> 41: <span class="keywordflow">return</span> <span class="stringliteral">&quot;tRNS chunk has wrong size for RGB image&quot;</span>;</div>
<div class="line"><a name="l05283"></a><span class="lineno"> 5283</span>&#160;    <span class="keywordflow">case</span> 42: <span class="keywordflow">return</span> <span class="stringliteral">&quot;tRNS chunk appeared while it was not allowed for this color type&quot;</span>;</div>
<div class="line"><a name="l05284"></a><span class="lineno"> 5284</span>&#160;    <span class="keywordflow">case</span> 43: <span class="keywordflow">return</span> <span class="stringliteral">&quot;bKGD chunk has wrong size for palette image&quot;</span>;</div>
<div class="line"><a name="l05285"></a><span class="lineno"> 5285</span>&#160;    <span class="keywordflow">case</span> 44: <span class="keywordflow">return</span> <span class="stringliteral">&quot;bKGD chunk has wrong size for greyscale image&quot;</span>;</div>
<div class="line"><a name="l05286"></a><span class="lineno"> 5286</span>&#160;    <span class="keywordflow">case</span> 45: <span class="keywordflow">return</span> <span class="stringliteral">&quot;bKGD chunk has wrong size for RGB image&quot;</span>;</div>
<div class="line"><a name="l05287"></a><span class="lineno"> 5287</span>&#160;    <span class="comment">/*Is the palette too small?*/</span></div>
<div class="line"><a name="l05288"></a><span class="lineno"> 5288</span>&#160;    <span class="keywordflow">case</span> 46: <span class="keywordflow">return</span> <span class="stringliteral">&quot;a value in indexed image is larger than the palette size (bitdepth = 8)&quot;</span>;</div>
<div class="line"><a name="l05289"></a><span class="lineno"> 5289</span>&#160;    <span class="comment">/*Is the palette too small?*/</span></div>
<div class="line"><a name="l05290"></a><span class="lineno"> 5290</span>&#160;    <span class="keywordflow">case</span> 47: <span class="keywordflow">return</span> <span class="stringliteral">&quot;a value in indexed image is larger than the palette size (bitdepth &lt; 8)&quot;</span>;</div>
<div class="line"><a name="l05291"></a><span class="lineno"> 5291</span>&#160;    <span class="comment">/*the input data is empty, maybe a PNG file doesn&#39;t exist or is in the wrong path*/</span></div>
<div class="line"><a name="l05292"></a><span class="lineno"> 5292</span>&#160;    <span class="keywordflow">case</span> 48: <span class="keywordflow">return</span> <span class="stringliteral">&quot;empty input or file doesn&#39;t exist&quot;</span>;</div>
<div class="line"><a name="l05293"></a><span class="lineno"> 5293</span>&#160;    <span class="keywordflow">case</span> 49: <span class="keywordflow">return</span> <span class="stringliteral">&quot;jumped past memory while generating dynamic huffman tree&quot;</span>;</div>
<div class="line"><a name="l05294"></a><span class="lineno"> 5294</span>&#160;    <span class="keywordflow">case</span> 50: <span class="keywordflow">return</span> <span class="stringliteral">&quot;jumped past memory while generating dynamic huffman tree&quot;</span>;</div>
<div class="line"><a name="l05295"></a><span class="lineno"> 5295</span>&#160;    <span class="keywordflow">case</span> 51: <span class="keywordflow">return</span> <span class="stringliteral">&quot;jumped past memory while inflating huffman block&quot;</span>;</div>
<div class="line"><a name="l05296"></a><span class="lineno"> 5296</span>&#160;    <span class="keywordflow">case</span> 52: <span class="keywordflow">return</span> <span class="stringliteral">&quot;jumped past memory while inflating&quot;</span>;</div>
<div class="line"><a name="l05297"></a><span class="lineno"> 5297</span>&#160;    <span class="keywordflow">case</span> 53: <span class="keywordflow">return</span> <span class="stringliteral">&quot;size of zlib data too small&quot;</span>;</div>
<div class="line"><a name="l05298"></a><span class="lineno"> 5298</span>&#160;</div>
<div class="line"><a name="l05299"></a><span class="lineno"> 5299</span>&#160;    <span class="comment">/*jumped past tree while generating huffman tree, this could be when the</span></div>
<div class="line"><a name="l05300"></a><span class="lineno"> 5300</span>&#160;<span class="comment">    tree will have more leaves than symbols after generating it out of the</span></div>
<div class="line"><a name="l05301"></a><span class="lineno"> 5301</span>&#160;<span class="comment">    given lenghts. They call this an oversubscribed dynamic bit lengths tree in zlib.*/</span></div>
<div class="line"><a name="l05302"></a><span class="lineno"> 5302</span>&#160;    <span class="keywordflow">case</span> 55: <span class="keywordflow">return</span> <span class="stringliteral">&quot;jumped past tree while generating huffman tree&quot;</span>;</div>
<div class="line"><a name="l05303"></a><span class="lineno"> 5303</span>&#160;    </div>
<div class="line"><a name="l05304"></a><span class="lineno"> 5304</span>&#160;    <span class="keywordflow">case</span> 56: <span class="keywordflow">return</span> <span class="stringliteral">&quot;given output image colorType or bitDepth not supported for color conversion&quot;</span>;</div>
<div class="line"><a name="l05305"></a><span class="lineno"> 5305</span>&#160;    <span class="keywordflow">case</span> 57: <span class="keywordflow">return</span> <span class="stringliteral">&quot;invalid CRC encountered (checking CRC can be disabled)&quot;</span>;</div>
<div class="line"><a name="l05306"></a><span class="lineno"> 5306</span>&#160;    <span class="keywordflow">case</span> 58: <span class="keywordflow">return</span> <span class="stringliteral">&quot;invalid ADLER32 encountered (checking ADLER32 can be disabled)&quot;</span>;</div>
<div class="line"><a name="l05307"></a><span class="lineno"> 5307</span>&#160;    <span class="keywordflow">case</span> 59: <span class="keywordflow">return</span> <span class="stringliteral">&quot;conversion to unexisting color mode or color mode conversion not supported&quot;</span>;</div>
<div class="line"><a name="l05308"></a><span class="lineno"> 5308</span>&#160;    <span class="keywordflow">case</span> 60: <span class="keywordflow">return</span> <span class="stringliteral">&quot;invalid window size given in the settings of the encoder (must be 0-32768)&quot;</span>;</div>
<div class="line"><a name="l05309"></a><span class="lineno"> 5309</span>&#160;    <span class="keywordflow">case</span> 61: <span class="keywordflow">return</span> <span class="stringliteral">&quot;invalid BTYPE given in the settings of the encoder (only 0, 1 and 2 are allowed)&quot;</span>;</div>
<div class="line"><a name="l05310"></a><span class="lineno"> 5310</span>&#160;    <span class="comment">/*LodePNG leaves the choice of RGB to greyscale conversion formula to the user.*/</span></div>
<div class="line"><a name="l05311"></a><span class="lineno"> 5311</span>&#160;    <span class="keywordflow">case</span> 62: <span class="keywordflow">return</span> <span class="stringliteral">&quot;conversion from RGB to greyscale not supported&quot;</span>;</div>
<div class="line"><a name="l05312"></a><span class="lineno"> 5312</span>&#160;    <span class="keywordflow">case</span> 63: <span class="keywordflow">return</span> <span class="stringliteral">&quot;length of a chunk too long, max allowed for PNG is 2147483647 bytes per chunk&quot;</span>; <span class="comment">/*(2^31-1)*/</span></div>
<div class="line"><a name="l05313"></a><span class="lineno"> 5313</span>&#160;    <span class="comment">/*this would result in the inability of a deflated block to ever contain an end code. It must be at least 1.*/</span></div>
<div class="line"><a name="l05314"></a><span class="lineno"> 5314</span>&#160;    <span class="keywordflow">case</span> 64: <span class="keywordflow">return</span> <span class="stringliteral">&quot;the length of the END symbol 256 in the Huffman tree is 0&quot;</span>; </div>
<div class="line"><a name="l05315"></a><span class="lineno"> 5315</span>&#160;    <span class="keywordflow">case</span> 66: <span class="keywordflow">return</span> <span class="stringliteral">&quot;the length of a text chunk keyword given to the encoder is longer than the maximum of 79 bytes&quot;</span>;</div>
<div class="line"><a name="l05316"></a><span class="lineno"> 5316</span>&#160;    <span class="keywordflow">case</span> 67: <span class="keywordflow">return</span> <span class="stringliteral">&quot;the length of a text chunk keyword given to the encoder is smaller than the minimum of 1 byte&quot;</span>;</div>
<div class="line"><a name="l05317"></a><span class="lineno"> 5317</span>&#160;    <span class="keywordflow">case</span> 68: <span class="keywordflow">return</span> <span class="stringliteral">&quot;tried to encode a PLTE chunk with a palette that has less than 1 or more than 256 colors&quot;</span>;</div>
<div class="line"><a name="l05318"></a><span class="lineno"> 5318</span>&#160;    <span class="keywordflow">case</span> 69: <span class="keywordflow">return</span> <span class="stringliteral">&quot;unknown chunk type with &#39;critical&#39; flag encountered by the decoder&quot;</span>;</div>
<div class="line"><a name="l05319"></a><span class="lineno"> 5319</span>&#160;    <span class="keywordflow">case</span> 71: <span class="keywordflow">return</span> <span class="stringliteral">&quot;unexisting interlace mode given to encoder (must be 0 or 1)&quot;</span>;</div>
<div class="line"><a name="l05320"></a><span class="lineno"> 5320</span>&#160;    <span class="keywordflow">case</span> 72: <span class="keywordflow">return</span> <span class="stringliteral">&quot;while decoding, unexisting compression method encountering in zTXt or iTXt chunk (it must be 0)&quot;</span>;</div>
<div class="line"><a name="l05321"></a><span class="lineno"> 5321</span>&#160;    <span class="keywordflow">case</span> 73: <span class="keywordflow">return</span> <span class="stringliteral">&quot;invalid tIME chunk size&quot;</span>;</div>
<div class="line"><a name="l05322"></a><span class="lineno"> 5322</span>&#160;    <span class="keywordflow">case</span> 74: <span class="keywordflow">return</span> <span class="stringliteral">&quot;invalid pHYs chunk size&quot;</span>;</div>
<div class="line"><a name="l05323"></a><span class="lineno"> 5323</span>&#160;    <span class="comment">/*length could be wrong, or data chopped off*/</span></div>
<div class="line"><a name="l05324"></a><span class="lineno"> 5324</span>&#160;    <span class="keywordflow">case</span> 75: <span class="keywordflow">return</span> <span class="stringliteral">&quot;no null termination char found while decoding text chunk&quot;</span>;</div>
<div class="line"><a name="l05325"></a><span class="lineno"> 5325</span>&#160;    <span class="keywordflow">case</span> 76: <span class="keywordflow">return</span> <span class="stringliteral">&quot;iTXt chunk too short to contain required bytes&quot;</span>;</div>
<div class="line"><a name="l05326"></a><span class="lineno"> 5326</span>&#160;    <span class="keywordflow">case</span> 77: <span class="keywordflow">return</span> <span class="stringliteral">&quot;integer overflow in buffer size&quot;</span>;</div>
<div class="line"><a name="l05327"></a><span class="lineno"> 5327</span>&#160;    <span class="keywordflow">case</span> 78: <span class="keywordflow">return</span> <span class="stringliteral">&quot;failed to open file for reading&quot;</span>; <span class="comment">/*file doesn&#39;t exist or couldn&#39;t be opened for reading*/</span></div>
<div class="line"><a name="l05328"></a><span class="lineno"> 5328</span>&#160;    <span class="keywordflow">case</span> 79: <span class="keywordflow">return</span> <span class="stringliteral">&quot;failed to open file for writing&quot;</span>;</div>
<div class="line"><a name="l05329"></a><span class="lineno"> 5329</span>&#160;    <span class="keywordflow">case</span> 80: <span class="keywordflow">return</span> <span class="stringliteral">&quot;tried creating a tree of 0 symbols&quot;</span>;</div>
<div class="line"><a name="l05330"></a><span class="lineno"> 5330</span>&#160;    <span class="keywordflow">default</span>: ; <span class="comment">/*nothing to do here, checks for other error values are below*/</span></div>
<div class="line"><a name="l05331"></a><span class="lineno"> 5331</span>&#160;  }</div>
<div class="line"><a name="l05332"></a><span class="lineno"> 5332</span>&#160;</div>
<div class="line"><a name="l05333"></a><span class="lineno"> 5333</span>&#160;  <span class="keywordflow">if</span>(code &gt;= 9900 &amp;&amp; code &lt;= 9999) <span class="keywordflow">return</span> <span class="stringliteral">&quot;memory allocation failed&quot;</span>;</div>
<div class="line"><a name="l05334"></a><span class="lineno"> 5334</span>&#160;</div>
<div class="line"><a name="l05335"></a><span class="lineno"> 5335</span>&#160;  <span class="keywordflow">return</span> <span class="stringliteral">&quot;unknown error code&quot;</span>;</div>
<div class="line"><a name="l05336"></a><span class="lineno"> 5336</span>&#160;}</div>
<div class="line"><a name="l05337"></a><span class="lineno"> 5337</span>&#160;</div>
<div class="line"><a name="l05338"></a><span class="lineno"> 5338</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/*LODEPNG_COMPILE_ERROR_TEXT*/</span><span class="preprocessor"></span></div>
<div class="line"><a name="l05339"></a><span class="lineno"> 5339</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l05340"></a><span class="lineno"> 5340</span>&#160;<span class="comment">/* ////////////////////////////////////////////////////////////////////////// */</span></div>
<div class="line"><a name="l05341"></a><span class="lineno"> 5341</span>&#160;<span class="comment">/* ////////////////////////////////////////////////////////////////////////// */</span></div>
<div class="line"><a name="l05342"></a><span class="lineno"> 5342</span>&#160;<span class="comment">/* // End of PNG related code. Begin of C++ wrapper.                       // */</span></div>
<div class="line"><a name="l05343"></a><span class="lineno"> 5343</span>&#160;<span class="comment">/* ////////////////////////////////////////////////////////////////////////// */</span></div>
<div class="line"><a name="l05344"></a><span class="lineno"> 5344</span>&#160;<span class="comment">/* ////////////////////////////////////////////////////////////////////////// */</span></div>
<div class="line"><a name="l05345"></a><span class="lineno"> 5345</span>&#160;</div>
<div class="line"><a name="l05346"></a><span class="lineno"> 5346</span>&#160;<span class="preprocessor">#ifdef __cplusplus</span></div>
<div class="line"><a name="l05347"></a><span class="lineno"> 5347</span>&#160;<span class="preprocessor"></span><span class="keyword">namespace </span>LodePNG</div>
<div class="line"><a name="l05348"></a><span class="lineno"> 5348</span>&#160;{</div>
<div class="line"><a name="l05349"></a><span class="lineno"> 5349</span>&#160;<span class="preprocessor">#ifdef LODEPNG_COMPILE_DISK</span></div>
<div class="line"><a name="l05350"></a><span class="lineno"> 5350</span>&#160;<span class="preprocessor"></span>  <span class="keywordtype">void</span> loadFile(std::vector&lt;unsigned char&gt;&amp; buffer, <span class="keyword">const</span> std::string&amp; filename)</div>
<div class="line"><a name="l05351"></a><span class="lineno"> 5351</span>&#160;  {</div>
<div class="line"><a name="l05352"></a><span class="lineno"> 5352</span>&#160;    std::ifstream file(filename.c_str(), std::ios::in|std::ios::binary|std::ios::ate);</div>
<div class="line"><a name="l05353"></a><span class="lineno"> 5353</span>&#160;</div>
<div class="line"><a name="l05354"></a><span class="lineno"> 5354</span>&#160;    <span class="comment">/*get filesize*/</span></div>
<div class="line"><a name="l05355"></a><span class="lineno"> 5355</span>&#160;    std::streamsize size = 0;</div>
<div class="line"><a name="l05356"></a><span class="lineno"> 5356</span>&#160;    <span class="keywordflow">if</span>(file.seekg(0, std::ios::end).good()) size = file.tellg();</div>
<div class="line"><a name="l05357"></a><span class="lineno"> 5357</span>&#160;    <span class="keywordflow">if</span>(file.seekg(0, std::ios::beg).good()) size -= file.tellg();</div>
<div class="line"><a name="l05358"></a><span class="lineno"> 5358</span>&#160;</div>
<div class="line"><a name="l05359"></a><span class="lineno"> 5359</span>&#160;    <span class="comment">/*read contents of the file into the vector*/</span></div>
<div class="line"><a name="l05360"></a><span class="lineno"> 5360</span>&#160;    buffer.resize(<span class="keywordtype">size_t</span>(size));</div>
<div class="line"><a name="l05361"></a><span class="lineno"> 5361</span>&#160;    <span class="keywordflow">if</span>(size &gt; 0) file.read((<span class="keywordtype">char</span>*)(&amp;buffer[0]), size);</div>
<div class="line"><a name="l05362"></a><span class="lineno"> 5362</span>&#160;  }</div>
<div class="line"><a name="l05363"></a><span class="lineno"> 5363</span>&#160;</div>
<div class="line"><a name="l05364"></a><span class="lineno"> 5364</span>&#160;  <span class="comment">/*write given buffer to the file, overwriting the file, it doesn&#39;t append to it.*/</span></div>
<div class="line"><a name="l05365"></a><span class="lineno"> 5365</span>&#160;  <span class="keywordtype">void</span> saveFile(<span class="keyword">const</span> std::vector&lt;unsigned char&gt;&amp; buffer, <span class="keyword">const</span> std::string&amp; filename)</div>
<div class="line"><a name="l05366"></a><span class="lineno"> 5366</span>&#160;  {</div>
<div class="line"><a name="l05367"></a><span class="lineno"> 5367</span>&#160;    std::ofstream file(filename.c_str(), std::ios::out|std::ios::binary);</div>
<div class="line"><a name="l05368"></a><span class="lineno"> 5368</span>&#160;    file.write(buffer.empty() ? 0 : (<span class="keywordtype">char</span>*)&amp;buffer[0], std::streamsize(buffer.size()));</div>
<div class="line"><a name="l05369"></a><span class="lineno"> 5369</span>&#160;  }</div>
<div class="line"><a name="l05370"></a><span class="lineno"> 5370</span>&#160;<span class="preprocessor">#endif //LODEPNG_COMPILE_DISK</span></div>
<div class="line"><a name="l05371"></a><span class="lineno"> 5371</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l05372"></a><span class="lineno"> 5372</span>&#160;<span class="comment">/* ////////////////////////////////////////////////////////////////////////// */</span></div>
<div class="line"><a name="l05373"></a><span class="lineno"> 5373</span>&#160;</div>
<div class="line"><a name="l05374"></a><span class="lineno"> 5374</span>&#160;<span class="preprocessor">#ifdef LODEPNG_COMPILE_ZLIB</span></div>
<div class="line"><a name="l05375"></a><span class="lineno"> 5375</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef LODEPNG_COMPILE_DECODER</span></div>
<div class="line"><a name="l05376"></a><span class="lineno"> 5376</span>&#160;<span class="preprocessor"></span>  <span class="keywordtype">unsigned</span> decompress(std::vector&lt;unsigned char&gt;&amp; out, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* in, <span class="keywordtype">size_t</span> insize,</div>
<div class="line"><a name="l05377"></a><span class="lineno"> 5377</span>&#160;                      <span class="keyword">const</span> <a class="code" href="struct_lode_p_n_g___decompress_settings.html">LodePNG_DecompressSettings</a>&amp; settings)</div>
<div class="line"><a name="l05378"></a><span class="lineno"> 5378</span>&#160;  {</div>
<div class="line"><a name="l05379"></a><span class="lineno"> 5379</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* buffer = 0;</div>
<div class="line"><a name="l05380"></a><span class="lineno"> 5380</span>&#160;    <span class="keywordtype">size_t</span> buffersize = 0;</div>
<div class="line"><a name="l05381"></a><span class="lineno"> 5381</span>&#160;    <span class="keywordtype">unsigned</span> error = <a class="code" href="lodepng_8cpp.html#af11d6ba19787c8d48aa3ed88cf3e6462">LodePNG_zlib_decompress</a>(&amp;buffer, &amp;buffersize, in, insize, &amp;settings);</div>
<div class="line"><a name="l05382"></a><span class="lineno"> 5382</span>&#160;    <span class="keywordflow">if</span>(buffer)</div>
<div class="line"><a name="l05383"></a><span class="lineno"> 5383</span>&#160;    {</div>
<div class="line"><a name="l05384"></a><span class="lineno"> 5384</span>&#160;      out.insert(out.end(), &amp;buffer[0], &amp;buffer[buffersize]);</div>
<div class="line"><a name="l05385"></a><span class="lineno"> 5385</span>&#160;      <a class="code" href="namespace_f_w.html#a93be8f55938d6ffb5ca0af1f95f81589">free</a>(buffer);</div>
<div class="line"><a name="l05386"></a><span class="lineno"> 5386</span>&#160;    }</div>
<div class="line"><a name="l05387"></a><span class="lineno"> 5387</span>&#160;    <span class="keywordflow">return</span> error;</div>
<div class="line"><a name="l05388"></a><span class="lineno"> 5388</span>&#160;  }</div>
<div class="line"><a name="l05389"></a><span class="lineno"> 5389</span>&#160;</div>
<div class="line"><a name="l05390"></a><span class="lineno"> 5390</span>&#160;  <span class="keywordtype">unsigned</span> decompress(std::vector&lt;unsigned char&gt;&amp; out, <span class="keyword">const</span> std::vector&lt;unsigned char&gt;&amp; in,</div>
<div class="line"><a name="l05391"></a><span class="lineno"> 5391</span>&#160;                      <span class="keyword">const</span> <a class="code" href="struct_lode_p_n_g___decompress_settings.html">LodePNG_DecompressSettings</a>&amp; settings)</div>
<div class="line"><a name="l05392"></a><span class="lineno"> 5392</span>&#160;  {</div>
<div class="line"><a name="l05393"></a><span class="lineno"> 5393</span>&#160;    <span class="keywordflow">return</span> decompress(out, in.empty() ? 0 : &amp;in[0], in.size(), settings);</div>
<div class="line"><a name="l05394"></a><span class="lineno"> 5394</span>&#160;  }</div>
<div class="line"><a name="l05395"></a><span class="lineno"> 5395</span>&#160;<span class="preprocessor">#endif //LODEPNG_COMPILE_DECODER</span></div>
<div class="line"><a name="l05396"></a><span class="lineno"> 5396</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l05397"></a><span class="lineno"> 5397</span>&#160;<span class="preprocessor">#ifdef LODEPNG_COMPILE_ENCODER</span></div>
<div class="line"><a name="l05398"></a><span class="lineno"> 5398</span>&#160;<span class="preprocessor"></span>  <span class="keywordtype">unsigned</span> compress(std::vector&lt;unsigned char&gt;&amp; out, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* in, <span class="keywordtype">size_t</span> insize,</div>
<div class="line"><a name="l05399"></a><span class="lineno"> 5399</span>&#160;                    <span class="keyword">const</span> <a class="code" href="struct_lode_p_n_g___compress_settings.html">LodePNG_CompressSettings</a>&amp; settings)</div>
<div class="line"><a name="l05400"></a><span class="lineno"> 5400</span>&#160;  {</div>
<div class="line"><a name="l05401"></a><span class="lineno"> 5401</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* buffer = 0;</div>
<div class="line"><a name="l05402"></a><span class="lineno"> 5402</span>&#160;    <span class="keywordtype">size_t</span> buffersize = 0;</div>
<div class="line"><a name="l05403"></a><span class="lineno"> 5403</span>&#160;    <span class="keywordtype">unsigned</span> error = <a class="code" href="lodepng_8cpp.html#aa2ff174234767c087c7ba974ba862be9">LodePNG_zlib_compress</a>(&amp;buffer, &amp;buffersize, in, insize, &amp;settings);</div>
<div class="line"><a name="l05404"></a><span class="lineno"> 5404</span>&#160;    <span class="keywordflow">if</span>(buffer)</div>
<div class="line"><a name="l05405"></a><span class="lineno"> 5405</span>&#160;    {</div>
<div class="line"><a name="l05406"></a><span class="lineno"> 5406</span>&#160;      out.insert(out.end(), &amp;buffer[0], &amp;buffer[buffersize]);</div>
<div class="line"><a name="l05407"></a><span class="lineno"> 5407</span>&#160;      <a class="code" href="namespace_f_w.html#a93be8f55938d6ffb5ca0af1f95f81589">free</a>(buffer);</div>
<div class="line"><a name="l05408"></a><span class="lineno"> 5408</span>&#160;    }</div>
<div class="line"><a name="l05409"></a><span class="lineno"> 5409</span>&#160;    <span class="keywordflow">return</span> error;</div>
<div class="line"><a name="l05410"></a><span class="lineno"> 5410</span>&#160;  }</div>
<div class="line"><a name="l05411"></a><span class="lineno"> 5411</span>&#160;</div>
<div class="line"><a name="l05412"></a><span class="lineno"> 5412</span>&#160;  <span class="keywordtype">unsigned</span> compress(std::vector&lt;unsigned char&gt;&amp; out, <span class="keyword">const</span> std::vector&lt;unsigned char&gt;&amp; in,</div>
<div class="line"><a name="l05413"></a><span class="lineno"> 5413</span>&#160;                    <span class="keyword">const</span> <a class="code" href="struct_lode_p_n_g___compress_settings.html">LodePNG_CompressSettings</a>&amp; settings)</div>
<div class="line"><a name="l05414"></a><span class="lineno"> 5414</span>&#160;  {</div>
<div class="line"><a name="l05415"></a><span class="lineno"> 5415</span>&#160;    <span class="keywordflow">return</span> compress(out, in.empty() ? 0 : &amp;in[0], in.size(), settings);</div>
<div class="line"><a name="l05416"></a><span class="lineno"> 5416</span>&#160;  }</div>
<div class="line"><a name="l05417"></a><span class="lineno"> 5417</span>&#160;<span class="preprocessor">#endif //LODEPNG_COMPILE_ENCODER</span></div>
<div class="line"><a name="l05418"></a><span class="lineno"> 5418</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#endif //LODEPNG_COMPILE_ZLIB</span></div>
<div class="line"><a name="l05419"></a><span class="lineno"> 5419</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l05420"></a><span class="lineno"> 5420</span>&#160;<span class="preprocessor">#ifdef LODEPNG_COMPILE_PNG</span></div>
<div class="line"><a name="l05421"></a><span class="lineno"> 5421</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef LODEPNG_COMPILE_DECODER</span></div>
<div class="line"><a name="l05422"></a><span class="lineno"> 5422</span>&#160;<span class="preprocessor"></span>  Decoder::Decoder()</div>
<div class="line"><a name="l05423"></a><span class="lineno"> 5423</span>&#160;  {</div>
<div class="line"><a name="l05424"></a><span class="lineno"> 5424</span>&#160;    <a class="code" href="lodepng_8cpp.html#a313e972622f025eba50616c62ff033d0">LodePNG_Decoder_init</a>(<span class="keyword">this</span>);</div>
<div class="line"><a name="l05425"></a><span class="lineno"> 5425</span>&#160;  }</div>
<div class="line"><a name="l05426"></a><span class="lineno"> 5426</span>&#160;</div>
<div class="line"><a name="l05427"></a><span class="lineno"> 5427</span>&#160;  Decoder::~Decoder()</div>
<div class="line"><a name="l05428"></a><span class="lineno"> 5428</span>&#160;  {</div>
<div class="line"><a name="l05429"></a><span class="lineno"> 5429</span>&#160;    <a class="code" href="lodepng_8cpp.html#aa28cca4bd765525e9f777bc4a7c50ced">LodePNG_Decoder_cleanup</a>(<span class="keyword">this</span>);</div>
<div class="line"><a name="l05430"></a><span class="lineno"> 5430</span>&#160;  }</div>
<div class="line"><a name="l05431"></a><span class="lineno"> 5431</span>&#160;</div>
<div class="line"><a name="l05432"></a><span class="lineno"> 5432</span>&#160;  <span class="keywordtype">void</span> Decoder::operator=(<span class="keyword">const</span> <a class="code" href="struct_lode_p_n_g___decoder.html">LodePNG_Decoder</a>&amp; other)</div>
<div class="line"><a name="l05433"></a><span class="lineno"> 5433</span>&#160;  {</div>
<div class="line"><a name="l05434"></a><span class="lineno"> 5434</span>&#160;    <a class="code" href="lodepng_8cpp.html#af9bcef894a1ff5d76f2fabd23365d289">LodePNG_Decoder_copy</a>(<span class="keyword">this</span>, &amp;other);</div>
<div class="line"><a name="l05435"></a><span class="lineno"> 5435</span>&#160;  }</div>
<div class="line"><a name="l05436"></a><span class="lineno"> 5436</span>&#160;</div>
<div class="line"><a name="l05437"></a><span class="lineno"> 5437</span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="namespace_f_w.html#a08e4933631da71a1c74b09b0a4da7d24">Decoder::hasError</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l05438"></a><span class="lineno"> 5438</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l05439"></a><span class="lineno"> 5439</span>&#160;    <span class="keywordflow">return</span> error != 0;</div>
<div class="line"><a name="l05440"></a><span class="lineno"> 5440</span>&#160;  }</div>
<div class="line"><a name="l05441"></a><span class="lineno"> 5441</span>&#160;  <span class="keywordtype">unsigned</span> <a class="code" href="namespace_f_w.html#a57a9c09878d7bf99b2c6097e173ce6ad">Decoder::getError</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l05442"></a><span class="lineno"> 5442</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l05443"></a><span class="lineno"> 5443</span>&#160;    <span class="keywordflow">return</span> error;</div>
<div class="line"><a name="l05444"></a><span class="lineno"> 5444</span>&#160;  }</div>
<div class="line"><a name="l05445"></a><span class="lineno"> 5445</span>&#160;</div>
<div class="line"><a name="l05446"></a><span class="lineno"> 5446</span>&#160;  <span class="keywordtype">unsigned</span> Decoder::getWidth()<span class="keyword"> const</span></div>
<div class="line"><a name="l05447"></a><span class="lineno"> 5447</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l05448"></a><span class="lineno"> 5448</span>&#160;    <span class="keywordflow">return</span> infoPng.<a class="code" href="struct_lode_p_n_g___info_png.html#a74be99b177b28f3178c02139c4b7f149">width</a>;</div>
<div class="line"><a name="l05449"></a><span class="lineno"> 5449</span>&#160;  }</div>
<div class="line"><a name="l05450"></a><span class="lineno"> 5450</span>&#160;</div>
<div class="line"><a name="l05451"></a><span class="lineno"> 5451</span>&#160;  <span class="keywordtype">unsigned</span> Decoder::getHeight()<span class="keyword"> const</span></div>
<div class="line"><a name="l05452"></a><span class="lineno"> 5452</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l05453"></a><span class="lineno"> 5453</span>&#160;    <span class="keywordflow">return</span> infoPng.<a class="code" href="struct_lode_p_n_g___info_png.html#a4b87ec9649e7177af7a5f5e08e5bc491">height</a>;</div>
<div class="line"><a name="l05454"></a><span class="lineno"> 5454</span>&#160;  }</div>
<div class="line"><a name="l05455"></a><span class="lineno"> 5455</span>&#160;</div>
<div class="line"><a name="l05456"></a><span class="lineno"> 5456</span>&#160;  <span class="keywordtype">unsigned</span> Decoder::getBpp()</div>
<div class="line"><a name="l05457"></a><span class="lineno"> 5457</span>&#160;  {</div>
<div class="line"><a name="l05458"></a><span class="lineno"> 5458</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="lodepng_8cpp.html#a81151c0087467b4ac2a815b3234fdb5a">LodePNG_InfoColor_getBpp</a>(&amp;infoPng.<a class="code" href="struct_lode_p_n_g___info_png.html#acce58518f72f42ba94db4c1cfd69336b">color</a>);</div>
<div class="line"><a name="l05459"></a><span class="lineno"> 5459</span>&#160;  }</div>
<div class="line"><a name="l05460"></a><span class="lineno"> 5460</span>&#160;</div>
<div class="line"><a name="l05461"></a><span class="lineno"> 5461</span>&#160;  <span class="keywordtype">unsigned</span> Decoder::getChannels()</div>
<div class="line"><a name="l05462"></a><span class="lineno"> 5462</span>&#160;  {</div>
<div class="line"><a name="l05463"></a><span class="lineno"> 5463</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="lodepng_8cpp.html#a62159dfd6cf8a67b55d5bbc70fee589b">LodePNG_InfoColor_getChannels</a>(&amp;infoPng.<a class="code" href="struct_lode_p_n_g___info_png.html#acce58518f72f42ba94db4c1cfd69336b">color</a>);</div>
<div class="line"><a name="l05464"></a><span class="lineno"> 5464</span>&#160;  }</div>
<div class="line"><a name="l05465"></a><span class="lineno"> 5465</span>&#160;</div>
<div class="line"><a name="l05466"></a><span class="lineno"> 5466</span>&#160;  <span class="keywordtype">unsigned</span> Decoder::isGreyscaleType()</div>
<div class="line"><a name="l05467"></a><span class="lineno"> 5467</span>&#160;  {</div>
<div class="line"><a name="l05468"></a><span class="lineno"> 5468</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="lodepng_8cpp.html#ac0564ed5cbac6fcfda3b28b3078cde65">LodePNG_InfoColor_isGreyscaleType</a>(&amp;infoPng.<a class="code" href="struct_lode_p_n_g___info_png.html#acce58518f72f42ba94db4c1cfd69336b">color</a>);</div>
<div class="line"><a name="l05469"></a><span class="lineno"> 5469</span>&#160;  }</div>
<div class="line"><a name="l05470"></a><span class="lineno"> 5470</span>&#160;</div>
<div class="line"><a name="l05471"></a><span class="lineno"> 5471</span>&#160;  <span class="keywordtype">unsigned</span> Decoder::isAlphaType()</div>
<div class="line"><a name="l05472"></a><span class="lineno"> 5472</span>&#160;  {</div>
<div class="line"><a name="l05473"></a><span class="lineno"> 5473</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="lodepng_8cpp.html#af139bc36c2a9b88d21dc3652520a3f73">LodePNG_InfoColor_isAlphaType</a>(&amp;infoPng.<a class="code" href="struct_lode_p_n_g___info_png.html#acce58518f72f42ba94db4c1cfd69336b">color</a>);</div>
<div class="line"><a name="l05474"></a><span class="lineno"> 5474</span>&#160;  }</div>
<div class="line"><a name="l05475"></a><span class="lineno"> 5475</span>&#160;</div>
<div class="line"><a name="l05476"></a><span class="lineno"> 5476</span>&#160;  <span class="keywordtype">void</span> Decoder::decode(std::vector&lt;unsigned char&gt;&amp; out, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* in, <span class="keywordtype">size_t</span> insize)</div>
<div class="line"><a name="l05477"></a><span class="lineno"> 5477</span>&#160;  {</div>
<div class="line"><a name="l05478"></a><span class="lineno"> 5478</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* <a class="code" href="_d_l_l_imports_8inl.html#a9dbca2ffca3195a70ff9a21d5c97b242">buffer</a>;</div>
<div class="line"><a name="l05479"></a><span class="lineno"> 5479</span>&#160;    <span class="keywordtype">size_t</span> buffersize;</div>
<div class="line"><a name="l05480"></a><span class="lineno"> 5480</span>&#160;    <a class="code" href="lodepng_8cpp.html#a3d29161f6cf08ed35dd9751e6d25cd12">LodePNG_Decoder_decode</a>(<span class="keyword">this</span>, &amp;buffer, &amp;buffersize, in, insize);</div>
<div class="line"><a name="l05481"></a><span class="lineno"> 5481</span>&#160;    <span class="keywordflow">if</span>(buffer)</div>
<div class="line"><a name="l05482"></a><span class="lineno"> 5482</span>&#160;    {</div>
<div class="line"><a name="l05483"></a><span class="lineno"> 5483</span>&#160;      out.insert(out.end(), &amp;buffer[0], &amp;buffer[buffersize]);</div>
<div class="line"><a name="l05484"></a><span class="lineno"> 5484</span>&#160;      <a class="code" href="namespace_f_w.html#a93be8f55938d6ffb5ca0af1f95f81589">free</a>(buffer);</div>
<div class="line"><a name="l05485"></a><span class="lineno"> 5485</span>&#160;    }</div>
<div class="line"><a name="l05486"></a><span class="lineno"> 5486</span>&#160;  }</div>
<div class="line"><a name="l05487"></a><span class="lineno"> 5487</span>&#160;</div>
<div class="line"><a name="l05488"></a><span class="lineno"> 5488</span>&#160;  <span class="keywordtype">void</span> Decoder::decode(std::vector&lt;unsigned char&gt;&amp; out, <span class="keyword">const</span> std::vector&lt;unsigned char&gt;&amp; in)</div>
<div class="line"><a name="l05489"></a><span class="lineno"> 5489</span>&#160;  {</div>
<div class="line"><a name="l05490"></a><span class="lineno"> 5490</span>&#160;    decode(out, in.empty() ? 0 : &amp;in[0], in.size());</div>
<div class="line"><a name="l05491"></a><span class="lineno"> 5491</span>&#160;  }</div>
<div class="line"><a name="l05492"></a><span class="lineno"> 5492</span>&#160;</div>
<div class="line"><a name="l05493"></a><span class="lineno"> 5493</span>&#160;  <span class="keywordtype">void</span> Decoder::inspect(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* in, <span class="keywordtype">size_t</span> insize)</div>
<div class="line"><a name="l05494"></a><span class="lineno"> 5494</span>&#160;  {</div>
<div class="line"><a name="l05495"></a><span class="lineno"> 5495</span>&#160;    <a class="code" href="lodepng_8cpp.html#afddaefb609ec98a432b3dd0437c849ad">LodePNG_Decoder_inspect</a>(<span class="keyword">this</span>, in, insize);</div>
<div class="line"><a name="l05496"></a><span class="lineno"> 5496</span>&#160;  }</div>
<div class="line"><a name="l05497"></a><span class="lineno"> 5497</span>&#160;</div>
<div class="line"><a name="l05498"></a><span class="lineno"> 5498</span>&#160;  <span class="keywordtype">void</span> Decoder::inspect(<span class="keyword">const</span> std::vector&lt;unsigned char&gt;&amp; in)</div>
<div class="line"><a name="l05499"></a><span class="lineno"> 5499</span>&#160;  {</div>
<div class="line"><a name="l05500"></a><span class="lineno"> 5500</span>&#160;    inspect(in.empty() ? 0 : &amp;in[0], in.size());</div>
<div class="line"><a name="l05501"></a><span class="lineno"> 5501</span>&#160;  }</div>
<div class="line"><a name="l05502"></a><span class="lineno"> 5502</span>&#160;</div>
<div class="line"><a name="l05503"></a><span class="lineno"> 5503</span>&#160;  <span class="keyword">const</span> <a class="code" href="struct_lode_p_n_g___decode_settings.html">LodePNG_DecodeSettings</a>&amp; Decoder::getSettings()<span class="keyword"> const</span></div>
<div class="line"><a name="l05504"></a><span class="lineno"> 5504</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l05505"></a><span class="lineno"> 5505</span>&#160;    <span class="keywordflow">return</span> settings;</div>
<div class="line"><a name="l05506"></a><span class="lineno"> 5506</span>&#160;  }</div>
<div class="line"><a name="l05507"></a><span class="lineno"> 5507</span>&#160;</div>
<div class="line"><a name="l05508"></a><span class="lineno"> 5508</span>&#160;  <a class="code" href="struct_lode_p_n_g___decode_settings.html">LodePNG_DecodeSettings</a>&amp; Decoder::getSettings()</div>
<div class="line"><a name="l05509"></a><span class="lineno"> 5509</span>&#160;  {</div>
<div class="line"><a name="l05510"></a><span class="lineno"> 5510</span>&#160;    <span class="keywordflow">return</span> settings;</div>
<div class="line"><a name="l05511"></a><span class="lineno"> 5511</span>&#160;  }</div>
<div class="line"><a name="l05512"></a><span class="lineno"> 5512</span>&#160;</div>
<div class="line"><a name="l05513"></a><span class="lineno"> 5513</span>&#160;  <span class="keywordtype">void</span> Decoder::setSettings(<span class="keyword">const</span> <a class="code" href="struct_lode_p_n_g___decode_settings.html">LodePNG_DecodeSettings</a>&amp; settings)</div>
<div class="line"><a name="l05514"></a><span class="lineno"> 5514</span>&#160;  {</div>
<div class="line"><a name="l05515"></a><span class="lineno"> 5515</span>&#160;    this-&gt;settings = settings;</div>
<div class="line"><a name="l05516"></a><span class="lineno"> 5516</span>&#160;  }</div>
<div class="line"><a name="l05517"></a><span class="lineno"> 5517</span>&#160;</div>
<div class="line"><a name="l05518"></a><span class="lineno"> 5518</span>&#160;  <span class="keyword">const</span> <a class="code" href="struct_lode_p_n_g___info_png.html">LodePNG_InfoPng</a>&amp; Decoder::getInfoPng()<span class="keyword"> const</span></div>
<div class="line"><a name="l05519"></a><span class="lineno"> 5519</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l05520"></a><span class="lineno"> 5520</span>&#160;    <span class="keywordflow">return</span> infoPng;</div>
<div class="line"><a name="l05521"></a><span class="lineno"> 5521</span>&#160;  }</div>
<div class="line"><a name="l05522"></a><span class="lineno"> 5522</span>&#160;</div>
<div class="line"><a name="l05523"></a><span class="lineno"> 5523</span>&#160;  <a class="code" href="struct_lode_p_n_g___info_png.html">LodePNG_InfoPng</a>&amp; Decoder::getInfoPng()</div>
<div class="line"><a name="l05524"></a><span class="lineno"> 5524</span>&#160;  {</div>
<div class="line"><a name="l05525"></a><span class="lineno"> 5525</span>&#160;    <span class="keywordflow">return</span> infoPng;</div>
<div class="line"><a name="l05526"></a><span class="lineno"> 5526</span>&#160;  }</div>
<div class="line"><a name="l05527"></a><span class="lineno"> 5527</span>&#160;</div>
<div class="line"><a name="l05528"></a><span class="lineno"> 5528</span>&#160;  <span class="keywordtype">void</span> Decoder::setInfoPng(<span class="keyword">const</span> <a class="code" href="struct_lode_p_n_g___info_png.html">LodePNG_InfoPng</a>&amp; info)</div>
<div class="line"><a name="l05529"></a><span class="lineno"> 5529</span>&#160;  {</div>
<div class="line"><a name="l05530"></a><span class="lineno"> 5530</span>&#160;    error = <a class="code" href="lodepng_8cpp.html#a0e188efe0b87e1b7d11a01ff85881368">LodePNG_InfoPng_copy</a>(&amp;this-&gt;infoPng, &amp;info);</div>
<div class="line"><a name="l05531"></a><span class="lineno"> 5531</span>&#160;  }</div>
<div class="line"><a name="l05532"></a><span class="lineno"> 5532</span>&#160;</div>
<div class="line"><a name="l05533"></a><span class="lineno"> 5533</span>&#160;  <span class="keywordtype">void</span> Decoder::swapInfoPng(<a class="code" href="struct_lode_p_n_g___info_png.html">LodePNG_InfoPng</a>&amp; info)</div>
<div class="line"><a name="l05534"></a><span class="lineno"> 5534</span>&#160;  {</div>
<div class="line"><a name="l05535"></a><span class="lineno"> 5535</span>&#160;    <a class="code" href="lodepng_8cpp.html#a64f7d3440fc708f7a349e11324119b52">LodePNG_InfoPng_swap</a>(&amp;this-&gt;infoPng, &amp;info);</div>
<div class="line"><a name="l05536"></a><span class="lineno"> 5536</span>&#160;  }</div>
<div class="line"><a name="l05537"></a><span class="lineno"> 5537</span>&#160;</div>
<div class="line"><a name="l05538"></a><span class="lineno"> 5538</span>&#160;  <span class="keyword">const</span> <a class="code" href="struct_lode_p_n_g___info_raw.html">LodePNG_InfoRaw</a>&amp; Decoder::getInfoRaw()<span class="keyword"> const</span></div>
<div class="line"><a name="l05539"></a><span class="lineno"> 5539</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l05540"></a><span class="lineno"> 5540</span>&#160;    <span class="keywordflow">return</span> infoRaw;</div>
<div class="line"><a name="l05541"></a><span class="lineno"> 5541</span>&#160;  }</div>
<div class="line"><a name="l05542"></a><span class="lineno"> 5542</span>&#160;</div>
<div class="line"><a name="l05543"></a><span class="lineno"> 5543</span>&#160;  <a class="code" href="struct_lode_p_n_g___info_raw.html">LodePNG_InfoRaw</a>&amp; Decoder::getInfoRaw()</div>
<div class="line"><a name="l05544"></a><span class="lineno"> 5544</span>&#160;  {</div>
<div class="line"><a name="l05545"></a><span class="lineno"> 5545</span>&#160;    <span class="keywordflow">return</span> infoRaw;</div>
<div class="line"><a name="l05546"></a><span class="lineno"> 5546</span>&#160;  }</div>
<div class="line"><a name="l05547"></a><span class="lineno"> 5547</span>&#160;</div>
<div class="line"><a name="l05548"></a><span class="lineno"> 5548</span>&#160;  <span class="keywordtype">void</span> Decoder::setInfoRaw(<span class="keyword">const</span> <a class="code" href="struct_lode_p_n_g___info_raw.html">LodePNG_InfoRaw</a>&amp; info)</div>
<div class="line"><a name="l05549"></a><span class="lineno"> 5549</span>&#160;  {</div>
<div class="line"><a name="l05550"></a><span class="lineno"> 5550</span>&#160;    error = <a class="code" href="lodepng_8cpp.html#a745b94bf14f6c3497b6280863e71e5a6">LodePNG_InfoRaw_copy</a>(&amp;this-&gt;infoRaw, &amp;info);</div>
<div class="line"><a name="l05551"></a><span class="lineno"> 5551</span>&#160;  }</div>
<div class="line"><a name="l05552"></a><span class="lineno"> 5552</span>&#160;</div>
<div class="line"><a name="l05553"></a><span class="lineno"> 5553</span>&#160;<span class="preprocessor">#endif //LODEPNG_COMPILE_DECODER</span></div>
<div class="line"><a name="l05554"></a><span class="lineno"> 5554</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l05555"></a><span class="lineno"> 5555</span>&#160;  <span class="comment">/* ////////////////////////////////////////////////////////////////////////// */</span></div>
<div class="line"><a name="l05556"></a><span class="lineno"> 5556</span>&#160;</div>
<div class="line"><a name="l05557"></a><span class="lineno"> 5557</span>&#160;<span class="preprocessor">#ifdef LODEPNG_COMPILE_ENCODER</span></div>
<div class="line"><a name="l05558"></a><span class="lineno"> 5558</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l05559"></a><span class="lineno"> 5559</span>&#160;  Encoder::Encoder()</div>
<div class="line"><a name="l05560"></a><span class="lineno"> 5560</span>&#160;  {</div>
<div class="line"><a name="l05561"></a><span class="lineno"> 5561</span>&#160;    <a class="code" href="lodepng_8cpp.html#a187956c5e5784f77f5b17181310be304">LodePNG_Encoder_init</a>(<span class="keyword">this</span>);</div>
<div class="line"><a name="l05562"></a><span class="lineno"> 5562</span>&#160;  }</div>
<div class="line"><a name="l05563"></a><span class="lineno"> 5563</span>&#160;</div>
<div class="line"><a name="l05564"></a><span class="lineno"> 5564</span>&#160;  Encoder::~Encoder()</div>
<div class="line"><a name="l05565"></a><span class="lineno"> 5565</span>&#160;  {</div>
<div class="line"><a name="l05566"></a><span class="lineno"> 5566</span>&#160;    <a class="code" href="lodepng_8cpp.html#a7269f380122edb94715d5e2e87eab835">LodePNG_Encoder_cleanup</a>(<span class="keyword">this</span>);</div>
<div class="line"><a name="l05567"></a><span class="lineno"> 5567</span>&#160;  }</div>
<div class="line"><a name="l05568"></a><span class="lineno"> 5568</span>&#160;</div>
<div class="line"><a name="l05569"></a><span class="lineno"> 5569</span>&#160;  <span class="keywordtype">void</span> Encoder::operator=(<span class="keyword">const</span> <a class="code" href="struct_lode_p_n_g___encoder.html">LodePNG_Encoder</a>&amp; other)</div>
<div class="line"><a name="l05570"></a><span class="lineno"> 5570</span>&#160;  {</div>
<div class="line"><a name="l05571"></a><span class="lineno"> 5571</span>&#160;    <a class="code" href="lodepng_8cpp.html#a0c0160b2f998d5966324922a153ee557">LodePNG_Encoder_copy</a>(<span class="keyword">this</span>, &amp;other);</div>
<div class="line"><a name="l05572"></a><span class="lineno"> 5572</span>&#160;  }</div>
<div class="line"><a name="l05573"></a><span class="lineno"> 5573</span>&#160;</div>
<div class="line"><a name="l05574"></a><span class="lineno"> 5574</span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="namespace_f_w.html#a08e4933631da71a1c74b09b0a4da7d24">Encoder::hasError</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l05575"></a><span class="lineno"> 5575</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l05576"></a><span class="lineno"> 5576</span>&#160;    <span class="keywordflow">return</span> error != 0;</div>
<div class="line"><a name="l05577"></a><span class="lineno"> 5577</span>&#160;  }</div>
<div class="line"><a name="l05578"></a><span class="lineno"> 5578</span>&#160;</div>
<div class="line"><a name="l05579"></a><span class="lineno"> 5579</span>&#160;  <span class="keywordtype">unsigned</span> <a class="code" href="namespace_f_w.html#a57a9c09878d7bf99b2c6097e173ce6ad">Encoder::getError</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l05580"></a><span class="lineno"> 5580</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l05581"></a><span class="lineno"> 5581</span>&#160;    <span class="keywordflow">return</span> error;</div>
<div class="line"><a name="l05582"></a><span class="lineno"> 5582</span>&#160;  }</div>
<div class="line"><a name="l05583"></a><span class="lineno"> 5583</span>&#160;</div>
<div class="line"><a name="l05584"></a><span class="lineno"> 5584</span>&#160;  <span class="keywordtype">void</span> Encoder::encode(std::vector&lt;unsigned char&gt;&amp; out, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* image, <span class="keywordtype">unsigned</span> w, <span class="keywordtype">unsigned</span> h)</div>
<div class="line"><a name="l05585"></a><span class="lineno"> 5585</span>&#160;  {</div>
<div class="line"><a name="l05586"></a><span class="lineno"> 5586</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* <a class="code" href="_d_l_l_imports_8inl.html#a9dbca2ffca3195a70ff9a21d5c97b242">buffer</a>;</div>
<div class="line"><a name="l05587"></a><span class="lineno"> 5587</span>&#160;    <span class="keywordtype">size_t</span> buffersize;</div>
<div class="line"><a name="l05588"></a><span class="lineno"> 5588</span>&#160;    <a class="code" href="lodepng_8cpp.html#a125bf00fe358f550d268f19b48527ef3">LodePNG_Encoder_encode</a>(<span class="keyword">this</span>, &amp;buffer, &amp;buffersize, image, w, h);</div>
<div class="line"><a name="l05589"></a><span class="lineno"> 5589</span>&#160;    <span class="keywordflow">if</span>(buffer)</div>
<div class="line"><a name="l05590"></a><span class="lineno"> 5590</span>&#160;    {</div>
<div class="line"><a name="l05591"></a><span class="lineno"> 5591</span>&#160;      out.insert(out.end(), &amp;buffer[0], &amp;buffer[buffersize]);</div>
<div class="line"><a name="l05592"></a><span class="lineno"> 5592</span>&#160;      <a class="code" href="namespace_f_w.html#a93be8f55938d6ffb5ca0af1f95f81589">free</a>(buffer);</div>
<div class="line"><a name="l05593"></a><span class="lineno"> 5593</span>&#160;    }</div>
<div class="line"><a name="l05594"></a><span class="lineno"> 5594</span>&#160;  }</div>
<div class="line"><a name="l05595"></a><span class="lineno"> 5595</span>&#160;</div>
<div class="line"><a name="l05596"></a><span class="lineno"> 5596</span>&#160;  <span class="keywordtype">void</span> Encoder::encode(std::vector&lt;unsigned char&gt;&amp; out, <span class="keyword">const</span> std::vector&lt;unsigned char&gt;&amp; image,</div>
<div class="line"><a name="l05597"></a><span class="lineno"> 5597</span>&#160;                       <span class="keywordtype">unsigned</span> w, <span class="keywordtype">unsigned</span> h)</div>
<div class="line"><a name="l05598"></a><span class="lineno"> 5598</span>&#160;  {</div>
<div class="line"><a name="l05599"></a><span class="lineno"> 5599</span>&#160;    encode(out, image.empty() ? 0 : &amp;image[0], w, h);</div>
<div class="line"><a name="l05600"></a><span class="lineno"> 5600</span>&#160;  }</div>
<div class="line"><a name="l05601"></a><span class="lineno"> 5601</span>&#160;</div>
<div class="line"><a name="l05602"></a><span class="lineno"> 5602</span>&#160;  <span class="keywordtype">void</span> Encoder::clearPalette()</div>
<div class="line"><a name="l05603"></a><span class="lineno"> 5603</span>&#160;  {</div>
<div class="line"><a name="l05604"></a><span class="lineno"> 5604</span>&#160;    <a class="code" href="lodepng_8cpp.html#ac78fd072f3dcc91ee6e3a250cfa64ea5">LodePNG_InfoColor_clearPalette</a>(&amp;infoPng.<a class="code" href="struct_lode_p_n_g___info_png.html#acce58518f72f42ba94db4c1cfd69336b">color</a>);</div>
<div class="line"><a name="l05605"></a><span class="lineno"> 5605</span>&#160;  }</div>
<div class="line"><a name="l05606"></a><span class="lineno"> 5606</span>&#160;</div>
<div class="line"><a name="l05607"></a><span class="lineno"> 5607</span>&#160;  <span class="keywordtype">void</span> Encoder::addPalette(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> r, <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> g, <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> b, <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> a)</div>
<div class="line"><a name="l05608"></a><span class="lineno"> 5608</span>&#160;  {</div>
<div class="line"><a name="l05609"></a><span class="lineno"> 5609</span>&#160;    error = <a class="code" href="lodepng_8cpp.html#af062c1db1f9e18f47aa2d9a86651dea3">LodePNG_InfoColor_addPalette</a>(&amp;infoPng.<a class="code" href="struct_lode_p_n_g___info_png.html#acce58518f72f42ba94db4c1cfd69336b">color</a>, r, g, b, a);</div>
<div class="line"><a name="l05610"></a><span class="lineno"> 5610</span>&#160;  }</div>
<div class="line"><a name="l05611"></a><span class="lineno"> 5611</span>&#160;</div>
<div class="line"><a name="l05612"></a><span class="lineno"> 5612</span>&#160;<span class="preprocessor">#ifdef LODEPNG_COMPILE_ANCILLARY_CHUNKS</span></div>
<div class="line"><a name="l05613"></a><span class="lineno"> 5613</span>&#160;<span class="preprocessor"></span>  <span class="keywordtype">void</span> Encoder::clearText()</div>
<div class="line"><a name="l05614"></a><span class="lineno"> 5614</span>&#160;  {</div>
<div class="line"><a name="l05615"></a><span class="lineno"> 5615</span>&#160;    <a class="code" href="lodepng_8cpp.html#a4837cdd713daa3c3a641d4b872f83cfc">LodePNG_Text_clear</a>(&amp;infoPng.<a class="code" href="struct_lode_p_n_g___info_png.html#a2ba6d900f4eee624a18df252e9df40e9">text</a>);</div>
<div class="line"><a name="l05616"></a><span class="lineno"> 5616</span>&#160;  }</div>
<div class="line"><a name="l05617"></a><span class="lineno"> 5617</span>&#160;</div>
<div class="line"><a name="l05618"></a><span class="lineno"> 5618</span>&#160;  <span class="keywordtype">void</span> Encoder::addText(<span class="keyword">const</span> std::string&amp; key, <span class="keyword">const</span> std::string&amp; str)</div>
<div class="line"><a name="l05619"></a><span class="lineno"> 5619</span>&#160;  {</div>
<div class="line"><a name="l05620"></a><span class="lineno"> 5620</span>&#160;    error = <a class="code" href="lodepng_8cpp.html#a9de001414ae7aa2b695c31171b4267ff">LodePNG_Text_add</a>(&amp;infoPng.<a class="code" href="struct_lode_p_n_g___info_png.html#a2ba6d900f4eee624a18df252e9df40e9">text</a>, key.c_str(), str.c_str());</div>
<div class="line"><a name="l05621"></a><span class="lineno"> 5621</span>&#160;  }</div>
<div class="line"><a name="l05622"></a><span class="lineno"> 5622</span>&#160;</div>
<div class="line"><a name="l05623"></a><span class="lineno"> 5623</span>&#160;  <span class="keywordtype">void</span> Encoder::clearIText()</div>
<div class="line"><a name="l05624"></a><span class="lineno"> 5624</span>&#160;  {</div>
<div class="line"><a name="l05625"></a><span class="lineno"> 5625</span>&#160;    <a class="code" href="lodepng_8cpp.html#af63c0478e6478580bcc2726dfe205598">LodePNG_IText_clear</a>(&amp;infoPng.<a class="code" href="struct_lode_p_n_g___info_png.html#a6a25d5f857d5e8d1c326997b78d9daf1">itext</a>);</div>
<div class="line"><a name="l05626"></a><span class="lineno"> 5626</span>&#160;  }</div>
<div class="line"><a name="l05627"></a><span class="lineno"> 5627</span>&#160;</div>
<div class="line"><a name="l05628"></a><span class="lineno"> 5628</span>&#160;  <span class="keywordtype">void</span> Encoder::addIText(<span class="keyword">const</span> std::string&amp; key, <span class="keyword">const</span> std::string&amp; langtag,</div>
<div class="line"><a name="l05629"></a><span class="lineno"> 5629</span>&#160;                         <span class="keyword">const</span> std::string&amp; transkey, <span class="keyword">const</span> std::string&amp; str)</div>
<div class="line"><a name="l05630"></a><span class="lineno"> 5630</span>&#160;  {</div>
<div class="line"><a name="l05631"></a><span class="lineno"> 5631</span>&#160;    error = <a class="code" href="lodepng_8cpp.html#a637a6754fae89a90ea3ba46b1fa99df3">LodePNG_IText_add</a>(&amp;infoPng.<a class="code" href="struct_lode_p_n_g___info_png.html#a6a25d5f857d5e8d1c326997b78d9daf1">itext</a>, key.c_str(), langtag.c_str(), transkey.c_str(), str.c_str());</div>
<div class="line"><a name="l05632"></a><span class="lineno"> 5632</span>&#160;  }</div>
<div class="line"><a name="l05633"></a><span class="lineno"> 5633</span>&#160;<span class="preprocessor">#endif //LODEPNG_COMPILE_ANCILLARY_CHUNKS</span></div>
<div class="line"><a name="l05634"></a><span class="lineno"> 5634</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l05635"></a><span class="lineno"> 5635</span>&#160;  <span class="keyword">const</span> <a class="code" href="struct_lode_p_n_g___encode_settings.html">LodePNG_EncodeSettings</a>&amp; Encoder::getSettings()<span class="keyword"> const</span></div>
<div class="line"><a name="l05636"></a><span class="lineno"> 5636</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l05637"></a><span class="lineno"> 5637</span>&#160;    <span class="keywordflow">return</span> settings;</div>
<div class="line"><a name="l05638"></a><span class="lineno"> 5638</span>&#160;  }</div>
<div class="line"><a name="l05639"></a><span class="lineno"> 5639</span>&#160;</div>
<div class="line"><a name="l05640"></a><span class="lineno"> 5640</span>&#160;  <a class="code" href="struct_lode_p_n_g___encode_settings.html">LodePNG_EncodeSettings</a>&amp; Encoder::getSettings()</div>
<div class="line"><a name="l05641"></a><span class="lineno"> 5641</span>&#160;  {</div>
<div class="line"><a name="l05642"></a><span class="lineno"> 5642</span>&#160;    <span class="keywordflow">return</span> settings;</div>
<div class="line"><a name="l05643"></a><span class="lineno"> 5643</span>&#160;  }</div>
<div class="line"><a name="l05644"></a><span class="lineno"> 5644</span>&#160;</div>
<div class="line"><a name="l05645"></a><span class="lineno"> 5645</span>&#160;  <span class="keywordtype">void</span> Encoder::setSettings(<span class="keyword">const</span> <a class="code" href="struct_lode_p_n_g___encode_settings.html">LodePNG_EncodeSettings</a>&amp; settings)</div>
<div class="line"><a name="l05646"></a><span class="lineno"> 5646</span>&#160;  {</div>
<div class="line"><a name="l05647"></a><span class="lineno"> 5647</span>&#160;    this-&gt;settings = settings;</div>
<div class="line"><a name="l05648"></a><span class="lineno"> 5648</span>&#160;  }</div>
<div class="line"><a name="l05649"></a><span class="lineno"> 5649</span>&#160;</div>
<div class="line"><a name="l05650"></a><span class="lineno"> 5650</span>&#160;  <span class="keyword">const</span> <a class="code" href="struct_lode_p_n_g___info_png.html">LodePNG_InfoPng</a>&amp; Encoder::getInfoPng()<span class="keyword"> const</span></div>
<div class="line"><a name="l05651"></a><span class="lineno"> 5651</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l05652"></a><span class="lineno"> 5652</span>&#160;    <span class="keywordflow">return</span> infoPng;</div>
<div class="line"><a name="l05653"></a><span class="lineno"> 5653</span>&#160;  }</div>
<div class="line"><a name="l05654"></a><span class="lineno"> 5654</span>&#160;</div>
<div class="line"><a name="l05655"></a><span class="lineno"> 5655</span>&#160;  <a class="code" href="struct_lode_p_n_g___info_png.html">LodePNG_InfoPng</a>&amp; Encoder::getInfoPng()</div>
<div class="line"><a name="l05656"></a><span class="lineno"> 5656</span>&#160;  {</div>
<div class="line"><a name="l05657"></a><span class="lineno"> 5657</span>&#160;    <span class="keywordflow">return</span> infoPng;</div>
<div class="line"><a name="l05658"></a><span class="lineno"> 5658</span>&#160;  }</div>
<div class="line"><a name="l05659"></a><span class="lineno"> 5659</span>&#160;</div>
<div class="line"><a name="l05660"></a><span class="lineno"> 5660</span>&#160;  <span class="keywordtype">void</span> Encoder::setInfoPng(<span class="keyword">const</span> <a class="code" href="struct_lode_p_n_g___info_png.html">LodePNG_InfoPng</a>&amp; info)</div>
<div class="line"><a name="l05661"></a><span class="lineno"> 5661</span>&#160;  {</div>
<div class="line"><a name="l05662"></a><span class="lineno"> 5662</span>&#160;    error = <a class="code" href="lodepng_8cpp.html#a0e188efe0b87e1b7d11a01ff85881368">LodePNG_InfoPng_copy</a>(&amp;this-&gt;infoPng, &amp;info);</div>
<div class="line"><a name="l05663"></a><span class="lineno"> 5663</span>&#160;  }</div>
<div class="line"><a name="l05664"></a><span class="lineno"> 5664</span>&#160;</div>
<div class="line"><a name="l05665"></a><span class="lineno"> 5665</span>&#160;  <span class="keywordtype">void</span> Encoder::swapInfoPng(<a class="code" href="struct_lode_p_n_g___info_png.html">LodePNG_InfoPng</a>&amp; info)</div>
<div class="line"><a name="l05666"></a><span class="lineno"> 5666</span>&#160;  {</div>
<div class="line"><a name="l05667"></a><span class="lineno"> 5667</span>&#160;    <a class="code" href="lodepng_8cpp.html#a64f7d3440fc708f7a349e11324119b52">LodePNG_InfoPng_swap</a>(&amp;this-&gt;infoPng, &amp;info);</div>
<div class="line"><a name="l05668"></a><span class="lineno"> 5668</span>&#160;  }</div>
<div class="line"><a name="l05669"></a><span class="lineno"> 5669</span>&#160;</div>
<div class="line"><a name="l05670"></a><span class="lineno"> 5670</span>&#160;  <span class="keyword">const</span> <a class="code" href="struct_lode_p_n_g___info_raw.html">LodePNG_InfoRaw</a>&amp; Encoder::getInfoRaw()<span class="keyword"> const</span></div>
<div class="line"><a name="l05671"></a><span class="lineno"> 5671</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l05672"></a><span class="lineno"> 5672</span>&#160;    <span class="keywordflow">return</span> infoRaw;</div>
<div class="line"><a name="l05673"></a><span class="lineno"> 5673</span>&#160;  }</div>
<div class="line"><a name="l05674"></a><span class="lineno"> 5674</span>&#160;</div>
<div class="line"><a name="l05675"></a><span class="lineno"> 5675</span>&#160;  <a class="code" href="struct_lode_p_n_g___info_raw.html">LodePNG_InfoRaw</a>&amp; Encoder::getInfoRaw()</div>
<div class="line"><a name="l05676"></a><span class="lineno"> 5676</span>&#160;  {</div>
<div class="line"><a name="l05677"></a><span class="lineno"> 5677</span>&#160;    <span class="keywordflow">return</span> infoRaw;</div>
<div class="line"><a name="l05678"></a><span class="lineno"> 5678</span>&#160;  }</div>
<div class="line"><a name="l05679"></a><span class="lineno"> 5679</span>&#160;</div>
<div class="line"><a name="l05680"></a><span class="lineno"> 5680</span>&#160;  <span class="keywordtype">void</span> Encoder::setInfoRaw(<span class="keyword">const</span> <a class="code" href="struct_lode_p_n_g___info_raw.html">LodePNG_InfoRaw</a>&amp; info)</div>
<div class="line"><a name="l05681"></a><span class="lineno"> 5681</span>&#160;  {</div>
<div class="line"><a name="l05682"></a><span class="lineno"> 5682</span>&#160;    error = <a class="code" href="lodepng_8cpp.html#a745b94bf14f6c3497b6280863e71e5a6">LodePNG_InfoRaw_copy</a>(&amp;this-&gt;infoRaw, &amp;info);</div>
<div class="line"><a name="l05683"></a><span class="lineno"> 5683</span>&#160;  }</div>
<div class="line"><a name="l05684"></a><span class="lineno"> 5684</span>&#160;<span class="preprocessor">#endif //LODEPNG_COMPILE_ENCODER</span></div>
<div class="line"><a name="l05685"></a><span class="lineno"> 5685</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l05686"></a><span class="lineno"> 5686</span>&#160;  <span class="comment">/* ////////////////////////////////////////////////////////////////////////// */</span></div>
<div class="line"><a name="l05687"></a><span class="lineno"> 5687</span>&#160;</div>
<div class="line"><a name="l05688"></a><span class="lineno"> 5688</span>&#160;<span class="preprocessor">#ifdef LODEPNG_COMPILE_DECODER</span></div>
<div class="line"><a name="l05689"></a><span class="lineno"> 5689</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l05690"></a><span class="lineno"> 5690</span>&#160;  <span class="keywordtype">unsigned</span> decode(std::vector&lt;unsigned char&gt;&amp; out, <span class="keywordtype">unsigned</span>&amp; w, <span class="keywordtype">unsigned</span>&amp; h, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* in,</div>
<div class="line"><a name="l05691"></a><span class="lineno"> 5691</span>&#160;                  <span class="keywordtype">size_t</span> insize, <span class="keywordtype">unsigned</span> colorType, <span class="keywordtype">unsigned</span> bitDepth)</div>
<div class="line"><a name="l05692"></a><span class="lineno"> 5692</span>&#160;  {</div>
<div class="line"><a name="l05693"></a><span class="lineno"> 5693</span>&#160;    Decoder decoder;</div>
<div class="line"><a name="l05694"></a><span class="lineno"> 5694</span>&#160;    decoder.getInfoRaw().color.colorType = colorType;</div>
<div class="line"><a name="l05695"></a><span class="lineno"> 5695</span>&#160;    decoder.getInfoRaw().color.bitDepth = bitDepth;</div>
<div class="line"><a name="l05696"></a><span class="lineno"> 5696</span>&#160;    decoder.decode(out, in, insize);</div>
<div class="line"><a name="l05697"></a><span class="lineno"> 5697</span>&#160;    w = decoder.getWidth();</div>
<div class="line"><a name="l05698"></a><span class="lineno"> 5698</span>&#160;    h = decoder.getHeight();</div>
<div class="line"><a name="l05699"></a><span class="lineno"> 5699</span>&#160;    <span class="keywordflow">return</span> decoder.getError();</div>
<div class="line"><a name="l05700"></a><span class="lineno"> 5700</span>&#160;  }</div>
<div class="line"><a name="l05701"></a><span class="lineno"> 5701</span>&#160;</div>
<div class="line"><a name="l05702"></a><span class="lineno"> 5702</span>&#160;  <span class="keywordtype">unsigned</span> decode(std::vector&lt;unsigned char&gt;&amp; out, <span class="keywordtype">unsigned</span>&amp; w, <span class="keywordtype">unsigned</span>&amp; h,</div>
<div class="line"><a name="l05703"></a><span class="lineno"> 5703</span>&#160;                  <span class="keyword">const</span> std::vector&lt;unsigned char&gt;&amp; in, <span class="keywordtype">unsigned</span> colorType, <span class="keywordtype">unsigned</span> bitDepth)</div>
<div class="line"><a name="l05704"></a><span class="lineno"> 5704</span>&#160;  {</div>
<div class="line"><a name="l05705"></a><span class="lineno"> 5705</span>&#160;    <span class="keywordflow">return</span> decode(out, w, h, in.empty() ? 0 : &amp;in[0], (unsigned)in.size(), colorType, bitDepth);</div>
<div class="line"><a name="l05706"></a><span class="lineno"> 5706</span>&#160;  }</div>
<div class="line"><a name="l05707"></a><span class="lineno"> 5707</span>&#160;</div>
<div class="line"><a name="l05708"></a><span class="lineno"> 5708</span>&#160;<span class="preprocessor">#ifdef LODEPNG_COMPILE_DISK</span></div>
<div class="line"><a name="l05709"></a><span class="lineno"> 5709</span>&#160;<span class="preprocessor"></span>  <span class="keywordtype">unsigned</span> decode(std::vector&lt;unsigned char&gt;&amp; out, <span class="keywordtype">unsigned</span>&amp; w, <span class="keywordtype">unsigned</span>&amp; h, <span class="keyword">const</span> std::string&amp; filename,</div>
<div class="line"><a name="l05710"></a><span class="lineno"> 5710</span>&#160;                  <span class="keywordtype">unsigned</span> colorType, <span class="keywordtype">unsigned</span> bitDepth)</div>
<div class="line"><a name="l05711"></a><span class="lineno"> 5711</span>&#160;  {</div>
<div class="line"><a name="l05712"></a><span class="lineno"> 5712</span>&#160;    std::vector&lt;unsigned char&gt; <a class="code" href="_d_l_l_imports_8inl.html#a9dbca2ffca3195a70ff9a21d5c97b242">buffer</a>;</div>
<div class="line"><a name="l05713"></a><span class="lineno"> 5713</span>&#160;    loadFile(buffer, filename);</div>
<div class="line"><a name="l05714"></a><span class="lineno"> 5714</span>&#160;    <span class="keywordflow">return</span> decode(out, w, h, buffer, colorType, bitDepth);</div>
<div class="line"><a name="l05715"></a><span class="lineno"> 5715</span>&#160;  }</div>
<div class="line"><a name="l05716"></a><span class="lineno"> 5716</span>&#160;<span class="preprocessor">#endif //LODEPNG_COMPILE_DECODER</span></div>
<div class="line"><a name="l05717"></a><span class="lineno"> 5717</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#endif //LODEPNG_COMPILE_DISK</span></div>
<div class="line"><a name="l05718"></a><span class="lineno"> 5718</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l05719"></a><span class="lineno"> 5719</span>&#160;<span class="preprocessor">#ifdef LODEPNG_COMPILE_ENCODER</span></div>
<div class="line"><a name="l05720"></a><span class="lineno"> 5720</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l05721"></a><span class="lineno"> 5721</span>&#160;  <span class="keywordtype">unsigned</span> encode(std::vector&lt;unsigned char&gt;&amp; out, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* in, <span class="keywordtype">unsigned</span> w, <span class="keywordtype">unsigned</span> h,</div>
<div class="line"><a name="l05722"></a><span class="lineno"> 5722</span>&#160;                  <span class="keywordtype">unsigned</span> colorType, <span class="keywordtype">unsigned</span> bitDepth)</div>
<div class="line"><a name="l05723"></a><span class="lineno"> 5723</span>&#160;  {</div>
<div class="line"><a name="l05724"></a><span class="lineno"> 5724</span>&#160;    Encoder encoder;</div>
<div class="line"><a name="l05725"></a><span class="lineno"> 5725</span>&#160;    encoder.getInfoRaw().color.colorType = colorType;</div>
<div class="line"><a name="l05726"></a><span class="lineno"> 5726</span>&#160;    encoder.getInfoRaw().color.bitDepth = bitDepth;</div>
<div class="line"><a name="l05727"></a><span class="lineno"> 5727</span>&#160;    encoder.getInfoPng().color.colorType = colorType;</div>
<div class="line"><a name="l05728"></a><span class="lineno"> 5728</span>&#160;    encoder.getInfoPng().color.bitDepth = bitDepth;</div>
<div class="line"><a name="l05729"></a><span class="lineno"> 5729</span>&#160;    encoder.encode(out, in, w, h);</div>
<div class="line"><a name="l05730"></a><span class="lineno"> 5730</span>&#160;    <span class="keywordflow">return</span> encoder.getError();</div>
<div class="line"><a name="l05731"></a><span class="lineno"> 5731</span>&#160;  }</div>
<div class="line"><a name="l05732"></a><span class="lineno"> 5732</span>&#160;</div>
<div class="line"><a name="l05733"></a><span class="lineno"> 5733</span>&#160;  <span class="keywordtype">unsigned</span> encode(std::vector&lt;unsigned char&gt;&amp; out, <span class="keyword">const</span> std::vector&lt;unsigned char&gt;&amp; in, <span class="keywordtype">unsigned</span> w, <span class="keywordtype">unsigned</span> h,</div>
<div class="line"><a name="l05734"></a><span class="lineno"> 5734</span>&#160;                  <span class="keywordtype">unsigned</span> colorType, <span class="keywordtype">unsigned</span> bitDepth)</div>
<div class="line"><a name="l05735"></a><span class="lineno"> 5735</span>&#160;  {</div>
<div class="line"><a name="l05736"></a><span class="lineno"> 5736</span>&#160;    <span class="keywordflow">return</span> encode(out, in.empty() ? 0 : &amp;in[0], w, h, colorType, bitDepth);</div>
<div class="line"><a name="l05737"></a><span class="lineno"> 5737</span>&#160;  }</div>
<div class="line"><a name="l05738"></a><span class="lineno"> 5738</span>&#160;</div>
<div class="line"><a name="l05739"></a><span class="lineno"> 5739</span>&#160;<span class="preprocessor">#ifdef LODEPNG_COMPILE_DISK</span></div>
<div class="line"><a name="l05740"></a><span class="lineno"> 5740</span>&#160;<span class="preprocessor"></span>  <span class="keywordtype">unsigned</span> encode(<span class="keyword">const</span> std::string&amp; filename, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* in, <span class="keywordtype">unsigned</span> w, <span class="keywordtype">unsigned</span> h,</div>
<div class="line"><a name="l05741"></a><span class="lineno"> 5741</span>&#160;                  <span class="keywordtype">unsigned</span> colorType, <span class="keywordtype">unsigned</span> bitDepth)</div>
<div class="line"><a name="l05742"></a><span class="lineno"> 5742</span>&#160;  {</div>
<div class="line"><a name="l05743"></a><span class="lineno"> 5743</span>&#160;    std::vector&lt;unsigned char&gt; <a class="code" href="_d_l_l_imports_8inl.html#a9dbca2ffca3195a70ff9a21d5c97b242">buffer</a>;</div>
<div class="line"><a name="l05744"></a><span class="lineno"> 5744</span>&#160;    Encoder encoder;</div>
<div class="line"><a name="l05745"></a><span class="lineno"> 5745</span>&#160;    encoder.getInfoRaw().color.colorType = colorType;</div>
<div class="line"><a name="l05746"></a><span class="lineno"> 5746</span>&#160;    encoder.getInfoRaw().color.bitDepth = bitDepth;</div>
<div class="line"><a name="l05747"></a><span class="lineno"> 5747</span>&#160;    encoder.encode(buffer, in, w, h);</div>
<div class="line"><a name="l05748"></a><span class="lineno"> 5748</span>&#160;    <span class="keywordflow">if</span>(!encoder.hasError()) saveFile(buffer, filename);</div>
<div class="line"><a name="l05749"></a><span class="lineno"> 5749</span>&#160;    <span class="keywordflow">return</span> encoder.getError();</div>
<div class="line"><a name="l05750"></a><span class="lineno"> 5750</span>&#160;  }</div>
<div class="line"><a name="l05751"></a><span class="lineno"> 5751</span>&#160;</div>
<div class="line"><a name="l05752"></a><span class="lineno"> 5752</span>&#160;  <span class="keywordtype">unsigned</span> encode(<span class="keyword">const</span> std::string&amp; filename, <span class="keyword">const</span> std::vector&lt;unsigned char&gt;&amp; in, <span class="keywordtype">unsigned</span> w, <span class="keywordtype">unsigned</span> h,</div>
<div class="line"><a name="l05753"></a><span class="lineno"> 5753</span>&#160;                  <span class="keywordtype">unsigned</span> colorType, <span class="keywordtype">unsigned</span> bitDepth)</div>
<div class="line"><a name="l05754"></a><span class="lineno"> 5754</span>&#160;  {</div>
<div class="line"><a name="l05755"></a><span class="lineno"> 5755</span>&#160;    <span class="keywordflow">return</span> encode(filename, in.empty() ? 0 : &amp;in[0], w, h, colorType, bitDepth);</div>
<div class="line"><a name="l05756"></a><span class="lineno"> 5756</span>&#160;  }</div>
<div class="line"><a name="l05757"></a><span class="lineno"> 5757</span>&#160;<span class="preprocessor">#endif //LODEPNG_COMPILE_DISK</span></div>
<div class="line"><a name="l05758"></a><span class="lineno"> 5758</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#endif //LODEPNG_COMPILE_ENCODER</span></div>
<div class="line"><a name="l05759"></a><span class="lineno"> 5759</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#endif //LODEPNG_COMPILE_PNG</span></div>
<div class="line"><a name="l05760"></a><span class="lineno"> 5760</span>&#160;<span class="preprocessor"></span>} <span class="comment">//namespace LodePNG</span></div>
<div class="line"><a name="l05761"></a><span class="lineno"> 5761</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/*__cplusplus C++ RAII wrapper*/</span><span class="preprocessor"></span></div>
<div class="ttc" id="struct_lode_p_n_g___encode_settings_html_a5074182840fae2ac4399ca9fa6660b41"><div class="ttname"><a href="struct_lode_p_n_g___encode_settings.html#a5074182840fae2ac4399ca9fa6660b41">LodePNG_EncodeSettings::autoLeaveOutAlphaChannel</a></div><div class="ttdeci">unsigned autoLeaveOutAlphaChannel</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8h_source.html#l00699">lodepng.h:699</a></div></div>
<div class="ttc" id="struct_lode_p_n_g___decoder_html_abfd722a76000f55a38d99b34ec596720"><div class="ttname"><a href="struct_lode_p_n_g___decoder.html#abfd722a76000f55a38d99b34ec596720">LodePNG_Decoder::infoRaw</a></div><div class="ttdeci">LodePNG_InfoRaw infoRaw</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8h_source.html#l00650">lodepng.h:650</a></div></div>
<div class="ttc" id="_d_l_l_imports_8inl_html_a08fccce21fc4e2b456ae007e9b576c41"><div class="ttname"><a href="_d_l_l_imports_8inl.html#a08fccce21fc4e2b456ae007e9b576c41">offset</a></div><div class="ttdeci">CUdevice int ordinal char int CUdevice dev CUdevprop CUdevice dev CUcontext ctx CUcontext ctx CUcontext pctx CUmodule const void image CUmodule const void fatCubin CUfunction CUmodule const char name void p CUfunction unsigned int bytes CUtexref pTexRef CUtexref CUarray unsigned int Flags CUtexref int CUaddress_mode am CUtexref unsigned int Flags CUaddress_mode CUtexref int dim CUarray_format int CUtexref hTexRef CUfunction unsigned int numbytes CUfunction int offset</div><div class="ttdef"><b>Definition:</b> <a href="_d_l_l_imports_8inl_source.html#l00084">DLLImports.inl:84</a></div></div>
<div class="ttc" id="struct_lode_p_n_g___i_text_html_af20920b249db552b73ec00f259500cfc"><div class="ttname"><a href="struct_lode_p_n_g___i_text.html#af20920b249db552b73ec00f259500cfc">LodePNG_IText::transkeys</a></div><div class="ttdeci">char ** transkeys</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8h_source.html#l00477">lodepng.h:477</a></div></div>
<div class="ttc" id="lodepng_8cpp_html_a223cd919d45a68b8a91b20e3001e4dc6"><div class="ttname"><a href="lodepng_8cpp.html#a223cd919d45a68b8a91b20e3001e4dc6">LodePNG_Text_init</a></div><div class="ttdeci">void LodePNG_Text_init(LodePNG_Text *text)</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8cpp_source.html#l02577">lodepng.cpp:2577</a></div></div>
<div class="ttc" id="_defs_8hpp_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="_defs_8hpp.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="_defs_8hpp_source.html#l00039">Defs.hpp:39</a></div></div>
<div class="ttc" id="structvector_html"><div class="ttname"><a href="structvector.html">vector</a></div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8cpp_source.html#l00085">lodepng.cpp:85</a></div></div>
<div class="ttc" id="struct_lode_p_n_g___info_png_html_a2ba6d900f4eee624a18df252e9df40e9"><div class="ttname"><a href="struct_lode_p_n_g___info_png.html#a2ba6d900f4eee624a18df252e9df40e9">LodePNG_InfoPng::text</a></div><div class="ttdeci">LodePNG_Text text</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8h_source.html#l00558">lodepng.h:558</a></div></div>
<div class="ttc" id="lodepng_8cpp_html_a0e188efe0b87e1b7d11a01ff85881368"><div class="ttname"><a href="lodepng_8cpp.html#a0e188efe0b87e1b7d11a01ff85881368">LodePNG_InfoPng_copy</a></div><div class="ttdeci">unsigned LodePNG_InfoPng_copy(LodePNG_InfoPng *dest, const LodePNG_InfoPng *source)</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8cpp_source.html#l02760">lodepng.cpp:2760</a></div></div>
<div class="ttc" id="struct_lode_p_n_g___info_png_html"><div class="ttname"><a href="struct_lode_p_n_g___info_png.html">LodePNG_InfoPng</a></div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8h_source.html#l00524">lodepng.h:524</a></div></div>
<div class="ttc" id="lodepng_8cpp_html_aca6d9a07dd0805433de47feb04e0fc52"><div class="ttname"><a href="lodepng_8cpp.html#aca6d9a07dd0805433de47feb04e0fc52">LodePNG_loadFile</a></div><div class="ttdeci">unsigned LodePNG_loadFile(unsigned char **out, size_t *outsize, const char *filename)</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8cpp_source.html#l00393">lodepng.cpp:393</a></div></div>
<div class="ttc" id="lodepng_8cpp_html_a691b23954341613b96b6d98ce67d339c"><div class="ttname"><a href="lodepng_8cpp.html#a691b23954341613b96b6d98ce67d339c">ERROR_BREAK</a></div><div class="ttdeci">#define ERROR_BREAK(code)</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8cpp_source.html#l00071">lodepng.cpp:71</a></div></div>
<div class="ttc" id="lodepng_8cpp_html_a81151c0087467b4ac2a815b3234fdb5a"><div class="ttname"><a href="lodepng_8cpp.html#a81151c0087467b4ac2a815b3234fdb5a">LodePNG_InfoColor_getBpp</a></div><div class="ttdeci">unsigned LodePNG_InfoColor_getBpp(const LodePNG_InfoColor *info)</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8cpp_source.html#l02494">lodepng.cpp:2494</a></div></div>
<div class="ttc" id="structuivector_html_aac0395a9ad397ae7a28219561ab49ffa"><div class="ttname"><a href="structuivector.html#aac0395a9ad397ae7a28219561ab49ffa">uivector::allocsize</a></div><div class="ttdeci">size_t allocsize</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8cpp_source.html#l00170">lodepng.cpp:170</a></div></div>
<div class="ttc" id="struct_lode_p_n_g___encode_settings_html_a0f14cf8e264027f702bff5d9ed9a0ade"><div class="ttname"><a href="struct_lode_p_n_g___encode_settings.html#a0f14cf8e264027f702bff5d9ed9a0ade">LodePNG_EncodeSettings::add_id</a></div><div class="ttdeci">unsigned add_id</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8h_source.html#l00705">lodepng.h:705</a></div></div>
<div class="ttc" id="struct_lode_p_n_g___i_text_html_abcb2f7a9848f6cf561e15e7c7f43fcb3"><div class="ttname"><a href="struct_lode_p_n_g___i_text.html#abcb2f7a9848f6cf561e15e7c7f43fcb3">LodePNG_IText::langtags</a></div><div class="ttdeci">char ** langtags</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8h_source.html#l00475">lodepng.h:475</a></div></div>
<div class="ttc" id="struct_lode_p_n_g___encode_settings_html_a1bb1c6043e4bcf65ddebd204ac3ab7f5"><div class="ttname"><a href="struct_lode_p_n_g___encode_settings.html#a1bb1c6043e4bcf65ddebd204ac3ab7f5">LodePNG_EncodeSettings::bruteForceFilters</a></div><div class="ttdeci">unsigned bruteForceFilters</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8h_source.html#l00696">lodepng.h:696</a></div></div>
<div class="ttc" id="lodepng_8cpp_html_af5a4469e6cb7a84476d16686fd55fcda"><div class="ttname"><a href="lodepng_8cpp.html#af5a4469e6cb7a84476d16686fd55fcda">LodePNG_defaultCompressSettings</a></div><div class="ttdeci">const LodePNG_CompressSettings LodePNG_defaultCompressSettings</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8cpp_source.html#l02173">lodepng.cpp:2173</a></div></div>
<div class="ttc" id="lodepng_8cpp_html_aa2ff174234767c087c7ba974ba862be9"><div class="ttname"><a href="lodepng_8cpp.html#aa2ff174234767c087c7ba974ba862be9">LodePNG_zlib_compress</a></div><div class="ttdeci">unsigned LodePNG_zlib_compress(unsigned char **out, size_t *outsize, const unsigned char *in, size_t insize, const LodePNG_CompressSettings *settings)</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8cpp_source.html#l02086">lodepng.cpp:2086</a></div></div>
<div class="ttc" id="lodepng_8cpp_html_a358797f791102c447e2e895e8da46854"><div class="ttname"><a href="lodepng_8cpp.html#a358797f791102c447e2e895e8da46854">uivector</a></div><div class="ttdeci">struct uivector uivector</div></div>
<div class="ttc" id="namespace_f_w_html_a440e071d8fdbc9789b728245caad99c0"><div class="ttname"><a href="namespace_f_w.html#a440e071d8fdbc9789b728245caad99c0">FW::malloc</a></div><div class="ttdeci">void * malloc(size_t size)</div><div class="ttdef"><b>Definition:</b> <a href="_defs_8cpp_source.html#l00120">Defs.cpp:120</a></div></div>
<div class="ttc" id="lodepng_8cpp_html_aa28cca4bd765525e9f777bc4a7c50ced"><div class="ttname"><a href="lodepng_8cpp.html#aa28cca4bd765525e9f777bc4a7c50ced">LodePNG_Decoder_cleanup</a></div><div class="ttdeci">void LodePNG_Decoder_cleanup(LodePNG_Decoder *decoder)</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8cpp_source.html#l04186">lodepng.cpp:4186</a></div></div>
<div class="ttc" id="lodepng_8cpp_html_ab1a96344114c67ce549c848c44a9597b"><div class="ttname"><a href="lodepng_8cpp.html#ab1a96344114c67ce549c848c44a9597b">LodePNG_chunk_next</a></div><div class="ttdeci">unsigned char * LodePNG_chunk_next(unsigned char *chunk)</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8cpp_source.html#l02349">lodepng.cpp:2349</a></div></div>
<div class="ttc" id="lodepng_8cpp_html_ab454c837b98c2643be639477e6bc3c5f"><div class="ttname"><a href="lodepng_8cpp.html#ab454c837b98c2643be639477e6bc3c5f">LodePNG_UnknownChunks_cleanup</a></div><div class="ttdeci">void LodePNG_UnknownChunks_cleanup(LodePNG_UnknownChunks *chunks)</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8cpp_source.html#l02551">lodepng.cpp:2551</a></div></div>
<div class="ttc" id="lodepng_8cpp_html_a08b94fef98f8164a529fc60330647479"><div class="ttname"><a href="lodepng_8cpp.html#a08b94fef98f8164a529fc60330647479">LodePNG_decode32</a></div><div class="ttdeci">unsigned LodePNG_decode32(unsigned char **out, unsigned *w, unsigned *h, const unsigned char *in, size_t insize)</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8cpp_source.html#l04131">lodepng.cpp:4131</a></div></div>
<div class="ttc" id="struct_lode_p_n_g___info_png_html_a0f0b0d882e5c099d06d608c79295ba2d"><div class="ttname"><a href="struct_lode_p_n_g___info_png.html#a0f0b0d882e5c099d06d608c79295ba2d">LodePNG_InfoPng::phys_defined</a></div><div class="ttdeci">unsigned phys_defined</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8h_source.html#l00568">lodepng.h:568</a></div></div>
<div class="ttc" id="struct_lode_p_n_g___info_png_html_a4b87ec9649e7177af7a5f5e08e5bc491"><div class="ttname"><a href="struct_lode_p_n_g___info_png.html#a4b87ec9649e7177af7a5f5e08e5bc491">LodePNG_InfoPng::height</a></div><div class="ttdeci">unsigned height</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8h_source.html#l00534">lodepng.h:534</a></div></div>
<div class="ttc" id="lodepng_8cpp_html_a58feace6a0d109fc6bb2161504a3011e"><div class="ttname"><a href="lodepng_8cpp.html#a58feace6a0d109fc6bb2161504a3011e">NUM_DEFLATE_CODE_SYMBOLS</a></div><div class="ttdeci">#define NUM_DEFLATE_CODE_SYMBOLS</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8cpp_source.html#l00499">lodepng.cpp:499</a></div></div>
<div class="ttc" id="struct_lode_p_n_g___i_text_html_aa4e0811fdc21677603e387168179e66e"><div class="ttname"><a href="struct_lode_p_n_g___i_text.html#aa4e0811fdc21677603e387168179e66e">LodePNG_IText::strings</a></div><div class="ttdeci">char ** strings</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8h_source.html#l00479">lodepng.h:479</a></div></div>
<div class="ttc" id="struct_lode_p_n_g___info_png_html_a101ffbacd7026dad4ab062e984cecf17"><div class="ttname"><a href="struct_lode_p_n_g___info_png.html#a101ffbacd7026dad4ab062e984cecf17">LodePNG_InfoPng::filterMethod</a></div><div class="ttdeci">unsigned filterMethod</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8h_source.html#l00536">lodepng.h:536</a></div></div>
<div class="ttc" id="_d_l_l_imports_8inl_html_a9dbca2ffca3195a70ff9a21d5c97b242"><div class="ttname"><a href="_d_l_l_imports_8inl.html#a9dbca2ffca3195a70ff9a21d5c97b242">buffer</a></div><div class="ttdeci">CUdevice int ordinal char int CUdevice dev CUdevprop CUdevice dev CUcontext ctx CUcontext ctx CUcontext pctx CUmodule const void image CUmodule const void fatCubin CUfunction CUmodule const char name void p CUfunction unsigned int bytes CUtexref pTexRef CUtexref CUarray unsigned int Flags CUtexref int CUaddress_mode am CUtexref unsigned int Flags CUaddress_mode CUtexref int dim CUarray_format int CUtexref hTexRef CUfunction unsigned int numbytes CUfunction int float value CUfunction int CUtexref hTexRef CUfunction int int grid_height CUevent unsigned int Flags CUevent hEvent CUevent hEvent CUstream unsigned int Flags CUstream hStream GLuint bufferobj unsigned int CUdevice dev CUdeviceptr unsigned int CUmodule const char name CUdeviceptr unsigned int bytesize CUdeviceptr dptr void unsigned int bytesize void CUdeviceptr unsigned int ByteCount CUarray unsigned int CUdeviceptr unsigned int ByteCount CUarray unsigned int const void unsigned int ByteCount CUarray unsigned int CUarray unsigned int unsigned int ByteCount void CUarray unsigned int unsigned int CUstream hStream const CUDA_MEMCPY2D pCopy CUdeviceptr const void unsigned int CUstream hStream const CUDA_MEMCPY2D CUstream hStream CUdeviceptr unsigned char unsigned int N CUdeviceptr unsigned int unsigned int N CUdeviceptr unsigned int unsigned short unsigned int unsigned int Height CUarray const CUDA_ARRAY_DESCRIPTOR pAllocateArray CUarray const CUDA_ARRAY3D_DESCRIPTOR pAllocateArray unsigned int CUtexref CUdeviceptr unsigned int bytes CUcontext unsigned int CUdevice device GLenum texture GLenum GLuint buffer</div><div class="ttdef"><b>Definition:</b> <a href="_d_l_l_imports_8inl_source.html#l00315">DLLImports.inl:315</a></div></div>
<div class="ttc" id="lodepng_8cpp_html_ac78fd072f3dcc91ee6e3a250cfa64ea5"><div class="ttname"><a href="lodepng_8cpp.html#ac78fd072f3dcc91ee6e3a250cfa64ea5">LodePNG_InfoColor_clearPalette</a></div><div class="ttdeci">void LodePNG_InfoColor_clearPalette(LodePNG_InfoColor *info)</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8cpp_source.html#l02466">lodepng.cpp:2466</a></div></div>
<div class="ttc" id="_d_l_l_imports_8inl_html_a156a9c7e986e0352d0fe500e629d5171"><div class="ttname"><a href="_d_l_l_imports_8inl.html#a156a9c7e986e0352d0fe500e629d5171">data</a></div><div class="ttdeci">CUdevice int ordinal char int CUdevice dev CUdevprop CUdevice dev CUcontext ctx CUcontext ctx CUcontext pctx CUmodule const void image CUmodule const void fatCubin CUfunction CUmodule const char name void p CUfunction unsigned int bytes CUtexref pTexRef CUtexref CUarray unsigned int Flags CUtexref int CUaddress_mode am CUtexref unsigned int Flags CUaddress_mode CUtexref int dim CUarray_format int CUtexref hTexRef CUfunction unsigned int numbytes CUfunction int float value CUfunction int CUtexref hTexRef CUfunction int int grid_height CUevent unsigned int Flags CUevent hEvent CUevent hEvent CUstream unsigned int Flags CUstream hStream GLuint bufferobj unsigned int CUdevice dev CUdeviceptr unsigned int CUmodule const char name CUdeviceptr unsigned int bytesize CUdeviceptr dptr void unsigned int bytesize void CUdeviceptr unsigned int ByteCount CUarray unsigned int CUdeviceptr unsigned int ByteCount CUarray unsigned int const void unsigned int ByteCount CUarray unsigned int CUarray unsigned int unsigned int ByteCount void CUarray unsigned int unsigned int CUstream hStream const CUDA_MEMCPY2D pCopy CUdeviceptr const void unsigned int CUstream hStream const CUDA_MEMCPY2D CUstream hStream CUdeviceptr unsigned char unsigned int N CUdeviceptr unsigned int unsigned int N CUdeviceptr unsigned int unsigned short unsigned int unsigned int Height CUarray const CUDA_ARRAY_DESCRIPTOR pAllocateArray CUarray const CUDA_ARRAY3D_DESCRIPTOR pAllocateArray unsigned int CUtexref CUdeviceptr unsigned int bytes CUcontext unsigned int CUdevice device GLenum texture GLenum GLuint buffer GLenum GLuint renderbuffer GLenum GLsizeiptr const GLvoid * data</div><div class="ttdef"><b>Definition:</b> <a href="_d_l_l_imports_8inl_source.html#l00319">DLLImports.inl:319</a></div></div>
<div class="ttc" id="lodepng_8cpp_html_a75457d20497de64abea3a34daefc4f8c"><div class="ttname"><a href="lodepng_8cpp.html#a75457d20497de64abea3a34daefc4f8c">LodePNG_create_chunk</a></div><div class="ttdeci">unsigned LodePNG_create_chunk(unsigned char **out, size_t *outlength, unsigned length, const char *type, const unsigned char *data)</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8cpp_source.html#l02380">lodepng.cpp:2380</a></div></div>
<div class="ttc" id="lodepng_8cpp_html_a166194e49966c1079f332863aad52770"><div class="ttname"><a href="lodepng_8cpp.html#a166194e49966c1079f332863aad52770">LodePNG_IText_init</a></div><div class="ttdeci">void LodePNG_IText_init(LodePNG_IText *text)</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8cpp_source.html#l02641">lodepng.cpp:2641</a></div></div>
<div class="ttc" id="struct_lode_p_n_g___time_html_a7ebc5c1cff16ed456268f6b4de66f4d7"><div class="ttname"><a href="struct_lode_p_n_g___time.html#a7ebc5c1cff16ed456268f6b4de66f4d7">LodePNG_Time::hour</a></div><div class="ttdeci">unsigned char hour</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8h_source.html#l00420">lodepng.h:420</a></div></div>
<div class="ttc" id="lodepng_8cpp_html_a7835adf81910eb662237cc15c0ed8ee3"><div class="ttname"><a href="lodepng_8cpp.html#a7835adf81910eb662237cc15c0ed8ee3">LodePNG_error_text</a></div><div class="ttdeci">const char * LodePNG_error_text(unsigned code)</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8cpp_source.html#l05239">lodepng.cpp:5239</a></div></div>
<div class="ttc" id="struct_lode_p_n_g___encoder_html"><div class="ttname"><a href="struct_lode_p_n_g___encoder.html">LodePNG_Encoder</a></div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8h_source.html#l00718">lodepng.h:718</a></div></div>
<div class="ttc" id="struct_lode_p_n_g___compress_settings_html_ab7b87ac5529ab33b12efb05372974ca5"><div class="ttname"><a href="struct_lode_p_n_g___compress_settings.html#ab7b87ac5529ab33b12efb05372974ca5">LodePNG_CompressSettings::useLZ77</a></div><div class="ttdeci">unsigned useLZ77</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8h_source.html#l00315">lodepng.h:315</a></div></div>
<div class="ttc" id="lodepng_8cpp_html_a2f5ecf25393f688611987c61f698f1ce"><div class="ttname"><a href="lodepng_8cpp.html#a2f5ecf25393f688611987c61f698f1ce">LodePNG_InfoColor_cleanup</a></div><div class="ttdeci">void LodePNG_InfoColor_cleanup(LodePNG_InfoColor *info)</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8cpp_source.html#l02461">lodepng.cpp:2461</a></div></div>
<div class="ttc" id="struct_lode_p_n_g___i_text_html_a487ca35406b7c5fdd13fd32e9c148c21"><div class="ttname"><a href="struct_lode_p_n_g___i_text.html#a487ca35406b7c5fdd13fd32e9c148c21">LodePNG_IText::keys</a></div><div class="ttdeci">char ** keys</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8h_source.html#l00473">lodepng.h:473</a></div></div>
<div class="ttc" id="lodepng_8cpp_html_ad705dca4fd163e14e555a6e2e3223af1"><div class="ttname"><a href="lodepng_8cpp.html#ad705dca4fd163e14e555a6e2e3223af1">HuffmanTree</a></div><div class="ttdeci">struct HuffmanTree HuffmanTree</div></div>
<div class="ttc" id="struct_lode_p_n_g___unknown_chunks_html_a9923d61d31e17e7093194da5182eda97"><div class="ttname"><a href="struct_lode_p_n_g___unknown_chunks.html#a9923d61d31e17e7093194da5182eda97">LodePNG_UnknownChunks::data</a></div><div class="ttdeci">unsigned char * data[3]</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8h_source.html#l00509">lodepng.h:509</a></div></div>
<div class="ttc" id="struct_lode_p_n_g___time_html_a68ba78f192f4ed04bed783591df81405"><div class="ttname"><a href="struct_lode_p_n_g___time.html#a68ba78f192f4ed04bed783591df81405">LodePNG_Time::month</a></div><div class="ttdeci">unsigned char month</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8h_source.html#l00418">lodepng.h:418</a></div></div>
<div class="ttc" id="lodepng_8cpp_html_a313e972622f025eba50616c62ff033d0"><div class="ttname"><a href="lodepng_8cpp.html#a313e972622f025eba50616c62ff033d0">LodePNG_Decoder_init</a></div><div class="ttdeci">void LodePNG_Decoder_init(LodePNG_Decoder *decoder)</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8cpp_source.html#l04178">lodepng.cpp:4178</a></div></div>
<div class="ttc" id="struct_lode_p_n_g___compress_settings_html_aafec7ef311a7ad4e2ad3b1184e2aa805"><div class="ttname"><a href="struct_lode_p_n_g___compress_settings.html#aafec7ef311a7ad4e2ad3b1184e2aa805">LodePNG_CompressSettings::btype</a></div><div class="ttdeci">unsigned btype</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8h_source.html#l00314">lodepng.h:314</a></div></div>
<div class="ttc" id="struct_lode_p_n_g___decompress_settings_html"><div class="ttname"><a href="struct_lode_p_n_g___decompress_settings.html">LodePNG_DecompressSettings</a></div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8h_source.html#l00297">lodepng.h:297</a></div></div>
<div class="ttc" id="struct_lode_p_n_g___encode_settings_html"><div class="ttname"><a href="struct_lode_p_n_g___encode_settings.html">LodePNG_EncodeSettings</a></div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8h_source.html#l00684">lodepng.h:684</a></div></div>
<div class="ttc" id="lodepng_8cpp_html_a62159dfd6cf8a67b55d5bbc70fee589b"><div class="ttname"><a href="lodepng_8cpp.html#a62159dfd6cf8a67b55d5bbc70fee589b">LodePNG_InfoColor_getChannels</a></div><div class="ttdeci">unsigned LodePNG_InfoColor_getChannels(const LodePNG_InfoColor *info)</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8cpp_source.html#l02500">lodepng.cpp:2500</a></div></div>
<div class="ttc" id="struct_lode_p_n_g___decode_settings_html_af8de90c1410b0ad33c4d2712cafef26e"><div class="ttname"><a href="struct_lode_p_n_g___decode_settings.html#af8de90c1410b0ad33c4d2712cafef26e">LodePNG_DecodeSettings::zlibsettings</a></div><div class="ttdeci">LodePNG_DecompressSettings zlibsettings</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8h_source.html#l00625">lodepng.h:625</a></div></div>
<div class="ttc" id="lodepng_8cpp_html_a64f7d3440fc708f7a349e11324119b52"><div class="ttname"><a href="lodepng_8cpp.html#a64f7d3440fc708f7a349e11324119b52">LodePNG_InfoPng_swap</a></div><div class="ttdeci">void LodePNG_InfoPng_swap(LodePNG_InfoPng *a, LodePNG_InfoPng *b)</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8cpp_source.html#l02780">lodepng.cpp:2780</a></div></div>
<div class="ttc" id="lodepng_8cpp_html_a90de60ea21ee48b050fcd9c7a45b6a78"><div class="ttname"><a href="lodepng_8cpp.html#a90de60ea21ee48b050fcd9c7a45b6a78">LodePNG_encode24_file</a></div><div class="ttdeci">unsigned LodePNG_encode24_file(const char *filename, const unsigned char *image, unsigned w, unsigned h)</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8cpp_source.html#l05185">lodepng.cpp:5185</a></div></div>
<div class="ttc" id="struct_lode_p_n_g___info_png_html_a6a25d5f857d5e8d1c326997b78d9daf1"><div class="ttname"><a href="struct_lode_p_n_g___info_png.html#a6a25d5f857d5e8d1c326997b78d9daf1">LodePNG_InfoPng::itext</a></div><div class="ttdeci">LodePNG_IText itext</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8h_source.html#l00561">lodepng.h:561</a></div></div>
<div class="ttc" id="struct_lode_p_n_g___i_text_html_a5af6eb21b9963d7f49e28d7ea181763c"><div class="ttname"><a href="struct_lode_p_n_g___i_text.html#a5af6eb21b9963d7f49e28d7ea181763c">LodePNG_IText::num</a></div><div class="ttdeci">size_t num</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8h_source.html#l00471">lodepng.h:471</a></div></div>
<div class="ttc" id="struct_coin_html_a1d6bc1176bb9fcbd9ca8c781c92ef432"><div class="ttname"><a href="struct_coin.html#a1d6bc1176bb9fcbd9ca8c781c92ef432">Coin::symbols</a></div><div class="ttdeci">uivector symbols</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8cpp_source.html#l00696">lodepng.cpp:696</a></div></div>
<div class="ttc" id="lodepng_8cpp_html_aaddd7d56dc63d15b1e142e803c4a408a"><div class="ttname"><a href="lodepng_8cpp.html#aaddd7d56dc63d15b1e142e803c4a408a">LodePNG_decode32_file</a></div><div class="ttdeci">unsigned LodePNG_decode32_file(unsigned char **out, unsigned *w, unsigned *h, const char *filename)</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8cpp_source.html#l04154">lodepng.cpp:4154</a></div></div>
<div class="ttc" id="struct_lode_p_n_g___decoder_html_a03ad3505caf0cba6de6cadfd41b9067e"><div class="ttname"><a href="struct_lode_p_n_g___decoder.html#a03ad3505caf0cba6de6cadfd41b9067e">LodePNG_Decoder::settings</a></div><div class="ttdeci">LodePNG_DecodeSettings settings</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8h_source.html#l00649">lodepng.h:649</a></div></div>
<div class="ttc" id="lodepng_8cpp_html_a604ea30e5e116f443a85a821a53402c7"><div class="ttname"><a href="lodepng_8cpp.html#a604ea30e5e116f443a85a821a53402c7">vector</a></div><div class="ttdeci">struct vector vector</div></div>
<div class="ttc" id="_d_l_l_imports_8inl_html_a5720e2b8f4f85b31e0bab5a1b6e69c74"><div class="ttname"><a href="_d_l_l_imports_8inl.html#a5720e2b8f4f85b31e0bab5a1b6e69c74">length</a></div><div class="ttdeci">CUdevice int ordinal char int CUdevice dev CUdevprop CUdevice dev CUcontext ctx CUcontext ctx CUcontext pctx CUmodule const void image CUmodule const void fatCubin CUfunction CUmodule const char name void p CUfunction unsigned int bytes CUtexref pTexRef CUtexref CUarray unsigned int Flags CUtexref int CUaddress_mode am CUtexref unsigned int Flags CUaddress_mode CUtexref int dim CUarray_format int CUtexref hTexRef CUfunction unsigned int numbytes CUfunction int float value CUfunction int CUtexref hTexRef CUfunction int int grid_height CUevent unsigned int Flags CUevent hEvent CUevent hEvent CUstream unsigned int Flags CUstream hStream GLuint bufferobj unsigned int CUdevice dev CUdeviceptr unsigned int CUmodule const char name CUdeviceptr unsigned int bytesize CUdeviceptr dptr void unsigned int bytesize void CUdeviceptr unsigned int ByteCount CUarray unsigned int CUdeviceptr unsigned int ByteCount CUarray unsigned int const void unsigned int ByteCount CUarray unsigned int CUarray unsigned int unsigned int ByteCount void CUarray unsigned int unsigned int CUstream hStream const CUDA_MEMCPY2D pCopy CUdeviceptr const void unsigned int CUstream hStream const CUDA_MEMCPY2D CUstream hStream CUdeviceptr unsigned char unsigned int N CUdeviceptr unsigned int unsigned int N CUdeviceptr unsigned int unsigned short unsigned int unsigned int Height CUarray const CUDA_ARRAY_DESCRIPTOR pAllocateArray CUarray const CUDA_ARRAY3D_DESCRIPTOR pAllocateArray unsigned int CUtexref CUdeviceptr unsigned int bytes CUcontext unsigned int CUdevice device GLenum texture GLenum GLuint buffer GLenum GLuint renderbuffer GLenum GLsizeiptr const GLvoid GLenum usage GLuint shader GLenum type GLsizei const GLuint framebuffers GLsizei const GLuint renderbuffers GLuint v GLuint v GLenum GLenum GLenum GLuint GLint level GLsizei GLuint framebuffers GLuint const GLchar name GLenum GLintptr GLsizeiptr GLvoid data GLuint GLenum GLint param GLuint GLenum GLint param GLhandleARB programObj GLenum GLenum GLsizei GLsizei height GLenum GLint GLint GLsizei GLsizei GLsizei GLint GLenum GLenum const GLvoid pixels GLint GLsizei const GLfloat value GLint GLfloat GLfloat v1 GLint GLfloat GLfloat GLfloat v2 GLint GLsizei const GLfloat value GLint GLsizei GLboolean const GLfloat value GLuint program GLuint GLfloat GLfloat GLfloat z GLuint GLint GLenum GLboolean GLsizei const GLvoid pointer GLuint GLuint const GLchar name GLenum GLsizei GLenum GLsizei GLsizei height GLenum GLuint renderbuffer GLenum GLenum GLint params GLuint GLsizei range GLuint GLsizei const GLubyte GLsizei GLenum const GLvoid coords GLuint GLsizei GLsizei GLsizei const GLubyte GLsizei GLenum const GLvoid coords GLuint GLenum GLsizei length</div><div class="ttdef"><b>Definition:</b> <a href="_d_l_l_imports_8inl_source.html#l00388">DLLImports.inl:388</a></div></div>
<div class="ttc" id="lodepng_8cpp_html_a947faf188804eb1b43158cd836333a6f"><div class="ttname"><a href="lodepng_8cpp.html#a947faf188804eb1b43158cd836333a6f">DEFAULT_WINDOWSIZE</a></div><div class="ttdeci">#define DEFAULT_WINDOWSIZE</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8cpp_source.html#l02163">lodepng.cpp:2163</a></div></div>
<div class="ttc" id="struct_lode_p_n_g___info_png_html_aa220d359b0f73b1f61a87f1c3bf8aad6"><div class="ttname"><a href="struct_lode_p_n_g___info_png.html#aa220d359b0f73b1f61a87f1c3bf8aad6">LodePNG_InfoPng::time_defined</a></div><div class="ttdeci">unsigned char time_defined</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8h_source.html#l00564">lodepng.h:564</a></div></div>
<div class="ttc" id="lodepng_8cpp_html_a187956c5e5784f77f5b17181310be304"><div class="ttname"><a href="lodepng_8cpp.html#a187956c5e5784f77f5b17181310be304">LodePNG_Encoder_init</a></div><div class="ttdeci">void LodePNG_Encoder_init(LodePNG_Encoder *encoder)</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8cpp_source.html#l05203">lodepng.cpp:5203</a></div></div>
<div class="ttc" id="lodepng_8cpp_html_abaea3ca539b3d5f1624ac8286f47b34c"><div class="ttname"><a href="lodepng_8cpp.html#abaea3ca539b3d5f1624ac8286f47b34c">LodePNG_InfoColor_init</a></div><div class="ttdeci">void LodePNG_InfoColor_init(LodePNG_InfoColor *info)</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8cpp_source.html#l02451">lodepng.cpp:2451</a></div></div>
<div class="ttc" id="namespace_f_w_html_a3a10d44b3bb3a43e7a6c30e8242248ed"><div class="ttname"><a href="namespace_f_w.html#a3a10d44b3bb3a43e7a6c30e8242248ed">FW::L</a></div><div class="ttdeci">int L</div><div class="ttdef"><b>Definition:</b> <a href="_math_8hpp_source.html#l00509">Math.hpp:509</a></div></div>
<div class="ttc" id="namespace_f_w_html_ae73c23ac68578f9a4a32ee9668118369"><div class="ttname"><a href="namespace_f_w.html#ae73c23ac68578f9a4a32ee9668118369">FW::hash</a></div><div class="ttdeci">U32 hash(const T &amp;value)</div><div class="ttdef"><b>Definition:</b> <a href="_hash_8hpp_source.html#l00199">Hash.hpp:199</a></div></div>
<div class="ttc" id="struct_lode_p_n_g___time_html_a298fdd9a10f4a122e4921624d3bfd78b"><div class="ttname"><a href="struct_lode_p_n_g___time.html#a298fdd9a10f4a122e4921624d3bfd78b">LodePNG_Time::day</a></div><div class="ttdeci">unsigned char day</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8h_source.html#l00419">lodepng.h:419</a></div></div>
<div class="ttc" id="structuivector_html_a427d761df4bb4f0f19b4a973fc224c78"><div class="ttname"><a href="structuivector.html#a427d761df4bb4f0f19b4a973fc224c78">uivector::data</a></div><div class="ttdeci">unsigned * data</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8cpp_source.html#l00168">lodepng.cpp:168</a></div></div>
<div class="ttc" id="struct_lode_p_n_g___info_raw_html"><div class="ttname"><a href="struct_lode_p_n_g___info_raw.html">LodePNG_InfoRaw</a></div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8h_source.html#l00591">lodepng.h:591</a></div></div>
<div class="ttc" id="struct_lode_p_n_g___i_text_html"><div class="ttname"><a href="struct_lode_p_n_g___i_text.html">LodePNG_IText</a></div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8h_source.html#l00465">lodepng.h:465</a></div></div>
<div class="ttc" id="struct_lode_p_n_g___unknown_chunks_html"><div class="ttname"><a href="struct_lode_p_n_g___unknown_chunks.html">LodePNG_UnknownChunks</a></div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8h_source.html#l00499">lodepng.h:499</a></div></div>
<div class="ttc" id="struct_lode_p_n_g___compress_settings_html_adaebb6134716768bd1636aa97ec68b90"><div class="ttname"><a href="struct_lode_p_n_g___compress_settings.html#adaebb6134716768bd1636aa97ec68b90">LodePNG_CompressSettings::windowSize</a></div><div class="ttdeci">unsigned windowSize</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8h_source.html#l00316">lodepng.h:316</a></div></div>
<div class="ttc" id="structucvector_html_a235168baac13f0c78bd3e309dc170f90"><div class="ttname"><a href="structucvector.html#a235168baac13f0c78bd3e309dc170f90">ucvector::allocsize</a></div><div class="ttdeci">size_t allocsize</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8cpp_source.html#l00250">lodepng.cpp:250</a></div></div>
<div class="ttc" id="structvector_html_afee87fd86bbabb017991064293317a8b"><div class="ttname"><a href="structvector.html#afee87fd86bbabb017991064293317a8b">vector::data</a></div><div class="ttdeci">void * data</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8cpp_source.html#l00087">lodepng.cpp:87</a></div></div>
<div class="ttc" id="struct_lode_p_n_g___time_html"><div class="ttname"><a href="struct_lode_p_n_g___time.html">LodePNG_Time</a></div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8h_source.html#l00415">lodepng.h:415</a></div></div>
<div class="ttc" id="lodepng_8cpp_html_a1d08e922a7f80b5afcde010489db6579"><div class="ttname"><a href="lodepng_8cpp.html#a1d08e922a7f80b5afcde010489db6579">LodePNG_chunk_check_crc</a></div><div class="ttdeci">unsigned LodePNG_chunk_check_crc(const unsigned char *chunk)</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8cpp_source.html#l02332">lodepng.cpp:2332</a></div></div>
<div class="ttc" id="struct_lode_p_n_g___encode_settings_html_aec49a17d50b61c20a5e08a79bc6c9d2d"><div class="ttname"><a href="struct_lode_p_n_g___encode_settings.html#aec49a17d50b61c20a5e08a79bc6c9d2d">LodePNG_EncodeSettings::text_compression</a></div><div class="ttdeci">unsigned text_compression</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8h_source.html#l00707">lodepng.h:707</a></div></div>
<div class="ttc" id="struct_lode_p_n_g___encode_settings_html_ae2d55a9f02c8711e426c08f54d268279"><div class="ttname"><a href="struct_lode_p_n_g___encode_settings.html#ae2d55a9f02c8711e426c08f54d268279">LodePNG_EncodeSettings::zlibsettings</a></div><div class="ttdeci">LodePNG_CompressSettings zlibsettings</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8h_source.html#l00686">lodepng.h:686</a></div></div>
<div class="ttc" id="lodepng_8cpp_html_a89f06ac9bcf1964fb4d663ad7a8dc4a1"><div class="ttname"><a href="lodepng_8cpp.html#a89f06ac9bcf1964fb4d663ad7a8dc4a1">READBIT</a></div><div class="ttdeci">#define READBIT(bitpointer, bitstream)</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8cpp_source.html#l00471">lodepng.cpp:471</a></div></div>
<div class="ttc" id="lodepng_8cpp_html_a798ef8e10a95cbb610ee6a0f2c92f61c"><div class="ttname"><a href="lodepng_8cpp.html#a798ef8e10a95cbb610ee6a0f2c92f61c">LodePNG_Text_cleanup</a></div><div class="ttdeci">void LodePNG_Text_cleanup(LodePNG_Text *text)</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8cpp_source.html#l02584">lodepng.cpp:2584</a></div></div>
<div class="ttc" id="struct_lode_p_n_g___decoder_html_aa84a32ab83a4e50d909259b2041cb13e"><div class="ttname"><a href="struct_lode_p_n_g___decoder.html#aa84a32ab83a4e50d909259b2041cb13e">LodePNG_Decoder::infoPng</a></div><div class="ttdeci">LodePNG_InfoPng infoPng</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8h_source.html#l00651">lodepng.h:651</a></div></div>
<div class="ttc" id="struct_lode_p_n_g___info_png_html_ad261cbe064eb69a92638e880d99347ca"><div class="ttname"><a href="struct_lode_p_n_g___info_png.html#ad261cbe064eb69a92638e880d99347ca">LodePNG_InfoPng::interlaceMethod</a></div><div class="ttdeci">unsigned interlaceMethod</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8h_source.html#l00537">lodepng.h:537</a></div></div>
<div class="ttc" id="_d_l_l_imports_8inl_html_a801542531fe9fad1565d31155ba5517b"><div class="ttname"><a href="_d_l_l_imports_8inl.html#a801542531fe9fad1565d31155ba5517b">x</a></div><div class="ttdeci">CUdevice int ordinal char int CUdevice dev CUdevprop CUdevice dev CUcontext ctx CUcontext ctx CUcontext pctx CUmodule const void image CUmodule const void fatCubin CUfunction CUmodule const char name void p CUfunction unsigned int bytes CUtexref pTexRef CUtexref CUarray unsigned int Flags CUtexref int CUaddress_mode am CUtexref unsigned int Flags CUaddress_mode CUtexref int dim CUarray_format int CUtexref hTexRef CUfunction unsigned int numbytes CUfunction int float value CUfunction int CUtexref hTexRef CUfunction int int grid_height CUevent unsigned int Flags CUevent hEvent CUevent hEvent CUstream unsigned int Flags CUstream hStream GLuint bufferobj unsigned int CUdevice dev CUdeviceptr unsigned int CUmodule const char name CUdeviceptr unsigned int bytesize CUdeviceptr dptr void unsigned int bytesize void CUdeviceptr unsigned int ByteCount CUarray unsigned int CUdeviceptr unsigned int ByteCount CUarray unsigned int const void unsigned int ByteCount CUarray unsigned int CUarray unsigned int unsigned int ByteCount void CUarray unsigned int unsigned int CUstream hStream const CUDA_MEMCPY2D pCopy CUdeviceptr const void unsigned int CUstream hStream const CUDA_MEMCPY2D CUstream hStream CUdeviceptr unsigned char unsigned int N CUdeviceptr unsigned int unsigned int N CUdeviceptr unsigned int unsigned short unsigned int unsigned int Height CUarray const CUDA_ARRAY_DESCRIPTOR pAllocateArray CUarray const CUDA_ARRAY3D_DESCRIPTOR pAllocateArray unsigned int CUtexref CUdeviceptr unsigned int bytes CUcontext unsigned int CUdevice device GLenum texture GLenum GLuint buffer GLenum GLuint renderbuffer GLenum GLsizeiptr const GLvoid GLenum usage GLuint shader GLenum type GLsizei const GLuint framebuffers GLsizei const GLuint renderbuffers GLuint v GLuint v GLenum GLenum GLenum GLuint GLint level GLsizei GLuint framebuffers GLuint const GLchar name GLenum GLintptr GLsizeiptr GLvoid data GLuint GLenum GLint param GLuint GLenum GLint param GLhandleARB programObj GLenum GLenum GLsizei GLsizei height GLenum GLint GLint GLsizei GLsizei GLsizei GLint GLenum GLenum const GLvoid pixels GLint GLsizei const GLfloat value GLint GLfloat GLfloat v1 GLint GLfloat GLfloat GLfloat v2 GLint GLsizei const GLfloat value GLint GLsizei GLboolean const GLfloat value GLuint program GLuint GLfloat x</div><div class="ttdef"><b>Definition:</b> <a href="_d_l_l_imports_8inl_source.html#l00363">DLLImports.inl:363</a></div></div>
<div class="ttc" id="lodepng_8cpp_html_a4d2cd18166489c9373aad80d9036addb"><div class="ttname"><a href="lodepng_8cpp.html#a4d2cd18166489c9373aad80d9036addb">Coin</a></div><div class="ttdeci">struct Coin Coin</div></div>
<div class="ttc" id="lodepng_8cpp_html_a720d71deb4b13a7ca7ab683e9367a61e"><div class="ttname"><a href="lodepng_8cpp.html#a720d71deb4b13a7ca7ab683e9367a61e">LodePNG_decode</a></div><div class="ttdeci">unsigned LodePNG_decode(unsigned char **out, unsigned *w, unsigned *h, const unsigned char *in, size_t insize, unsigned colorType, unsigned bitDepth)</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8cpp_source.html#l04114">lodepng.cpp:4114</a></div></div>
<div class="ttc" id="struct_coin_html"><div class="ttname"><a href="struct_coin.html">Coin</a></div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8cpp_source.html#l00694">lodepng.cpp:694</a></div></div>
<div class="ttc" id="lodepng_8cpp_html_aeebb8a3150e965e39e3cea345e4f875a"><div class="ttname"><a href="lodepng_8cpp.html#aeebb8a3150e965e39e3cea345e4f875a">LodePNG_encode</a></div><div class="ttdeci">unsigned LodePNG_encode(unsigned char **out, size_t *outsize, const unsigned char *image, unsigned w, unsigned h, unsigned colorType, unsigned bitDepth)</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8cpp_source.html#l05142">lodepng.cpp:5142</a></div></div>
<div class="ttc" id="struct_lode_p_n_g___info_color_html_a9d538965a46d59bbdea744da8b290591"><div class="ttname"><a href="struct_lode_p_n_g___info_color.html#a9d538965a46d59bbdea744da8b290591">LodePNG_InfoColor::bitDepth</a></div><div class="ttdeci">unsigned bitDepth</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8h_source.html#l00337">lodepng.h:337</a></div></div>
<div class="ttc" id="struct_huffman_tree_html_adf034ca9ce62a4ebfffaaeaba4378a26"><div class="ttname"><a href="struct_huffman_tree.html#adf034ca9ce62a4ebfffaaeaba4378a26">HuffmanTree::maxbitlen</a></div><div class="ttdeci">unsigned maxbitlen</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8cpp_source.html#l00540">lodepng.cpp:540</a></div></div>
<div class="ttc" id="lodepng_8cpp_html_a4af200ba997cfba6319267d2f970dfa3"><div class="ttname"><a href="lodepng_8cpp.html#a4af200ba997cfba6319267d2f970dfa3">LodePNG_UnknownChunks_init</a></div><div class="ttdeci">void LodePNG_UnknownChunks_init(LodePNG_UnknownChunks *chunks)</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8cpp_source.html#l02544">lodepng.cpp:2544</a></div></div>
<div class="ttc" id="structuivector_html_aa999025945f0c93d0461192475ae2720"><div class="ttname"><a href="structuivector.html#aa999025945f0c93d0461192475ae2720">uivector::size</a></div><div class="ttdeci">size_t size</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8cpp_source.html#l00169">lodepng.cpp:169</a></div></div>
<div class="ttc" id="struct_lode_p_n_g___info_png_html_a52e3f42ce7942e5ebd0c60db6737056a"><div class="ttname"><a href="struct_lode_p_n_g___info_png.html#a52e3f42ce7942e5ebd0c60db6737056a">LodePNG_InfoPng::time</a></div><div class="ttdeci">LodePNG_Time time</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8h_source.html#l00565">lodepng.h:565</a></div></div>
<div class="ttc" id="lodepng_8cpp_html_a8614eb41779500a05b72943a7a8f06ae"><div class="ttname"><a href="lodepng_8cpp.html#a8614eb41779500a05b72943a7a8f06ae">LodePNG_encode_file</a></div><div class="ttdeci">unsigned LodePNG_encode_file(const char *filename, const unsigned char *image, unsigned w, unsigned h, unsigned colorType, unsigned bitDepth)</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8cpp_source.html#l05169">lodepng.cpp:5169</a></div></div>
<div class="ttc" id="lodepng_8cpp_html_a5ac964beddc20407668774ebf7804fc4"><div class="ttname"><a href="lodepng_8cpp.html#a5ac964beddc20407668774ebf7804fc4">LodePNG_DecompressSettings_init</a></div><div class="ttdeci">void LodePNG_DecompressSettings_init(LodePNG_DecompressSettings *settings)</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8cpp_source.html#l02179">lodepng.cpp:2179</a></div></div>
<div class="ttc" id="namespace_f_w_html_ab37f6a6b7427cf34d9cec7c7d482d9d2"><div class="ttname"><a href="namespace_f_w.html#ab37f6a6b7427cf34d9cec7c7d482d9d2">FW::sum</a></div><div class="ttdeci">FW_CUDA_FUNC T sum(const VectorBase&lt; T, L, S &gt; &amp;v)</div><div class="ttdef"><b>Definition:</b> <a href="_math_8hpp_source.html#l00463">Math.hpp:463</a></div></div>
<div class="ttc" id="_d_l_l_imports_8inl_html_af7bcdfc5a984ba9c6720d5f0416f249d"><div class="ttname"><a href="_d_l_l_imports_8inl.html#af7bcdfc5a984ba9c6720d5f0416f249d">y</a></div><div class="ttdeci">CUdevice int ordinal char int CUdevice dev CUdevprop CUdevice dev CUcontext ctx CUcontext ctx CUcontext pctx CUmodule const void image CUmodule const void fatCubin CUfunction CUmodule const char name void p CUfunction unsigned int bytes CUtexref pTexRef CUtexref CUarray unsigned int Flags CUtexref int CUaddress_mode am CUtexref unsigned int Flags CUaddress_mode CUtexref int dim CUarray_format int CUtexref hTexRef CUfunction unsigned int numbytes CUfunction int float value CUfunction int CUtexref hTexRef CUfunction int int grid_height CUevent unsigned int Flags CUevent hEvent CUevent hEvent CUstream unsigned int Flags CUstream hStream GLuint bufferobj unsigned int CUdevice dev CUdeviceptr unsigned int CUmodule const char name CUdeviceptr unsigned int bytesize CUdeviceptr dptr void unsigned int bytesize void CUdeviceptr unsigned int ByteCount CUarray unsigned int CUdeviceptr unsigned int ByteCount CUarray unsigned int const void unsigned int ByteCount CUarray unsigned int CUarray unsigned int unsigned int ByteCount void CUarray unsigned int unsigned int CUstream hStream const CUDA_MEMCPY2D pCopy CUdeviceptr const void unsigned int CUstream hStream const CUDA_MEMCPY2D CUstream hStream CUdeviceptr unsigned char unsigned int N CUdeviceptr unsigned int unsigned int N CUdeviceptr unsigned int unsigned short unsigned int unsigned int Height CUarray const CUDA_ARRAY_DESCRIPTOR pAllocateArray CUarray const CUDA_ARRAY3D_DESCRIPTOR pAllocateArray unsigned int CUtexref CUdeviceptr unsigned int bytes CUcontext unsigned int CUdevice device GLenum texture GLenum GLuint buffer GLenum GLuint renderbuffer GLenum GLsizeiptr const GLvoid GLenum usage GLuint shader GLenum type GLsizei const GLuint framebuffers GLsizei const GLuint renderbuffers GLuint v GLuint v GLenum GLenum GLenum GLuint GLint level GLsizei GLuint framebuffers GLuint const GLchar name GLenum GLintptr GLsizeiptr GLvoid data GLuint GLenum GLint param GLuint GLenum GLint param GLhandleARB programObj GLenum GLenum GLsizei GLsizei height GLenum GLint GLint GLsizei GLsizei GLsizei GLint GLenum GLenum const GLvoid pixels GLint GLsizei const GLfloat value GLint GLfloat GLfloat v1 GLint GLfloat GLfloat GLfloat v2 GLint GLsizei const GLfloat value GLint GLsizei GLboolean const GLfloat value GLuint program GLuint GLfloat GLfloat y</div><div class="ttdef"><b>Definition:</b> <a href="_d_l_l_imports_8inl_source.html#l00363">DLLImports.inl:363</a></div></div>
<div class="ttc" id="lodepng_8cpp_html_aaf0b1dce9e5514b1d56509dcb6d57033"><div class="ttname"><a href="lodepng_8cpp.html#aaf0b1dce9e5514b1d56509dcb6d57033">LodePNG_InfoColor_hasPaletteAlpha</a></div><div class="ttdeci">unsigned LodePNG_InfoColor_hasPaletteAlpha(const LodePNG_InfoColor *info)</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8cpp_source.html#l02520">lodepng.cpp:2520</a></div></div>
<div class="ttc" id="lodepng_8cpp_html_a924159ab70e41380aff27ba6c54e258f"><div class="ttname"><a href="lodepng_8cpp.html#a924159ab70e41380aff27ba6c54e258f">LodePNG_Text_copy</a></div><div class="ttdeci">unsigned LodePNG_Text_copy(LodePNG_Text *dest, const LodePNG_Text *source)</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8cpp_source.html#l02589">lodepng.cpp:2589</a></div></div>
<div class="ttc" id="lodepng_8cpp_html_a6bfc53fc461cddfd37ca800524985040"><div class="ttname"><a href="lodepng_8cpp.html#a6bfc53fc461cddfd37ca800524985040">LodePNG_InfoColor_isPaletteType</a></div><div class="ttdeci">unsigned LodePNG_InfoColor_isPaletteType(const LodePNG_InfoColor *info)</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8cpp_source.html#l02515">lodepng.cpp:2515</a></div></div>
<div class="ttc" id="lodepng_8cpp_html_a8ebce7aaef4f64e50d2ad2e3a383a505"><div class="ttname"><a href="lodepng_8cpp.html#a8ebce7aaef4f64e50d2ad2e3a383a505">ucvector</a></div><div class="ttdeci">struct ucvector ucvector</div></div>
<div class="ttc" id="lodepng_8cpp_html_af062c1db1f9e18f47aa2d9a86651dea3"><div class="ttname"><a href="lodepng_8cpp.html#af062c1db1f9e18f47aa2d9a86651dea3">LodePNG_InfoColor_addPalette</a></div><div class="ttdeci">unsigned LodePNG_InfoColor_addPalette(LodePNG_InfoColor *info, unsigned char r, unsigned char g, unsigned char b, unsigned char a)</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8cpp_source.html#l02472">lodepng.cpp:2472</a></div></div>
<div class="ttc" id="structucvector_html_ace794c5713208c5a20f21762cd87c919"><div class="ttname"><a href="structucvector.html#ace794c5713208c5a20f21762cd87c919">ucvector::data</a></div><div class="ttdeci">unsigned char * data</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8cpp_source.html#l00248">lodepng.cpp:248</a></div></div>
<div class="ttc" id="_d_l_l_imports_8inl_html_aa775029a6efb12d0b0eeef97c1814d04"><div class="ttname"><a href="_d_l_l_imports_8inl.html#aa775029a6efb12d0b0eeef97c1814d04">v</a></div><div class="ttdeci">CUdevice int ordinal char int CUdevice dev CUdevprop CUdevice dev CUcontext ctx CUcontext ctx CUcontext pctx CUmodule const void image CUmodule const void fatCubin CUfunction CUmodule const char name void p CUfunction unsigned int bytes CUtexref pTexRef CUtexref CUarray unsigned int Flags CUtexref int CUaddress_mode am CUtexref unsigned int Flags CUaddress_mode CUtexref int dim CUarray_format int CUtexref hTexRef CUfunction unsigned int numbytes CUfunction int float value CUfunction int CUtexref hTexRef CUfunction int int grid_height CUevent unsigned int Flags CUevent hEvent CUevent hEvent CUstream unsigned int Flags CUstream hStream GLuint bufferobj unsigned int CUdevice dev CUdeviceptr unsigned int CUmodule const char name CUdeviceptr unsigned int bytesize CUdeviceptr dptr void unsigned int bytesize void CUdeviceptr unsigned int ByteCount CUarray unsigned int CUdeviceptr unsigned int ByteCount CUarray unsigned int const void unsigned int ByteCount CUarray unsigned int CUarray unsigned int unsigned int ByteCount void CUarray unsigned int unsigned int CUstream hStream const CUDA_MEMCPY2D pCopy CUdeviceptr const void unsigned int CUstream hStream const CUDA_MEMCPY2D CUstream hStream CUdeviceptr unsigned char unsigned int N CUdeviceptr unsigned int unsigned int N CUdeviceptr unsigned int unsigned short unsigned int unsigned int Height CUarray const CUDA_ARRAY_DESCRIPTOR pAllocateArray CUarray const CUDA_ARRAY3D_DESCRIPTOR pAllocateArray unsigned int CUtexref CUdeviceptr unsigned int bytes CUcontext unsigned int CUdevice device GLenum texture GLenum GLuint buffer GLenum GLuint renderbuffer GLenum GLsizeiptr const GLvoid GLenum usage GLuint shader GLenum type GLsizei const GLuint framebuffers GLsizei const GLuint renderbuffers GLuint v</div><div class="ttdef"><b>Definition:</b> <a href="_d_l_l_imports_8inl_source.html#l00329">DLLImports.inl:329</a></div></div>
<div class="ttc" id="lodepng_8cpp_html_ace44ddf46ee78445d379279be6f9cf7d"><div class="ttname"><a href="lodepng_8cpp.html#ace44ddf46ee78445d379279be6f9cf7d">LodePNG_UnknownChunks_copy</a></div><div class="ttdeci">unsigned LodePNG_UnknownChunks_copy(LodePNG_UnknownChunks *dest, const LodePNG_UnknownChunks *src)</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8cpp_source.html#l02557">lodepng.cpp:2557</a></div></div>
<div class="ttc" id="struct_lode_p_n_g___compress_settings_html"><div class="ttname"><a href="struct_lode_p_n_g___compress_settings.html">LodePNG_CompressSettings</a></div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8h_source.html#l00311">lodepng.h:311</a></div></div>
<div class="ttc" id="namespace_f_w_html_a93be8f55938d6ffb5ca0af1f95f81589"><div class="ttname"><a href="namespace_f_w.html#a93be8f55938d6ffb5ca0af1f95f81589">FW::free</a></div><div class="ttdeci">void free(void *ptr)</div><div class="ttdef"><b>Definition:</b> <a href="_defs_8cpp_source.html#l00164">Defs.cpp:164</a></div></div>
<div class="ttc" id="lodepng_8cpp_html_a7269f380122edb94715d5e2e87eab835"><div class="ttname"><a href="lodepng_8cpp.html#a7269f380122edb94715d5e2e87eab835">LodePNG_Encoder_cleanup</a></div><div class="ttdeci">void LodePNG_Encoder_cleanup(LodePNG_Encoder *encoder)</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8cpp_source.html#l05211">lodepng.cpp:5211</a></div></div>
<div class="ttc" id="struct_lode_p_n_g___info_color_html_a5536a8859201cd11df789ec7ad8263df"><div class="ttname"><a href="struct_lode_p_n_g___info_color.html#a5536a8859201cd11df789ec7ad8263df">LodePNG_InfoColor::key_r</a></div><div class="ttdeci">unsigned key_r</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8h_source.html#l00366">lodepng.h:366</a></div></div>
<div class="ttc" id="struct_lode_p_n_g___decoder_html"><div class="ttname"><a href="struct_lode_p_n_g___decoder.html">LodePNG_Decoder</a></div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8h_source.html#l00647">lodepng.h:647</a></div></div>
<div class="ttc" id="namespace_f_w_html_a57a9c09878d7bf99b2c6097e173ce6ad"><div class="ttname"><a href="namespace_f_w.html#a57a9c09878d7bf99b2c6097e173ce6ad">FW::getError</a></div><div class="ttdeci">const String &amp; getError(void)</div><div class="ttdef"><b>Definition:</b> <a href="_defs_8cpp_source.html#l00296">Defs.cpp:296</a></div></div>
<div class="ttc" id="struct_lode_p_n_g___decode_settings_html_af46b8d4852b5af72cf712a98cf78f44b"><div class="ttname"><a href="struct_lode_p_n_g___decode_settings.html#af46b8d4852b5af72cf712a98cf78f44b">LodePNG_DecodeSettings::readTextChunks</a></div><div class="ttdeci">unsigned readTextChunks</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8h_source.html#l00631">lodepng.h:631</a></div></div>
<div class="ttc" id="struct_lode_p_n_g___text_html"><div class="ttname"><a href="struct_lode_p_n_g___text.html">LodePNG_Text</a></div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8h_source.html#l00438">lodepng.h:438</a></div></div>
<div class="ttc" id="lodepng_8cpp_html_abaf9330852c93cddc2e633f975e56193"><div class="ttname"><a href="lodepng_8cpp.html#abaf9330852c93cddc2e633f975e56193">LodePNG_chunk_critical</a></div><div class="ttdeci">unsigned char LodePNG_chunk_critical(const unsigned char *chunk)</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8cpp_source.html#l02307">lodepng.cpp:2307</a></div></div>
<div class="ttc" id="_d_l_l_imports_8inl_html_abd7736f9cab649e6a7b4c85084454cdf"><div class="ttname"><a href="_d_l_l_imports_8inl.html#abd7736f9cab649e6a7b4c85084454cdf">bytes</a></div><div class="ttdeci">CUdevice int ordinal char int CUdevice dev CUdevprop CUdevice dev CUcontext ctx CUcontext ctx CUcontext pctx CUmodule const void image CUmodule const void fatCubin CUfunction CUmodule const char name void p CUfunction unsigned int bytes</div><div class="ttdef"><b>Definition:</b> <a href="_d_l_l_imports_8inl_source.html#l00068">DLLImports.inl:68</a></div></div>
<div class="ttc" id="lodepng_8cpp_html_ab2b9a3341171c2cd4a31bdff0211f007"><div class="ttname"><a href="lodepng_8cpp.html#ab2b9a3341171c2cd4a31bdff0211f007">LodePNG_chunk_data_const</a></div><div class="ttdeci">const unsigned char * LodePNG_chunk_data_const(const unsigned char *chunk)</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8cpp_source.html#l02327">lodepng.cpp:2327</a></div></div>
<div class="ttc" id="struct_coin_html_a0427f9a678a9ce031a254f40f06b3669"><div class="ttname"><a href="struct_coin.html#a0427f9a678a9ce031a254f40f06b3669">Coin::weight</a></div><div class="ttdeci">float weight</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8cpp_source.html#l00697">lodepng.cpp:697</a></div></div>
<div class="ttc" id="lodepng_8cpp_html_af89aa48b710fa002d71884069726bf8c"><div class="ttname"><a href="lodepng_8cpp.html#af89aa48b710fa002d71884069726bf8c">LodePNG_chunk_safetocopy</a></div><div class="ttdeci">unsigned char LodePNG_chunk_safetocopy(const unsigned char *chunk)</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8cpp_source.html#l02317">lodepng.cpp:2317</a></div></div>
<div class="ttc" id="structvector_html_a52795ebc16dc899ccb6c1f9f6238921a"><div class="ttname"><a href="structvector.html#a52795ebc16dc899ccb6c1f9f6238921a">vector::allocsize</a></div><div class="ttdeci">size_t allocsize</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8cpp_source.html#l00089">lodepng.cpp:89</a></div></div>
<div class="ttc" id="struct_lode_p_n_g___decode_settings_html_a08d95fa78ebdfcdeb8dcb05ccee6716c"><div class="ttname"><a href="struct_lode_p_n_g___decode_settings.html#a08d95fa78ebdfcdeb8dcb05ccee6716c">LodePNG_DecodeSettings::ignoreCrc</a></div><div class="ttdeci">unsigned ignoreCrc</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8h_source.html#l00627">lodepng.h:627</a></div></div>
<div class="ttc" id="struct_lode_p_n_g___info_color_html_a49842a304ffd0abc8aa791030c5fa5dd"><div class="ttname"><a href="struct_lode_p_n_g___info_color.html#a49842a304ffd0abc8aa791030c5fa5dd">LodePNG_InfoColor::palettesize</a></div><div class="ttdeci">size_t palettesize</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8h_source.html#l00355">lodepng.h:355</a></div></div>
<div class="ttc" id="struct_lode_p_n_g___info_png_html_adbda2bda427f0dd6ae1b85daaab21c6c"><div class="ttname"><a href="struct_lode_p_n_g___info_png.html#adbda2bda427f0dd6ae1b85daaab21c6c">LodePNG_InfoPng::background_g</a></div><div class="ttdeci">unsigned background_g</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8h_source.html#l00554">lodepng.h:554</a></div></div>
<div class="ttc" id="structvector_html_a4200005b6949608d6a533db1a0d299c8"><div class="ttname"><a href="structvector.html#a4200005b6949608d6a533db1a0d299c8">vector::size</a></div><div class="ttdeci">size_t size</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8cpp_source.html#l00088">lodepng.cpp:88</a></div></div>
<div class="ttc" id="struct_lode_p_n_g___time_html_a7990f2e77aee4b5bd87e417e850d5352"><div class="ttname"><a href="struct_lode_p_n_g___time.html#a7990f2e77aee4b5bd87e417e850d5352">LodePNG_Time::minute</a></div><div class="ttdeci">unsigned char minute</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8h_source.html#l00421">lodepng.h:421</a></div></div>
<div class="ttc" id="namespace_f_w_html_a79b17ce962874a748b7d0229f4e05c59"><div class="ttname"><a href="namespace_f_w.html#a79b17ce962874a748b7d0229f4e05c59">FW::abs</a></div><div class="ttdeci">FW_CUDA_FUNC S32 abs(S32 a)</div><div class="ttdef"><b>Definition:</b> <a href="_math_8hpp_source.html#l00041">Math.hpp:41</a></div></div>
<div class="ttc" id="namespace_f_w_html_a1c91e4066f0cc4e93981c3a04a229198"><div class="ttname"><a href="namespace_f_w.html#a1c91e4066f0cc4e93981c3a04a229198">FW::realloc</a></div><div class="ttdeci">void * realloc(void *ptr, size_t size)</div><div class="ttdef"><b>Definition:</b> <a href="_defs_8cpp_source.html#l00191">Defs.cpp:191</a></div></div>
<div class="ttc" id="lodepng_8cpp_html_a5b48becc8f2653ba2bb90858d38fc9ec"><div class="ttname"><a href="lodepng_8cpp.html#a5b48becc8f2653ba2bb90858d38fc9ec">NUM_DISTANCE_SYMBOLS</a></div><div class="ttdeci">#define NUM_DISTANCE_SYMBOLS</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8cpp_source.html#l00501">lodepng.cpp:501</a></div></div>
<div class="ttc" id="lodepng_8cpp_html_ae22b6f611167b5f0f0468989746fe406"><div class="ttname"><a href="lodepng_8cpp.html#ae22b6f611167b5f0f0468989746fe406">LodePNG_defaultDecompressSettings</a></div><div class="ttdeci">const LodePNG_DecompressSettings LodePNG_defaultDecompressSettings</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8cpp_source.html#l02184">lodepng.cpp:2184</a></div></div>
<div class="ttc" id="struct_lode_p_n_g___info_color_html_a4ed18d179c5078137a18e742b1c41a00"><div class="ttname"><a href="struct_lode_p_n_g___info_color.html#a4ed18d179c5078137a18e742b1c41a00">LodePNG_InfoColor::colorType</a></div><div class="ttdeci">unsigned colorType</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8h_source.html#l00336">lodepng.h:336</a></div></div>
<div class="ttc" id="lodepng_8cpp_html_a4e9b1ed7e3242b335ddd8b4a0aba161f"><div class="ttname"><a href="lodepng_8cpp.html#a4e9b1ed7e3242b335ddd8b4a0aba161f">LodePNG_chunk_length</a></div><div class="ttdeci">unsigned LodePNG_chunk_length(const unsigned char *chunk)</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8cpp_source.html#l02289">lodepng.cpp:2289</a></div></div>
<div class="ttc" id="struct_lode_p_n_g___text_html_a341513a6ccbcccaa482eb4a356408dd4"><div class="ttname"><a href="struct_lode_p_n_g___text.html#a341513a6ccbcccaa482eb4a356408dd4">LodePNG_Text::strings</a></div><div class="ttdeci">char ** strings</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8h_source.html#l00444">lodepng.h:444</a></div></div>
<div class="ttc" id="struct_lode_p_n_g___info_png_html_afbab2f688332e8c787717f797de8153e"><div class="ttname"><a href="struct_lode_p_n_g___info_png.html#afbab2f688332e8c787717f797de8153e">LodePNG_InfoPng::background_r</a></div><div class="ttdeci">unsigned background_r</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8h_source.html#l00553">lodepng.h:553</a></div></div>
<div class="ttc" id="lodepng_8cpp_html_adf9597781d7175fdee0b2466e6e462e7"><div class="ttname"><a href="lodepng_8cpp.html#adf9597781d7175fdee0b2466e6e462e7">LAST_LENGTH_CODE_INDEX</a></div><div class="ttdeci">#define LAST_LENGTH_CODE_INDEX</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8cpp_source.html#l00497">lodepng.cpp:497</a></div></div>
<div class="ttc" id="struct_lode_p_n_g___info_png_html_a7b8e98bf898590f785930c7b470254bc"><div class="ttname"><a href="struct_lode_p_n_g___info_png.html#a7b8e98bf898590f785930c7b470254bc">LodePNG_InfoPng::background_b</a></div><div class="ttdeci">unsigned background_b</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8h_source.html#l00555">lodepng.h:555</a></div></div>
<div class="ttc" id="struct_lode_p_n_g___encoder_html_a18e658a08db22dd34fc26c138f3eb2df"><div class="ttname"><a href="struct_lode_p_n_g___encoder.html#a18e658a08db22dd34fc26c138f3eb2df">LodePNG_Encoder::error</a></div><div class="ttdeci">unsigned error</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8h_source.html#l00728">lodepng.h:728</a></div></div>
<div class="ttc" id="struct_lode_p_n_g___text_html_ac85227f4c54ecda3f8beaff52e19b5c9"><div class="ttname"><a href="struct_lode_p_n_g___text.html#ac85227f4c54ecda3f8beaff52e19b5c9">LodePNG_Text::num</a></div><div class="ttdeci">size_t num</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8h_source.html#l00442">lodepng.h:442</a></div></div>
<div class="ttc" id="lodepng_8cpp_html_afddaefb609ec98a432b3dd0437c849ad"><div class="ttname"><a href="lodepng_8cpp.html#afddaefb609ec98a432b3dd0437c849ad">LodePNG_Decoder_inspect</a></div><div class="ttdeci">void LodePNG_Decoder_inspect(LodePNG_Decoder *decoder, const unsigned char *in, size_t inlength)</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8cpp_source.html#l03359">lodepng.cpp:3359</a></div></div>
<div class="ttc" id="lodepng_8cpp_html_a4837cdd713daa3c3a641d4b872f83cfc"><div class="ttname"><a href="lodepng_8cpp.html#a4837cdd713daa3c3a641d4b872f83cfc">LodePNG_Text_clear</a></div><div class="ttdeci">void LodePNG_Text_clear(LodePNG_Text *text)</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8cpp_source.html#l02603">lodepng.cpp:2603</a></div></div>
<div class="ttc" id="lodepng_8cpp_html_a1887de65d8e8d03605c736ace1c9f3aa"><div class="ttname"><a href="lodepng_8cpp.html#a1887de65d8e8d03605c736ace1c9f3aa">LodePNG_CompressSettings_init</a></div><div class="ttdeci">void LodePNG_CompressSettings_init(LodePNG_CompressSettings *settings)</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8cpp_source.html#l02165">lodepng.cpp:2165</a></div></div>
<div class="ttc" id="struct_lode_p_n_g___unknown_chunks_html_ab124de165db15c6cd5db43378c8ae15a"><div class="ttname"><a href="struct_lode_p_n_g___unknown_chunks.html#ab124de165db15c6cd5db43378c8ae15a">LodePNG_UnknownChunks::datasize</a></div><div class="ttdeci">size_t datasize[3]</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8h_source.html#l00510">lodepng.h:510</a></div></div>
<div class="ttc" id="lodepng_8cpp_html_a16e9565fa7d5805df2256db07ed49177"><div class="ttname"><a href="lodepng_8cpp.html#a16e9565fa7d5805df2256db07ed49177">LodePNG_chunk_next_const</a></div><div class="ttdeci">const unsigned char * LodePNG_chunk_next_const(const unsigned char *chunk)</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8cpp_source.html#l02355">lodepng.cpp:2355</a></div></div>
<div class="ttc" id="_d_l_l_imports_8inl_html_ab709438bbd0c872fe3f3894e04efaf2d"><div class="ttname"><a href="_d_l_l_imports_8inl.html#ab709438bbd0c872fe3f3894e04efaf2d">len</a></div><div class="ttdeci">CUdevice int ordinal char int len</div><div class="ttdef"><b>Definition:</b> <a href="_d_l_l_imports_8inl_source.html#l00048">DLLImports.inl:48</a></div></div>
<div class="ttc" id="lodepng_8cpp_html_abb33bc7b86c94e91f2919065e8c3e68e"><div class="ttname"><a href="lodepng_8cpp.html#abb33bc7b86c94e91f2919065e8c3e68e">LodePNG_IText_cleanup</a></div><div class="ttdeci">void LodePNG_IText_cleanup(LodePNG_IText *text)</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8cpp_source.html#l02650">lodepng.cpp:2650</a></div></div>
<div class="ttc" id="lodepng_8cpp_html_a35604ddb7255afb1526979ca40815987"><div class="ttname"><a href="lodepng_8cpp.html#a35604ddb7255afb1526979ca40815987">LodePNG_saveFile</a></div><div class="ttdeci">unsigned LodePNG_saveFile(const unsigned char *buffer, size_t buffersize, const char *filename)</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8cpp_source.html#l00421">lodepng.cpp:421</a></div></div>
<div class="ttc" id="lodepng_8cpp_html_aa45fcc1f7d9966d67adf624481dd6ff4"><div class="ttname"><a href="lodepng_8cpp.html#aa45fcc1f7d9966d67adf624481dd6ff4">LodePNG_decode24</a></div><div class="ttdeci">unsigned LodePNG_decode24(unsigned char **out, unsigned *w, unsigned *h, const unsigned char *in, size_t insize)</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8cpp_source.html#l04136">lodepng.cpp:4136</a></div></div>
<div class="ttc" id="lodepng_8cpp_html_a3d29161f6cf08ed35dd9751e6d25cd12"><div class="ttname"><a href="lodepng_8cpp.html#a3d29161f6cf08ed35dd9751e6d25cd12">LodePNG_Decoder_decode</a></div><div class="ttdeci">void LodePNG_Decoder_decode(LodePNG_Decoder *decoder, unsigned char **out, size_t *outsize, const unsigned char *in, size_t insize)</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8cpp_source.html#l04068">lodepng.cpp:4068</a></div></div>
<div class="ttc" id="lodepng_8h_html"><div class="ttname"><a href="lodepng_8h.html">lodepng.h</a></div></div>
<div class="ttc" id="struct_lode_p_n_g___info_png_html_a9c0f6237cfefc693ed17dbc3a843fe0f"><div class="ttname"><a href="struct_lode_p_n_g___info_png.html#a9c0f6237cfefc693ed17dbc3a843fe0f">LodePNG_InfoPng::phys_x</a></div><div class="ttdeci">unsigned phys_x</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8h_source.html#l00569">lodepng.h:569</a></div></div>
<div class="ttc" id="lodepng_8cpp_html_a894c6c210779b2187070ac0551e3ade6"><div class="ttname"><a href="lodepng_8cpp.html#a894c6c210779b2187070ac0551e3ade6">LodePNG_IText_copy</a></div><div class="ttdeci">unsigned LodePNG_IText_copy(LodePNG_IText *dest, const LodePNG_IText *source)</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8cpp_source.html#l02655">lodepng.cpp:2655</a></div></div>
<div class="ttc" id="namespace_f_w_html_a08e4933631da71a1c74b09b0a4da7d24"><div class="ttname"><a href="namespace_f_w.html#a08e4933631da71a1c74b09b0a4da7d24">FW::hasError</a></div><div class="ttdeci">bool hasError(void)</div><div class="ttdef"><b>Definition:</b> <a href="_defs_8cpp_source.html#l00289">Defs.cpp:289</a></div></div>
<div class="ttc" id="lodepng_8cpp_html_a279c66151f5c87b2225ebe866ce98f71"><div class="ttname"><a href="lodepng_8cpp.html#a279c66151f5c87b2225ebe866ce98f71">LodePNG_InfoRaw_init</a></div><div class="ttdeci">void LodePNG_InfoRaw_init(LodePNG_InfoRaw *info)</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8cpp_source.html#l02798">lodepng.cpp:2798</a></div></div>
<div class="ttc" id="_d_l_l_imports_8inl_html_abf1b96ba8e05b846fde16efb5851232e"><div class="ttname"><a href="_d_l_l_imports_8inl.html#abf1b96ba8e05b846fde16efb5851232e">index</a></div><div class="ttdeci">CUdevice int ordinal char int CUdevice dev CUdevprop CUdevice dev CUcontext ctx CUcontext ctx CUcontext pctx CUmodule const void image CUmodule const void fatCubin CUfunction CUmodule const char name void p CUfunction unsigned int bytes CUtexref pTexRef CUtexref CUarray unsigned int Flags CUtexref int CUaddress_mode am CUtexref unsigned int Flags CUaddress_mode CUtexref int dim CUarray_format int CUtexref hTexRef CUfunction unsigned int numbytes CUfunction int float value CUfunction int CUtexref hTexRef CUfunction int int grid_height CUevent unsigned int Flags CUevent hEvent CUevent hEvent CUstream unsigned int Flags CUstream hStream GLuint bufferobj unsigned int CUdevice dev CUdeviceptr unsigned int CUmodule const char name CUdeviceptr unsigned int bytesize CUdeviceptr dptr void unsigned int bytesize void CUdeviceptr unsigned int ByteCount CUarray unsigned int CUdeviceptr unsigned int ByteCount CUarray unsigned int const void unsigned int ByteCount CUarray unsigned int CUarray unsigned int unsigned int ByteCount void CUarray unsigned int unsigned int CUstream hStream const CUDA_MEMCPY2D pCopy CUdeviceptr const void unsigned int CUstream hStream const CUDA_MEMCPY2D CUstream hStream CUdeviceptr unsigned char unsigned int N CUdeviceptr unsigned int unsigned int N CUdeviceptr unsigned int unsigned short unsigned int unsigned int Height CUarray const CUDA_ARRAY_DESCRIPTOR pAllocateArray CUarray const CUDA_ARRAY3D_DESCRIPTOR pAllocateArray unsigned int CUtexref CUdeviceptr unsigned int bytes CUcontext unsigned int CUdevice device GLenum texture GLenum GLuint buffer GLenum GLuint renderbuffer GLenum GLsizeiptr const GLvoid GLenum usage GLuint shader GLenum type GLsizei const GLuint framebuffers GLsizei const GLuint renderbuffers GLuint v GLuint v GLenum GLenum GLenum GLuint GLint level GLsizei GLuint framebuffers GLuint const GLchar name GLenum GLintptr GLsizeiptr GLvoid data GLuint GLenum GLint param GLuint GLenum GLint param GLhandleARB programObj GLenum GLenum GLsizei GLsizei height GLenum GLint GLint GLsizei GLsizei GLsizei GLint GLenum GLenum const GLvoid pixels GLint GLsizei const GLfloat value GLint GLfloat GLfloat v1 GLint GLfloat GLfloat GLfloat v2 GLint GLsizei const GLfloat value GLint GLsizei GLboolean const GLfloat value GLuint program GLuint index</div><div class="ttdef"><b>Definition:</b> <a href="_d_l_l_imports_8inl_source.html#l00363">DLLImports.inl:363</a></div></div>
<div class="ttc" id="structvector_html_aab0b37e2650659a664f4c993e6309d42"><div class="ttname"><a href="structvector.html#aab0b37e2650659a664f4c993e6309d42">vector::typesize</a></div><div class="ttdeci">unsigned typesize</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8cpp_source.html#l00090">lodepng.cpp:90</a></div></div>
<div class="ttc" id="struct_huffman_tree_html_a24afa4a1079f6ee1c9829b9b5aa5fe89"><div class="ttname"><a href="struct_huffman_tree.html#a24afa4a1079f6ee1c9829b9b5aa5fe89">HuffmanTree::tree2d</a></div><div class="ttdeci">uivector tree2d</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8cpp_source.html#l00537">lodepng.cpp:537</a></div></div>
<div class="ttc" id="lodepng_8cpp_html_a7884592df167f7136fc928cacf1efd36"><div class="ttname"><a href="lodepng_8cpp.html#a7884592df167f7136fc928cacf1efd36">LodePNG_InfoPng_cleanup</a></div><div class="ttdeci">void LodePNG_InfoPng_cleanup(LodePNG_InfoPng *info)</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8cpp_source.html#l02748">lodepng.cpp:2748</a></div></div>
<div class="ttc" id="_d_l_l_imports_8inl_html_a3f2d6cd655118d09cc005e6760706570"><div class="ttname"><a href="_d_l_l_imports_8inl.html#a3f2d6cd655118d09cc005e6760706570">value</a></div><div class="ttdeci">CUdevice int ordinal char int CUdevice dev CUdevprop CUdevice dev CUcontext ctx CUcontext ctx CUcontext pctx CUmodule const void image CUmodule const void fatCubin CUfunction CUmodule const char name void p CUfunction unsigned int bytes CUtexref pTexRef CUtexref CUarray unsigned int Flags CUtexref int CUaddress_mode am CUtexref unsigned int Flags CUaddress_mode CUtexref int dim CUarray_format int CUtexref hTexRef CUfunction unsigned int numbytes CUfunction int float value</div><div class="ttdef"><b>Definition:</b> <a href="_d_l_l_imports_8inl_source.html#l00084">DLLImports.inl:84</a></div></div>
<div class="ttc" id="_d_l_l_imports_8inl_html_a7bfd2fdf58fb75abde6e36d72617c71b"><div class="ttname"><a href="_d_l_l_imports_8inl.html#a7bfd2fdf58fb75abde6e36d72617c71b">n</a></div><div class="ttdeci">CUdevice int ordinal char int CUdevice dev CUdevprop CUdevice dev CUcontext ctx CUcontext ctx CUcontext pctx CUmodule const void image CUmodule const void fatCubin CUfunction CUmodule const char name void p CUfunction unsigned int bytes CUtexref pTexRef CUtexref CUarray unsigned int Flags CUtexref int CUaddress_mode am CUtexref unsigned int Flags CUaddress_mode CUtexref int dim CUarray_format int CUtexref hTexRef CUfunction unsigned int numbytes CUfunction int float value CUfunction int CUtexref hTexRef CUfunction int int grid_height CUevent unsigned int Flags CUevent hEvent CUevent hEvent CUstream unsigned int Flags CUstream hStream GLuint bufferobj unsigned int CUdevice dev CUdeviceptr unsigned int CUmodule const char name CUdeviceptr unsigned int bytesize CUdeviceptr dptr void unsigned int bytesize void CUdeviceptr unsigned int ByteCount CUarray unsigned int CUdeviceptr unsigned int ByteCount CUarray unsigned int const void unsigned int ByteCount CUarray unsigned int CUarray unsigned int unsigned int ByteCount void CUarray unsigned int unsigned int CUstream hStream const CUDA_MEMCPY2D pCopy CUdeviceptr const void unsigned int CUstream hStream const CUDA_MEMCPY2D CUstream hStream CUdeviceptr unsigned char unsigned int N CUdeviceptr unsigned int unsigned int N CUdeviceptr unsigned int unsigned short unsigned int unsigned int Height CUarray const CUDA_ARRAY_DESCRIPTOR pAllocateArray CUarray const CUDA_ARRAY3D_DESCRIPTOR pAllocateArray unsigned int CUtexref CUdeviceptr unsigned int bytes CUcontext unsigned int CUdevice device GLenum texture GLenum GLuint buffer GLenum GLuint renderbuffer GLenum GLsizeiptr const GLvoid GLenum usage GLuint shader GLenum type GLsizei n</div><div class="ttdef"><b>Definition:</b> <a href="_d_l_l_imports_8inl_source.html#l00325">DLLImports.inl:325</a></div></div>
<div class="ttc" id="struct_lode_p_n_g___time_html_ae00d9df8a901579a2b563b683cc85169"><div class="ttname"><a href="struct_lode_p_n_g___time.html#ae00d9df8a901579a2b563b683cc85169">LodePNG_Time::year</a></div><div class="ttdeci">unsigned year</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8h_source.html#l00417">lodepng.h:417</a></div></div>
<div class="ttc" id="lodepng_8cpp_html_a347e6964b32f99efb902fbf7b1a9d934"><div class="ttname"><a href="lodepng_8cpp.html#a347e6964b32f99efb902fbf7b1a9d934">LodePNG_read32bitInt</a></div><div class="ttdeci">unsigned LodePNG_read32bitInt(const unsigned char *buffer)</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8cpp_source.html#l00365">lodepng.cpp:365</a></div></div>
<div class="ttc" id="lodepng_8cpp_html_a22ed04d49e008cb4295a8b366c4f2f3b"><div class="ttname"><a href="lodepng_8cpp.html#a22ed04d49e008cb4295a8b366c4f2f3b">NUM_CODE_LENGTH_CODES</a></div><div class="ttdeci">#define NUM_CODE_LENGTH_CODES</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8cpp_source.html#l00503">lodepng.cpp:503</a></div></div>
<div class="ttc" id="lodepng_8cpp_html_a9e7ce5d1928b44ba6a7c30465b996c68"><div class="ttname"><a href="lodepng_8cpp.html#a9e7ce5d1928b44ba6a7c30465b996c68">LodePNG_convert</a></div><div class="ttdeci">unsigned LodePNG_convert(unsigned char *out, const unsigned char *in, LodePNG_InfoColor *infoOut, LodePNG_InfoColor *infoIn, unsigned w, unsigned h)</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8cpp_source.html#l03257">lodepng.cpp:3257</a></div></div>
<div class="ttc" id="struct_lode_p_n_g___decode_settings_html_aeab30cd87a6bb9334a77e4f32422a4b8"><div class="ttname"><a href="struct_lode_p_n_g___decode_settings.html#aeab30cd87a6bb9334a77e4f32422a4b8">LodePNG_DecodeSettings::rememberUnknownChunks</a></div><div class="ttdeci">unsigned rememberUnknownChunks</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8h_source.html#l00636">lodepng.h:636</a></div></div>
<div class="ttc" id="structucvector_html_a27c99c34de0c5b3ca0c242d402c69499"><div class="ttname"><a href="structucvector.html#a27c99c34de0c5b3ca0c242d402c69499">ucvector::size</a></div><div class="ttdeci">size_t size</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8cpp_source.html#l00249">lodepng.cpp:249</a></div></div>
<div class="ttc" id="struct_lode_p_n_g___info_color_html_a44bf4906335328972acebd6c8b83a073"><div class="ttname"><a href="struct_lode_p_n_g___info_color.html#a44bf4906335328972acebd6c8b83a073">LodePNG_InfoColor::key_g</a></div><div class="ttdeci">unsigned key_g</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8h_source.html#l00367">lodepng.h:367</a></div></div>
<div class="ttc" id="struct_lode_p_n_g___decode_settings_html"><div class="ttname"><a href="struct_lode_p_n_g___decode_settings.html">LodePNG_DecodeSettings</a></div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8h_source.html#l00623">lodepng.h:623</a></div></div>
<div class="ttc" id="lodepng_8cpp_html_a163707b72a32eb5d48d39c1b4e6837fb"><div class="ttname"><a href="lodepng_8cpp.html#a163707b72a32eb5d48d39c1b4e6837fb">LodePNG_encode24</a></div><div class="ttdeci">unsigned LodePNG_encode24(unsigned char **out, size_t *outsize, const unsigned char *image, unsigned w, unsigned h)</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8cpp_source.html#l05163">lodepng.cpp:5163</a></div></div>
<div class="ttc" id="struct_lode_p_n_g___info_png_html_a37f6cddbe33b775fab09a91076b72f4c"><div class="ttname"><a href="struct_lode_p_n_g___info_png.html#a37f6cddbe33b775fab09a91076b72f4c">LodePNG_InfoPng::background_defined</a></div><div class="ttdeci">unsigned background_defined</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8h_source.html#l00552">lodepng.h:552</a></div></div>
<div class="ttc" id="lodepng_8cpp_html_a1e3ab3e373966fd2c323bd5a698ccfb1"><div class="ttname"><a href="lodepng_8cpp.html#a1e3ab3e373966fd2c323bd5a698ccfb1">LodePNG_chunk_type_equals</a></div><div class="ttdeci">unsigned char LodePNG_chunk_type_equals(const unsigned char *chunk, const char *type)</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8cpp_source.html#l02301">lodepng.cpp:2301</a></div></div>
<div class="ttc" id="lodepng_8cpp_html_ac88579bb0993b9f3df5d634a10afb74f"><div class="ttname"><a href="lodepng_8cpp.html#ac88579bb0993b9f3df5d634a10afb74f">LodePNG_decode24_file</a></div><div class="ttdeci">unsigned LodePNG_decode24_file(unsigned char **out, unsigned *w, unsigned *h, const char *filename)</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8cpp_source.html#l04159">lodepng.cpp:4159</a></div></div>
<div class="ttc" id="lodepng_8h_html_a156a7a7f60acffc88f67cfc533beff2b"><div class="ttname"><a href="lodepng_8h.html#a156a7a7f60acffc88f67cfc533beff2b">LODEPNG_COMPILE_UNKNOWN_CHUNKS</a></div><div class="ttdeci">#define LODEPNG_COMPILE_UNKNOWN_CHUNKS</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8h_source.html#l00061">lodepng.h:61</a></div></div>
<div class="ttc" id="lodepng_8cpp_html_ad7beb96e92dd01a605c669af79a54a00"><div class="ttname"><a href="lodepng_8cpp.html#ad7beb96e92dd01a605c669af79a54a00">LodePNG_InfoColor_copy</a></div><div class="ttdeci">unsigned LodePNG_InfoColor_copy(LodePNG_InfoColor *dest, const LodePNG_InfoColor *source)</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8cpp_source.html#l02787">lodepng.cpp:2787</a></div></div>
<div class="ttc" id="structucvector_html"><div class="ttname"><a href="structucvector.html">ucvector</a></div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8cpp_source.html#l00246">lodepng.cpp:246</a></div></div>
<div class="ttc" id="struct_lode_p_n_g___decode_settings_html_a30c0660818a6551d0ffdc1600ad42167"><div class="ttname"><a href="struct_lode_p_n_g___decode_settings.html#a30c0660818a6551d0ffdc1600ad42167">LodePNG_DecodeSettings::color_convert</a></div><div class="ttdeci">unsigned color_convert</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8h_source.html#l00628">lodepng.h:628</a></div></div>
<div class="ttc" id="struct_lode_p_n_g___encoder_html_ae36ceb21b9d1007491f4edbb2be12bab"><div class="ttname"><a href="struct_lode_p_n_g___encoder.html#ae36ceb21b9d1007491f4edbb2be12bab">LodePNG_Encoder::settings</a></div><div class="ttdeci">LodePNG_EncodeSettings settings</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8h_source.html#l00721">lodepng.h:721</a></div></div>
<div class="ttc" id="struct_lode_p_n_g___info_png_html_acce58518f72f42ba94db4c1cfd69336b"><div class="ttname"><a href="struct_lode_p_n_g___info_png.html#acce58518f72f42ba94db4c1cfd69336b">LodePNG_InfoPng::color</a></div><div class="ttdeci">LodePNG_InfoColor color</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8h_source.html#l00538">lodepng.h:538</a></div></div>
<div class="ttc" id="struct_lode_p_n_g___encode_settings_html_a44de1047cd9f3bfd55bf8c5313620065"><div class="ttname"><a href="struct_lode_p_n_g___encode_settings.html#a44de1047cd9f3bfd55bf8c5313620065">LodePNG_EncodeSettings::force_palette</a></div><div class="ttdeci">unsigned force_palette</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8h_source.html#l00702">lodepng.h:702</a></div></div>
<div class="ttc" id="struct_lode_p_n_g___decompress_settings_html_a6dfc36e99305ee75bab8f416d80fb9a5"><div class="ttname"><a href="struct_lode_p_n_g___decompress_settings.html#a6dfc36e99305ee75bab8f416d80fb9a5">LodePNG_DecompressSettings::ignoreAdler32</a></div><div class="ttdeci">unsigned ignoreAdler32</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8h_source.html#l00299">lodepng.h:299</a></div></div>
<div class="ttc" id="lodepng_8cpp_html_ac0564ed5cbac6fcfda3b28b3078cde65"><div class="ttname"><a href="lodepng_8cpp.html#ac0564ed5cbac6fcfda3b28b3078cde65">LodePNG_InfoColor_isGreyscaleType</a></div><div class="ttdeci">unsigned LodePNG_InfoColor_isGreyscaleType(const LodePNG_InfoColor *info)</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8cpp_source.html#l02505">lodepng.cpp:2505</a></div></div>
<div class="ttc" id="lodepng_8cpp_html_a8047414db7062af3671e20c90a4a4ae7"><div class="ttname"><a href="lodepng_8cpp.html#a8047414db7062af3671e20c90a4a4ae7">LodePNG_append_chunk</a></div><div class="ttdeci">unsigned LodePNG_append_chunk(unsigned char **out, size_t *outlength, const unsigned char *chunk)</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8cpp_source.html#l02361">lodepng.cpp:2361</a></div></div>
<div class="ttc" id="lodepng_8cpp_html_a988f89f0cd9d740e7310ecdfa79db5d5"><div class="ttname"><a href="lodepng_8cpp.html#a988f89f0cd9d740e7310ecdfa79db5d5">LodePNG_decode_file</a></div><div class="ttdeci">unsigned LodePNG_decode_file(unsigned char **out, unsigned *w, unsigned *h, const char *filename, unsigned colorType, unsigned bitDepth)</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8cpp_source.html#l04142">lodepng.cpp:4142</a></div></div>
<div class="ttc" id="lodepng_8cpp_html_acfb12caea990f92b3aed7c199f615213"><div class="ttname"><a href="lodepng_8cpp.html#acfb12caea990f92b3aed7c199f615213">FIRST_LENGTH_CODE_INDEX</a></div><div class="ttdeci">#define FIRST_LENGTH_CODE_INDEX</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8cpp_source.html#l00496">lodepng.cpp:496</a></div></div>
<div class="ttc" id="lodepng_8cpp_html_a5f9dec8a5637a646a41821af36faa152"><div class="ttname"><a href="lodepng_8cpp.html#a5f9dec8a5637a646a41821af36faa152">LodePNG_chunk_data</a></div><div class="ttdeci">unsigned char * LodePNG_chunk_data(unsigned char *chunk)</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8cpp_source.html#l02322">lodepng.cpp:2322</a></div></div>
<div class="ttc" id="struct_lode_p_n_g___info_color_html_ac6de7ff58cb1f39a73567abb826f72f5"><div class="ttname"><a href="struct_lode_p_n_g___info_color.html#ac6de7ff58cb1f39a73567abb826f72f5">LodePNG_InfoColor::palette</a></div><div class="ttdeci">unsigned char * palette</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8h_source.html#l00354">lodepng.h:354</a></div></div>
<div class="ttc" id="struct_huffman_tree_html"><div class="ttname"><a href="struct_huffman_tree.html">HuffmanTree</a></div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8cpp_source.html#l00535">lodepng.cpp:535</a></div></div>
<div class="ttc" id="structuivector_html"><div class="ttname"><a href="structuivector.html">uivector</a></div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8cpp_source.html#l00166">lodepng.cpp:166</a></div></div>
<div class="ttc" id="lodepng_8cpp_html_af11d6ba19787c8d48aa3ed88cf3e6462"><div class="ttname"><a href="lodepng_8cpp.html#af11d6ba19787c8d48aa3ed88cf3e6462">LodePNG_zlib_decompress</a></div><div class="ttdeci">unsigned LodePNG_zlib_decompress(unsigned char **out, size_t *outsize, const unsigned char *in, size_t insize, const LodePNG_DecompressSettings *settings)</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8cpp_source.html#l02032">lodepng.cpp:2032</a></div></div>
<div class="ttc" id="struct_lode_p_n_g___info_png_html_a177065a8eeb66398a89ed93e7c2b2f50"><div class="ttname"><a href="struct_lode_p_n_g___info_png.html#a177065a8eeb66398a89ed93e7c2b2f50">LodePNG_InfoPng::compressionMethod</a></div><div class="ttdeci">unsigned compressionMethod</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8h_source.html#l00535">lodepng.h:535</a></div></div>
<div class="ttc" id="struct_lode_p_n_g___encoder_html_a5c4bc6d9be898fbcc14b5d762d69457e"><div class="ttname"><a href="struct_lode_p_n_g___encoder.html#a5c4bc6d9be898fbcc14b5d762d69457e">LodePNG_Encoder::infoPng</a></div><div class="ttdeci">LodePNG_InfoPng infoPng</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8h_source.html#l00724">lodepng.h:724</a></div></div>
<div class="ttc" id="struct_lode_p_n_g___info_png_html_a74be99b177b28f3178c02139c4b7f149"><div class="ttname"><a href="struct_lode_p_n_g___info_png.html#a74be99b177b28f3178c02139c4b7f149">LodePNG_InfoPng::width</a></div><div class="ttdeci">unsigned width</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8h_source.html#l00533">lodepng.h:533</a></div></div>
<div class="ttc" id="_d_l_l_imports_8inl_html_a5a11afa44e3df9fa01e461dc15484392"><div class="ttname"><a href="_d_l_l_imports_8inl.html#a5a11afa44e3df9fa01e461dc15484392">p</a></div><div class="ttdeci">CUdevice int ordinal char int CUdevice dev CUdevprop CUdevice dev CUcontext ctx CUcontext ctx CUcontext pctx CUmodule const void image CUmodule const void fatCubin CUfunction CUmodule const char name void * p</div><div class="ttdef"><b>Definition:</b> <a href="_d_l_l_imports_8inl_source.html#l00066">DLLImports.inl:66</a></div></div>
<div class="ttc" id="lodepng_8cpp_html_a6572f09bfc611dc6267a4af4e0770f28"><div class="ttname"><a href="lodepng_8cpp.html#a6572f09bfc611dc6267a4af4e0770f28">LodePNG_InfoColor_canHaveAlpha</a></div><div class="ttdeci">unsigned LodePNG_InfoColor_canHaveAlpha(const LodePNG_InfoColor *info)</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8cpp_source.html#l02530">lodepng.cpp:2530</a></div></div>
<div class="ttc" id="lodepng_8cpp_html_af9bcef894a1ff5d76f2fabd23365d289"><div class="ttname"><a href="lodepng_8cpp.html#af9bcef894a1ff5d76f2fabd23365d289">LodePNG_Decoder_copy</a></div><div class="ttdeci">void LodePNG_Decoder_copy(LodePNG_Decoder *dest, const LodePNG_Decoder *source)</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8cpp_source.html#l04192">lodepng.cpp:4192</a></div></div>
<div class="ttc" id="lodepng_8cpp_html_a75be5c73ab8b78aa8e583976007a363f"><div class="ttname"><a href="lodepng_8cpp.html#a75be5c73ab8b78aa8e583976007a363f">LodePNG_encode32</a></div><div class="ttdeci">unsigned LodePNG_encode32(unsigned char **out, size_t *outsize, const unsigned char *image, unsigned w, unsigned h)</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8cpp_source.html#l05158">lodepng.cpp:5158</a></div></div>
<div class="ttc" id="lodepng_8cpp_html_a35e023707c907e36ad1435754cfbb4da"><div class="ttname"><a href="lodepng_8cpp.html#a35e023707c907e36ad1435754cfbb4da">LodePNG_chunk_generate_crc</a></div><div class="ttdeci">void LodePNG_chunk_generate_crc(unsigned char *chunk)</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8cpp_source.html#l02342">lodepng.cpp:2342</a></div></div>
<div class="ttc" id="_d_l_l_imports_8inl_html_a1d14bae93fe47a03f0ace206fef6a34e"><div class="ttname"><a href="_d_l_l_imports_8inl.html#a1d14bae93fe47a03f0ace206fef6a34e">type</a></div><div class="ttdeci">CUdevice int ordinal char int CUdevice dev CUdevprop CUdevice dev CUcontext ctx CUcontext ctx CUcontext pctx CUmodule const void image CUmodule const void fatCubin CUfunction CUmodule const char name void p CUfunction unsigned int bytes CUtexref pTexRef CUtexref CUarray unsigned int Flags CUtexref int CUaddress_mode am CUtexref unsigned int Flags CUaddress_mode CUtexref int dim CUarray_format int CUtexref hTexRef CUfunction unsigned int numbytes CUfunction int float value CUfunction int CUtexref hTexRef CUfunction int int grid_height CUevent unsigned int Flags CUevent hEvent CUevent hEvent CUstream unsigned int Flags CUstream hStream GLuint bufferobj unsigned int CUdevice dev CUdeviceptr unsigned int CUmodule const char name CUdeviceptr unsigned int bytesize CUdeviceptr dptr void unsigned int bytesize void CUdeviceptr unsigned int ByteCount CUarray unsigned int CUdeviceptr unsigned int ByteCount CUarray unsigned int const void unsigned int ByteCount CUarray unsigned int CUarray unsigned int unsigned int ByteCount void CUarray unsigned int unsigned int CUstream hStream const CUDA_MEMCPY2D pCopy CUdeviceptr const void unsigned int CUstream hStream const CUDA_MEMCPY2D CUstream hStream CUdeviceptr unsigned char unsigned int N CUdeviceptr unsigned int unsigned int N CUdeviceptr unsigned int unsigned short unsigned int unsigned int Height CUarray const CUDA_ARRAY_DESCRIPTOR pAllocateArray CUarray const CUDA_ARRAY3D_DESCRIPTOR pAllocateArray unsigned int CUtexref CUdeviceptr unsigned int bytes CUcontext unsigned int CUdevice device GLenum texture GLenum GLuint buffer GLenum GLuint renderbuffer GLenum GLsizeiptr const GLvoid GLenum usage GLuint shader GLenum type</div><div class="ttdef"><b>Definition:</b> <a href="_d_l_l_imports_8inl_source.html#l00323">DLLImports.inl:323</a></div></div>
<div class="ttc" id="lodepng_8cpp_html_af63c0478e6478580bcc2726dfe205598"><div class="ttname"><a href="lodepng_8cpp.html#af63c0478e6478580bcc2726dfe205598">LodePNG_IText_clear</a></div><div class="ttdeci">void LodePNG_IText_clear(LodePNG_IText *text)</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8cpp_source.html#l02672">lodepng.cpp:2672</a></div></div>
<div class="ttc" id="lodepng_8cpp_html_ac1a87f6ae0de91fe9c7716ff5dc3fbea"><div class="ttname"><a href="lodepng_8cpp.html#ac1a87f6ae0de91fe9c7716ff5dc3fbea">LodePNG_InfoColor_equal</a></div><div class="ttdeci">unsigned LodePNG_InfoColor_equal(const LodePNG_InfoColor *info1, const LodePNG_InfoColor *info2)</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8cpp_source.html#l02537">lodepng.cpp:2537</a></div></div>
<div class="ttc" id="lodepng_8cpp_html_a637a6754fae89a90ea3ba46b1fa99df3"><div class="ttname"><a href="lodepng_8cpp.html#a637a6754fae89a90ea3ba46b1fa99df3">LodePNG_IText_add</a></div><div class="ttdeci">unsigned LodePNG_IText_add(LodePNG_IText *text, const char *key, const char *langtag, const char *transkey, const char *str)</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8cpp_source.html#l02688">lodepng.cpp:2688</a></div></div>
<div class="ttc" id="struct_lode_p_n_g___info_color_html_a9f99cc5b4366f1eed325d13b4f191560"><div class="ttname"><a href="struct_lode_p_n_g___info_color.html#a9f99cc5b4366f1eed325d13b4f191560">LodePNG_InfoColor::key_b</a></div><div class="ttdeci">unsigned key_b</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8h_source.html#l00368">lodepng.h:368</a></div></div>
<div class="ttc" id="lodepng_8cpp_html_af139bc36c2a9b88d21dc3652520a3f73"><div class="ttname"><a href="lodepng_8cpp.html#af139bc36c2a9b88d21dc3652520a3f73">LodePNG_InfoColor_isAlphaType</a></div><div class="ttdeci">unsigned LodePNG_InfoColor_isAlphaType(const LodePNG_InfoColor *info)</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8cpp_source.html#l02510">lodepng.cpp:2510</a></div></div>
<div class="ttc" id="struct_lode_p_n_g___info_png_html_aea8ade694048f5912c235478b4ec1a35"><div class="ttname"><a href="struct_lode_p_n_g___info_png.html#aea8ade694048f5912c235478b4ec1a35">LodePNG_InfoPng::phys_y</a></div><div class="ttdeci">unsigned phys_y</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8h_source.html#l00570">lodepng.h:570</a></div></div>
<div class="ttc" id="struct_lode_p_n_g___time_html_a68daf5323e84b536893b9b21e50022c1"><div class="ttname"><a href="struct_lode_p_n_g___time.html#a68daf5323e84b536893b9b21e50022c1">LodePNG_Time::second</a></div><div class="ttdeci">unsigned char second</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8h_source.html#l00422">lodepng.h:422</a></div></div>
<div class="ttc" id="lodepng_8cpp_html_a125bf00fe358f550d268f19b48527ef3"><div class="ttname"><a href="lodepng_8cpp.html#a125bf00fe358f550d268f19b48527ef3">LodePNG_Encoder_encode</a></div><div class="ttdeci">void LodePNG_Encoder_encode(LodePNG_Encoder *encoder, unsigned char **out, size_t *outsize, const unsigned char *image, unsigned w, unsigned h)</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8cpp_source.html#l04938">lodepng.cpp:4938</a></div></div>
<div class="ttc" id="struct_lode_p_n_g___info_png_html_aab80ead40f4068cd89e71056143b1cd5"><div class="ttname"><a href="struct_lode_p_n_g___info_png.html#aab80ead40f4068cd89e71056143b1cd5">LodePNG_InfoPng::phys_unit</a></div><div class="ttdeci">unsigned char phys_unit</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8h_source.html#l00571">lodepng.h:571</a></div></div>
<div class="ttc" id="_d_l_l_imports_8inl_html_af213c44c249febd5dd9ecd01be302487"><div class="ttname"><a href="_d_l_l_imports_8inl.html#af213c44c249febd5dd9ecd01be302487">image</a></div><div class="ttdeci">CUdevice int ordinal char int CUdevice dev CUdevprop CUdevice dev CUcontext ctx CUcontext ctx CUcontext pctx CUmodule const void * image</div><div class="ttdef"><b>Definition:</b> <a href="_d_l_l_imports_8inl_source.html#l00060">DLLImports.inl:60</a></div></div>
<div class="ttc" id="_d_l_l_imports_8inl_html_abcaf2e752dfff61ecb0b2d0a593966ee"><div class="ttname"><a href="_d_l_l_imports_8inl.html#abcaf2e752dfff61ecb0b2d0a593966ee">size</a></div><div class="ttdeci">CUdevice int ordinal char int CUdevice dev CUdevprop CUdevice dev CUcontext ctx CUcontext ctx CUcontext pctx CUmodule const void image CUmodule const void fatCubin CUfunction CUmodule const char name void p CUfunction unsigned int bytes CUtexref pTexRef CUtexref CUarray unsigned int Flags CUtexref int CUaddress_mode am CUtexref unsigned int Flags CUaddress_mode CUtexref int dim CUarray_format int CUtexref hTexRef CUfunction unsigned int numbytes CUfunction int float value CUfunction int CUtexref hTexRef CUfunction int int grid_height CUevent unsigned int Flags CUevent hEvent CUevent hEvent CUstream unsigned int Flags CUstream hStream GLuint bufferobj unsigned int CUdevice dev CUdeviceptr unsigned int CUmodule const char name CUdeviceptr unsigned int bytesize CUdeviceptr dptr void unsigned int bytesize void CUdeviceptr unsigned int ByteCount CUarray unsigned int CUdeviceptr unsigned int ByteCount CUarray unsigned int const void unsigned int ByteCount CUarray unsigned int CUarray unsigned int unsigned int ByteCount void CUarray unsigned int unsigned int CUstream hStream const CUDA_MEMCPY2D pCopy CUdeviceptr const void unsigned int CUstream hStream const CUDA_MEMCPY2D CUstream hStream CUdeviceptr unsigned char unsigned int N CUdeviceptr unsigned int unsigned int N CUdeviceptr unsigned int unsigned short unsigned int unsigned int Height CUarray const CUDA_ARRAY_DESCRIPTOR pAllocateArray CUarray const CUDA_ARRAY3D_DESCRIPTOR pAllocateArray unsigned int CUtexref CUdeviceptr unsigned int bytes CUcontext unsigned int CUdevice device GLenum texture GLenum GLuint buffer GLenum GLuint renderbuffer GLenum GLsizeiptr size</div><div class="ttdef"><b>Definition:</b> <a href="_d_l_l_imports_8inl_source.html#l00319">DLLImports.inl:319</a></div></div>
<div class="ttc" id="lodepng_8cpp_html_a745b94bf14f6c3497b6280863e71e5a6"><div class="ttname"><a href="lodepng_8cpp.html#a745b94bf14f6c3497b6280863e71e5a6">LodePNG_InfoRaw_copy</a></div><div class="ttdeci">unsigned LodePNG_InfoRaw_copy(LodePNG_InfoRaw *dest, const LodePNG_InfoRaw *source)</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8cpp_source.html#l02808">lodepng.cpp:2808</a></div></div>
<div class="ttc" id="lodepng_8cpp_html_ae8ee35b701bba217323f27723d2690f5"><div class="ttname"><a href="lodepng_8cpp.html#ae8ee35b701bba217323f27723d2690f5">LodePNG_InfoRaw_cleanup</a></div><div class="ttdeci">void LodePNG_InfoRaw_cleanup(LodePNG_InfoRaw *info)</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8cpp_source.html#l02803">lodepng.cpp:2803</a></div></div>
<div class="ttc" id="lodepng_8cpp_html_a1433657518ac8048e15943b47abe953e"><div class="ttname"><a href="lodepng_8cpp.html#a1433657518ac8048e15943b47abe953e">LodePNG_encode32_file</a></div><div class="ttdeci">unsigned LodePNG_encode32_file(const char *filename, const unsigned char *image, unsigned w, unsigned h)</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8cpp_source.html#l05180">lodepng.cpp:5180</a></div></div>
<div class="ttc" id="lodepng_8cpp_html_a66ddccc82c59e05d746086f56997b4cd"><div class="ttname"><a href="lodepng_8cpp.html#a66ddccc82c59e05d746086f56997b4cd">LodePNG_InfoPng_init</a></div><div class="ttdeci">void LodePNG_InfoPng_init(LodePNG_InfoPng *info)</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8cpp_source.html#l02726">lodepng.cpp:2726</a></div></div>
<div class="ttc" id="struct_lode_p_n_g___encoder_html_af37ca9b0bcecd5d1d68756fd293ab998"><div class="ttname"><a href="struct_lode_p_n_g___encoder.html#af37ca9b0bcecd5d1d68756fd293ab998">LodePNG_Encoder::infoRaw</a></div><div class="ttdeci">LodePNG_InfoRaw infoRaw</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8h_source.html#l00726">lodepng.h:726</a></div></div>
<div class="ttc" id="struct_huffman_tree_html_a0bb5fd80eb9ec029f66cf30641b98363"><div class="ttname"><a href="struct_huffman_tree.html#a0bb5fd80eb9ec029f66cf30641b98363">HuffmanTree::tree1d</a></div><div class="ttdeci">uivector tree1d</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8cpp_source.html#l00538">lodepng.cpp:538</a></div></div>
<div class="ttc" id="lodepng_8cpp_html_a0c0160b2f998d5966324922a153ee557"><div class="ttname"><a href="lodepng_8cpp.html#a0c0160b2f998d5966324922a153ee557">LodePNG_Encoder_copy</a></div><div class="ttdeci">void LodePNG_Encoder_copy(LodePNG_Encoder *dest, const LodePNG_Encoder *source)</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8cpp_source.html#l05217">lodepng.cpp:5217</a></div></div>
<div class="ttc" id="struct_huffman_tree_html_a608df5a24f60d1077a5cde19d5149e1f"><div class="ttname"><a href="struct_huffman_tree.html#a608df5a24f60d1077a5cde19d5149e1f">HuffmanTree::numcodes</a></div><div class="ttdeci">unsigned numcodes</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8cpp_source.html#l00541">lodepng.cpp:541</a></div></div>
<div class="ttc" id="struct_lode_p_n_g___decoder_html_a1986e8d73bf733140e2de07993685983"><div class="ttname"><a href="struct_lode_p_n_g___decoder.html#a1986e8d73bf733140e2de07993685983">LodePNG_Decoder::error</a></div><div class="ttdeci">unsigned error</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8h_source.html#l00652">lodepng.h:652</a></div></div>
<div class="ttc" id="lodepng_8cpp_html_a9de001414ae7aa2b695c31171b4267ff"><div class="ttname"><a href="lodepng_8cpp.html#a9de001414ae7aa2b695c31171b4267ff">LodePNG_Text_add</a></div><div class="ttdeci">unsigned LodePNG_Text_add(LodePNG_Text *text, const char *key, const char *str)</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8cpp_source.html#l02615">lodepng.cpp:2615</a></div></div>
<div class="ttc" id="struct_huffman_tree_html_a293790e0f67d8fdf9df5a2914af39251"><div class="ttname"><a href="struct_huffman_tree.html#a293790e0f67d8fdf9df5a2914af39251">HuffmanTree::lengths</a></div><div class="ttdeci">uivector lengths</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8cpp_source.html#l00539">lodepng.cpp:539</a></div></div>
<div class="ttc" id="lodepng_8cpp_html_a698acb89e1bf5837b33c30ef35c30044"><div class="ttname"><a href="lodepng_8cpp.html#a698acb89e1bf5837b33c30ef35c30044">VERSION_STRING</a></div><div class="ttdeci">#define VERSION_STRING</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8cpp_source.html#l00040">lodepng.cpp:40</a></div></div>
<div class="ttc" id="lodepng_8cpp_html_af3cff22c00facc19aa15202f1001e863"><div class="ttname"><a href="lodepng_8cpp.html#af3cff22c00facc19aa15202f1001e863">LodePNG_chunk_type</a></div><div class="ttdeci">void LodePNG_chunk_type(char type[5], const unsigned char *chunk)</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8cpp_source.html#l02294">lodepng.cpp:2294</a></div></div>
<div class="ttc" id="lodepng_8cpp_html_a08a6b93d30eb7ee67b9c0788436b3bd6"><div class="ttname"><a href="lodepng_8cpp.html#a08a6b93d30eb7ee67b9c0788436b3bd6">LodePNG_chunk_private</a></div><div class="ttdeci">unsigned char LodePNG_chunk_private(const unsigned char *chunk)</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8cpp_source.html#l02312">lodepng.cpp:2312</a></div></div>
<div class="ttc" id="struct_lode_p_n_g___info_png_html_a97faa43bfd4e8f8df1cd836c713edac3"><div class="ttname"><a href="struct_lode_p_n_g___info_png.html#a97faa43bfd4e8f8df1cd836c713edac3">LodePNG_InfoPng::unknown_chunks</a></div><div class="ttdeci">LodePNG_UnknownChunks unknown_chunks</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8h_source.html#l00576">lodepng.h:576</a></div></div>
<div class="ttc" id="struct_lode_p_n_g___info_color_html_aa0193ce13025c776a0dfb1e6d1bed14a"><div class="ttname"><a href="struct_lode_p_n_g___info_color.html#aa0193ce13025c776a0dfb1e6d1bed14a">LodePNG_InfoColor::key_defined</a></div><div class="ttdeci">unsigned key_defined</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8h_source.html#l00365">lodepng.h:365</a></div></div>
<div class="ttc" id="lodepng_8cpp_html_af803b1b42c6d252d173df9cd0b32725a"><div class="ttname"><a href="lodepng_8cpp.html#af803b1b42c6d252d173df9cd0b32725a">CERROR_BREAK</a></div><div class="ttdeci">#define CERROR_BREAK(errorvar, code)</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8cpp_source.html#l00064">lodepng.cpp:64</a></div></div>
<div class="ttc" id="lodepng_8cpp_html_a3cd7cc1583795fd14b7fe1179e005ab1"><div class="ttname"><a href="lodepng_8cpp.html#a3cd7cc1583795fd14b7fe1179e005ab1">LodePNG_EncodeSettings_init</a></div><div class="ttdeci">void LodePNG_EncodeSettings_init(LodePNG_EncodeSettings *settings)</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8cpp_source.html#l05191">lodepng.cpp:5191</a></div></div>
<div class="ttc" id="struct_lode_p_n_g___info_raw_html_ae9fa1c020358980be41f861ab71589fb"><div class="ttname"><a href="struct_lode_p_n_g___info_raw.html#ae9fa1c020358980be41f861ab71589fb">LodePNG_InfoRaw::color</a></div><div class="ttdeci">LodePNG_InfoColor color</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8h_source.html#l00593">lodepng.h:593</a></div></div>
<div class="ttc" id="struct_lode_p_n_g___text_html_a51f019c99f3759befdf3ba5c8f6de70f"><div class="ttname"><a href="struct_lode_p_n_g___text.html#a51f019c99f3759befdf3ba5c8f6de70f">LodePNG_Text::keys</a></div><div class="ttdeci">char ** keys</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8h_source.html#l00443">lodepng.h:443</a></div></div>
<div class="ttc" id="struct_lode_p_n_g___info_color_html"><div class="ttname"><a href="struct_lode_p_n_g___info_color.html">LodePNG_InfoColor</a></div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8h_source.html#l00333">lodepng.h:333</a></div></div>
<div class="ttc" id="lodepng_8cpp_html_aa9aea0a1381bbd4357058eaecb56cbb3"><div class="ttname"><a href="lodepng_8cpp.html#aa9aea0a1381bbd4357058eaecb56cbb3">LodePNG_DecodeSettings_init</a></div><div class="ttdeci">void LodePNG_DecodeSettings_init(LodePNG_DecodeSettings *settings)</div><div class="ttdef"><b>Definition:</b> <a href="lodepng_8cpp_source.html#l04165">lodepng.cpp:4165</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_5752cadd8276ecfd63d9b924f2a4d4b5.html">framework</a></li><li class="navelem"><a class="el" href="dir_8e5ec1f0ab17a1b08d4aec419fa9802a.html">3rdparty</a></li><li class="navelem"><a class="el" href="dir_e20c216edfcb95fb98f4861a011b4662.html">lodepng</a></li><li class="navelem"><a class="el" href="lodepng_8cpp.html">lodepng.cpp</a></li>
    <li class="footer">Generated on Wed Dec 10 2014 14:36:43 for NTrace by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.6 </li>
  </ul>
</div>
</body>
</html>
